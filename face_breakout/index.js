(()=>{var hW=Object.create;var Lf=Object.defineProperty;var gW=Object.getOwnPropertyDescriptor;var vW=Object.getOwnPropertyNames;var xW=Object.getPrototypeOf,yW=Object.prototype.hasOwnProperty;var Tk=r=>Lf(r,"__esModule",{value:!0});var jt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Io=(r,e)=>{Tk(r);for(var t in e)Lf(r,t,{get:e[t],enumerable:!0})},bW=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of vW(e))!yW.call(r,n)&&n!=="default"&&Lf(r,n,{get:()=>e[n],enumerable:!(t=gW(e,n))||t.enumerable});return r},kc=r=>bW(Tk(Lf(r!=null?hW(xW(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var Be=(r,e,t)=>new Promise((n,o)=>{var a=u=>{try{s(t.next(u))}catch(l){o(l)}},i=u=>{try{s(t.throw(u))}catch(l){o(l)}},s=u=>u.done?n(u.value):Promise.resolve(u.value).then(a,i);s((t=t.apply(r,e)).next())});var Dv=jt(()=>{});var Ak=jt(()=>{});var Rv=jt(()=>{});var Id=jt(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var wW=Dv();function kW(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var _W=kW(wW);var $v=function(r,e){return $v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},$v(r,e)};function Co(r,e){$v(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function De(r,e,t,n){function o(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function s(c){try{l(n.next(c))}catch(p){i(p)}}function u(c){try{l(n.throw(c))}catch(p){i(p)}}function l(c){c.done?a(c.value):o(c.value).then(s,u)}l((n=n.apply(r,e||[])).next())})}function Re(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,o=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(c){l=[6,c],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Zr(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ee(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,a=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)a.push(o.value)}catch(s){i={error:s}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(i)throw i.error}}return a}function gt(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Ee(arguments[e]));return r}var SW=1e-7,IW=1e-4,CW=function(){function r(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},r.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},r.prototype.has=function(e){return this.data.has(e)},r.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},r.prototype.numDataIds=function(){return this.dataIdsCount},r}(),Fk=function(){function r(){}return r.prototype.refCount=function(e){return bn("refCount")},r.prototype.incRef=function(e){return bn("incRef")},r.prototype.timerAvailable=function(){return!0},r.prototype.time=function(e){return bn("time")},r.prototype.read=function(e){return bn("read")},r.prototype.readSync=function(e){return bn("readSync")},r.prototype.numDataIds=function(){return bn("numDataIds")},r.prototype.disposeData=function(e,t){return bn("disposeData")},r.prototype.write=function(e,t,n){return bn("write")},r.prototype.move=function(e,t,n,o,a){return bn("move")},r.prototype.memory=function(){return bn("memory")},r.prototype.floatPrecision=function(){return bn("floatPrecision")},r.prototype.epsilon=function(){return this.floatPrecision()===32?SW:IW},r.prototype.dispose=function(){return bn("dispose")},r}();function bn(r){throw new Error("'"+r+"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen")}function Dk(r){for(var e=r.length,t=0;e>0;)t=Math.random()*e|0,e--,Vf(r,e,t)}function NW(r,e){if(r.length!==e.length)throw new Error("Array sizes must match to be shuffled together "+("First array length was "+r.length)+("Second array length was "+e.length));for(var t=r.length,n=0;t>0;)n=Math.random()*t|0,t--,Vf(r,t,n),Vf(e,t,n)}function _c(r,e,t){return Math.max(r,Math.min(e,t))}function EW(r){return r%2==0?r:r+1}function Vf(r,e,t){var n=r[e];r[e]=r[t],r[t]=n}function TW(r){for(var e=0,t=0;t<r.length;t++)e+=r[t];return e}function AW(r,e){var t=Math.random();return e*t+(1-t)*r}function FW(r,e){for(var t=0,n=0;n<r.length;n++){var o=Number(r[n])-Number(e[n]);t+=o*o}return t}function P(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function $r(r,e,t){t===void 0&&(t=""),P(No(r,e),function(){return t+(" Shapes "+r+" and "+e+" must match")})}function Qa(r){P(r!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function es(r,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(r)||Er(r)&&!t)for(var n=0;n<r.length;++n)es(r[n],e,t);else e.push(r);return e}function sr(r){if(r.length===0)return 1;for(var e=r[0],t=1;t<r.length;t++)e*=r[t];return e}function DW(r){return r.length===0}function No(r,e){if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function zr(r){return r%1==0}function RW(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var e=Math.exp(2*r);return(e-1)/(e+1)}function $W(r){var e=Math.ceil(Math.sqrt(r));return[e,Math.ceil(r/e)]}function PW(r){for(var e=new Uint32Array(r),t=0;t<r;++t)e[t]=t;return Dk(e),e}function Sc(r,e){return e<=r.length?r:r+" ".repeat(e-r.length)}function OW(r,e,t){return e===void 0&&(e=function(n){return 0}),new Promise(function(n,o){var a=0,i=function(){if(r()){n();return}a++;var s=e(a);if(t!=null&&a>=t){o();return}setTimeout(i,s)};i()})}function MW(r,e){for(var t=1,n=-1,o=0;o<r.length;++o)if(r[o]>=0)t*=r[o];else if(r[o]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+n+" and dim "+o));n=o}else if(r[o]<0)throw Error("Shapes can not be < 0. Found "+r[o]+" at dim "+o);if(n===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+r);return r}if(t===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. "+("Got "+e+" / "+t));var a=r.slice();return a[n]=e/t,a}function Ic(r,e){var t=e.length;return r=r==null?e.map(function(n,o){return o}):[].concat(r),P(r.every(function(n){return n>=-t&&n<t}),function(){return"All values in axis param must be in range [-"+t+", "+t+") but "+("got axis "+r)}),P(r.every(function(n){return zr(n)}),function(){return"All values in axis param must be integers but "+("got axis "+r)}),r.map(function(n){return n<0?t+n:n})}function Rk(r,e){for(var t=[],n=[],o=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||o?null:Ic(e,r).sort(),i=0,s=0;s<r.length;++s){if(a!=null){if(a[i]===s&&r[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+r[s]+"' is not 1");(a[i]==null||a[i]>s)&&r[s]===1&&(t.push(r[s]),n.push(s)),a[i]<=s&&i++}r[s]!==1&&(t.push(r[s]),n.push(s))}return{newShape:t,keptDims:n}}function $k(r,e){var t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else throw new Error("Unknown data type "+r);return t}function Pk(r,e){var t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else if(r==="string")t=new Array(e);else throw new Error("Unknown data type "+r);return t}function Ok(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+e+" being uploaded contains "+n+".")}}function Mk(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function BW(r,e){return!(e==="complex64"||e==="float32"&&r!=="complex64"||e==="int32"&&r!=="float32"&&r!=="complex64"||e==="bool"&&r==="bool")}function Er(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray}function Pv(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function Bk(r){if(r==null)return 0;var e=0;return r.forEach(function(t){return e+=t.length}),e}function da(r){return typeof r=="string"||r instanceof String}function Lk(r){return typeof r=="boolean"}function Vk(r){return typeof r=="number"}function Wf(r){return Array.isArray(r)?Wf(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray?"int32":Vk(r)?"float32":da(r)?"string":Lk(r)?"bool":"float32"}function ma(r){return!!(r&&r.constructor&&r.call&&r.apply)}function zf(r,e){for(var t=e;t<r;++t)if(r%t==0)return t;return r}function Du(r){var e=r.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=r[e-1];for(var n=e-3;n>=0;--n)t[n]=t[n+1]*r[n+1];return t}function Wk(r,e,t,n){n===void 0&&(n=!1);var o=new Array;if(e.length===1)for(var a=e[0]*(n?2:1),i=0;i<a;i++)o[i]=t[r+i];else for(var a=e[0],s=e.slice(1),u=s.reduce(function(c,p){return c*p})*(n?2:1),i=0;i<a;i++)o[i]=Wk(r+i*u,s,t,n);return o}function Ru(r,e,t){if(t===void 0&&(t=!1),r.length===0)return e[0];var n=r.reduce(function(o,a){return o*a})*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error("["+r+"] does not match the input size "+e.length+(t?" for a complex tensor":"")+".");return Wk(0,r,e,t)}function Ov(r,e){for(var t=Uf(r,e),n=0;n<t.length;n++)t[n]=1;return t}function Uf(r,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+e)}function LW(r,e){var t=r.reduce(function(n,o){return n*o},1);if(e==null||e==="float32")return Ru(r,new Float32Array(t));if(e==="int32")return Ru(r,new Int32Array(t));if(e==="bool")return Ru(r,new Uint8Array(t));throw new Error("Unknown data type "+e)}function Mv(r){r.forEach(function(e){P(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+r+"].")})})}function VW(r,e,t){if(e===0)return 0;if(e===1)return r[0];for(var n=r[r.length-1],o=0;o<r.length-1;++o)n+=t[o]*r[o];return n}function WW(r,e,t){if(e===0)return[];if(e===1)return[r];for(var n=new Array(e),o=0;o<n.length-1;++o)n[o]=Math.floor(r/t[o]),r-=n[o]*t[o];return n[n.length-1]=r,n}function Bv(r){return r&&r.then&&typeof r.then=="function"}function eo(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];at().getBool("IS_TEST")||at().getBool("PROD")||console.warn.apply(console,gt(r))}function zW(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];at().getBool("IS_TEST")||at().getBool("PROD")||console.log.apply(console,gt(r))}var zk="tfjsflags",Uk=function(){function r(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=UW,this.populateURLFlags()}return r.prototype.setPlatform=function(e,t){this.platform!=null&&eo("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+t+".")),this.platformName=e,this.platform=t},r.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){var o=this.urlFlags[e];eo("Setting feature override from URL "+e+": "+o+"."),this.set(e,o)}},r.prototype.getAsync=function(e){return De(this,void 0,void 0,function(){var t,n;return Re(this,function(o){switch(o.label){case 0:return e in this.flags?[2,this.flags[e]]:(t=this.flags,n=e,[4,this.evaluateFlag(e)]);case 1:return t[n]=o.sent(),[2,this.flags[e]]}})})},r.prototype.get=function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Bv(t))throw new Error("Flag "+e+" cannot be synchronously evaluated. Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]},r.prototype.getNumber=function(e){return this.get(e)},r.prototype.getBool=function(e){return this.get(e)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},r.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},r.prototype.setFlags=function(e){this.flags=Object.assign({},e)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var e=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var t=this.getQueryParams(this.global.location.search);if(zk in t){var n=t[zk].split(",");n.forEach(function(o){var a=Ee(o.split(":"),2),i=a[0],s=a[1];e.urlFlags[i]=jW(i,s)})}}},r}();function UW(r){var e={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return GW(e,n[0],n[1]),n.join("=")}),e}function GW(r,e,t){r[decodeURIComponent(e)]=decodeURIComponent(t||"")}function jW(r,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+r+".")}function at(){return I.ENV}I.ENV=null;function HW(r){I.ENV=r}var Lv;function Gk(){if(Lv==null){var r=void 0;if(typeof window!="undefined")r=window;else if(typeof global!="undefined")r=global;else if(typeof process!="undefined")r=process;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");Lv=r}return Lv}function qW(){var r=Gk();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function Vv(r,e){var t=qW();if(t.has(r))return t.get(r);var n=e();return t.set(r,n),t.get(r)}var jk="Abs",Hk="Acos",qk="Acosh",Wv="Add",Kk="AddN",Xk="All",Yk="Any",Zk="ArgMax",Jk="ArgMin",Qk="Asin",e_="Asinh",t_="Atan",r_="Atanh",n_="Atan2",o_="AvgPool",KW="AvgPoolGrad",a_="AvgPool3D",XW="AvgPool3DGrad",s_="BatchMatMul",i_="BatchToSpaceND",u_="Bincount",YW="BroadcastTo",l_="BroadcastArgs",zv="Cast",c_="Ceil",p_="ClipByValue",f_="Complex",d_="ComplexAbs",m_="Concat",h_="Conv2D",g_="Conv2DBackpropFilter",v_="Conv2DBackpropInput",x_="Conv3D",ZW="Conv3DBackpropFilterV2",y_="Conv3DBackpropInputV2",b_="Cos",w_="Cosh",k_="Cumsum",__="CropAndResize",S_="DenseBincount",I_="DepthToSpace",C_="DepthwiseConv2dNative",N_="DepthwiseConv2dNativeBackpropFilter",E_="DepthwiseConv2dNativeBackpropInput",T_="Diag",A_="Dilation2D",JW="Dilation2DBackpropInput",QW="Dilation2DBackpropFilter",F_="RealDiv",D_="Einsum",R_="Elu",ez="EluGrad",$_="Erf",P_="Equal",O_="Exp",M_="ExpandDims",B_="Expm1",L_="FFT",V_="Fill",W_="FlipLeftRight",z_="Floor",U_="FloorDiv",G_="FusedBatchNorm",j_="GatherV2",H_="GatherNd",q_="Greater",K_="GreaterEqual",Uv="Identity",X_="IFFT",Y_="Imag",Z_="IsFinite",J_="IsInf",Q_="IsNan",eS="LeakyRelu",tS="Less",rS="LessEqual",nS="LinSpace",oS="Log",aS="Log1p",sS="LogicalAnd",iS="LogicalNot",uS="LogicalOr",tz="LogSoftmax",lS="LRN",rz="LRNGrad",cS="Max",pS="Maximum",fS="MaxPool",nz="MaxPoolGrad",dS="MaxPool3D",oz="MaxPool3DGrad",mS="MaxPoolWithArgmax",hS="Mean",gS="Min",vS="Minimum",xS="MirrorPad",yS="Mod",bS="Multinomial",wS="Multiply",kS="Neg",_S="NotEqual",SS="NonMaxSuppressionV3",IS="NonMaxSuppressionV4",CS="NonMaxSuppressionV5",NS="OnesLike",ES="OneHot",TS="Pack",AS="PadV2",az="Pool",FS="Pow",DS="Prelu",RS="Prod",$S="Range",PS="Real",OS="Reciprocal",MS="Relu",BS="Reshape",LS="ResizeNearestNeighbor",sz="ResizeNearestNeighborGrad",VS="ResizeBilinear",iz="ResizeBilinearGrad",WS="Relu6",zS="Reverse",US="Round",GS="Rsqrt",jS="ScatterNd",HS="Select",qS="Selu",KS="Slice",XS="Sin",YS="Sinh",ZS="Sign",JS="Sigmoid",QS="Softplus",e2="Sqrt",t2="Sum",r2="SpaceToBatchND",n2="SplitV",o2="Softmax",a2="SparseFillEmptyRows",s2="SparseReshape",i2="SparseSegmentMean",u2="SparseSegmentSum",l2="SparseToDense",c2="SquaredDifference",uz="Square",p2="StridedSlice",f2="StringNGrams",d2="StringSplit",m2="StringToHashBucketFast",h2="Sub",g2="Tan",v2="Tanh",Gv="Tile",x2="TopK",y2="Transform",b2="Transpose",w2="Unique",k2="Unpack",_2="UnsortedSegmentSum",S2="ZerosLike",I2="Step",jv="FromPixels",C2="RotateWithOffset",Hv="_FusedMatMul",qv="FusedConv2D",Kv="FusedDepthwiseConv2D",$u=Vv("kernelRegistry",function(){return new Map}),Cc=Vv("gradRegistry",function(){return new Map});function Gf(r,e){var t=Yv(r,e);return $u.get(t)}function Xv(r){return Cc.get(r)}function jf(r){for(var e=$u.entries(),t=[];;){var n=e.next(),o=n.done,a=n.value;if(o)break;var i=Ee(a,2),s=i[0],u=i[1],l=Ee(s.split("_"),1),c=l[0];c===r&&t.push(u)}return t}function N2(r){var e=r.kernelName,t=r.backendName,n=Yv(e,t);$u.has(n)&&eo("The kernel '"+e+"' for backend "+("'"+t+"' is already registered")),$u.set(n,r)}function lz(r){var e=r.kernelName;Cc.has(e)&&at().getBool("DEBUG")&&eo("Overriding the gradient for '"+e+"'"),Cc.set(e,r)}function cz(r,e){var t=Yv(r,e);if(!$u.has(t))throw new Error("The kernel '"+r+"' for backend "+("'"+e+"' is not registered"));$u.delete(t)}function pz(r){if(!Cc.has(r))throw new Error("The gradient '"+r+"' for backend is not registered");Cc.delete(r)}function fz(r,e){var t=jf(r);t.forEach(function(n){var o=Object.assign({},n,{backendName:e});N2(o)})}function Yv(r,e){return e+"_"+r}var Zv=Rt,wn=null;try{wn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function Rt(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Rt.prototype.__isLong__;Object.defineProperty(Rt.prototype,"__isLong__",{value:!0});function Jr(r){return(r&&r.__isLong__)===!0}Rt.isLong=Jr;var E2={},T2={};function ts(r,e){var t,n,o;return e?(r>>>=0,(o=0<=r&&r<256)&&(n=T2[r],n)?n:(t=$t(r,(r|0)<0?-1:0,!0),o&&(T2[r]=t),t)):(r|=0,(o=-128<=r&&r<128)&&(n=E2[r],n)?n:(t=$t(r,r<0?-1:0,!1),o&&(E2[r]=t),t))}Rt.fromInt=ts;function kn(r,e){if(isNaN(r))return e?rs:_n;if(e){if(r<0)return rs;if(r>=F2)return O2}else{if(r<=-D2)return Qr;if(r+1>=D2)return P2}return r<0?kn(-r,e).neg():$t(r%Pu|0,r/Pu|0,e)}Rt.fromNumber=kn;function $t(r,e,t){return new Rt(r,e,t)}Rt.fromBits=$t;var Hf=Math.pow;function Jv(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return _n;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return Jv(r.substring(1),e,t).neg();for(var o=kn(Hf(t,8)),a=_n,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),u=parseInt(r.substring(i,i+s),t);if(s<8){var l=kn(Hf(t,s));a=a.mul(l).add(kn(u))}else a=a.mul(o),a=a.add(kn(u))}return a.unsigned=e,a}Rt.fromString=Jv;function Wn(r,e){return typeof r=="number"?kn(r,e):typeof r=="string"?Jv(r,e):$t(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Rt.fromValue=Wn;var A2=1<<16,dz=1<<24,Pu=A2*A2,F2=Pu*Pu,D2=F2/2,R2=ts(dz),_n=ts(0);Rt.ZERO=_n;var rs=ts(0,!0);Rt.UZERO=rs;var Ou=ts(1);Rt.ONE=Ou;var $2=ts(1,!0);Rt.UONE=$2;var Qv=ts(-1);Rt.NEG_ONE=Qv;var P2=$t(4294967295|0,2147483647|0,!1);Rt.MAX_VALUE=P2;var O2=$t(4294967295|0,4294967295|0,!0);Rt.MAX_UNSIGNED_VALUE=O2;var Qr=$t(0,2147483648|0,!1);Rt.MIN_VALUE=Qr;var ge=Rt.prototype;ge.toInt=function(){return this.unsigned?this.low>>>0:this.low};ge.toNumber=function(){return this.unsigned?(this.high>>>0)*Pu+(this.low>>>0):this.high*Pu+(this.low>>>0)};ge.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Qr)){var t=kn(e),n=this.div(t),o=n.mul(t).sub(this);return n.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var a=kn(Hf(e,6),this.unsigned),i=this,s="";;){var u=i.div(a),l=i.sub(u.mul(a)).toInt()>>>0,c=l.toString(e);if(i=u,i.isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}};ge.getHighBits=function(){return this.high};ge.getHighBitsUnsigned=function(){return this.high>>>0};ge.getLowBits=function(){return this.low};ge.getLowBitsUnsigned=function(){return this.low>>>0};ge.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Qr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};ge.isZero=function(){return this.high===0&&this.low===0};ge.eqz=ge.isZero;ge.isNegative=function(){return!this.unsigned&&this.high<0};ge.isPositive=function(){return this.unsigned||this.high>=0};ge.isOdd=function(){return(this.low&1)==1};ge.isEven=function(){return(this.low&1)==0};ge.equals=function(e){return Jr(e)||(e=Wn(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};ge.eq=ge.equals;ge.notEquals=function(e){return!this.eq(e)};ge.neq=ge.notEquals;ge.ne=ge.notEquals;ge.lessThan=function(e){return this.comp(e)<0};ge.lt=ge.lessThan;ge.lessThanOrEqual=function(e){return this.comp(e)<=0};ge.lte=ge.lessThanOrEqual;ge.le=ge.lessThanOrEqual;ge.greaterThan=function(e){return this.comp(e)>0};ge.gt=ge.greaterThan;ge.greaterThanOrEqual=function(e){return this.comp(e)>=0};ge.gte=ge.greaterThanOrEqual;ge.ge=ge.greaterThanOrEqual;ge.compare=function(e){if(Jr(e)||(e=Wn(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ge.comp=ge.compare;ge.negate=function(){return!this.unsigned&&this.eq(Qr)?Qr:this.not().add(Ou)};ge.neg=ge.negate;ge.add=function(e){Jr(e)||(e=Wn(e));var t=this.high>>>16,n=this.high&65535,o=this.low>>>16,a=this.low&65535,i=e.high>>>16,s=e.high&65535,u=e.low>>>16,l=e.low&65535,c=0,p=0,f=0,d=0;return d+=a+l,f+=d>>>16,d&=65535,f+=o+u,p+=f>>>16,f&=65535,p+=n+s,c+=p>>>16,p&=65535,c+=t+i,c&=65535,$t(f<<16|d,c<<16|p,this.unsigned)};ge.subtract=function(e){return Jr(e)||(e=Wn(e)),this.add(e.neg())};ge.sub=ge.subtract;ge.multiply=function(e){if(this.isZero())return _n;if(Jr(e)||(e=Wn(e)),wn){var t=wn.mul(this.low,this.high,e.low,e.high);return $t(t,wn.get_high(),this.unsigned)}if(e.isZero())return _n;if(this.eq(Qr))return e.isOdd()?Qr:_n;if(e.eq(Qr))return this.isOdd()?Qr:_n;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(R2)&&e.lt(R2))return kn(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=this.high&65535,a=this.low>>>16,i=this.low&65535,s=e.high>>>16,u=e.high&65535,l=e.low>>>16,c=e.low&65535,p=0,f=0,d=0,m=0;return m+=i*c,d+=m>>>16,m&=65535,d+=a*c,f+=d>>>16,d&=65535,d+=i*l,f+=d>>>16,d&=65535,f+=o*c,p+=f>>>16,f&=65535,f+=a*l,p+=f>>>16,f&=65535,f+=i*u,p+=f>>>16,f&=65535,p+=n*c+o*l+a*u+i*s,p&=65535,$t(d<<16|m,p<<16|f,this.unsigned)};ge.mul=ge.multiply;ge.divide=function(e){if(Jr(e)||(e=Wn(e)),e.isZero())throw Error("division by zero");if(wn){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?wn.div_u:wn.div_s)(this.low,this.high,e.low,e.high);return $t(t,wn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?rs:_n;var n,o,a;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return rs;if(e.gt(this.shru(1)))return $2;a=rs}else{if(this.eq(Qr)){if(e.eq(Ou)||e.eq(Qv))return Qr;if(e.eq(Qr))return Ou;var i=this.shr(1);return n=i.div(e).shl(1),n.eq(_n)?e.isNegative()?Ou:Qv:(o=this.sub(e.mul(n)),a=n.add(o.div(e)),a)}else if(e.eq(Qr))return this.unsigned?rs:_n;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=_n}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),u=s<=48?1:Hf(2,s-48),l=kn(n),c=l.mul(e);c.isNegative()||c.gt(o);)n-=u,l=kn(n,this.unsigned),c=l.mul(e);l.isZero()&&(l=Ou),a=a.add(l),o=o.sub(c)}return a};ge.div=ge.divide;ge.modulo=function(e){if(Jr(e)||(e=Wn(e)),wn){var t=(this.unsigned?wn.rem_u:wn.rem_s)(this.low,this.high,e.low,e.high);return $t(t,wn.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ge.mod=ge.modulo;ge.rem=ge.modulo;ge.not=function(){return $t(~this.low,~this.high,this.unsigned)};ge.and=function(e){return Jr(e)||(e=Wn(e)),$t(this.low&e.low,this.high&e.high,this.unsigned)};ge.or=function(e){return Jr(e)||(e=Wn(e)),$t(this.low|e.low,this.high|e.high,this.unsigned)};ge.xor=function(e){return Jr(e)||(e=Wn(e)),$t(this.low^e.low,this.high^e.high,this.unsigned)};ge.shiftLeft=function(e){return Jr(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?$t(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):$t(0,this.low<<e-32,this.unsigned)};ge.shl=ge.shiftLeft;ge.shiftRight=function(e){return Jr(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?$t(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):$t(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ge.shr=ge.shiftRight;ge.shiftRightUnsigned=function(e){if(Jr(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var n=this.low;return $t(n>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?$t(t,0,this.unsigned):$t(t>>>e-32,0,this.unsigned)};ge.shru=ge.shiftRightUnsigned;ge.shr_u=ge.shiftRightUnsigned;ge.toSigned=function(){return this.unsigned?$t(this.low,this.high,!1):this};ge.toUnsigned=function(){return this.unsigned?this:$t(this.low,this.high,!0)};ge.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ge.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ge.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Rt.fromBytes=function(e,t,n){return n?Rt.fromBytesLE(e,t):Rt.fromBytesBE(e,t)};Rt.fromBytesLE=function(e,t){return new Rt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Rt.fromBytesBE=function(e,t){return new Rt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var mz=Object.assign(Object.create(null),Zv,{default:Zv}),ns=Zv||mz;function Nc(r){return ns.fromString(r,!0,16)}var M2=Nc("c3a5c85c97cb3127"),os=Nc("b492b66fbe98f273"),Pr=Nc("9ae16a3b2f90404f");function ex(r){return r.xor(r.shru(47))}function B2(r,e,t){var n=r.slice(e,e+t);return ns.fromBytes(Array.from(n),!0,!0)}function It(r,e){return B2(r,e,8)}function L2(r,e){return B2(r,e,4)}function vr(r,e){return e===0?r:r.shru(e).or(r.shl(64-e))}function ha(r,e,t){t===void 0&&(t=Nc("9ddfea08eb382d69"));var n=r.xor(e).mul(t);n=n.xor(n.shru(47));var o=e.xor(n).mul(t);return o=o.xor(o.shru(47)),o=o.mul(t),o}function hz(r,e,t,n,o,a){o=o.add(r),a=vr(a.add(o).add(n),21);var i=o;return o=o.add(e),o=o.add(t),a=a.add(vr(o,44)),[o.add(n),a.add(i)]}function qf(r,e,t,n){return hz(It(r,e),It(r,e+8),It(r,e+16),It(r,e+24),t,n)}function gz(r,e){if(e===void 0&&(e=r.length),e>=8){var t=Pr.add(e*2),n=It(r,0).add(Pr),o=It(r,e-8),a=vr(o,37).mul(t).add(n),i=vr(n,25).add(o).mul(t);return ha(a,i,t)}if(e>=4){var t=Pr.add(e*2),n=L2(r,0);return ha(n.shl(3).add(e),L2(r,e-4),t)}if(e>0){var n=r[0],o=r[e>>1],a=r[e-1],s=n+(o<<8),u=e+(a<<2);return ex(Pr.mul(s).xor(M2.mul(u))).mul(Pr)}return Pr}function vz(r,e){e===void 0&&(e=r.length);var t=Pr.add(e*2),n=It(r,0).mul(os),o=It(r,8),a=It(r,e-8).mul(t),i=It(r,e-16).mul(Pr);return ha(vr(n.add(o),43).add(vr(a,30)).add(i),n.add(vr(o.add(Pr),18)).add(a),t)}function xz(r,e){e===void 0&&(e=r.length);var t=Pr.add(e*2),n=It(r,0).mul(Pr),o=It(r,8),a=It(r,e-8).mul(t),i=It(r,e-16).mul(Pr),s=vr(n.add(o),43).add(vr(a,30)).add(i),u=ha(s,n.add(vr(o.add(Pr),18)).add(a),t),l=It(r,16).mul(t),c=It(r,24),p=s.add(It(r,e-32)).mul(t),f=u.add(It(r,e-24)).mul(t);return ha(vr(l.add(c),43).add(vr(p,30)).add(f),l.add(vr(c.add(n),18)).add(p),t)}function yz(r,e){var t,n;e===void 0&&(e=r.length);var o=ns.fromNumber(81,!0);if(e<=32)return e<=16?gz(r,e):vz(r,e);if(e<=64)return xz(r,e);var a=o,i=o.mul(os).add(113),s=ex(i.mul(Pr).add(113)).mul(Pr),u=[ns.UZERO,ns.UZERO],l=[ns.UZERO,ns.UZERO];a=a.mul(Pr).add(It(r,0));var c=0,p=(e-1>>6)*64,f=p+(e-1&63)-63;do a=vr(a.add(i).add(u[0]).add(It(r,c+8)),37).mul(os),i=vr(i.add(u[1]).add(It(r,c+48)),42).mul(os),a=a.xor(l[1]),i=i.add(u[0]).add(It(r,c+40)),s=vr(s.add(l[0]),33).mul(os),u=qf(r,c,u[1].mul(os),a.add(l[0])),l=qf(r,c+32,s.add(l[1]),i.add(It(r,c+16))),t=Ee([a,s],2),s=t[0],a=t[1],c+=64;while(c!==p);var d=os.add(s.and(255).shl(1));return c=f,l[0]=l[0].add(e-1&63),u[0]=u[0].add(l[0]),l[0]=l[0].add(u[0]),a=vr(a.add(i).add(u[0]).add(It(r,c+8)),37).mul(d),i=vr(i.add(u[1]).add(It(r,c+48)),42).mul(d),a=a.xor(l[1].mul(9)),i=i.add(u[0].mul(9).add(It(r,c+40))),s=vr(s.add(l[0]),33).mul(d),u=qf(r,c,u[1].mul(d),a.add(l[0])),l=qf(r,c+32,s.add(l[1]),i.add(It(r,c+16))),n=Ee([a,s],2),s=n[0],a=n[1],ha(ha(u[0],l[0],d).add(ex(i).mul(M2)).add(s),ha(u[1],l[1],d).add(a),d)}function bz(r,e){return e==="string"?Tc(r):Kf([r],e)}function wz(r,e){return r instanceof Float32Array&&e==="float32"||r instanceof Int32Array&&e==="int32"||r instanceof Uint8Array&&e==="bool"}function Kf(r,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=es(r)),at().getBool("DEBUG")&&Ok(r,e),wz(r,e))return r;if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool"){for(var t=new Uint8Array(r.length),n=0;n<t.length;++n)Math.round(r[n])!==0&&(t[n]=1);return t}else throw new Error("Unknown data type "+e)}function Ec(){return at().platform.now()}function kz(r,e){return at().platform.fetch(r,e)}function Tc(r,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",at().platform.encode(r,e)}function Xf(r,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",at().platform.decode(r,e)}var _z={__proto__:null,createScalarValue:bz,toTypedArray:Kf,now:Ec,fetch:kz,encodeString:Tc,decodeString:Xf,shuffle:Dk,shuffleCombo:NW,clamp:_c,nearestLargerEven:EW,swap:Vf,sum:TW,randUniform:AW,distSquared:FW,assert:P,assertShapesMatch:$r,assertNonNull:Qa,flatten:es,sizeFromShape:sr,isScalarShape:DW,arraysEqual:No,isInt:zr,tanh:RW,sizeToSquarishShape:$W,createShuffledIndices:PW,rightPad:Sc,repeatedTry:OW,inferFromImplicitShape:MW,parseAxisParam:Ic,squeezeShape:Rk,getTypedArrayFromDType:$k,getArrayFromDType:Pk,checkConversionForErrors:Ok,isValidDtype:Mk,hasEncodingLoss:BW,isTypedArray:Er,bytesPerElement:Pv,bytesFromStringArray:Bk,isString:da,isBoolean:Lk,isNumber:Vk,inferDtype:Wf,isFunction:ma,nearestDivisor:zf,computeStrides:Du,toNestedArray:Ru,makeOnesTypedArray:Ov,makeZerosTypedArray:Uf,makeZerosNestedTypedArray:LW,assertNonNegativeIntegerDimensions:Mv,locToIndex:VW,indexToLoc:WW,isPromise:Bv,hexToLong:Nc,fingerPrint64:yz},Sz=function(){function r(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Cz)}return r.prototype.profileKernel=function(e,t,n){var o,a,i,s=function(){i=n()},u,l=Ec();if(this.backendTimer.timerAvailable())u=this.backendTimer.time(s);else{s();try{for(var c=Zr(i),p=c.next();!p.done;p=c.next()){var f=p.value;f.dataSync()}}catch(g){o={error:g}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}u=Promise.resolve({kernelMs:Ec()-l})}if(at().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var d=function(g){var v=i[g];v.data().then(function(x){Iz(x,v.dtype,e)})},m=0;m<i.length;m++)d(m);var h={kernelName:e,outputs:i,inputs:t,timeMs:u.then(function(g){return g.kernelMs}),extraInfo:u.then(function(g){return g.getExtraProfileInfo!=null?g.getExtraProfileInfo():""})};return h},r.prototype.logKernelProfile=function(e){var t=this,n=e.kernelName,o=e.outputs,a=e.timeMs,i=e.inputs,s=e.extraInfo;o.forEach(function(u){Promise.all([u.data(),a,s]).then(function(l){t.logger.logKernelProfile(n,u,l[0],l[1],i,l[2])})})},r}();function Iz(r,e,t){if(e!=="float32")return!1;for(var n=0;n<r.length;n++){var o=r[n];if(isNaN(o)||!isFinite(o))return console.warn("Found "+o+" in the result of '"+t+"'"),!0}return!1}var Cz=function(){function r(){}return r.prototype.logKernelProfile=function(e,t,n,o,a,i){var s=typeof o=="number"?Sc(o+"ms",9):o.error,u=Sc(e,25),l=t.rank,c=t.size,p=Sc(t.shape.toString(),14),f="";for(var d in a){var m=a[d];if(m!=null){var h=m.shape||t.shape,g=h.length;f+=d+": "+g+"D "+(g>0?h:"")+" "}}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+p+"	%c"+c+"	%c"+f+"	%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r}();function Nz(r,e,t){for(var n={},o={},a=0;a<e.length;a++)n[e[a].id]=!0;for(var a=0;a<r.length;a++){var i=r[a],s=i.inputs;for(var u in s){for(var l=s[u],c=!1,p=0;p<e.length;p++)if(n[l.id]){i.outputs.forEach(function(y){return n[y.id]=!0}),c=!0,o[i.id]=!0;break}if(c)break}}var f={};f[t.id]=!0;for(var d={},a=r.length-1;a>=0;a--)for(var i=r[a],s=i.inputs,p=0;p<i.outputs.length;p++)if(f[i.outputs[p].id]){for(var u in s)f[s[u].id]=!0,d[i.id]=!0;break}for(var m=[],a=0;a<r.length;a++){var i=r[a];if(o[i.id]&&d[i.id]){var h={};for(var u in i.inputs){var g=i.inputs[u];n[g.id]&&(h[u]=g)}var v=Object.assign({},i);v.inputs=h,v.outputs=i.outputs,m.push(v)}}return m}function Ez(r,e,t,n){for(var o=function(i){var s=e[i],u=[];if(s.outputs.forEach(function(f){var d=r[f.id];d!=null?u.push(d):u.push(null)}),s.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+s.kernelName+"."));var l=s.gradient(u),c=function(f){if(!(f in l))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(l)+"."));var d=t(function(){return l[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+s.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var m=s.inputs[f];if(!No(d.shape,m.shape))throw new Error("Error in gradient for op "+s.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+m.shape+"'"));if(r[m.id]==null)r[m.id]=d;else{var h=r[m.id];r[m.id]=n(h,d),h.dispose()}};for(var p in s.inputs)c(p)},a=e.length-1;a>=0;a--)o(a)}var V2=20,Ac=3,tx=7;function Tz(r,e,t,n){var o=Du(e),a=Az(r,e,t,o),i=e.length,s=Yf(r,e,t,o,a),u=["Tensor"];return n&&(u.push("  dtype: "+t),u.push("  rank: "+i),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Az(r,e,t,n){var o=sr(e),a=n[n.length-1],i=new Array(a).fill(0),s=e.length,u=t==="complex64"?Dc(r):r;if(s>1)for(var l=0;l<o/a;l++)for(var c=l*a,p=0;p<a;p++)i[p]=Math.max(i[p],Fc(u[c+p],0,t).length);return i}function Fc(r,e,t){var n;return Array.isArray(r)?n=parseFloat(r[0].toFixed(tx))+" + "+(parseFloat(r[1].toFixed(tx))+"j"):da(r)?n="'"+r+"'":t==="bool"?n=W2(r):n=parseFloat(r.toFixed(tx)).toString(),Sc(n,e)}function W2(r){return r===0?"false":"true"}function Yf(r,e,t,n,o,a){a===void 0&&(a=!0);var i=t==="complex64"?2:1,s=e[0],u=e.length;if(u===0){if(t==="complex64"){var l=Dc(r);return[Fc(l[0],0,t)]}return t==="bool"?[W2(r[0])]:[r[0].toString()]}if(u===1){if(s>V2){var c=Ac*i,p=Array.from(r.slice(0,c)),f=Array.from(r.slice((s-Ac)*i,s*i));return t==="complex64"&&(p=Dc(p),f=Dc(f)),["["+p.map(function(E,T){return Fc(E,o[T],t)}).join(", ")+", ..., "+f.map(function(E,T){return Fc(E,o[s-Ac+T],t)}).join(", ")+"]"]}var d=t==="complex64"?Dc(r):Array.from(r);return["["+d.map(function(E,T){return Fc(E,o[T],t)}).join(", ")+"]"]}var m=e.slice(1),h=n.slice(1),g=n[0]*i,v=[];if(s>V2){for(var x=0;x<Ac;x++){var y=x*g,b=y+g;v.push.apply(v,gt(Yf(r.slice(y,b),m,t,h,o,!1)))}v.push("...");for(var x=s-Ac;x<s;x++){var y=x*g,b=y+g;v.push.apply(v,gt(Yf(r.slice(y,b),m,t,h,o,x===s-1)))}}else for(var x=0;x<s;x++){var y=x*g,b=y+g;v.push.apply(v,gt(Yf(r.slice(y,b),m,t,h,o,x===s-1)))}var k=u===2?",":"";v[0]="["+v[0]+k;for(var x=1;x<v.length-1;x++)v[x]=" "+v[x]+k;for(var N=`,
`,x=2;x<u;x++)N+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":N),v}function Dc(r){for(var e=[],t=0;t<r.length;t+=2)e.push([r[t],r[t+1]]);return e}var Zf=function(){function r(e,t,n){var o=this;if(this.dtype=t,this.shape=e.slice(),this.size=sr(e),n!=null){var a=n.length;P(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+o.size+"'.")})}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Pk(t,this.size),this.strides=Du(e)}return r.prototype.set=function(e){for(var t=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];n.length===0&&(n=[0]),P(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must "+("match the rank ("+t.rank+")")});var a=this.locToIndex(n);this.values[a]=e},r.prototype.get=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];n.length===0&&(n=[0]);var a=0;try{for(var i=Zr(n),s=i.next();!s.done;s=i.next()){var u=s.value;if(u<0||u>=this.shape[a]){var l="Requested out of range element at "+n+". "+("  Buffer shape="+this.shape);throw new Error(l)}a++}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var c=n[n.length-1],p=0;p<n.length-1;++p)c+=this.strides[p]*n[p];return this.values[c]},r.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},r.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return to().makeTensor(this.values,this.shape,this.dtype)},r}(),to=null,Mu=null;function Fz(r){to=r}function Dz(r){Mu=r}var ir=function(){function r(e,t,n,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=sr(e),this.strides=Du(e),this.dataId=n,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return De(this,void 0,void 0,function(){var e;return Re(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Mu.buffer(this.shape,this.dtype,e)]}})})},r.prototype.bufferSync=function(){return Mu.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return De(this,void 0,void 0,function(){var e;return Re(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Ru(this.shape,e,this.dtype==="complex64")]}})})},r.prototype.arraySync=function(){return Ru(this.shape,this.dataSync(),this.dtype==="complex64")},r.prototype.data=function(){return De(this,void 0,void 0,function(){var e,t;return Re(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=to().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(o){return Xf(o)})]}catch(o){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}})})},r.prototype.dataSync=function(){this.throwIfDisposed();var e=to().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(t){return Xf(t)})}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},r.prototype.bytes=function(){return De(this,void 0,void 0,function(){var e;return Re(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,to().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},r.prototype.dispose=function(){this.isDisposed||(to().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.print=function(e){return e===void 0&&(e=!1),Mu.print(this,e)},r.prototype.clone=function(){return this.throwIfDisposed(),Mu.clone(this)},r.prototype.toString=function(e){e===void 0&&(e=!1);var t=this.dataSync();return Tz(t,this.shape,this.dtype,e)},r.prototype.cast=function(e){return this.throwIfDisposed(),Mu.cast(this,e)},r.prototype.variable=function(e,t,n){return e===void 0&&(e=!0),this.throwIfDisposed(),to().makeVariable(this,e,t,n)},r}();Object.defineProperty(ir,Symbol.hasInstance,{value:function(r){return!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null}});function Rz(){return Vv("Tensor",function(){return ir})}Rz();var Rc=function(r){Co(e,r);function e(t,n,o,a){var i=r.call(this,t.shape,t.dtype,t.dataId,a)||this;return i.trainable=n,i.name=o,i}return e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!No(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and "+("previous value ("+this.shape+") must match"));to().disposeTensor(this),this.dataId=t.dataId,to().incRef(this,null)},e.prototype.dispose=function(){to().disposeVariable(this),this.isDisposedInternal=!0},e}(ir);Object.defineProperty(Rc,Symbol.hasInstance,{value:function(r){return r instanceof ir&&r.assign!=null&&r.assign instanceof Function}});I.Rank=void 0;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(I.Rank||(I.Rank={}));var rx;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(rx||(rx={}));var nx;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(nx||(nx={}));var ox;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(ox||(ox={}));var ax;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(ax||(ax={}));var $z={float32:ox,int32:rx,bool:nx,complex64:ax};function Jf(r,e){if(r==="string"||e==="string"){if(r==="string"&&e==="string")return"string";throw new Error("Can not upcast "+r+" with "+e)}return $z[r][e]}function Pz(r){return Jf(r,"int32")}function Yt(r,e){if(r.dtype===e.dtype)return[r,e];var t=Jf(r.dtype,e.dtype);return[r.cast(t),e.cast(t)]}function z2(r,e){P(r.dtype===e.dtype,function(){return"The dtypes of the first("+r.dtype+") and"+(" second("+e.dtype+") input must match")})}function Oz(r,e){return e.some(function(t){return t.id===r.id})}function sx(r){var e=[],t=new Set;return U2(r,e,t),e}function U2(r,e,t){if(r!=null){if(r instanceof ir){e.push(r);return}if(!!Mz(r)){var n=r;for(var o in n){var a=n[o];t.has(a)||(t.add(a),U2(a,e,t))}}}}function Mz(r){return Array.isArray(r)||typeof r=="object"}var Bz={__proto__:null,makeTypesMatch:Yt,assertTypesMatch:z2,isTensorInList:Oz,getTensorsInContainer:sx};function ix(r){return r.kernelName!=null}var G2=function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(function(e){return e.name})))}}}return r.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},r}(),ux=function(){function r(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new G2}return r.prototype.ready=function(){return De(this,void 0,void 0,function(){var e,t,n,o;return Re(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,a.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return o=a.sent(),o?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name,n=e.asyncInit;if(n)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(e){if(!(e in this.registry))if(e in this.registryFactory){var t=this.initializeBackend(e).asyncInit;if(t)return null}else return null;return this.registry[e]},r.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},r.prototype.registerBackend=function(e,t,n){return n===void 0&&(n=1),e in this.registryFactory?(eo(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},r.prototype.setBackend=function(e){return De(this,void 0,void 0,function(){var t,n,o,a,i;return Re(this,function(s){switch(s.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,o=t.asyncInit,o?[4,n]:[3,2]);case 1:return i=s.sent(),[3,3];case 2:i=n,s.label=3;case 3:if(a=i,!a)return[2,!1];s.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Sz(this.backendInstance),[2,!0]}})})},r.prototype.setupRegisteredKernels=function(){var e=this,t=jf(this.backendName);t.forEach(function(n){n.setupFunc!=null&&n.setupFunc(e.backendInstance)})},r.prototype.disposeRegisteredKernels=function(e){var t=this,n=jf(e);n.forEach(function(o){o.disposeFunc!=null&&o.disposeFunc(t.registry[e])})},r.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(n==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var o=n.factory();if(o&&!(o instanceof Fk)&&typeof o.then=="function"){var a=++this.pendingBackendInitId,i=o.then(function(s){return a<t.pendingBackendInitId?!1:(t.registry[e]=s,t.pendingBackendInit=null,!0)}).catch(function(s){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,eo("Initialization of backend "+e+" failed"),eo(s.stack||s.message)),!1});return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(s){return eo("Initialization of backend "+e+" failed"),eo(s.stack||s.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},r.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],o=this.initializeBackend(n),a=o.success,i=o.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),o=n.backend,a=this.readSync(t),i=o.refCount(t);o.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(e,t){var n=this,o=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}var a;return this.scopedRun(function(){return n.startScope(o)},function(){return n.endScope(a)},function(){return a=t(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a})},r.prototype.scopedRun=function(e,t,n){e();try{var o=n();return t(),o}catch(a){throw t(),a}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(e){var t=G.runKernel(Uv,{x:e}),n={x:e},o=function(i){return{x:function(){var s="float32",u={x:i},l={dtype:s};return G.runKernel(zv,u,l)}}},a=[];return this.addTapeNode(this.state.activeScope.name,n,[t],o,a,{}),t},r.prototype.runKernel=function(e,t,n){this.backendName==null&&this.backend;var o=Gf(e,this.backendName)!=null;if(!o)throw new Error("Kernel '"+e+"' not registered for backend '"+this.backendName+"'");return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(e,t,n){var o=this.backend.numDataIds(),a=0;n.forEach(function(u){a+=u.dtype==="complex64"?3:1});var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-t-a-i;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+s+" data ids) after running '"+e+"'"))},r.prototype.runKernelFunc=function(e){var t=this,n,o=[],a=this.isTapeOn(),i=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var u;this.backendName==null&&this.backend;var l,c=ix(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(ix(e)){var p=e.kernelName,f=e.inputs,d=e.attrs;this.backendName==null&&this.backend;var m=Gf(p,this.backendName);P(m!=null,function(){return"Cannot find registered kernel '"+p+"' for backend '"+t.backendName+"'"}),u=function(){var k=t.backend.numDataIds();l=m.kernelFunc({inputs:f,attrs:d,backend:t.backend});var N=Array.isArray(l)?l:[l];t.shouldCheckForMemLeaks()&&t.checkKernelForMemLeak(p,k,N);var E=N.map(function(R){if(R.rank!=null)return R;var $=R.dataId,O=R.shape,M=R.dtype;return t.makeTensorFromDataId($,O,M)});if(a){var T=t.getTensorsForGradient(p,f,E);o=t.saveTensorsForBackwardMode(T)}return E}}else{var h=e.forwardFunc,g=function(k){!a||(o=k.map(function(N){return t.keep(t.clone(N))}))};u=function(){var k=t.backend.numDataIds();l=t.tidy(function(){return h(t.backend,g)});var N=Array.isArray(l)?l:[l];return t.shouldCheckForMemLeaks()&&t.checkKernelForMemLeak(c,k,N),N}}var v=e.inputs,x=e.attrs,y=ix(e)?null:e.backwardsFunc,b;return this.scopedRun(function(){return t.state.kernelDepth++},function(){return t.state.kernelDepth--},function(){!t.ENV.getBool("DEBUG")&&!t.state.profiling?n=u():(b=t.profiler.profileKernel(c,v,function(){return u()}),t.ENV.getBool("DEBUG")&&t.profiler.logKernelProfile(b),n=b.outputs)}),a&&this.addTapeNode(c,v,n,y,o,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(v).map(function(k){return v[k]!=null?v[k].shape:null}),outputShapes:n.map(function(k){return k.shape}),kernelTimeMs:b.timeMs,extraInfo:b.extraInfo}),Array.isArray(l)?n:n[0]},r.prototype.saveTensorsForBackwardMode=function(e){var t=this,n=e.map(function(o){return t.keep(t.clone(o))});return n},r.prototype.getTensorsForGradient=function(e,t,n){var o=Xv(e);if(o!=null){var a=o.inputsToSave||[],i=o.outputsToSave||[],s=void 0;o.saveAllInputs?(P(Array.isArray(t),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(t).map(function(l){return t[l]})):s=a.map(function(l){return t[l]});var u=n.filter(function(l,c){return i[c]});return s.concat(u)}return[]},r.prototype.makeTensor=function(e,t,n,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",o=o||this.backend;var a=e;n==="string"&&da(e[0])&&(a=e.map(function(c){return Tc(c)}));var i=o.write(a,t,n),s=new ir(t,n,i,this.nextTensorId());if(this.trackTensor(s,o),n==="string"){var u=this.state.tensorInfo.get(i),l=Bk(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},r.prototype.makeTensorFromDataId=function(e,t,n,o){n=n||"float32";var a=new ir(t,n,e,this.nextTensorId());return this.trackTensor(a,o),a},r.prototype.makeVariable=function(e,t,n,o){t===void 0&&(t=!0),n=n||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));var a=new Rc(e,t,n,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},r.prototype.trackTensor=function(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;var n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*Pv(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Rc||this.track(e)},r.prototype.incRef=function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)},r.prototype.removeDataId=function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)},r.prototype.disposeTensor=function(e){if(!!this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){var n=e.size*Pv(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}},r.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},r.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},r.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},r.prototype.profile=function(e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,p,f;return Re(this,function(d){switch(d.label){case 0:return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],o=this.state.activeProfile,[4,e()];case 1:o.result=d.sent(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,gt(this.state.activeProfile.kernels.map(function(m){return m.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,d.label=2;case 2:d.trys.push([2,8,9,10]),a=Zr(this.state.activeProfile.kernels),i=a.next(),d.label=3;case 3:return i.done?[3,7]:(s=i.value,u=s,[4,s.kernelTimeMs]);case 4:return u.kernelTimeMs=d.sent(),l=s,[4,s.extraInfo];case 5:l.extraInfo=d.sent(),d.label=6;case 6:return i=a.next(),[3,3];case 7:return[3,10];case 8:return c=d.sent(),p={error:c},[3,10];case 9:try{i&&!i.done&&(f=a.return)&&f.call(a)}finally{if(p)throw p.error}return[7];case 10:return[2,this.state.activeProfile]}})})},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(e,t,n,o,a,i){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},l=Xv(e);l!=null&&(o=l.gradFunc),o!=null&&(u.gradient=function(c){return c=c.map(function(p,f){if(p==null){var d=n[f],m=Uf(d.size,d.dtype);return s.makeTensor(m,d.shape,d.dtype)}return p}),o(c.length>1?c:c[0],a,i)}),this.state.activeTape.push(u)},r.prototype.keep=function(e){return e.kept=!0,e},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},r.prototype.endScope=function(e){for(var t=this,n=sx(e),o=new Set(n.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];!i.kept&&!o.has(i.id)&&i.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(u){!u.kept&&u.scopeId===s.id&&t.track(u)})},r.prototype.gradients=function(e,t,n,o){var a=this;if(o===void 0&&(o=!1),P(t.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",e)});P(i instanceof ir,function(){return"The result y returned by f() must be a tensor."});var s=Nz(this.state.activeTape,t,i);if(!o&&s.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u={};u[i.id]=n==null?Lz(i.shape):n,Ez(u,s,function(c){return a.tidy(c)},Vz);var l=t.map(function(c){return u[c.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(c){var p,f;try{for(var d=Zr(c.saved),m=d.next();!m.done;m=d.next()){var h=m.value;h.dispose()}}catch(g){p={error:g}}finally{try{m&&!m.done&&(f=d.return)&&f.call(d)}finally{if(p)throw p.error}}}),a.state.activeTape=null),{value:i,grads:l}})},r.prototype.customGrad=function(e){var t=this;return P(ma(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];P(n.every(function(l){return l instanceof ir}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a,i={};n.forEach(function(l,c){i[c]=l});var s=function(l,c){return a=e.apply(void 0,gt(n,[c])),P(a.value instanceof ir,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),P(ma(a.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),a.value},u=function(l,c){var p=a.gradFunc(l,c),f=Array.isArray(p)?p:[p];P(f.length===n.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),P(f.every(function(m){return m instanceof ir}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return f.forEach(function(m,h){d[h]=function(){return m}}),d};return t.runKernelFunc({forwardFunc:s,backwardsFunc:u,inputs:i})}},r.prototype.readSync=function(e){var t=this.state.tensorInfo.get(e);return t.backend.readSync(e)},r.prototype.read=function(e){var t=this.state.tensorInfo.get(e);return t.backend.read(e)},r.prototype.time=function(e){return De(this,void 0,void 0,function(){var t,n;return Re(this,function(o){switch(o.label){case 0:return t=Ec(),[4,this.backend.time(e)];case 1:return n=o.sent(),n.wallMs=Ec()-t,[2,n]}})})},r.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new G2;for(var e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r}();ux.nextTensorId=0;ux.nextVariableId=0;function Lz(r){var e=Ov(sr(r),"float32");return G.makeTensor(e,r,"float32")}function j2(){var r=Gk();if(r._tfengine==null){var e=new Uk(r);r._tfengine=new ux(e)}return HW(r._tfengine.ENV),Fz(function(){return r._tfengine}),r._tfengine}var G=j2();function Vz(r,e){var t={a:r,b:e};return G.runKernel(Wv,t)}function Wz(){return typeof navigator!="undefined"&&navigator!=null}var lx;function zz(r){lx=r}function Uz(r){if(lx!==void 0)return lx;if(r||Wz()){if(r||(r=navigator),r.product==="ReactNative")return!0;var e=r.userAgent||r.vendor||(typeof window!="undefined"?window.opera:"");if(!e){var t=r;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function H2(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var Gz={__proto__:null,mockIsMobile:zz,isMobile:Uz,isBrowser:H2};var zn=at();zn.registerFlag("DEBUG",function(){return!1},function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});zn.registerFlag("IS_BROWSER",function(){return H2()});zn.registerFlag("IS_NODE",function(){return typeof process!="undefined"&&typeof process.versions!="undefined"&&typeof process.versions.node!="undefined"});zn.registerFlag("IS_CHROME",function(){return typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)});zn.registerFlag("PROD",function(){return!1});zn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return zn.getBool("DEBUG")});zn.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0});zn.registerFlag("IS_TEST",function(){return!1});zn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",function(){return!0});zn.registerFlag("WRAP_TO_IMAGEBITMAP",function(){return!1});function ro(r,e){var t=r;if(Er(r))return e==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(t)||Er(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(r)&&at().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&q2(r,n,[]),n}function q2(r,e,t){if(t=t||[],!Array.isArray(r)&&!Er(r)){P(e.length===0,function(){return"Element arr["+t.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+e[0]+" elements")});return}P(e.length>0,function(){return"Element arr["+t.join("][")+"] should be a primitive, "+("but is an array of "+r.length+" elements")}),P(r.length===e[0],function(){return"Element arr["+t.join("][")+"] should have "+e[0]+" "+("elements, but has "+r.length+" elements")});for(var n=e.slice(1),o=0;o<r.length;++o)q2(r[o],n,t.concat(o))}function K2(r,e,t,n){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==e||r==="numeric"&&e==="string")throw new Error("Argument '"+t+"' passed to '"+n+"' must "+("be "+r+" tensor, but got "+e+" tensor"))}}function F(r,e,t,n){if(n===void 0&&(n="numeric"),r instanceof ir)return K2(n,r.dtype,e,t),r;var o=Wf(r);if(o!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(o=n),K2(n,o,e,t),r==null||!Er(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var a=r==null?"null":r.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var i=ro(r,o);!Er(r)&&!Array.isArray(r)&&(r=[r]);var s=!0,u=o!=="string"?Kf(r,o):es(r,[],s);return G.makeTensor(u,i,o)}function $c(r,e,t,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");var o=r;return o.map(function(a,i){return F(a,e+"["+i+"]",t,n)})}var X2="__op";function U(r){var e=Object.keys(r);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(e.length+" keys."));var t=e[0],n=r[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+X2;var o=function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];G.startScope(t);try{var s=n.apply(void 0,gt(a));return Bv(s)&&console.error("Cannot return a Promise inside of tidy."),G.endScope(s),s}catch(u){throw G.endScope(null),u}};return Object.defineProperty(o,"name",{value:t,configurable:!0}),o}function jz(r,e){var t=F(r,"real","complex"),n=F(e,"imag","complex");$r(t.shape,n.shape,"real and imag shapes, "+t.shape+" and "+n.shape+", must match in call to tf.complex().");var o={real:t,imag:n};return G.runKernel(f_,o)}var as=U({complex_:jz});function ga(r,e,t,n){if(n==null&&(n=Wf(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Er(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Mv(e);var o=sr(e),a=sr(t);P(o===a,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+(o+" values but has "+a)});for(var i=0;i<t.length;++i){var s=t[i],u=i===t.length-1?s!==sr(e.slice(i)):!0;P(t[i]===e[i]||!u,function(){return"Error creating a new Tensor. Inferred shape "+("("+t+") does not match the provided ")+("shape ("+e+"). ")})}}return!Er(r)&&!Array.isArray(r)&&(r=[r]),e=e||t,r=n!=="string"?Kf(r,n):es(r,[],!0),G.makeTensor(r,e,n)}function Bu(r,e,t){var n=ro(r,t);return ga(r,e,n,t)}var cx={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Qf=4;function Hz(r,e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s,u=this;return Re(this,function(l){switch(l.label){case 0:for(t=[],n=[],o=Array.isArray(r)?r.map(function(c){return c.name}):Object.keys(r),a=function(c){var p=o[c],f=Array.isArray(r)?r[c].tensor:r[p];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string"&&f.dtype!=="complex64")throw new Error("Unsupported dtype in weight '"+p+"': "+f.dtype);var d={name:p,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var m=new Promise(function(h){return De(u,void 0,void 0,function(){var g,v,x,y,b,k,N;return Re(this,function(E){switch(E.label){case 0:return[4,f.bytes()];case 1:for(g=E.sent(),v=g.reduce(function(T,R){return T+R.length},0)+Qf*g.length,x=new Uint8Array(v),y=0,b=0;b<g.length;b++)k=g[b],N=new Uint8Array(new Uint32Array([k.length]).buffer),x.set(N,y),y+=Qf,x.set(k,y),y+=k.length;return h(x),[2]}})})});n.push(m)}else n.push(f.data());e!=null&&(d.group=e),t.push(d)},i=0;i<o.length;++i)a(i);return[4,Promise.all(n)];case 1:return s=l.sent(),[2,{data:qz(s),specs:t}]}})})}function Y2(r,e){var t,n,o={},a,i=0;try{for(var s=Zr(e),u=s.next();!u.done;u=s.next()){var l=u.value,c=l.name,p=l.dtype,f=l.shape,d=sr(f),m=void 0;if("quantization"in l){var h=l.quantization;if(h.dtype==="uint8"||h.dtype==="uint16"){if(!("min"in h&&"scale"in h))throw new Error("Weight "+l.name+" with quantization "+h.dtype+" doesn't have corresponding metadata min and scale.")}else if(h.dtype==="float16"){if(p!=="float32")throw new Error("Weight "+l.name+" is quantized with "+h.dtype+" "+("which only supports weights of type float32 not "+p+"."))}else throw new Error("Weight "+l.name+" has unknown "+("quantization dtype "+h.dtype+". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");var g=cx[h.dtype],v=r.slice(i,i+d*g),x=h.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(p==="float32")if(h.dtype==="uint8"||h.dtype==="uint16"){m=new Float32Array(x.length);for(var y=0;y<x.length;y++){var b=x[y];m[y]=b*h.scale+h.min}}else if(h.dtype==="float16")a===void 0&&(a=Qz()),m=a(x);else throw new Error("Unsupported quantization type "+h.dtype+" for weight type float32.");else if(p==="int32"){if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Unsupported quantization type "+h.dtype+" for weight type int32.");m=new Int32Array(x.length);for(var y=0;y<x.length;y++){var b=x[y];m[y]=Math.round(b*h.scale+h.min)}}else throw new Error("Unsupported dtype in weight '"+c+"': "+p);i+=d*g}else if(p==="string"){var k=sr(l.shape);m=[];for(var y=0;y<k;y++){var N=new Uint32Array(r.slice(i,i+Qf))[0];i+=Qf;var E=new Uint8Array(r.slice(i,i+N));m.push(E),i+=N}}else{var T=cx[p],v=r.slice(i,i+d*T);if(p==="float32")m=new Float32Array(v);else if(p==="int32")m=new Int32Array(v);else if(p==="bool")m=new Uint8Array(v);else if(p==="complex64"){m=new Float32Array(v);for(var R=new Float32Array(m.length/2),$=new Float32Array(m.length/2),y=0;y<R.length;y++)R[y]=m[y*2],$[y]=m[y*2+1];var O=Bu(R,f,"float32"),M=Bu($,f,"float32");o[c]=as(O,M),O.dispose(),M.dispose()}else throw new Error("Unsupported dtype in weight '"+c+"': "+p);i+=d*T}p!=="complex64"&&(o[c]=Bu(m,f,p))}}catch(B){t={error:B}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o}function qz(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var e=0,t=[];r.forEach(function(a){if(e+=a.byteLength,t.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var n=new Uint8Array(e),o=0;return t.forEach(function(a){n.set(new Uint8Array(a.buffer),o),o+=a.byteLength}),n.buffer}var px=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function Z2(r){return px?Buffer.byteLength(r):new Blob([r]).size}function Kz(r){if(px)return Buffer.from(r).toString("base64");for(var e=new Uint8Array(r),t="",n=0,o=e.length;n<o;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function Xz(r){if(px){var e=Buffer.from(r,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var t=atob(r),n=new Uint8Array(t.length),o=0;o<t.length;++o)n.set([t.charCodeAt(o)],o);return n.buffer}function fx(r){if(r.length===1)return r[0];var e=0;r.forEach(function(o){e+=o.byteLength});var t=new Uint8Array(e),n=0;return r.forEach(function(o){t.set(new Uint8Array(o),n),n+=o.byteLength}),t.buffer}function J2(r){var e="/";for(r=r.trim();r.endsWith(e);)r=r.slice(0,r.length-1);var t=r.split(e);return t[t.length-1]}function Q2(r,e){var t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy,weightsManifest:e};return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),t}function dx(r,e){return De(this,void 0,void 0,function(){var t,n,o,a;return Re(this,function(i){switch(i.label){case 0:return t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy},r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),r.weightsManifest==null?[3,2]:[4,e(r.weightsManifest)];case 1:n=Ee.apply(void 0,[i.sent(),2]),o=n[0],a=n[1],t.weightSpecs=o,t.weightData=a,i.label=2;case 2:return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),[2,t]}})})}function Pc(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:Z2(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:Z2(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}function Yz(){var r=function(n){for(var o=n<<13,a=0;(o&8388608)==0;)a-=8388608,o<<=1;return o&=~8388608,a+=947912704,o|a},e=new Uint32Array(2048);e[0]=0;for(var t=1;t<1024;t++)e[t]=r(t);for(var t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function Zz(){var r=new Uint32Array(64);r[0]=0,r[31]=1199570944,r[32]=2147483648,r[63]=3347054592;for(var e=1;e<31;e++)r[e]=e<<23;for(var e=33;e<63;e++)r[e]=2147483648+(e-32<<23);return r}function Jz(){for(var r=new Uint32Array(64),e=0;e<64;e++)r[e]=1024;return r[0]=r[32]=0,r}function Qz(){var r=Yz(),e=Zz(),t=Jz();return function(n){for(var o=new ArrayBuffer(4*n.length),a=new Uint32Array(o),i=0;i<n.length;i++){var s=n[i],u=r[t[s>>10]+(s&1023)]+e[s>>10];a[i]=u}return new Float32Array(o)}}var fn=function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(e){r.getInstance().saveRouters.push(e)},r.registerLoadRouter=function(e){r.getInstance().loadRouters.push(e)},r.getSaveHandlers=function(e){return r.getHandlers(e,"save")},r.getLoadHandlers=function(e,t){return r.getHandlers(e,"load",t)},r.getHandlers=function(e,t,n){var o=[],a=t==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters;return a.forEach(function(i){var s=i(e,n);s!==null&&o.push(s)}),o},r}(),eU=function(r){return fn.registerSaveRouter(r)},tU=function(r){return fn.registerLoadRouter(r)},rU=function(r){return fn.getSaveHandlers(r)},nU=function(r,e){return fn.getLoadHandlers(r,e)},mx="tensorflowjs",hx=1,ss="models_store",va="model_info_store";function eI(){if(!at().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=typeof window=="undefined"?self:window,e=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function gx(r){var e=r.result;e.createObjectStore(ss,{keyPath:"modelPath"}),e.createObjectStore(va,{keyPath:"modelPath"})}var is=function(){function r(e){if(this.indexedDB=eI(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return r.prototype.save=function(e){return De(this,void 0,void 0,function(){return Re(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},r.prototype.load=function(){return De(this,void 0,void 0,function(){return Re(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},r.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(o,a){var i=n.indexedDB.open(mx,hx);i.onupgradeneeded=function(){return gx(i)},i.onsuccess=function(){var s=i.result;if(t==null){var u=s.transaction(ss,"readonly"),l=u.objectStore(ss),c=l.get(n.modelPath);c.onsuccess=function(){if(c.result==null)return s.close(),a(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));o(c.result.modelArtifacts)},c.onerror=function(g){return s.close(),a(c.error)},u.oncomplete=function(){return s.close()}}else{var p=Pc(t),f=s.transaction(va,"readwrite"),d=f.objectStore(va),m=d.put({modelPath:n.modelPath,modelArtifactsInfo:p}),h;m.onsuccess=function(){h=s.transaction(ss,"readwrite");var g=h.objectStore(ss),v=g.put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:p});v.onsuccess=function(){return o({modelArtifactsInfo:p})},v.onerror=function(x){d=f.objectStore(va);var y=d.delete(n.modelPath);y.onsuccess=function(){return s.close(),a(v.error)},y.onerror=function(b){return s.close(),a(v.error)}}},m.onerror=function(g){return s.close(),a(m.error)},f.oncomplete=function(){h==null?s.close():h.oncomplete=function(){return s.close()}}}},i.onerror=function(s){return a(i.error)}})},r}();is.URL_SCHEME="indexeddb://";var tI=function(r){return at().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(is.URL_SCHEME)?oU(r.slice(is.URL_SCHEME.length)):null};fn.registerSaveRouter(tI);fn.registerLoadRouter(tI);function oU(r){return new is(r)}function aU(r){return r.startsWith(is.URL_SCHEME)?r.slice(is.URL_SCHEME.length):r}var sU=function(){function r(){this.indexedDB=eI()}return r.prototype.listModels=function(){return De(this,void 0,void 0,function(){var e=this;return Re(this,function(t){return[2,new Promise(function(n,o){var a=e.indexedDB.open(mx,hx);a.onupgradeneeded=function(){return gx(a)},a.onsuccess=function(){var i=a.result,s=i.transaction(va,"readonly"),u=s.objectStore(va),l=u.getAll();l.onsuccess=function(){var c,p,f={};try{for(var d=Zr(l.result),m=d.next();!m.done;m=d.next()){var h=m.value;f[h.modelPath]=h.modelArtifactsInfo}}catch(g){c={error:g}}finally{try{m&&!m.done&&(p=d.return)&&p.call(d)}finally{if(c)throw c.error}}n(f)},l.onerror=function(c){return i.close(),o(l.error)},s.oncomplete=function(){return i.close()}},a.onerror=function(i){return o(a.error)}})]})})},r.prototype.removeModel=function(e){return De(this,void 0,void 0,function(){var t=this;return Re(this,function(n){return e=aU(e),[2,new Promise(function(o,a){var i=t.indexedDB.open(mx,hx);i.onupgradeneeded=function(){return gx(i)},i.onsuccess=function(){var s=i.result,u=s.transaction(va,"readwrite"),l=u.objectStore(va),c=l.get(e),p;c.onsuccess=function(){if(c.result==null)return s.close(),a(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var f=l.delete(e),d=function(){p=s.transaction(ss,"readwrite");var m=p.objectStore(ss),h=m.delete(e);h.onsuccess=function(){return o(c.result.modelArtifactsInfo)},h.onerror=function(g){return a(c.error)}};f.onsuccess=d,f.onerror=function(m){return d(),s.close(),a(c.error)}},c.onerror=function(f){return s.close(),a(c.error)},u.oncomplete=function(){p==null?s.close():p.oncomplete=function(){return s.close()}}},i.onerror=function(s){return a(i.error)}})]})})},r}(),Eo="/",Lu="tensorflowjs_models",rI="info",iU="model_topology",uU="weight_specs",lU="weight_data",cU="model_metadata";function nI(r){return{info:[Lu,r,rI].join(Eo),topology:[Lu,r,iU].join(Eo),weightSpecs:[Lu,r,uU].join(Eo),weightData:[Lu,r,lU].join(Eo),modelMetadata:[Lu,r,cU].join(Eo)}}function oI(r){var e,t;try{for(var n=Zr(Object.values(r)),o=n.next();!o.done;o=n.next()){var a=o.value;window.localStorage.removeItem(a)}}catch(i){e={error:i}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}}function pU(r){var e=r.split(Eo);if(e.length<3)throw new Error("Invalid key format: "+r);return e.slice(1,e.length-1).join(Eo)}function fU(r){return r.startsWith(us.URL_SCHEME)?r.slice(us.URL_SCHEME.length):r}var us=function(){function r(e){if(!at().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=nI(this.modelPath)}return r.prototype.save=function(e){return De(this,void 0,void 0,function(){var t,n,o,a;return Re(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),o=Pc(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,Kz(e.weightData)),a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),[2,{modelArtifactsInfo:o}]}catch(s){throw oI(this.keys),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: "+("modelTopologyBytes="+o.modelTopologyBytes+", ")+("weightSpecsBytes="+o.weightSpecsBytes+", ")+("weightDataBytes="+o.weightDataBytes+"."))}return[2]})})},r.prototype.load=function(){return De(this,void 0,void 0,function(){var e,t,n,o,a,i,s;return Re(this,function(u){if(e=JSON.parse(this.LS.getItem(this.keys.info)),e==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},n=JSON.parse(this.LS.getItem(this.keys.topology)),n==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)),o==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=o,a=this.LS.getItem(this.keys.modelMetadata),a!=null&&(i=JSON.parse(a),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,i.signature!=null&&(t.signature=i.signature),i.userDefinedMetadata!=null&&(t.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(t.modelInitializer=i.modelInitializer),i.trainingConfig!=null&&(t.trainingConfig=i.trainingConfig)),s=this.LS.getItem(this.keys.weightData),s==null)throw new Error("In local storage, the binary weight values of model "+("'"+this.modelPath+"' are missing."));return t.weightData=Xz(s),[2,t]})})},r}();us.URL_SCHEME="localstorage://";var aI=function(r){return at().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(us.URL_SCHEME)?dU(r.slice(us.URL_SCHEME.length)):null};fn.registerSaveRouter(aI);fn.registerLoadRouter(aI);function dU(r){return new us(r)}var mU=function(){function r(){P(at().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),P(typeof window=="undefined"||typeof window.localStorage!="undefined",function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return r.prototype.listModels=function(){return De(this,void 0,void 0,function(){var e,t,n,o,a,i;return Re(this,function(s){for(e={},t=Lu+Eo,n=Eo+rI,o=0;o<this.LS.length;++o)a=this.LS.key(o),a.startsWith(t)&&a.endsWith(n)&&(i=pU(a),e[i]=JSON.parse(this.LS.getItem(a)));return[2,e]})})},r.prototype.removeModel=function(e){return De(this,void 0,void 0,function(){var t,n;return Re(this,function(o){if(e=fU(e),t=nI(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),oI(t),[2,n]})})},r}(),Vu="://",xa=function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(e,t){P(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(Vu)&&(e=e.slice(0,e.indexOf(Vu))),P(e.length>0,function(){return"scheme must not be an empty string."});var n=r.getInstance();P(n.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),n.managers[e]=t},r.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r}();function ed(r){if(r.indexOf(Vu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+(""+xa.getSchemes().join(",")));return{scheme:r.split(Vu)[0],path:r.split(Vu)[1]}}function sI(r,e,t){return t===void 0&&(t=!1),De(this,void 0,void 0,function(){var n,o,a,i,s,u,l,c,p;return Re(this,function(f){switch(f.label){case 0:return P(r!==e,function(){return"Old path and new path are the same: '"+r+"'"}),n=fn.getLoadHandlers(r),P(n.length>0,function(){return"Copying failed because no load handler is found for source URL "+r+"."}),P(n.length<2,function(){return"Copying failed because more than one ("+n.length+") "+("load handlers for source URL "+r+".")}),o=n[0],a=fn.getSaveHandlers(e),P(a.length>0,function(){return"Copying failed because no save handler is found for destination "+("URL "+e+".")}),P(a.length<2,function(){return"Copying failed because more than one ("+n.length+") "+("save handlers for destination URL "+e+".")}),i=a[0],s=ed(r).scheme,u=ed(r).path,l=s===ed(r).scheme,[4,o.load()];case 1:return c=f.sent(),t&&l?[4,xa.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,i.save(c)];case 4:return p=f.sent(),t&&!l?[4,xa.getManager(s).removeModel(u)]:[3,6];case 5:f.sent(),f.label=6;case 6:return[2,p.modelArtifactsInfo]}})})}function hU(){return De(this,void 0,void 0,function(){var r,e,t,n,o,a,i,s,u,l,c;return Re(this,function(p){switch(p.label){case 0:r=xa.getSchemes(),e={},p.label=1;case 1:p.trys.push([1,6,7,8]),t=Zr(r),n=t.next(),p.label=2;case 2:return n.done?[3,5]:(o=n.value,[4,xa.getManager(o).listModels()]);case 3:a=p.sent();for(i in a)s=o+Vu+i,e[s]=a[i];p.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return u=p.sent(),l={error:u},[3,8];case 7:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(l)throw l.error}return[7];case 8:return[2,e]}})})}function gU(r){return De(this,void 0,void 0,function(){var e,t;return Re(this,function(n){return e=ed(r),t=xa.getManager(e.scheme),[2,t.removeModel(e.path)]})})}function vU(r,e){return De(this,void 0,void 0,function(){var t;return Re(this,function(n){return t=!1,[2,sI(r,e,t)]})})}function xU(r,e){return De(this,void 0,void 0,function(){var t;return Re(this,function(n){return t=!0,[2,sI(r,e,t)]})})}var yU=function(){function r(){}return r.prototype.fetch=function(e,t){return fetch(e,t)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},r.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},r}();if(at().get("IS_BROWSER")){at().setPlatform("browser",new yU);try{xa.registerManager(us.URL_SCHEME,new mU)}catch(r){}try{xa.registerManager(is.URL_SCHEME,new sU)}catch(r){}}var bU={importFetch:function(){return Ak()}},vx,wU=function(){function r(){this.util=Rv(),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(e,t){return at().global.fetch!=null?at().global.fetch(e,t):(vx==null&&(vx=bU.importFetch()),vx(e,t))},r.prototype.now=function(){var e=process.hrtime();return e[0]*1e3+e[1]/1e6},r.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},r.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},r}();at().get("IS_NODE")&&at().setPlatform("node",new wU);function To(r,e,t){return e===void 0&&(e="float32"),e=e||"float32",Mv(r),new Zf(r,e,t)}function kU(r,e){var t=F(r,"x","cast");if(!Mk(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var n={x:t},o={dtype:e};return G.runKernel(zv,n,o)}var tr=U({cast_:kU});function _U(r){var e=F(r,"x","clone","string_or_numeric"),t={x:e};return G.runKernel(Uv,t)}var ls=U({clone_:_U});function iI(r,e){e===void 0&&(e=!1),console.log(r.toString(e))}j2();var SU={buffer:To,cast:tr,clone:ls,print:iI};Dz(SU);var IU="model",CU=".json",NU=".weights.bin";function uI(r){return new Promise(function(e){return setTimeout(e)}).then(r)}var td=function(){function r(e){if(!at().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(r.URL_SCHEME)&&(e=e.slice(r.URL_SCHEME.length)),(e==null||e.length===0)&&(e=IU),this.modelJsonFileName=e+CU,this.weightDataFileName=e+NU}return r.prototype.save=function(e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s;return Re(this,function(u){switch(u.label){case 0:if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=Q2(e,n),a=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor,i.download=this.modelJsonFileName,i.href=a,[4,uI(function(){return i.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),e.weightData==null?[3,4]:(s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor,s.download=this.weightDataFileName,s.href=t,[4,uI(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Pc(e)}]}})})},r}();td.URL_SCHEME="downloads://";var EU=function(){function r(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+("but received "+e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}return r.prototype.load=function(){return De(this,void 0,void 0,function(){var e=this;return Re(this,function(t){return[2,new Promise(function(n,o){var a=new FileReader;a.onload=function(i){var s=JSON.parse(i.target.result),u=s.modelTopology;if(u==null){o(new Error("modelTopology field is missing from file "+e.jsonFile.name));return}var l=s.weightsManifest;if(l==null){o(new Error("weightManifest field is missing from file "+e.jsonFile.name));return}if(e.weightsFiles.length===0){n({modelTopology:u});return}var c=dx(s,function(p){return e.loadWeights(p)});n(c)},a.onerror=function(i){return o("Failed to read model topology and weights manifest JSON "+("from file '"+e.jsonFile.name+"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},a.readAsText(e.jsonFile)})]})})},r.prototype.loadWeights=function(e){var t,n,o=this,a=[],i=[];try{for(var s=Zr(e),u=s.next();!u.done;u=s.next()){var l=u.value;a.push.apply(a,gt(l.weights)),i.push.apply(i,gt(l.paths))}}catch(f){t={error:f}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}var c=this.checkManifestAndWeightFiles(e),p=i.map(function(f){return o.loadWeightsFile(f,c[f])});return Promise.all(p).then(function(f){return[a,fx(f)]})},r.prototype.loadWeightsFile=function(e,t){return new Promise(function(n,o){var a=new FileReader;a.onload=function(i){var s=i.target.result;n(s)},a.onerror=function(i){return o("Failed to weights data from file of path '"+e+"'.")},a.readAsArrayBuffer(t)})},r.prototype.checkManifestAndWeightFiles=function(e){var t,n,o=this,a=[],i=this.weightsFiles.map(function(p){return J2(p.name)}),s={};try{for(var u=Zr(e),l=u.next();!l.done;l=u.next()){var c=l.value;c.paths.forEach(function(p){var f=J2(p);if(a.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: "+("'"+f+"'"));if(a.push(f),i.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");s[p]=o.weightsFiles[i.indexOf(f)]})}}catch(p){t={error:p}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}if(a.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+("("+a.length+") and the number of weight files provided ")+("("+this.weightsFiles.length+")."));return s},r}(),TU=function(r){return at().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(td.URL_SCHEME)?AU(r.slice(td.URL_SCHEME.length)):null};fn.registerSaveRouter(TU);function AU(r){return r===void 0&&(r="model"),new td(r)}function FU(r){return new EU(r)}function lI(r,e,t,n){i(r),t=t==null?0:t,n=n==null?1:n,s(t,n);var o=0,a=function(u){return u.then(function(l){var c=t+ ++o/r.length*(n-t);return e(c),l}),u};function i(u){P(u!=null&&Array.isArray(u)&&u.length>0,function(){return"promises must be a none empty array"})}function s(u,l){P(u>=0&&u<=1,function(){return"Progress fraction must be in range [0, 1], but "+("got startFraction "+u)}),P(l>=0&&l<=1,function(){return"Progress fraction must be in range [0, 1], but "+("got endFraction "+l)}),P(l>=u,function(){return"startFraction must be no more than endFraction, but "+("got startFraction "+u+" and endFraction ")+(""+l)})}return Promise.all(r.map(a))}function cI(r,e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,p,f;return Re(this,function(d){switch(d.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?at().platform.fetch:e.fetchFunc,n=r.map(function(m){return t(m,e.requestInit,{isBinary:!0})}),o=0,a=.5,e.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return s=d.sent(),[3,4];case 2:return[4,lI(n,e.onProgress,o,a)];case 3:s=d.sent(),d.label=4;case 4:return i=s,u=i.map(function(m){return m.arrayBuffer()}),l=.5,c=1,e.onProgress!=null?[3,6]:[4,Promise.all(u)];case 5:return f=d.sent(),[3,8];case 6:return[4,lI(u,e.onProgress,l,c)];case 7:f=d.sent(),d.label=8;case 8:return p=f,[2,p]}})})}function DU(r,e,t,n){return e===void 0&&(e=""),De(this,void 0,void 0,function(){var o,a;return Re(this,function(i){return o=function(s){return cI(s,{requestInit:n})},a=pI(o),[2,a(r,e,t)]})})}function pI(r){var e=this;return function(t,n,o){return n===void 0&&(n=""),De(e,void 0,void 0,function(){var a,i,s,u,l,c,p,f,d,m;return Re(this,function(h){switch(h.label){case 0:if(a=t.map(function(){return!1}),i={},s=o!=null?o.map(function(){return!1}):[],u=[],t.forEach(function(g,v){var x=0;g.weights.forEach(function(y){var b="quantization"in y?y.quantization.dtype:y.dtype,k=cx[b]*sr(y.shape),N=function(){a[v]=!0,i[v]==null&&(i[v]=[]),i[v].push({manifestEntry:y,groupOffset:x,sizeBytes:k})};o!=null?o.forEach(function(E,T){E===y.name&&(N(),s[T]=!0)}):N(),u.push(y.name),x+=k})}),!s.every(function(g){return g}))throw l=o.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+(l.join(", ")+`. 
`)+"Manifest JSON has weights with names: "+(u.join(", ")+"."));return c=a.reduce(function(g,v,x){return v&&g.push(x),g},[]),p=[],c.forEach(function(g){t[g].paths.forEach(function(v){var x=n+(n.endsWith("/")?"":"/")+v;p.push(x)})}),[4,r(p)];case 1:return f=h.sent(),d={},m=0,c.forEach(function(g){for(var v=t[g].paths.length,x=0,y=0;y<v;y++)x+=f[m+y].byteLength;for(var b=new ArrayBuffer(x),k=new Uint8Array(b),N=0,E=0;E<v;E++){var T=new Uint8Array(f[m+E]);k.set(T,N),N+=T.byteLength}var R=i[g];R.forEach(function($){var O=b.slice($.groupOffset,$.groupOffset+$.sizeBytes),M=Y2(O,[$.manifestEntry]);for(var B in M)d[B]=M[B]}),m+=v}),[2,d]}})})}}var RU="application/octet-stream",$U="application/json",xx=function(){function r(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(P(typeof t.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=at().platform.fetch,P(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&P(e.length===2,function(){return"URL paths for http must have a length of 2, "+("(actual length is "+e.length+").")}),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return r.prototype.save=function(e){return De(this,void 0,void 0,function(){var t,n,o,a;return Re(this,function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit),t.body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o=Q2(e,n),t.body.append("model.json",new Blob([JSON.stringify(o)],{type:$U}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:RU}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if(a=i.sent(),a.ok)return[2,{modelArtifactsInfo:Pc(e),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+(a.status+"."))}})})},r.prototype.load=function(){return De(this,void 0,void 0,function(){var e,t,n,o,a,i=this;return Re(this,function(s){switch(s.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(e=s.sent(),!e.ok)throw new Error("Request to "+this.path+" failed with status code "+(e.status+". Please verify this URL points to ")+"the model JSON of the model to load.");s.label=2;case 2:return s.trys.push([2,4,,5]),[4,e.json()];case 3:return t=s.sent(),[3,5];case 4:throw s.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(o=t.modelTopology,a=t.weightsManifest,o==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return[2,dx(t,function(u){return i.loadWeights(u)})]}})})},r.prototype.loadWeights=function(e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,p,f,d,m,h,g,v,x,y,b,k,N,E,T,R,$,O,M;return Re(this,function(B){switch(B.label){case 0:t=Array.isArray(this.path)?this.path[1]:this.path,n=Ee(PU(t),2),o=n[0],a=n[1],i=this.weightPathPrefix||o,s=[];try{for(u=Zr(e),l=u.next();!l.done;l=u.next())c=l.value,s.push.apply(s,gt(c.weights))}catch(L){E={error:L}}finally{try{l&&!l.done&&(T=u.return)&&T.call(u)}finally{if(E)throw E.error}}p=[],f=[];try{for(d=Zr(e),m=d.next();!m.done;m=d.next()){h=m.value;try{for(g=(O=void 0,Zr(h.paths)),v=g.next();!v.done;v=g.next())x=v.value,this.weightUrlConverter!=null?f.push(this.weightUrlConverter(x)):p.push(i+x+a)}catch(L){O={error:L}}finally{try{v&&!v.done&&(M=g.return)&&M.call(g)}finally{if(O)throw O.error}}}}catch(L){R={error:L}}finally{try{m&&!m.done&&($=d.return)&&$.call(d)}finally{if(R)throw R.error}}return this.weightUrlConverter?(b=(y=p.push).apply,k=[p],[4,Promise.all(f)]):[3,2];case 1:b.apply(y,k.concat([gt.apply(void 0,[B.sent()])])),B.label=2;case 2:return[4,cI(p,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 3:return N=B.sent(),[2,[s,fx(N)]]}})})},r}();xx.URL_SCHEME_REGEX=/^https?:\/\//;function PU(r){var e=r.lastIndexOf("/"),t=r.lastIndexOf("?"),n=r.substring(0,e),o=t>e?r.substring(t):"";return[n+"/",o]}function yx(r){return r.match(xx.URL_SCHEME_REGEX)!=null}var fI=function(r,e){if(typeof fetch=="undefined"&&(e==null||e.fetchFunc==null))return null;var t=!0;return Array.isArray(r)?t=r.every(function(n){return yx(n)}):t=yx(r),t?bx(r,e):null};fn.registerSaveRouter(fI);fn.registerLoadRouter(fI);function bx(r,e){return new xx(r,e)}function OU(r,e){return bx(r,e)}var wx=function(){function r(e){this.modelArtifacts=e}return r.prototype.load=function(){return De(this,void 0,void 0,function(){return Re(this,function(e){return[2,this.modelArtifacts]})})},r}(),MU=function(){function r(e){this.saveHandler=e}return r.prototype.save=function(e){return De(this,void 0,void 0,function(){return Re(this,function(t){return[2,this.saveHandler(e)]})})},r}();function BU(r,e,t,n){if(arguments.length===1){var o=r.modelTopology!=null||r.weightSpecs!=null;return o?new wx(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new wx({modelTopology:r}))}else return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new wx({modelTopology:r,weightSpecs:e,weightData:t,trainingConfig:n})}function LU(r){return new MU(r)}var VU={__proto__:null,browserFiles:FU,browserHTTPRequest:OU,concatenateArrayBuffers:fx,decodeWeights:Y2,encodeWeights:Hz,fromMemory:BU,getLoadHandlers:nU,getModelArtifactsForJSON:dx,getModelArtifactsInfoForJSON:Pc,getSaveHandlers:rU,http:bx,isHTTPScheme:yx,loadWeights:DU,registerLoadRouter:tU,registerSaveRouter:eU,weightsLoaderFactory:pI,withSaveHandler:LU,copyModel:vU,listModels:hU,moveModel:xU,removeModel:gU};function WU(r,e,t,n){var o;t===void 0&&(t=!1),n===void 0&&(n=!1);var a=F(r,"a","matMul"),i=F(e,"b","matMul");o=Ee(Yt(a,i),2),a=o[0],i=o[1];var s={a,b:i},u={transposeA:t,transposeB:n};return G.runKernel(s_,s,u)}var vt=U({matMul_:WU});function zU(r,e,t,n){if(t===void 0&&(t=1),n===void 0&&(n=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var o=F(r,"indices","oneHot","int32"),a={indices:o},i={depth:e,onValue:t,offValue:n};return G.runKernel(ES,a,i)}var kx=U({oneHot_:zU});function UU(r,e){var t=F(r,"x","transpose");if(e==null&&(e=t.shape.map(function(a,i){return i}).reverse()),P(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" "+("must match length of perm "+e+".")}),e.forEach(function(a){P(a>=0&&a<t.rank,function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+(" but got "+e)})}),t.rank<=1)return t.clone();var n={x:t},o={perm:e};return G.runKernel(b2,n,o)}var rd=U({transpose_:UU});function GU(r,e,t){var n=F(r,"labels","confusionMatrix"),o=F(e,"predictions","confusionMatrix");P(t==null||t>0&&Number.isInteger(t),function(){return"If provided, numClasses must be a positive integer, "+("but got "+t)}),P(n.rank===1,function(){return"Expected the rank of labels to be 1, but got "+n.rank}),P(o.rank===1,function(){return"Expected the rank of predictions to be 1, "+("but got "+o.rank)}),P(n.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+(n.shape[0]+" vs. "+o.shape[0]+". ")+"Labels and predictions should have the same number of elements."}),P(t>0&&Number.isInteger(t),function(){return"numClasses is required to be a positive integer, but got "+(""+t)});var a=kx(tr(n,"int32"),t),i=kx(tr(o,"int32"),t),s=rd(a),u=vt(s,i);return tr(u,"int32")}var jU=U({confusionMatrix_:GU});var HU={__proto__:null,confusionMatrix:jU};function dI(r,e,t){if(Qa(r),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=ro(r,t);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ga(r,e,n,t)}var cs;function mI(r,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var t=!1,n=!1,o=!1,a=!1,i=!1,s=!1;if(r.data instanceof Uint8Array)t=!0;else if(typeof ImageData!="undefined"&&r instanceof ImageData)n=!0;else if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement)a=!0;else if(r.getContext!=null)i=!0;else if(typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap)s=!0;else throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+("but was "+r.constructor.name));if(o){var u=2;if(o&&r.readyState<u)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var l=Gf(jv,G.backendName);if(l!=null){var c={pixels:r},p={numChannels:e};return G.runKernel(jv,c,p)}var f=Ee(o?[r.videoWidth,r.videoHeight]:[r.width,r.height],2),d=f[0],m=f[1],h;if(i)h=r.getContext("2d").getImageData(0,0,d,m).data;else if(n||t)h=r.data;else if(a||o||s){if(cs==null)if(typeof document=="undefined")if(typeof OffscreenCanvas!="undefined"&&typeof OffscreenCanvasRenderingContext2D!="undefined")cs=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else cs=document.createElement("canvas").getContext("2d");cs.canvas.width=d,cs.canvas.height=m,cs.drawImage(r,0,0,d,m),h=cs.getImageData(0,0,d,m).data}var g;if(e===4)g=new Int32Array(h);else{var v=d*m;g=new Int32Array(v*e);for(var x=0;x<v;x++)for(var y=0;y<e;++y)g[x*e+y]=h[x*4+y]}var b=[m,d,e];return dI(g,b,"int32")}function qU(r){return r!=null&&r.data instanceof Uint8Array}function KU(){return typeof window!="undefined"&&typeof ImageBitmap!="undefined"&&window.hasOwnProperty("createImageBitmap")}function XU(r){return r!=null&&r.width!==0&&r.height!==0}function YU(r){return KU()&&!(r instanceof ImageBitmap)&&XU(r)&&!qU(r)}function ZU(r,e){return e===void 0&&(e=3),De(this,void 0,void 0,function(){var t,n;return Re(this,function(o){switch(o.label){case 0:if(t=null,!(at().getBool("WRAP_TO_IMAGEBITMAP")&&YU(r)))return[3,5];n=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,createImageBitmap(r,{premultiplyAlpha:"none"})];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),n=null,[3,4];case 4:return n!=null&&n.width===r.width&&n.height===r.height?t=n:t=r,[3,6];case 5:t=r,o.label=6;case 6:return[2,mI(t,e)]}})})}function JU(r,e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,p,f,d,m,h,g,v;return Re(this,function(x){switch(x.label){case 0:if(t=F(r,"img","toPixels"),r instanceof ir||(n=t,t=tr(n,"int32"),n.dispose()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(o=Ee(t.shape.slice(0,2),2),a=o[0],i=o[1],s=t.rank===2?1:t.shape[2],s>4||s===2)throw new Error("toPixels only supports depth of size "+("1, 3 or 4 but got "+s));if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");return[4,t.data()];case 1:for(u=x.sent(),l=t.dtype==="float32"?255:1,c=new Uint8ClampedArray(i*a*4),p=0;p<a*i;++p){for(f=[0,0,0,255],d=0;d<s;d++){if(m=u[p*s+d],t.dtype==="float32"){if(m<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the "+("range [0 - 1] but encountered "+m+"."))}else if(t.dtype==="int32"&&(m<0||m>255))throw new Error("Tensor values for a int32 Tensor must be in the "+("range [0 - 255] but encountered "+m+"."));s===1?(f[0]=m*l,f[1]=m*l,f[2]=m*l):f[d]=m*l}h=p*4,c[h+0]=Math.round(f[0]),c[h+1]=Math.round(f[1]),c[h+2]=Math.round(f[2]),c[h+3]=Math.round(f[3])}return e!=null&&(e.width=i,e.height=a,g=e.getContext("2d"),v=new ImageData(c,i,a),g.putImageData(v,0,0)),t!==r&&t.dispose(),[2,c]}})})}var QU=U({fromPixels_:mI}),eG={__proto__:null,fromPixelsAsync:ZU,toPixels:JU,fromPixels:QU};function hI(r,e){var t=r.shape.length,n=e.shape.length;if(t<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+(" but the rank was "+t+"."));if(n<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+(" but the rank was "+n+"."));if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type,"+(" but the dtype was "+e.dtype+"."));if(e.shape[n-1]>t)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+(e.shape[n-1]+" vs. "+t));if(sr(r.shape)===0)throw new Error("Requested more than 0 entries, but input is empty."+(" Input shape: "+r.shape+"."));for(var o=e.shape,a=o[o.length-1],i=1,s=0;s<o.length-1;++s)i*=o[s];var u=r.shape,l=o.slice();l.pop();for(var c=1,s=a;s<t;++s)c*=u[s],l.push(u[s]);var p=gt(Du(r.shape).map(function(f){return f/c}),[1]).slice(0,a);return[l,i,c,p]}var tG={__proto__:null,prepareAndValidate:hI};function _x(r,e,t){var n=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+("shape[sliceDim:], got updates.shape: "+t.shape)+(", indices.shape: "+e.shape+", shape: "+r)+(", sliceDim: "+n+", and batchDim: "+o+".");if(t.rank<o)throw new Error(a+(" update.rank < "+o+". "));if(r.length<n+(t.rank-o))throw new Error(a+(" Output shape length < "+(n+(t.rank-o))));if(t.rank!==o+r.length-n)throw new Error(a+(" update.rank != "+(o+r.length-n)));for(var i=0;i<o;++i)if(t.shape[i]!==e.shape[i])throw new Error(a+(" updates.shape["+i+"] ("+t.shape[i]+") != indices.shape["+i+"] ("+e.shape[i]+")."));for(var i=0;i<t.rank-o;++i)if(t.shape[i+o]!==r[i+n])throw new Error(a+(" updates.shape["+(i+o)+"] ("+t.shape[i+o]+") != shape["+(i+o)+"] ("+r[i+o]+")"))}function Sx(r,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+(" but the rank was "+e.rank+"."));if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+(" but the rank was "+r.rank+"."));if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}_x(t,e,r)}function gI(r,e,t){for(var n=e.shape.length,o=n>1?e.shape[n-1]:1,a=t.length,i=1,s=o;s<a;++s)i*=t[s];var u=o<1?1:o,l=sr(e.shape)/u,c=gt(Du(t.slice(0,o)),[1]),p=sr(t);return{sliceRank:o,numUpdates:l,sliceSize:i,strides:c,outputSize:p}}var rG={__proto__:null,validateUpdateShape:_x,validateInput:Sx,calculateShapes:gI},Ix=-2,nG=-1;function oG(r,e,t){var n=r.shape.length;P(n===e.length,function(){return"Error in slice"+n+"D: Length of begin "+e+" must "+("match the rank of the array ("+n+").")}),P(n===t.length,function(){return"Error in slice"+n+"D: Length of size "+t+" must "+("match the rank of the array ("+n+").")});for(var o=function(i){P(e[i]+t[i]<=r.shape[i],function(){return"Error in slice"+n+"D: begin["+i+"] + size["+i+"] "+("("+(e[i]+t[i])+") would overflow input.shape["+i+"] ("+r.shape[i]+")")})},a=0;a<n;++a)o(a)}function aG(r){for(var e=[],t=0;r>0;)r&1&&e.push(t),r/=2,t++;return e}function sG(r,e,t){for(var n=[],o=0;o<r.length;o++)n[o]=Math.ceil((e[o]-r[o])/t[o]);return n}function vI(r,e,t,n){for(var o=gt(r),a=o.length;a<n.length;a++)o.push(1);for(var a=0;a<t;a++)a===0?o[e]=1:(o.splice(e,0,1),o.pop());return o}function xI(r,e,t){return t<=r?t:t-(e-1)}function yI(r,e){for(var t=[],n=0;n<r;n++)t.push(e+n);return t}function iG(r,e,t,n,o,a,i,s,u){var l=r.length,c=new Array(l),p=new Array(l),f=new Array(l);if(e.length&&t>0){var d=e[0],m=t+1;c=bI(i,d,m,n,r),p=wI(s,d,m,o,r),f=vI(a,d,m,r)}else for(var h=0;h<l;h++)c[h]=_I(i,n,a,r,h,u),p[h]=SI(s,o,a,r,h,u),f[h]=kI(a,h,u);return{begin:c,end:p,strides:f}}function bI(r,e,t,n,o){for(var a=gt(o),i=yI(t,e),s=0;s<a.length;s++)if(i.indexOf(s)>-1)a[s]=0;else{var u=xI(e,t,s),l=n[u];r&1<<u&&(l=0),a[s]=l}return a}function wI(r,e,t,n,o){for(var a=gt(o),i=yI(t,e),s=0;s<a.length;s++)if(i.indexOf(s)>-1)a[s]=Number.MAX_SAFE_INTEGER;else{var u=xI(e,t,s),l=n[u];r&1<<u&&(l=Number.MAX_SAFE_INTEGER),a[s]=l}for(var c=0;c<a.length;c++){var p=o[c];a[c]<0&&(a[c]+=p),a[c]=_c(0,a[c],o[c])}return a}function kI(r,e,t){var n=r[e];return(t&1<<e||n==null)&&(n=1),n}function _I(r,e,t,n,o,a){var i=e[o],s=t[o]||1;(r&1<<o||a&1<<o||i==null)&&(s>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);var u=n[o];return i<0&&(i+=u),i=_c(0,i,u-1),i}function SI(r,e,t,n,o,a){var i=e[o],s=t[o]||1;(r&1<<o||a&1<<o||i==null)&&(s>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);var u=n[o];return i<0&&(i+=u),s>0?i=_c(0,i,u):i=_c(-1,i,u-1),i}function uG(r,e,t){for(var n=t.length,o=0;o<t.length;o++)if(t[o]>1){n=o;break}for(var o=n+1;o<t.length;o++)if(e[o]>0||t[o]!==r[o])return!1;return!0}function lG(r,e){for(var t=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)t+=r[n]*e[n];return t}function cG(r,e,t){var n,o=r.shape.length;typeof e=="number"?n=gt([e],new Array(o-1).fill(0)):e.length<o?n=e.concat(new Array(o-e.length).fill(0)):n=e.slice(),n.forEach(function(i){P(i!==-1,function(){return"slice() does not support negative begin indexing."})});var a;return t==null?a=new Array(o).fill(-1):typeof t=="number"?a=gt([t],new Array(o-1).fill(-1)):t.length<o?a=t.concat(new Array(o-t.length).fill(-1)):a=t,a=a.map(function(i,s){return i>=0?i:(P(i===-1,function(){return"Negative size values should be exactly -1 but got "+(i+" for the slice() size at index "+s+".")}),r.shape[s]-n[s])}),[n,a]}function pG(r,e,t,n,o,a,i,s,u){var l;if(n==null?(l=new Array(e.length),l.fill(1)):l=n,i!=null&&(i&i-1)!=0)throw new Error("Multiple ellipses in slice is not allowed.");for(var c=!1,p={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:l.slice(),beginMask:o,endMask:a,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:u},f=0;f<p.dims;f++)c&&(1<<f&s)!=0&&p.numAddAxisAfterEllipsis++,1<<f&i&&(c=!0);c||(p.ellipsisMask|=1<<p.dims,p.dims++);var d={dims:r.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};fG(p,d);for(var m=!0,h=!0,g=!0,v=[],x=[],f=0;f<r.length;++f){if(d.strides[f]===0)throw Error("strides["+f+"] must be non-zero");var y=!!(d.shrinkAxisMask&1<<f),b=r[f];if(b===-1){v.push(y?1:-1);continue}var k=[d.beginMask&1<<f,d.endMask&1<<f],N=[d.strides[f]>0?0:-1,d.strides[f]>0?b:b-1];if(y&&d.strides[f]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&d.strides[f]===1;var E=!!(d.beginMask&1<<f&&d.endMask&1<<f);if(d.beginValid&&d.endValid){if(y){var T=d.begin[f]<0?b+d.begin[f]:d.begin[f];if(d.begin[f]=T,d.end[f]=d.begin[f]+1,T<0||T>=b)throw Error("slice index "+d.begin[f]+" of dimension "+f+" out of bounds.")}else d.begin[f]=II(d.begin[f],0,d.strides[f],b,k,N),d.end[f]=II(d.end[f],1,d.strides[f],b,k,N);var R=d.strides[f]===1&&d.begin[f]===0&&d.end[f]===b;m=m&&R,h=h&&(f===0&&d.strides[f]===1||R)}else m=m&&d.strides[f]===1&&E,h=h&&(f===0&&d.strides[f]===1||E);var $=void 0,O=!1;if(d.beginValid&&d.endValid?($=d.end[f]-d.begin[f],O=!0):y?($=1,O=!0):E&&b>=0&&(d.strides[f]<0?$=-b:$=b,O=!0),O){var M=void 0;$===0||$<0!=d.strides[f]<0?M=0:M=Math.trunc($/d.strides[f])+($%d.strides[f]!=0?1:0),v.push(M)}else v.push(-1)}for(var B=0;B<d.finalShapeGatherIndices.length;++B){var L=d.finalShapeGatherIndices[B];L>=0?x.push(v[L]):L===Ix&&x.push(1)}var H=x.filter(function(W,K){return d.finalShapeGatherIndices[K]!==Ix});return{finalShapeSparse:H,finalShape:x,isIdentity:m,sliceDim0:h,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function fG(r,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;var t=0;e.beginValid=r.begin!=null,e.endValid=r.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(var n=0;n<r.dims;n++)if(1<<n&r.ellipsisMask)for(var o=Math.min(e.dims-(r.dims-n)+1+r.numAddAxisAfterEllipsis,e.dims);t<o;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=n;else if(1<<n&r.newAxisMask)e.finalShapeGatherIndices.push(Ix),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error("Index out of range using input dim "+t+"; input "+("has only "+e.dims+" dims, "+e.begin.length+"."));r.begin!=null&&(e.begin[t]=r.begin[n]),r.end!=null&&(e.end[t]=r.end[n]),e.strides[t]=r.strides[n],r.beginMask&1<<n&&(e.beginMask|=1<<t),r.endMask&1<<n&&(e.endMask|=1<<t),r.shrinkAxisMask&1<<n?(e.finalShapeGatherIndices.push(nG),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(n)),e.inputShapeGatherIndicesSparse[t]=n,t++}}function II(r,e,t,n,o,a){if(o[e])return t>0?a[e]:a[e+1&1];var i=r<0?n+r:r;return i<a[0]?a[0]:i>a[1]?a[1]:i}var CI={__proto__:null,assertParamsValid:oG,maskToAxes:aG,computeOutShape:sG,stridesWithElidedDims:vI,getNormalizedAxes:iG,startIndicesWithElidedDims:bI,stopIndicesWithElidedDims:wI,stridesForAxis:kI,startForAxis:_I,stopForAxis:SI,isSliceContinous:uG,computeFlatOffset:lG,parseSliceParams:cG,sliceInfo:pG};var NI=function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(e,t){return new e(t)},r}(),EI=function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(e){r.getMap().classNameMap[e.className]=[e,e.fromConfig]},r}();function ya(r){P(r.className!=null,function(){return"Class being registered does not have the static className property defined."}),P(typeof r.className=="string",function(){return"className is required to be a string, but got type "+typeof r.className}),P(r.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),EI.register(r)}var dG={__proto__:null,Serializable:NI,SerializationMap:EI,registerClass:ya};var mG=.001,TI=.1;function hG(r,e,t){return t==null&&(t=Cx()),Nx(r,e,function(n,o){return Ex(n,o,t)})}function Cx(){return G.backend.floatPrecision()===32?mG:TI}function Nx(r,e,t){var n=!0;if((Er(r)||Er(e))&&(n=!1),Er(r)&&Er(e)&&(n=!0),n){var o=r.constructor.name,a=e.constructor.name;if(o!==a)throw new Error("Arrays are of different type. Actual: "+o+". "+("Expected: "+a))}if(Array.isArray(r)&&Array.isArray(e)){var i=ro(r),s=ro(e);if(!No(i,s))throw new Error("Arrays have different shapes. "+("Actual: ["+i+"]. Expected: ["+s+"]"))}var u=Er(r)?r:es(r),l=Er(e)?e:es(e);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs "+("expected: "+l.length+`.
`)+("Actual:   "+u+`.
`)+("Expected: "+l+"."));for(var c=0;c<l.length;++c){var p=u[c],f=l[c];if(!t(p,f))throw new Error("Arrays differ: actual["+c+"] = "+p+", expected["+c+"] = "+f+`.
`+("Actual:   "+u+`.
`)+("Expected: "+l+"."))}}function gG(r,e){r().then(function(){return e.fail()},function(){return e()})}function vG(r,e){var t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return da(r)||da(r[0])||da(e)||da(e[0])?Nx(r,t,function(n,o){return n==o}):Nx(r,e,function(n,o){return Ex(n,o,0)})}function xG(r,e,t){if(t==null&&(t=Cx()),!Ex(r,e,t))throw new Error("Numbers differ: actual === "+r+", expected === "+e)}function Ex(r,e,t){return!isFinite(r)&&!isFinite(e)?!0:!(isNaN(r)||isNaN(e)||Math.abs(r-e)>t)}function yG(r,e,t){for(var n=0;n<r.length;n++)if(r[n]<e||r[n]>t)throw new Error("Value out of range:"+r[n]+" low: "+e+", high: "+t)}function bG(r,e){expect(new Float32Array(r)).toEqual(new Float32Array(e))}function AI(r){for(var e=0;e<r.length;e++){var t=r[e];Array.isArray(t)?AI(t):r[e]=Tc(t)}return r}var wG={__proto__:null,TEST_EPSILON_FLOAT16:TI,expectArraysClose:hG,testEpsilon:Cx,expectPromiseToFail:gG,expectArraysEqual:vG,expectNumbersClose:xG,expectValuesInRange:yG,expectArrayBuffersEqual:bG,encodeStrings:AI};var kG="3.11.0";function _G(){at().set("PROD",!0)}function SG(){at().set("DEBUG",!0)}function IG(){at().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function CG(r){at().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function NG(){G.disposeVariables()}function EG(){return G}function TG(){return G.memory()}function AG(r){return G.profile(r)}function dr(r,e){return G.tidy(r,e)}function Ur(r){var e=sx(r);e.forEach(function(t){return t.dispose()})}function FI(r){return G.keep(r)}function FG(r){return G.time(r)}function DG(r){return G.setBackend(r)}function RG(){return G.ready()}function $G(){return G.backendName}function PG(r){G.removeBackend(r)}function OG(r){return G.findBackend(r)}function MG(r){return G.findBackendFactory(r)}function BG(r,e,t){return t===void 0&&(t=1),G.registerBackend(r,e,t)}function LG(){return G.backend}function VG(r,e){at().setPlatform(r,e)}function WG(r,e){var t,n=F(r,"a","add"),o=F(e,"b","add");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(Wv,a)}var ze=U({add_:WG});function zG(r,e){var t,n=F(r,"a","floorDiv"),o=F(e,"b","floorDiv");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(U_,a)}var DI=U({floorDiv_:zG});function UG(r,e){var t,n=F(r,"a","div"),o=F(e,"b","div");if(t=Ee(Yt(n,o),2),n=t[0],o=t[1],n.dtype==="int32"&&o.dtype==="int32")return DI(n,o);var a={a:n,b:o},i={};return G.runKernel(F_,a,i)}var Pt=U({div_:UG});function GG(r,e){var t,n=F(r,"a","mul"),o=F(e,"b","mul");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(wS,a)}var be=U({mul_:GG});function jG(r){var e=F(r,"x","abs");if(e.dtype==="complex64"){var t={x:e};return G.runKernel(d_,t)}else{var t={x:e};return G.runKernel(jk,t)}}var dn=U({abs_:jG});function HG(r){var e=F(r,"x","acos"),t={x:e};return G.runKernel(Hk,t)}var qG=U({acos_:HG});function KG(r){var e=F(r,"x","acosh"),t={x:e};return G.runKernel(qk,t)}var XG=U({acosh_:KG});function YG(r){P(Array.isArray(r),function(){return"The argument passed to tf.addN() must be a list of tensors"}),P(r.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+(""+r.length)});var e=r.map(function(o,a){return F(o,"tensors"+a,"addN")}),t=e[0];e.forEach(function(o){if(o.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(o){if(!No(o.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=e;return G.runKernel(Kk,n)}var ZG=U({addN_:YG});function JG(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","all","bool"),o={x:n},a={axis:e,keepDims:t};return G.runKernel(Xk,o,a)}var QG=U({all_:JG});function e6(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","any","bool"),o={x:n},a={axis:e,keepDims:t};return G.runKernel(Yk,o,a)}var t6=U({any_:e6});function r6(r,e){e===void 0&&(e=0);var t=F(r,"x","argMax"),n={x:t},o={axis:e};return G.runKernel(Zk,n,o)}var n6=U({argMax_:r6});function o6(r,e){e===void 0&&(e=0);var t=F(r,"x","argMin"),n={x:t},o={axis:e};return G.runKernel(Jk,n,o)}var a6=U({argMin_:o6});function s6(r){var e=F(r,"x","asin"),t={x:e};return G.runKernel(Qk,t)}var i6=U({asin_:s6});function u6(r){var e=F(r,"x","asinh"),t={x:e};return G.runKernel(e_,t)}var l6=U({asinh_:u6});function c6(r){var e=F(r,"x","atan"),t={x:e};return G.runKernel(t_,t)}var p6=U({atan_:c6});function f6(r,e){var t,n=F(r,"a","atan2"),o=F(e,"b","atan2");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(n_,a)}var d6=U({atan2_:f6});function m6(r){var e=F(r,"x","atanh"),t={x:e};return G.runKernel(r_,t)}var h6=U({atanh_:m6});function g6(r,e,t,n,o,a){o===void 0&&(o="NHWC");var i=r[3],s=gt(e,[i]),u=PI(o);return Oc(r,s,t,a,n,null,null,u)}function RI(r,e,t,n,o,a,i){i===void 0&&(i="channelsLast");var s=Ee(nd(e),2),u=s[0],l=s[1],c;if(i==="channelsLast")c=[u,l,r[3],r[3]];else if(i==="channelsFirst")c=[u,l,r[1],r[1]];else throw new Error("Unknown dataFormat "+i);return Oc(r,c,t,n,o,a,!1,i)}function v6(r,e,t,n,o,a,i){i===void 0&&(i="NDHWC");var s=Ee(Ax(e),3),u=s[0],l=s[1],c=s[2],p,f;if(i==="NDHWC")f="channelsLast",p=[u,l,c,r[4],r[4]];else if(i==="NCDHW")f="channelsFirst",p=[u,l,c,r[1],r[1]];else throw new Error("Unknown dataFormat "+i);return $I(r,p,t,n,o,!1,f,a)}function Oc(r,e,t,n,o,a,i,s){var u,l;i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var c=Ee([-1,-1,-1,-1],4),p=c[0],f=c[1],d=c[2],m=c[3];if(s==="channelsLast")u=Ee(r,4),p=u[0],f=u[1],d=u[2],m=u[3];else if(s==="channelsFirst")l=Ee(r,4),p=l[0],m=l[1],f=l[2],d=l[3];else throw new Error("Unknown dataFormat "+s);var h=Ee(e,4),g=h[0],v=h[1],x=h[3],y=Ee(nd(t),2),b=y[0],k=y[1],N=Ee(nd(n),2),E=N[0],T=N[1],R=Wu(g,E),$=Wu(v,T),O=b6(o,f,d,b,k,R,$,a,s),M=O.padInfo,B=O.outHeight,L=O.outWidth,H=i?x*m:x,W;return s==="channelsFirst"?W=[p,H,B,L]:s==="channelsLast"&&(W=[p,B,L,H]),{batchSize:p,dataFormat:s,inHeight:f,inWidth:d,inChannels:m,outHeight:B,outWidth:L,outChannels:H,padInfo:M,strideHeight:b,strideWidth:k,filterHeight:g,filterWidth:v,effectiveFilterHeight:R,effectiveFilterWidth:$,dilationHeight:E,dilationWidth:T,inShape:r,outShape:W,filterShape:e}}function $I(r,e,t,n,o,a,i,s){var u,l;a===void 0&&(a=!1),i===void 0&&(i="channelsLast");var c=Ee([-1,-1,-1,-1,-1],5),p=c[0],f=c[1],d=c[2],m=c[3],h=c[4];if(i==="channelsLast")u=Ee(r,5),p=u[0],f=u[1],d=u[2],m=u[3],h=u[4];else if(i==="channelsFirst")l=Ee(r,5),p=l[0],h=l[1],f=l[2],d=l[3],m=l[4];else throw new Error("Unknown dataFormat "+i);var g=Ee(e,5),v=g[0],x=g[1],y=g[2],b=g[4],k=Ee(Ax(t),3),N=k[0],E=k[1],T=k[2],R=Ee(Ax(n),3),$=R[0],O=R[1],M=R[2],B=Wu(v,$),L=Wu(x,O),H=Wu(y,M),W=w6(o,f,d,m,N,E,T,B,L,H,s),K=W.padInfo,J=W.outDepth,Q=W.outHeight,ee=W.outWidth,Y=a?b*h:b,ne;return i==="channelsFirst"?ne=[p,Y,J,Q,ee]:i==="channelsLast"&&(ne=[p,J,Q,ee,Y]),{batchSize:p,dataFormat:i,inDepth:f,inHeight:d,inWidth:m,inChannels:h,outDepth:J,outHeight:Q,outWidth:ee,outChannels:Y,padInfo:K,strideDepth:N,strideHeight:E,strideWidth:T,filterDepth:v,filterHeight:x,filterWidth:y,effectiveFilterDepth:B,effectiveFilterHeight:L,effectiveFilterWidth:H,dilationDepth:$,dilationHeight:O,dilationWidth:M,inShape:r,outShape:ne,filterShape:e}}function x6(r,e,t,n,o){n==null&&(n=Tx(r,e,t));var a=r[0],i=r[1],s=ps((a-e+2*n)/t+1,o),u=ps((i-e+2*n)/t+1,o);return[s,u]}function y6(r,e,t,n,o,a){o==null&&(o=Tx(r,e,n));var i=r[0],s=r[1],u=r[2],l=ps((i-e+2*o)/n+1,a),c=ps((s-e+2*o)/n+1,a),p=ps((u-e+2*o)/n+1,a);return[l,c,p,t]}function Tx(r,e,t,n){n===void 0&&(n=1);var o=Wu(e,n);return Math.floor((r[0]*(t-1)-t+o)/2)}function nd(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Ax(r){return typeof r=="number"?[r,r,r]:r}function Wu(r,e){return e<=1?r:r+(r-1)*(e-1)}function b6(r,e,t,n,o,a,i,s,u){var l,c,p;if(typeof r=="number"){var f=r===0?"VALID":"NUMBER";l={top:r,bottom:r,left:r,right:r,type:f};var d=x6([e,t],a,n,r,s);c=d[0],p=d[1]}else if(r==="same"){c=Math.ceil(e/n),p=Math.ceil(t/o);var m=Math.max(0,(c-1)*n+a-e),h=Math.max(0,(p-1)*o+i-t),g=Math.floor(m/2),v=m-g,x=Math.floor(h/2),y=h-x;l={top:g,bottom:v,left:x,right:y,type:"SAME"}}else if(r==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-a+1)/n),p=Math.ceil((t-i+1)/o);else if(typeof r=="object"){var g=u==="channelsLast"?r[1][0]:r[2][0],v=u==="channelsLast"?r[1][1]:r[2][1],x=u==="channelsLast"?r[2][0]:r[3][0],y=u==="channelsLast"?r[2][1]:r[3][1],f=g===0&&v===0&&x===0&&y===0?"VALID":"EXPLICIT";l={top:g,bottom:v,left:x,right:y,type:f},c=ps((e-a+g+v)/n+1,s),p=ps((t-i+x+y)/o+1,s)}else throw Error("Unknown padding parameter: "+r);return{padInfo:l,outHeight:c,outWidth:p}}function w6(r,e,t,n,o,a,i,s,u,l,c){var p,f,d,m;if(typeof r=="number"){var h=r===0?"VALID":"NUMBER";p={top:r,bottom:r,left:r,right:r,front:r,back:r,type:h};var g=y6([e,t,n,1],s,1,o,r,c);f=g[0],d=g[1],m=g[2]}else if(r==="same"){f=Math.ceil(e/o),d=Math.ceil(t/a),m=Math.ceil(n/i);var v=(f-1)*o+s-e,x=(d-1)*a+u-t,y=(m-1)*i+l-n,b=Math.floor(v/2),k=v-b,N=Math.floor(x/2),E=x-N,T=Math.floor(y/2),R=y-T;p={top:N,bottom:E,left:T,right:R,front:b,back:k,type:"SAME"}}else if(r==="valid")p={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((e-s+1)/o),d=Math.ceil((t-u+1)/a),m=Math.ceil((n-l+1)/i);else throw Error("Unknown padding parameter: "+r);return{padInfo:p,outDepth:f,outHeight:d,outWidth:m}}function ps(r,e){if(!e)return Math.trunc(r);switch(e){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+e)}}function Mc(r){var e=Ee(nd(r),3),t=e[0],n=e[1],o=e[2];return t===1&&n===1&&o===1}function Ao(r,e){return Mc(r)||Mc(e)}function PI(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function k6(r,e){var t=F(r,"x","reshape","string_or_numeric"),n={x:t},o={shape:e};return G.runKernel(BS,n,o)}var ue=U({reshape_:k6});function _6(r,e,t,n,o){var a=F(r,"x","avgPool","float32"),i=1;P(Ao(t,i),function(){return"Error in avgPool: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+i+"'")});var s=a,u=!1;a.rank===3&&(u=!0,s=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]])),P(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),o!=null&&P(zr(n),function(){return"Error in avgPool: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o},p=G.runKernel(o_,l,c);return p=tr(p,a.dtype),u?ue(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var OI=U({avgPool_:_6});function S6(r,e,t,n,o,a){a===void 0&&(a="NDHWC");var i=F(r,"x","avgPool3d","float32"),s=i,u=!1;i.rank===4&&(u=!0,s=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),P(s.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+s.rank+"."}),P(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+("but got dataFormat of "+a)}),o!=null&&P(zr(n),function(){return"Error in avgPool3d: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o,dataFormat:a},p=G.runKernel(a_,l,c);return p=tr(p,s.dtype),u?ue(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var I6=U({avgPool3d_:S6});function C6(r,e){e===void 0&&(e=0),P(r.length>=1,function(){return"Pass at least one tensor to concat"});var t=$c(r,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")}),t.length===1)return ls(t[0]);var n=t,o={axis:e};return G.runKernel(m_,n,o)}var en=U({concat_:C6});function N6(r){var e=F(r,"x","sigmoid","float32"),t={x:e};return G.runKernel(JS,t)}var zu=U({sigmoid_:N6});function E6(r,e,t){var n=F(r,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");var o={x:n},a={begin:e,size:t};return G.runKernel(KS,o,a)}var Ht=U({slice_:E6});function T6(r){var e=F(r,"x","tanh","float32"),t={x:e};return G.runKernel(v2,t)}var Fx=U({tanh_:T6});function A6(r,e,t,n,o,a){var i=F(r,"forgetBias","basicLSTMCell"),s=F(e,"lstmKernel","basicLSTMCell"),u=F(t,"lstmBias","basicLSTMCell"),l=F(n,"data","basicLSTMCell"),c=F(o,"c","basicLSTMCell"),p=F(a,"h","basicLSTMCell"),f=en([l,p],1),d=vt(f,s),m=ze(d,u),h=m.shape[0],g=m.shape[1]/4,v=[h,g],x=Ht(m,[0,0],v),y=Ht(m,[0,g],v),b=Ht(m,[0,g*2],v),k=Ht(m,[0,g*3],v),N=ze(be(zu(x),Fx(y)),be(c,zu(ze(i,b)))),E=be(Fx(N),zu(k));return[N,E]}var F6=U({basicLSTMCell_:A6});function D6(r,e,t){var n=F(r,"x","batchToSpaceND"),o=e.reduce(function(s,u){return s*u});P(n.rank>=1+e.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+e.length}),P(t.length===e.length,function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length}),P(n.shape[0]%o==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+e.join(" * ")+" === "+o)});var a={x:n},i={blockShape:e,crops:t};return G.runKernel(i_,a,i)}var MI=U({batchToSpaceND_:D6});function R6(r){var e;return r.rank===0||r.rank===1?e=ue(r,[1,1,1,r.size]):r.rank===2?e=ue(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?e=ue(r,[1,r.shape[0],r.shape[1],r.shape[2]]):e=r,e}function $6(r,e,t,n,o,a){a==null&&(a=.001);var i=F(r,"x","batchNorm"),s=F(e,"mean","batchNorm"),u=F(t,"variance","batchNorm"),l;o!=null&&(l=F(o,"scale","batchNorm"));var c;n!=null&&(c=F(n,"offset","batchNorm")),P(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),P(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),P(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var p=R6(i),f={x:p,scale:l,offset:c,mean:s,variance:u},d={varianceEpsilon:a},m=G.runKernel(G_,f,d);return ue(m,i.shape)}var od=U({batchNorm_:$6});function P6(r,e,t,n,o,a){var i=F(r,"x","batchNorm"),s=F(e,"mean","batchNorm"),u=F(t,"variance","batchNorm"),l;o!=null&&(l=F(o,"scale","batchNorm"));var c;return n!=null&&(c=F(n,"offset","batchNorm")),P(i.rank===2,function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+(i.rank+".")}),P(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+("got rank "+s.rank+".")}),P(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+("but got rank "+u.rank+".")}),l!=null&&P(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+("but got rank "+l.rank+".")}),c!=null&&P(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+("but got rank "+c.rank+".")}),od(i,s,u,c,l,a)}var O6=U({batchNorm2d_:P6});function M6(r,e,t,n,o,a){var i=F(r,"x","batchNorm"),s=F(e,"mean","batchNorm"),u=F(t,"variance","batchNorm"),l;o!=null&&(l=F(o,"scale","batchNorm"));var c;return n!=null&&(c=F(n,"offset","batchNorm")),P(i.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+(i.rank+".")}),P(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+("got rank "+s.rank+".")}),P(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+("but got rank "+u.rank+".")}),l!=null&&P(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+("but got rank "+l.rank+".")}),c!=null&&P(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+("but got rank "+c.rank+".")}),od(i,s,u,c,l,a)}var B6=U({batchNorm3d_:M6});function L6(r,e,t,n,o,a){var i=F(r,"x","batchNorm"),s=F(e,"mean","batchNorm"),u=F(t,"variance","batchNorm"),l;o!=null&&(l=F(o,"scale","batchNorm"));var c;return n!=null&&(c=F(n,"offset","batchNorm")),P(i.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+(i.rank+".")}),P(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+("got rank "+s.rank+".")}),P(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+("but got rank "+u.rank+".")}),l!=null&&P(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+("but got rank "+l.rank+".")}),c!=null&&P(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+("but got rank "+c.rank+".")}),od(i,s,u,c,l,a)}var V6=U({batchNorm4d_:L6});function W6(r,e,t){var n=F(r,"x","bincount"),o=F(e,"weights","bincount");P(n.dtype==="int32",function(){return"Error in bincount: input "+("dtype must be int32, but got "+n.dtype)}),P(t>=0,function(){return"size must be non-negative, but got "+t+"."}),P(o.size===n.size||o.size===0,function(){return"Error in bincount: weights must have the same size as input or"+("0-length, but got input shape: "+n.shape+", weights shape: ")+(o.shape+".")});var a={x:n,weights:o},i={size:t};return G.runKernel(u_,a,i)}var BI=U({bincount_:W6});function z6(r,e){var t=F(r,"s0","broadcastArgs","int32"),n=F(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+("Has rank "+t.rank));if(n.rank!==1)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+("Has rank "+n.rank));var o={s0:t,s1:n};return G.runKernel(l_,o)}var U6=U({broadcastArgs_:z6});function G6(r,e){var t=F(r,"broadcastTo","x"),n=t.shape;if(e.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<t.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+t.rank+".");if(e.length>t.rank){for(var o=t.shape.slice();o.length<e.length;)o.unshift(1);t=ue(t,o)}for(var a=t.shape,i=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])i[s]=1;else if(t.shape[s]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+e+"].");var u=i.map(function(p,f){return p>1?f:-1}).filter(function(p){return p>=0});if(u.length===0)return ls(t);var l={x:t},c={reps:i};return G.runKernel(Gv,l,c)}var ad=U({broadcastTo_:G6});function j6(r){var e=F(r,"x","ceil","float32"),t={x:e};return G.runKernel(c_,t)}var H6=U({ceil_:j6});function q6(r,e,t){var n=F(r,"x","clipByValue");P(e<=t,function(){return"Error in clip: min ("+e+") must be "+("less than or equal to max ("+t+").")});var o={x:n},a={clipValueMin:e,clipValueMax:t};return G.runKernel(p_,o,a)}var K6=U({clipByValue_:q6});function X6(r){return en(r,0)}var Y6=U({concat1d_:X6});function Z6(r,e){return en(r,e)}var J6=U({concat2d_:Z6});function Q6(r,e){return en(r,e)}var ej=U({concat3d_:Q6});function tj(r,e){return en(r,e)}var rj=U({concat4d_:tj});function nj(r,e,t,n,o,a,i){o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]);var s=F(r,"x","conv2d","float32"),u=F(e,"filter","conv2d","float32"),l=s,c=!1;s.rank===3&&(c=!0,l=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),P(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),P(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+(u.rank+".")}),i!=null&&P(zr(n),function(){return"Error in conv2d: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+n+".")});var p=o==="NHWC"?l.shape[3]:l.shape[1];P(p===u.shape[2],function(){return"Error in conv2d: depth of input ("+p+") must match "+("input depth for filter "+u.shape[2]+".")}),P(Ao(t,a),function(){return"Error in conv2D: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+a+"'")});var f={x:l,filter:u},d={strides:t,pad:n,dataFormat:o,dilations:a,dimRoundingMode:i},m=G.runKernel(h_,f,d);return c?ue(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var sd=U({conv2d_:nj});function oj(r,e,t,n,o,a,i){o===void 0&&(o="NWC"),a===void 0&&(a=1);var s=F(r,"x","conv1d"),u=F(e,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=ue(s,[1,s.shape[0],s.shape[1]])),P(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),P(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+(u.rank+".")}),i!=null&&P(zr(n),function(){return"Error in conv1d: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+n+".")}),P(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match "+("input depth for filter "+u.shape[1]+".")}),P(Ao(t,a),function(){return"Error in conv1D: Either stride or dilation must be 1. "+("Got stride "+t+" and dilation '"+a+"'")}),P(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var p=ue(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=ue(l,[l.shape[0],1,l.shape[1],l.shape[2]]),d=[1,t],m=[1,a],h="NHWC",g=sd(f,p,d,n,h,m,i);return c?ue(g,[g.shape[2],g.shape[3]]):ue(g,[g.shape[0],g.shape[2],g.shape[3]])}var aj=U({conv1d_:oj});function sj(r,e,t,n,o,a,i){a===void 0&&(a="NHWC"),P(r.length===e.rank,function(){return"Length of inShape "+("("+r.length+") and rank of dy ("+e.rank+") must match")});var s=r,u=e,l=!1;e.rank===3&&(l=!0,u=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,r[0],r[1],r[2]]),P(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+(s.length+".")}),P(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+("rank "+u.rank)}),P(t.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+("rank "+t.rank)});var c=a==="NHWC"?s[3]:s[1],p=a==="NHWC"?u.shape[3]:u.shape[1];P(c===t.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must "+("match input depth for filter "+t.shape[2]+".")}),P(p===t.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+p+") must "+("match output depth for filter "+t.shape[3]+".")}),i!=null&&P(zr(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+o+".")});var f={dy:u,filter:t},d={strides:n,pad:o,dataFormat:a,dimRoundingMode:i,inputShape:s},m=G.runKernel(v_,f,d);return l?ue(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var LI=U({conv2DBackpropInput_:sj});function ij(r,e,t,n,o,a){var i=F(r,"x","conv2dTranspose"),s=F(e,"filter","conv2dTranspose");return LI(t,i,s,n,o,"NHWC",a)}var uj=U({conv2dTranspose_:ij});function lj(r,e,t,n,o,a){o===void 0&&(o="NDHWC"),a===void 0&&(a=[1,1,1]);var i=F(r,"x","conv3d"),s=F(e,"filter","conv3d"),u=i,l=!1;i.rank===4&&(l=!0,u=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),P(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),P(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+(s.rank+".")}),P(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match "+("input depth for filter "+s.shape[3]+".")}),P(Ao(t,a),function(){return"Error in conv3D: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+a+"'")}),P(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c={x:u,filter:s},p={strides:t,pad:n,dataFormat:o,dilations:a},f=G.runKernel(x_,c,p);return l?ue(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var cj=U({conv3d_:lj});function pj(r,e,t,n,o){P(r.length===e.rank,function(){return"Length of inShape "+("("+r.length+") and rank of dy ("+e.rank+") must match")});var a=r,i=e,s=!1;e.rank===4&&(s=!0,i=ue(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,r[0],r[1],r[2],r[3]]);var u=a[4],l=i.shape[4];P(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+(a.length+".")}),P(i.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+("rank "+i.rank)}),P(t.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+("rank "+t.rank)}),P(u===t.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must "+("match input depth for filter "+t.shape[3]+".")}),P(l===t.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must "+("match output depth for filter "+t.shape[4]+".")});var c={dy:i,filter:t},p={pad:o,strides:n,inputShape:a},f=G.runKernel(y_,c,p);return s?ue(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var fj=U({conv3DBackpropInput_:pj});function dj(r,e,t,n,o){var a=F(r,"x","conv3dTranspose"),i=F(e,"filter","conv3dTranspose");return fj(t,a,i,n,o)}var mj=U({conv3dTranspose_:dj});function hj(r){var e=F(r,"x","cos","float32"),t={x:e};return G.runKernel(b_,t)}var gj=U({cos_:hj});function vj(r){var e=F(r,"x","cosh","float32"),t={x:e};return G.runKernel(w_,t)}var xj=U({cosh_:vj});function yj(r,e,t,n){e===void 0&&(e=0),t===void 0&&(t=!1),n===void 0&&(n=!1);var o=F(r,"x","cumsum"),a={x:o},i={axis:e,exclusive:t,reverse:n};return G.runKernel(k_,a,i)}var bj=U({cumsum_:yj});function wj(r,e,t,n){n===void 0&&(n=!1);var o=F(r,"x","denseBincount"),a=F(e,"weights","denseBincount");P(o.dtype==="int32",function(){return"Error in denseBincount: input "+("dtype must be int32, but got "+o.dtype)}),P(o.rank<=2,function(){return"Error in denseBincount: input must be at most rank 2, but got "+("rank "+o.rank+".")}),P(t>=0,function(){return"size must be non-negative, but got "+t+"."}),P(a.size===o.size||a.size===0,function(){return"Error in denseBincount: weights must have the same shape as x or "+("0-length, but got x shape: "+o.shape+", weights shape: ")+(a.shape+".")});var i={x:o,weights:a},s={size:t,binaryOutput:n};return G.runKernel(S_,i,s)}var kj=U({denseBincount_:wj});function _j(r,e,t){t===void 0&&(t="NHWC");var n=F(r,"x","depthToSpace","float32"),o=t==="NHWC"?n.shape[1]:n.shape[2],a=t==="NHWC"?n.shape[2]:n.shape[3],i=t==="NHWC"?n.shape[3]:n.shape[1];P(e>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}),P(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
    `+o+" and "+e+`  for depthToSpace with input shape
    `+n.shape}),P(a*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
    `+a+" and "+e+` for depthToSpace with input shape
        `+n.shape}),P(i%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+i+" for depthToSpace with input shape "+n.shape});var s={x:n},u={blockSize:e,dataFormat:t};return G.runKernel(I_,s,u)}var Sj=U({depthToSpace_:_j});function Ij(r,e,t,n,o,a,i){o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]);var s=F(r,"x","depthwiseConv2d","float32"),u=F(e,"filter","depthwiseConv2d","float32"),l=s,c=!1;s.rank===3&&(c=!0,l=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),P(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+("rank "+l.rank+".")}),P(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+(u.rank+".")}),P(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels "+("("+l.shape[3]+") must match the inChannels dimension in ")+("filter "+u.shape[2]+".")}),i!=null&&P(zr(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+n+".")});var p={x:l,filter:u},f={strides:t,pad:n,dataFormat:o,dilations:a,dimRoundingMode:i},d=G.runKernel(C_,p,f);return c?ue(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Dx=U({depthwiseConv2d_:Ij});function Cj(r){var e=F(r,"x","diag"),t={x:e};return G.runKernel(T_,t)}var Nj=U({diag_:Cj});function Ej(r,e,t,n,o,a){o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC");var i=F(r,"x","dilation2d"),s=F(e,"filter","dilation2d");P(i.rank===3||i.rank===4,function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+(i.rank+".")}),P(s.rank===3,function(){return"Error in dilation2d: filter must be rank 3, but got rank "+(s.rank+".")}),P(a==="NHWC",function(){return"Error in dilation2d: Only NHWC is currently supported, "+("but got dataFormat of "+a)});var u=i,l=!1;i.rank===3&&(u=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=!0);var c={x:u,filter:s},p={strides:t,pad:n,dilations:o},f=G.runKernel(A_,c,p);return l?ue(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var Tj=U({dilation2d_:Ej});function Aj(r,e){for(var t=r.length,n=[],o=0;o<t;o++){var a=t-1-o,i=r[a]||1,s=e[e.length-1-o]||1;s>1&&i===1&&n.unshift(a)}return n}function VI(r,e){for(var t=[],n=0;n<e.length;n++){var o=r[r.length-n-1],a=e.length-n-1,i=e[a];(o==null||o===1&&i>1)&&t.unshift(a)}return t}function kr(r,e){for(var t=[],n=Math.max(r.length,e.length),o=0;o<n;o++){var a=r[r.length-o-1];a==null&&(a=1);var i=e[e.length-o-1];if(i==null&&(i=1),a===1)t.unshift(i);else if(i===1)t.unshift(a);else if(a!==i){var s="Operands could not be broadcast together with shapes "+(r+" and "+e+".");throw Error(s)}else t.unshift(a)}return t}function Fj(r,e){var t,n=F(r,"a","equal","string_or_numeric"),o=F(e,"b","equal","string_or_numeric");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(P_,a)}var WI=U({equal_:Fj});function Dj(r,e,t){var n=F(e,"a","where"),o=F(t,"b","where"),a=F(r,"condition","where","bool"),i=kr(kr(a.shape,n.shape),o.shape),s=ad(a,i),u=ad(n,i),l=ad(o,i),c={condition:s,t:u,e:l};return G.runKernel(HS,c)}var Uu=U({where_:Dj});function Rj(r){var e=F(r,"x","zerosLike"),t={x:e};return G.runKernel(S2,t)}var mn=U({zerosLike_:Rj});function $j(r,e){var t,n=F(r,"a","div"),o=F(e,"b","div");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a=Pt(n,o),i=mn(a),s=WI(o,i);return Uu(s,i,a)}var Pj=U({divNoNan_:$j});function Oj(r,e){var t=F(r,"t1","dot"),n=F(e,"t2","dot");P((t.rank===1||t.rank===2)&&(n.rank===1||n.rank===2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+(t.rank+" and "+n.rank+".")});var o=t.rank===1?t.size:t.shape[1],a=n.rank===1?n.size:n.shape[0];if(P(o===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+(o+" and "+a+".")}),t.rank===1&&n.rank===1){var i=ue(t,[1,-1]),s=ue(n,[-1,1]),u=vt(i,s);return ue(u,[])}else if(t.rank===1&&n.rank===2){var i=ue(t,[1,-1]),s=ue(n,[n.shape[0],n.shape[1]]),u=vt(i,s);return ue(u,[u.size])}else if(t.rank===2&&n.rank===1){var s=ue(n,[-1,1]),u=vt(t,s);return ue(u,[u.size])}else{var s=ue(n,[n.shape[0],n.shape[1]]),u=vt(t,s);return u}}var Mj=U({dot_:Oj});function Bj(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var n=e.map(function(a,i){return F(a,"tensors"+i,"einsum")}),o={equation:r};return G.runKernel(D_,n,o)}var Lj=U({einsum_:Bj});function Vj(r){var e=F(r,"x","elu","float32"),t={x:e};return G.runKernel(R_,t)}var zI=U({elu_:Vj});function Wj(r){var e=F(r,"x","erf");P(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=tr(e,"float32"));var t={x:e};return G.runKernel($_,t)}var zj=U({erf_:Wj});function Uj(r){var e=F(r,"x","exp"),t={x:e};return G.runKernel(O_,t)}var fs=U({exp_:Uj});function Gj(r,e){e===void 0&&(e=0);var t=F(r,"x","expandDims","string_or_numeric");P(e<=t.rank,function(){return"Axis must be <= rank of the tensor"});var n={input:t},o={dim:e};return G.runKernel(M_,n,o)}var ds=U({expandDims_:Gj});function jj(r){var e=F(r,"x","expm1"),t={x:e};return G.runKernel(B_,t)}var Hj=U({expm1_:jj});function qj(r,e){var t=F(r,"x","tile","string_or_numeric");P(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" "+("must match length of reps "+e+".")});var n={x:t},o={reps:e};return G.runKernel(Gv,n,o)}var Bc=U({tile_:qj});function Kj(r,e,t,n){n===void 0&&(n="float32"),e==null&&(e=r);for(var o=To([r,e],n),a=r<=e?r:e,i=0;i<a;++i)o.set(1,i,i);var s=ue(o.toTensor(),[r,e]);if(t==null)return s;if(t.length===1)return Bc(ds(s,0),[t[0],1,1]);if(t.length===2)return Bc(ds(ds(s,0),0),[t[0],t[1],1,1]);if(t.length===3)return Bc(ds(ds(ds(s,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+("batchShapes, but received "+t.length+"D."))}var UI=U({eye_:Kj});function id(r,e,t){var n={shape:r,value:e,dtype:t};return G.runKernel(V_,{},n)}function Xj(r){var e=F(r,"x","floor","float32"),t={x:e};return G.runKernel(z_,t)}var GI=U({floor_:Xj});function Yj(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=0);var o=F(r,"x","gather"),a=F(e,"indices","gather","int32"),i={x:o,indices:a},s={axis:t,batchDims:n};return G.runKernel(j_,i,s)}var jI=U({gather_:Yj});function Zj(r,e){var t,n=F(r,"a","greater","string_or_numeric"),o=F(e,"b","greater","string_or_numeric");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(q_,a)}var ud=U({greater_:Zj});function Jj(r,e){var t,n=F(r,"a","greaterEqual","string_or_numeric"),o=F(e,"b","greaterEqual","string_or_numeric");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(K_,a)}var HI=U({greaterEqual_:Jj});function Qj(r){var e=F(r,"input","imag"),t={input:e};return G.runKernel(Y_,t)}var Rx=U({imag_:Qj});function eH(r){var e=F(r,"x","isFinite"),t={x:e};return G.runKernel(Z_,t)}var tH=U({isFinite_:eH});function rH(r){var e=F(r,"x","isInf"),t={x:e};return G.runKernel(J_,t)}var nH=U({isInf_:rH});function oH(r){var e=F(r,"x","isNaN"),t={x:e};return G.runKernel(Q_,t)}var aH=U({isNaN_:oH});function sH(r,e){e===void 0&&(e=.2);var t=F(r,"x","leakyRelu"),n={x:t},o={alpha:e};return G.runKernel(eS,n,o)}var qI=U({leakyRelu_:sH});function iH(r,e){var t,n=F(r,"a","less","string_or_numeric"),o=F(e,"b","less","string_or_numeric");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(tS,a)}var uH=U({less_:iH});function lH(r,e){var t,n=F(r,"a","lessEqual","string_or_numeric"),o=F(e,"b","lessEqual","string_or_numeric");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(rS,a)}var $x=U({lessEqual_:lH});function cH(r,e,t){if(t<=0)throw new Error("The number of values should be positive.");var n={start:r,stop:e,num:t};return G.runKernel(nS,{},n)}function pH(r,e,t,n,o){e===void 0&&(e=5),t===void 0&&(t=1),n===void 0&&(n=1),o===void 0&&(o=.5);var a=F(r,"x","localResponseNormalization");P(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),P(zr(e),function(){return"Error in localResponseNormalization: depthRadius must be an "+("integer but got depthRadius "+e+".")});var i=a,s=!1;a.rank===3&&(s=!0,i=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]]));var u={x:i},l={depthRadius:e,bias:t,alpha:n,beta:o},c=G.runKernel(lS,u,l);return s?ue(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var fH=U({localResponseNormalization_:pH});function dH(r){var e=F(r,"x","log","float32"),t={x:e};return G.runKernel(oS,t)}var Lc=U({log_:dH});function mH(r){var e=F(r,"x","log1p"),t={x:e};return G.runKernel(aS,t)}var KI=U({log1p_:mH});function hH(r){return P(ma(r),function(){return"The f passed in grad(f) must be a function"}),function(e,t){var n=F(e,"x","tf.grad","string_or_numeric"),o=t!=null?F(t,"dy","tf.grad"):null;return G.tidy(function(){var a=G.gradients(function(){return r(n)},[n],o),i=a.value,s=a.grads;return o!=null&&$r(i.shape,o.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ld(s),s[0]})}}function gH(r){return P(ma(r),function(){return"The f passed in grads(f) must be a function"}),function(e,t){P(Array.isArray(e),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var n=$c(e,"args","tf.grads","string_or_numeric"),o=t!=null?F(t,"dy","tf.grads"):null;return G.tidy(function(){var a=G.gradients(function(){return r.apply(void 0,gt(n))},n,o),i=a.value,s=a.grads;return o!=null&&$r(i.shape,o.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ld(s),s})}}function vH(r){return P(ma(r),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(e,t){P(e instanceof ir,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),P(t==null||t instanceof ir,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var n=G.gradients(function(){return r(e)},[e],t),o=n.grads,a=n.value;return ld(o),{grad:o[0],value:a}}}function xH(r){return P(ma(r),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(e,t){P(Array.isArray(e)&&e.every(function(o){return o instanceof ir}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),P(t==null||t instanceof ir,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var n=G.gradients(function(){return r.apply(void 0,gt(e))},e,t);return t!=null&&$r(n.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ld(n.grads),n}}function XI(r,e){P(ma(r),function(){return"The f passed in variableGrads(f) must be a function"}),P(e==null||Array.isArray(e)&&e.every(function(p){return p instanceof Rc}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var t=e!=null;if(!t){e=[];for(var n in G.registeredVariables)e.push(G.registeredVariables[n])}var o=t?e.filter(function(p){return!p.trainable}):null,a=e.length;e=e.filter(function(p){return p.trainable}),P(e.length>0,function(){return"variableGrads() expects at least one of the input variables to "+("be trainable, but none of the "+a+" variables is ")+"trainable."});var i=!0,s=G.gradients(r,e,null,i),u=s.value,l=s.grads;P(l.some(function(p){return p!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),P(u.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it "+("returned a rank-"+u.rank+" tensor")});var c={};return e.forEach(function(p,f){l[f]!=null&&(c[p.name]=l[f])}),o!=null&&o.forEach(function(p){return c[p.name]=null}),{value:u,grads:c}}function no(r){return G.customGrad(r)}function ld(r){var e=r.filter(function(t){return t==null}).length;if(e>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function yH(r){var e=F(r,"x","neg"),t={x:e};return G.runKernel(kS,t)}var ba=U({neg_:yH});function bH(r){var e=F(r,"x","softplus"),t={x:e};return G.runKernel(QS,t)}var YI=U({softplus_:bH});function wH(r){var e=F(r,"x","logSigmoid"),t=no(function(n){var o=ba(YI(ba(n))),a=function(i){var s=be(i,zu(ba(n)));return s};return{value:o,gradFunc:a}});return t(e)}var kH=U({logSigmoid_:wH});function _H(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","max"),o={x:n},a={reductionIndices:e,keepDims:t};return G.runKernel(cS,o,a)}var Gu=U({max_:_H});function SH(r,e){var t,n=F(r,"a","sub"),o=F(e,"b","sub");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(h2,a)}var Je=U({sub_:SH});function IH(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","sum");n.dtype==="bool"&&(n=tr(n,"int32"));var o={x:n},a={axis:e,keepDims:t};return G.runKernel(t2,o,a)}var Ot=U({sum_:IH});function CH(r,e){e===void 0&&(e=-1);var t=F(r,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+("Logits was rank "+t.rank+" and axis was "+e));var n=no(function(o,a){var i=!0,s=Gu(o,e,!0),u=Je(o,s),l=Je(tr(u,"float32"),Lc(Ot(fs(u),e,i)));a([l]);var c=function(p,f){var d=Ee(f,1),m=d[0],h=!0,g=fs(m);return Je(p,be(Ot(p,e,h),g))};return{value:l,gradFunc:c}});return n(t)}var NH=U({logSoftmax_:CH});function Px(r,e){for(var t=0;t<r.length;++t)if(r[r.length-t-1]!==e-1-t)return!1;return!0}function ZI(r,e,t){for(var n=r.length+e.length,o=[],a=0,i=0,s=0;s<n;s++)t.indexOf(s)===-1?o.push(r[a++]):o.push(e[i++]);return o}function EH(r,e){for(var t=[],n=r.length,o=0;o<n;o++)e.indexOf(o)===-1&&t.push(r[o]);var a=e.map(function(i){return r[i]});return[t,a]}function Vc(r,e){var t=e.map(function(n){return 1});return ZI(r,t,e)}function TH(r,e,t){P(Px(e,t),function(){return r+" supports only inner-most axes for now. "+("Got axes "+e+" and rank-"+t+" input.")})}function AH(r,e){if(Px(r,e))return null;for(var t=[],n=0;n<e;++n)r.indexOf(n)===-1&&t.push(n);return r.forEach(function(o){return t.push(o)}),t}function FH(r){return r.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function DH(r,e){for(var t=[],n=e-r;n<e;++n)t.push(n);return t}function RH(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","logSumExp"),o=Ic(e,n.shape),a=Gu(n,o,!0),i=Je(n,a),s=fs(i),u=Ot(s,o),l=Lc(u),c=ze(ue(a,l.shape),l);if(t){var p=Vc(c.shape,o);return ue(c,p)}return c}var JI=U({logSumExp_:RH});function $H(r,e){var t=F(r,"a","logicalAnd","bool"),n=F(e,"b","logicalAnd","bool");kr(t.shape,n.shape);var o={a:t,b:n};return G.runKernel(sS,o)}var cd=U({logicalAnd_:$H});function PH(r){var e=F(r,"x","logicalNot","bool"),t={x:e};return G.runKernel(iS,t)}var QI=U({logicalNot_:PH});function OH(r,e){var t=F(r,"a","logicalOr","bool"),n=F(e,"b","logicalOr","bool");kr(t.shape,n.shape);var o={a:t,b:n};return G.runKernel(uS,o)}var eC=U({logicalOr_:OH});function MH(r,e){var t=F(r,"a","logicalXor","bool"),n=F(e,"b","logicalXor","bool");return kr(t.shape,n.shape),cd(eC(r,e),QI(cd(r,e)))}var BH=U({logicalXor_:MH});function LH(r,e,t,n,o){var a=F(r,"x","maxPool"),i=1,s=a,u=!1;a.rank===3&&(u=!0,s=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]])),P(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),P(Ao(t,i),function(){return"Error in maxPool: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+i+"'")}),o!=null&&P(zr(n),function(){return"Error in maxPool: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o},p=G.runKernel(fS,l,c);return u?ue(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var tC=U({maxPool_:LH});function VH(r,e,t,n,o,a){e===void 0&&(e=[1,1,1]),a===void 0&&(a="NDHWC");var i=F(r,"x","maxPool3d"),s=i,u=!1;i.rank===4&&(u=!0,s=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),P(s.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+s.rank+"."}),P(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+("but got dataFormat of "+a)}),o!=null&&P(zr(n),function(){return"Error in maxPool3d: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o,dataFormat:a},p=G.runKernel(dS,l,c);return u?ue(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var WH=U({maxPool3d_:VH});function zH(r,e,t,n,o){o===void 0&&(o=!1);var a=F(r,"x","maxPoolWithArgmax"),i={x:a},s={filterSize:e,strides:t,pad:n,includeBatchInIndex:o},u=G.runKernel(mS,i,s);return{result:u[0],indexes:u[1]}}var UH=U({maxPoolWithArgmax_:zH});function GH(r,e){var t,n=F(r,"a","maximum"),o=F(e,"b","maximum");t=Ee(Yt(n,o),2),n=t[0],o=t[1],n.dtype==="bool"&&(n=tr(n,"int32"),o=tr(o,"int32")),kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(pS,a)}var rC=U({maximum_:GH});function jH(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","mean"),o={x:n},a={axis:e,keepDims:t};return G.runKernel(hS,o,a)}var pd=U({mean_:jH});function ju(r,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=ju(r,"float32"),n=ju(r,"float32");return as(t,n)}var o=Uf(sr(r),e);return G.makeTensor(o,r,e)}function ms(r,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=ms(r,"float32"),n=ju(r,"float32");return as(t,n)}var o=Ov(sr(r),e);return G.makeTensor(o,r,e)}function HH(r,e,t){var n=(t===void 0?{}:t).indexing,o=n===void 0?"xy":n;if(o!=="xy"&&o!=="ij")throw new TypeError(o+" is not a valid third argument to meshgrid");if(r===void 0)return[];var a=F(r,"x","meshgrid",r instanceof ir?r.dtype:"float32");if(e===void 0)return[a];var i=F(e,"y","meshgrid",e instanceof ir?e.dtype:"float32"),s=sr(a.shape),u=sr(i.shape);return o==="xy"?(a=ue(a,[1,-1]),i=ue(i,[-1,1]),[vt(ms([u,1],a.dtype),a),vt(i,ms([1,s],i.dtype))]):(a=ue(a,[-1,1]),i=ue(i,[1,-1]),[vt(a,ms([1,u],a.dtype)),vt(ms([s,1],i.dtype),i)])}function qH(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","min"),o={x:n},a={axis:e,keepDims:t};return G.runKernel(gS,o,a)}var Ox=U({min_:qH});function KH(r,e){var t,n=F(r,"a","minimum"),o=F(e,"b","minimum");t=Ee(Yt(n,o),2),n=t[0],o=t[1],n.dtype==="bool"&&(n=tr(n,"int32"),o=tr(o,"int32")),kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(vS,a)}var nC=U({minimum_:KH});function XH(r,e,t){P(t==="reflect"||t==="symmetric",function(){return"Invalid mode. Mode must be either reflect or symmetric. "+("Got "+t+".")});var n=F(r,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");P(e.length===n.rank,function(){return"Padding doesn't match input. Must be "+n.rank+". "+("Got "+e.length+".")});for(var o=t==="reflect"?1:0,a=function(l){P(e[l].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),P(e[l][0]>=0&&e[l][0]<=n.shape[l]-o&&e[l][1]>=0&&e[l][1]<=n.shape[l]-o,function(){return"Padding in dimension "+l+" cannot be greater than or equal "+("to "+(n.shape[l]-o)+" or less than 0 for input of ")+("shape "+n.shape)})},i=0;i<n.rank;i++)a(i);var s={paddings:e,mode:t},u={x:n};return G.runKernel(xS,u,s)}var YH=U({mirrorPad_:XH});function ZH(r,e){var t,n=F(r,"a","mod"),o=F(e,"b","mod");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(yS,a)}var JH=U({mod_:ZH});function QH(r){var e=F(r,"x","square"),t={};return G.runKernel("Square",{x:e},t)}var Un=U({square_:QH});function eq(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1),r=F(r,"x","moments");var n=Ic(e,r.shape),o=pd(r,n,t),a=o.shape;t||(a=Vc(o.shape,n));var i=Un(Je(tr(r,"float32"),ue(o,a))),s=pd(i,n,t);return{mean:o,variance:s}}var tq=U({moments_:eq});function rq(r,e,t,n){for(var o=F(e,"data","multiRNNCell"),a=$c(t,"c","multiRNNCell"),i=$c(n,"h","multiRNNCell"),s=o,u=[],l=0;l<r.length;l++){var c=r[l](s,a[l],i[l]);u.push(c[0]),u.push(c[1]),s=c[1]}for(var p=[],f=[],l=0;l<u.length;l+=2)p.push(u[l]),f.push(u[l+1]);return[p,f]}var nq=U({multiRNNCell_:rq});function oq(r,e,t,n){n===void 0&&(n=!1);var o=F(r,"logits","multinomial"),a=o.size,i=o.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+(a+"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+i);t=t||Math.random();var s=i===1?ue(o,[1,-1]):o,u={logits:s},l={numSamples:e,seed:t,normalized:n},c=G.runKernel(bS,u,l);return i===1?ue(c,[c.size]):c}var aq=U({multinomial_:oq});function sq(r,e){var t,n=F(r,"a","notEqual","string_or_numeric"),o=F(e,"b","notEqual","string_or_numeric");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o};return G.runKernel(_S,a)}var oC=U({notEqual_:sq});function iq(r){var e=F(r,"x","onesLike"),t={x:e};return G.runKernel(NS,t)}var uq=U({onesLike_:iq});function lq(r,e){var t=F(r,"v1","outerProduct"),n=F(e,"v2","outerProduct");P(t.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+(t.rank+" and "+n.rank+".")});var o=ue(t,[-1,1]),a=ue(n,[1,-1]);return vt(o,a)}var cq=U({outerProduct_:lq});function pq(r,e,t){t===void 0&&(t=0);var n=F(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:e,constantValue:t},a={x:n};return G.runKernel(AS,a,o)}var Wc=U({pad_:pq});function fq(r,e,t){return t===void 0&&(t=0),P(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Wc(r,[e],t)}var dq=U({pad1d_:fq});function mq(r,e,t){return t===void 0&&(t=0),P(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Wc(r,e,t)}var hq=U({pad2d_:mq});function gq(r,e,t){return t===void 0&&(t=0),P(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Wc(r,e,t)}var vq=U({pad3d_:gq});function xq(r,e,t){return t===void 0&&(t=0),P(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Wc(r,e,t)}var yq=U({pad4d_:xq});function bq(r,e,t){var n=F(r,"x","spaceToBatchND");P(n.rank>=1+e.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+e.length}),P(t.length===e.length,function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length}),P(n.shape.reduce(function(i,s,u){return u>0&&u<=e.length?i&&(s+t[u-1][0]+t[u-1][1])%e[u-1]==0:i},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()});var o={x:n},a={blockShape:e,paddings:t};return G.runKernel(r2,o,a)}var aC=U({spaceToBatchND_:bq});function wq(r,e,t,n,o,a){o==null&&(o=[1,1]),a==null&&(a=1),n===0&&(n="valid");var i=F(r,"x","maxPool"),s=i,u=!1;i.rank===3&&(u=!0,s=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]])),P(Ao(a,o),function(){return"Error in pool: Either strides or dilations must be 1. "+("Got strides "+a+" and dilations '"+o+"'")});var l=RI(s.shape,e,a,o,n),c=[l.dilationHeight,l.dilationWidth],p;n==="same"?p=_q([l.filterHeight,l.filterWidth],c):p=[[0,0],[0,0]];var f=c[0]===1&&c[1]===1,d=Ee(kq([l.inHeight,l.inWidth],c,p),2),m=d[0],h=d[1],g=f?n:"valid",v=f?s:aC(s,c,m),x=t==="avg"?function(){return OI(v,e,a,g)}:function(){return tC(v,e,a,g)},y=x(),b=f?y:MI(y,c,h);return u?ue(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function kq(r,e,t){var n=t.map(function(c){return c[0]}),o=t.map(function(c){return c[1]}),a=r.concat(n,o),i=e.map(function(c,p){return(c-a[p]%c)%c}),s=o.map(function(c,p){return c+i[p]}),u=e.map(function(c,p){return[n[p],s[p]]}),l=e.map(function(c,p){return[0,i[p]]});return[u,l]}function _q(r,e){var t=r.map(function(i,s){return i+(i-1)*(e[s]-1)}),n=t.map(function(i){return i-1}),o=n.map(function(i){return Math.floor(i/2)}),a=n.map(function(i,s){return i-o[s]});return n.map(function(i,s){return[o[s],a[s]]})}var Sq=U({pool_:wq});function Iq(r,e){var t,n=F(r,"base","pow"),o=F(e,"exp","pow");t=Ee(Yt(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return G.runKernel(FS,a)}var zc=U({pow_:Iq});function Cq(r,e){var t=F(r,"x","prelu"),n=F(e,"alpha","prelu"),o={x:t,alpha:n};return G.runKernel(DS,o)}var sC=U({prelu_:Cq});function Nq(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=F(r,"x","prod");n.dtype==="bool"&&(n=tr(n,"int32"));var o={x:n},a={axis:e,keepDims:t};return G.runKernel(RS,o,a)}var Eq=U({prod_:Nq});function Tq(r,e,t){var n=sr(r),o=null;if(t==null||t==="float32")o=new Float32Array(n);else if(t==="int32")o=new Int32Array(n);else if(t==="bool")o=new Uint8Array(n);else throw new Error("Unknown data type "+t);for(var a=0;a<n;a++)o[a]=e();return G.makeTensor(o,r,t)}var Aq=U({rand_:Tq}),hs=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function gs(r){var e={exports:{}};return r(e,e.exports),e.exports}var Fq=gs(function(r){(function(e,t,n){function o(u){var l=this,c=s();l.next=function(){var p=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=p-(l.c=p|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function a(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function i(u,l){var c=new o(u),p=l&&l.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&a(p,c),f.state=function(){return a(c,{})}),f}function s(){var u=4022871197,l=function(c){c=String(c);for(var p=0;p<c.length;p++){u+=c.charCodeAt(p);var f=.02519603282416938*u;u=f>>>0,f-=u,f*=u,u=f>>>0,f-=u,u+=f*4294967296}return(u>>>0)*23283064365386963e-26};return l}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.alea=i})(hs,r,!1)}),Dq=gs(function(r){(function(e,t,n){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var p=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^p^p>>>8},s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function i(s,u){var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(typeof c=="object"&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xor128=i})(hs,r,!1)}),Rq=gs(function(r){(function(e,t,n){function o(s){var u=this,l="";u.next=function(){var p=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(p^p<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function i(s,u){var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(typeof c=="object"&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xorwow=i})(hs,r,!1)}),$q=gs(function(r){(function(e,t,n){function o(s){var u=this;u.next=function(){var c=u.x,p=u.i,f,d;return f=c[p],f^=f>>>7,d=f^f<<24,f=c[p+1&7],d^=f^f>>>10,f=c[p+3&7],d^=f^f>>>3,f=c[p+4&7],d^=f^f<<7,f=c[p+7&7],f=f^f<<13,d^=f^f<<9,c[p]=d,u.i=p+1&7,d};function l(c,p){var f,d=[];if(p===(p|0))d[0]=p;else for(p=""+p,f=0;f<p.length;++f)d[f&7]=d[f&7]<<15^p.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8&&(d[7]=-1),c.x=d,c.i=0,f=256;f>0;--f)c.next()}l(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function i(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(c.x&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xorshift7=i})(hs,r,!1)}),Pq=gs(function(r){(function(e,t,n){function o(s){var u=this;u.next=function(){var c=u.w,p=u.X,f=u.i,d,m;return u.w=c=c+1640531527|0,m=p[f+34&127],d=p[f=f+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,m=p[f]=m^d,u.i=f,m+(c^c>>>16)|0};function l(c,p){var f,d,m,h,g,v=[],x=128;for(p===(p|0)?(d=p,p=null):(p=p+"\0",d=0,x=Math.max(x,p.length)),m=0,h=-32;h<x;++h)p&&(d^=p.charCodeAt((h+32)%p.length)),h===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,h>=0&&(g=g+1640531527|0,f=v[h&127]^=d+g,m=f==0?m+1:0);for(m>=128&&(v[(p&&p.length||0)&127]=-1),m=127,h=4*128;h>0;--h)d=v[m+34&127],f=v[m=m+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,v[m]=d^f;c.w=g,c.X=v,c.i=m}l(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function i(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(c.X&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xor4096=i})(hs,r,!1)}),Oq=gs(function(r){(function(e,t,n){function o(s){var u=this,l="";u.next=function(){var p=u.b,f=u.c,d=u.d,m=u.a;return p=p<<25^p>>>7^f,f=f-d|0,d=d<<24^d>>>8^m,m=m-p|0,u.b=p=p<<20^p>>>12^f,u.c=f=f-d|0,u.d=d<<16^f>>>16^m,u.a=m-p|0},u.a=0,u.b=0,u.c=2654435769|0,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=s|0):l+=s;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function i(s,u){var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(typeof c=="object"&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.tychei=i})(hs,r,!1)}),vs=gs(function(r){(function(e,t,n){var o=256,a=6,i=52,s="random",u=n.pow(o,a),l=n.pow(2,i),c=l*2,p=o-1,f;function d(b,k,N){var E=[];k=k==!0?{entropy:!0}:k||{};var T=v(g(k.entropy?[b,y(t)]:b==null?x():b,3),E),R=new m(E),$=function(){for(var O=R.g(a),M=u,B=0;O<l;)O=(O+B)*o,M*=o,B=R.g(1);for(;O>=c;)O/=2,M/=2,B>>>=1;return(O+B)/M};return $.int32=function(){return R.g(4)|0},$.quick=function(){return R.g(4)/4294967296},$.double=$,v(y(R.S),t),(k.pass||N||function(O,M,B,L){return L&&(L.S&&h(L,R),O.state=function(){return h(R,{})}),B?(n[s]=O,M):O})($,T,"global"in k?k.global:this==n,k.state)}function m(b){var k,N=b.length,E=this,T=0,R=E.i=E.j=0,$=E.S=[];for(N||(b=[N++]);T<o;)$[T]=T++;for(T=0;T<o;T++)$[T]=$[R=p&R+b[T%N]+(k=$[T])],$[R]=k;(E.g=function(O){for(var M,B=0,L=E.i,H=E.j,W=E.S;O--;)M=W[L=p&L+1],B=B*o+W[p&(W[L]=W[H=p&H+M])+(W[H]=M)];return E.i=L,E.j=H,B})(o)}function h(b,k){return k.i=b.i,k.j=b.j,k.S=b.S.slice(),k}function g(b,k){var N=[],E=typeof b,T;if(k&&E=="object")for(T in b)try{N.push(g(b[T],k-1))}catch(R){}return N.length?N:E=="string"?b:b+"\0"}function v(b,k){for(var N=b+"",E,T=0;T<N.length;)k[p&T]=p&(E^=k[p&T]*19)+N.charCodeAt(T++);return y(k)}function x(){try{var b;return f&&(b=f.randomBytes)?b=b(o):(b=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(b)),y(b)}catch(E){var k=e.navigator,N=k&&k.plugins;return[+new Date,e,N,e.screen,y(t)]}}function y(b){return String.fromCharCode.apply(0,b)}if(v(n.random(),t),r.exports){r.exports=d;try{f=_W.default}catch(b){}}else n["seed"+s]=d})(typeof self!="undefined"?self:hs,[],Math)});vs.alea=Fq;vs.xor128=Dq;vs.xorwow=Rq;vs.xorshift7=$q;vs.xor4096=Pq;vs.tychei=Oq;var Mx=vs;var Bx=function(){function r(e,t,n,o,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);var i=a||Math.random();this.random=Mx.alea(i.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,o=!1;!o;){var a=void 0,i=void 0,s=void 0;do a=2*this.random()-1,i=2*this.random()-1,s=a*a+i*i;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*i*u,(!this.truncated||this.isValidTruncated(t))&&(o=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)},r.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},r.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},r}(),Mq=function(){function r(e,t,n,o){this.alpha=e,this.beta=1/t,this.dtype=n;var a=o||Math.random();this.randu=Mx.alea(a.toString()),this.randn=new Bx(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var e,t,n,o,a,i;;){do o=this.randn.nextValue(),i=1+this.c*o;while(i<=0);if(i*=i*i,e=o*o,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},r.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},r}(),Bq=function(){function r(e,t,n,o){var a=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=n,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=Mx.alea(o)}return r.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r}();function Lq(r,e,t,n,o){if(t===void 0&&(t=1),n===void 0&&(n="float32"),t==null&&(t=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var a=new Mq(e,t,n,o),i=To(r,n),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}var Vq=U({randomGamma_:Lq});function Wq(r,e,t,n,o){if(e===void 0&&(e=0),t===void 0&&(t=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var a=new Bx(e,t,n,!1,o),i=To(r,n),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}var zq=U({randomNormal_:Wq});function Uq(r,e,t,n,o){e===void 0&&(e=0),t===void 0&&(t=1),n===void 0&&(n="float32");for(var a=To(r,n),i=new Bq(e,t,null,o),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}var iC=U({randomUniform_:Uq});function Uc(r,e,t,n){if(t===void 0&&(t=1),n===void 0&&(n="float32"),t===0)throw new Error("Cannot have a step of zero");var o={start:r,stop:e,step:t,dtype:n};return G.runKernel($S,{},o)}function Gq(r){var e=F(r,"input","real"),t={input:e};return G.runKernel(PS,t)}var fd=U({real_:Gq});function jq(r){var e=F(r,"x","reciprocal"),t={x:e};return G.runKernel(OS,t)}var Hq=U({reciprocal_:jq});function qq(r){var e=F(r,"x","relu"),t={x:e};return G.runKernel(MS,t)}var dd=U({relu_:qq});function Kq(r){var e=F(r,"x","relu6"),t={x:e};return G.runKernel(WS,t)}var uC=U({relu6_:Kq});function Xq(r,e){var t=F(r,"x","reverse"),n={x:t},o={dims:e};return G.runKernel(zS,n,o)}var xs=U({reverse_:Xq});function Yq(r){var e=F(r,"x","reverse");return P(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),xs(e,0)}var Zq=U({reverse1d_:Yq});function Jq(r,e){var t=F(r,"x","reverse");return P(t.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."}),xs(t,e)}var Qq=U({reverse2d_:Jq});function eK(r,e){var t=F(r,"x","reverse");return P(t.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."}),xs(t,e)}var tK=U({reverse3d_:eK});function rK(r,e){var t=F(r,"x","reverse");return P(t.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."}),xs(t,e)}var nK=U({reverse4d_:rK});function oK(r){var e=F(r,"x","round"),t={x:e};return G.runKernel(US,t)}var lC=U({round_:oK});function aK(r){var e=F(r,"x","rsqrt","float32"),t={x:e};return G.runKernel(GS,t)}var sK=U({rsqrt_:aK});function xt(r,e){if((Er(r)&&e!=="string"||Array.isArray(r))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Er(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var t=[],n=[];return ga(r,t,n,e)}function iK(r){var e=F(r,"x","selu"),t={x:e};return G.runKernel(qS,t)}var uK=U({selu_:iK});function lK(r,e,t,n,o,a,i){a===void 0&&(a=[1,1]),i===void 0&&(i="NHWC");var s=F(r,"x","separableConv2d"),u=F(e,"depthwiseFilter","separableConv2d"),l=F(t,"pointwiseFilter","separableConv2d"),c=s,p=!1;if(s.rank===3&&(p=!0,c=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");P(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got "+("rank "+c.rank+".")}),P(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+("got rank "+u.rank+".")}),P(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+("got rank "+u.rank+".")}),P(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter "+(" must be 1, but got "+l.shape[0]+".")}),P(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise "+("filter must be 1, but got "+l.shape[1]+".")});var f=u.shape[2],d=u.shape[3];P(l.shape[2]===f*d,function(){return"Error in separableConv2d: the third dimension of pointwise filter "+("must be "+f*d+", ")+("but got "+l.shape[2]+".")});var m=Dx(c,u,n,o,i,a),h=1,g=sd(m,l,h,"valid",i);return p?ue(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var cK=U({separableConv2d_:lK});function pK(r,e){return De(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,u,p;return Re(this,function(f){switch(f.label){case 0:return t=F(r,"x","setdiff1d"),n=F(e,"y","setdiff1d"),P(t.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+n.dtype+")."}),P(t.rank===1,function(){return"x should be 1D tensor, but got x ("+t.shape+")."}),P(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,t.data()];case 1:return o=f.sent(),[4,n.data()];case 2:for(a=f.sent(),i=new Set(a),s=0,u=0;u<o.length;u++)i.has(o[u])||s++;for(l=new Zf([s],t.dtype),c=new Zf([s],"int32"),u=0,p=0;u<o.length;u++)i.has(o[u])||(l.values[p]=o[u],c.values[p]=u,p++);return[2,[l.toTensor(),c.toTensor()]]}})})}var fK=pK;function dK(r){var e=F(r,"x","sign"),t={x:e};return G.runKernel(ZS,t)}var mK=U({sign_:dK});function hK(r){var e=F(r,"x","sin","float32"),t={x:e};return G.runKernel(XS,t)}var gK=U({sin_:hK});function vK(r){var e=F(r,"x","sinh"),t={x:e};return G.runKernel(YS,t)}var xK=U({sinh_:vK});function yK(r,e,t){var n=F(r,"x","slice1d");return P(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),Ht(n,[e],[t])}var bK=U({slice1d_:yK});function wK(r,e,t){var n=F(r,"x","slice2d");return P(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),Ht(n,e,t)}var kK=U({slice2d_:wK});function _K(r,e,t){var n=F(r,"x","slice3d");return P(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),Ht(n,e,t)}var SK=U({slice3d_:_K});function IK(r,e,t){var n=F(r,"x","slice4d");return P(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),Ht(n,e,t)}var CK=U({slice4d_:IK});function NK(r,e){e===void 0&&(e=-1);var t=F(r,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+("Logits was rank "+t.rank+" and dim was "+e));var n={logits:t},o={dim:e};return G.runKernel(o2,n,o)}var EK=U({softmax_:NK});function TK(r){P(r.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 "+("but got "+r.dtype+".")});var e={input:r};return G.runKernel(L_,e)}var Lx=U({fft_:TK});function AK(r){P(r.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 "+("but got "+r.dtype+".")});var e={input:r};return G.runKernel(X_,e)}var md=U({ifft_:AK});function FK(r){var e=r.shape[r.shape.length-1],t=r.size/e,n;if(e<=2){var o=ue(r,[t,e]);n=md(o)}else{var a=[t,2*(e-1)],i=ue(fd(r),[t,e]),s=ue(Rx(r),[t,e]),u=xs(Ht(i,[0,1],[t,e-2]),1),l=be(xs(Ht(s,[0,1],[t,e-2]),1),xt(-1)),c=en([i,u],1),p=en([s,l],1),o=ue(as(c,p),[a[0],a[1]]);n=md(o)}if(n=fd(n),r.rank===3&&r.shape[0]!==0){var f=n,d=r.shape[0];n=ue(n,[d,n.shape[0]/d,n.shape[1]]),f.dispose()}return n}var cC=U({irfft_:FK});function DK(r,e,t){t===void 0&&(t=0);var n=F(r,"x","split"),o={x:n},a={numOrSizeSplits:e,axis:t};return G.runKernel(n2,o,a)}var Gc=U({split_:DK});function RK(r,e){P(r.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+r.dtype});var t=r.shape[r.shape.length-1],n=r.size/t,o;if(e!=null&&e<t){var a=r.shape.map(function(v){return 0}),i=r.shape.map(function(v){return v});i[r.shape.length-1]=e,o=Ht(r,a,i),t=e}else if(e!=null&&e>t){var s=r.shape.map(function(v){return v});s[r.shape.length-1]=e-t,o=en([r,ju(s)],r.shape.length-1),t=e}else o=r;var u=mn(o),l=ue(as(o,u),[n,t]),c=Lx(l),p=Math.floor(t/2)+1,f=fd(c),d=Rx(c),m=Gc(f,[p,t-p],f.shape.length-1),h=Gc(d,[p,t-p],d.shape.length-1),g=o.shape.slice();return g[o.shape.length-1]=p,ue(as(m[0],h[0]),g)}var Vx=U({rfft_:RK});function $K(r){var e=F(r,"x","sqrt","float32"),t={x:e};return G.runKernel(e2,t)}var Fo=U({sqrt_:$K});function PK(r,e){var t,n=F(r,"a","squaredDifference"),o=F(e,"b","squaredDifference");t=Ee(Yt(n,o),2),n=t[0],o=t[1],kr(n.shape,o.shape);var a={a:n,b:o},i={};return G.runKernel(c2,a,i)}var pC=U({squaredDifference_:PK});function OK(r,e){var t=F(r,"x","squeeze");return ue(t,Rk(t.shape,e).newShape)}var Wx=U({squeeze_:OK});function MK(r,e){e===void 0&&(e=0);var t=$c(r,"tensors","stack","string_or_numeric");P(t.length>=1,function(){return"Pass at least one tensor to tf.stack"}),t.length>0&&P(e<=t[0].rank,function(){return"Axis must be <= rank of the tensor"});var n=t,o={axis:e};return G.runKernel(TS,n,o)}var jc=U({stack_:MK});function BK(r,e){e===void 0&&(e=0);var t=F(r,"x","step"),n={x:t},o={alpha:e};return G.runKernel(I2,n,o)}var fC=U({step_:BK});function LK(r,e,t,n,o,a,i,s,u){o===void 0&&(o=0),a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),u===void 0&&(u=0);var l=F(r,"x","stridedSlice","string_or_numeric"),c={x:l},p={begin:e,end:t,strides:n,beginMask:o,endMask:a,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:u};return G.runKernel(p2,c,p)}var VK=U({stridedSlice_:LK});function WK(r){var e=F(r,"x","tan","float32"),t={x:e};return G.runKernel(g2,t)}var zK=U({tan_:WK});function Gn(r,e){Qa(r);var t=ro(r,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var n=null;return ga(r,n,t,e)}function Hc(r,e,t){if(Qa(r),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=ro(r,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ga(r,e,n,t)}function UK(r,e,t){if(Qa(r),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=ro(r,t);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ga(r,e,n,t)}function GK(r,e,t){if(Qa(r),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=ro(r,t);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ga(r,e,n,t)}function jK(r,e,t){if(Qa(r),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=ro(r,t);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||n,ga(r,e,n,t)}function HK(r,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var n=F(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=n.shape[n.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got "+e);if(e>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") "+("but got "+e));var a={x:n},i={k:e,sorted:t},s=Ee(G.runKernel(x2,a,i),2),u=s[0],l=s[1];return{values:u,indices:l}}var qK=U({topk_:HK});function KK(r,e,t,n,o){if(e===void 0&&(e=0),t===void 0&&(t=1),n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new Bx(e,t,n,!0,o),i=To(r,n),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}var XK=U({truncatedNormal_:KK});function YK(r,e){e===void 0&&(e=0);var t=F(r,"x","unique","string_or_numeric");P(t.rank>0,function(){return"The input tensor must be at least 1D"});var n={x:t},o={axis:e},a=Ee(G.runKernel(w2,n,o),2),i=a[0],s=a[1];return{values:i,indices:s}}var ZK=U({unique_:YK});function JK(r,e,t){var n=F(r,"x","unsortedSegmentSum"),o=F(e,"segmentIds","unsortedSegmentSum","int32");P(zr(t),function(){return"numSegments must be of dtype int"});var a={x:n,segmentIds:o},i={numSegments:t};return G.runKernel(_2,a,i)}var QK=U({unsortedSegmentSum_:JK});function e5(r,e){e===void 0&&(e=0);var t=F(r,"x","unstack","string_or_numeric");P(e>=-t.shape.length&&e<t.shape.length,function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"});var n={value:t},o={axis:e};return G.runKernel(k2,n,o)}var zx=U({unstack_:e5});function t5(r,e,t,n){return e===void 0&&(e=!0),G.makeVariable(r,e,t,n)}function dC(r,e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(n);for(var o=To(r,"int32"),a=To([t.length,r.length],"int32"),n=0;n<t.length;n++){var i=o.indexToLoc(t[n]),s=n*r.length;a.values.set(i,s)}return a.toTensor()}function r5(r){return De(this,void 0,void 0,function(){var e,t,n;return Re(this,function(o){switch(o.label){case 0:return e=F(r,"condition","whereAsync","bool"),[4,e.data()];case 1:return t=o.sent(),n=dC(e.shape,t),r!==e&&e.dispose(),[2,n]}})})}var mC=r5;function n5(r,e,t){return De(this,void 0,void 0,function(){var n,o,a,i,s,u,l,c,p,f,d,m,h;return Re(this,function(g){switch(g.label){case 0:for(n=F(r,"tensor","boolMask"),o=F(e,"mask","boolMask","bool"),a=t==null?0:t,i=o.rank,s=n.shape,P(i>0,function(){return"mask cannot be scalar"}),$r(s.slice(a,a+i),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+i;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+i)),p=ue(n,c),f=ue(o,[-1]),[4,mC(f)];case 1:return d=g.sent(),m=Wx(d,[1]),h=jI(p,m,a),r!==n&&n.dispose(),e!==o&&o.dispose(),m.dispose(),p.dispose(),f.dispose(),d.dispose(),[2,h]}})})}var o5=n5;function a5(r,e,t,n){e===void 0&&(e="euclidean"),t===void 0&&(t=null),n===void 0&&(n=!1),r=F(r,"x","norm");var o=hC(r,e,t),a=o.shape;if(n){var i=Ic(t,r.shape);a=Vc(o.shape,i)}return ue(o,a)}function hC(r,e,t){if(t===void 0&&(t=null),r.rank===0)return dn(r);if(r.rank!==1&&t===null)return hC(ue(r,[-1]),e,t);if(r.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Ot(dn(r),t);if(e===1/0)return Gu(dn(r),t);if(e===-1/0)return Ox(dn(r),t);if(e==="euclidean"||e===2)return Fo(Ot(zc(dn(r),xt(2,"int32")),t));throw new Error("Error in norm: invalid ord value: "+e)}if(Array.isArray(t)&&t.length===2){if(e===1)return Gu(Ot(dn(r),t[0]),t[1]-1);if(e===1/0)return Gu(Ot(dn(r),t[1]),t[0]);if(e===-1/0)return Ox(Ot(dn(r),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Fo(Ot(Un(r),t));throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+t)}var Ux=U({norm_:a5});function s5(r,e,t,n,o){o===void 0&&(o=!0);var a=F(r,"v","movingAverage"),i=F(e,"x","movingAverage"),s=F(t,"decay","movingAverage");z2(a,i),P(No(a.shape,i.shape),function(){return"Shape mismatch in v and x"});var u=xt(1),l=Je(u,s),c=be(Je(i,a),l);if(o){P(n!=null,function(){return"When using zeroDebias: true, step is required."});var p=F(n,"step","movingAverage");c=Pt(c,Je(u,zc(s,p)))}return ze(a,c)}var i5=U({movingAverage_:s5});function u5(r,e,t){var n=F(r,"indices","scatterND","int32"),o=F(e,"updates","scatterND");Sx(o,n,t);var a={indices:n,updates:o},i={shape:t};return G.runKernel(jS,a,i)}var l5=U({scatterND_:u5});function c5(r,e,t,n){if(r.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+(" but the dtype was "+r.dtype+"."));if(r.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+(" but got shape "+r.shape+"."));var o=r.rank>0?r.shape[0]:1,a=r.rank>1?r.shape[1]:1;if(t.length!==a)throw new Error("outputShape has incorrect number of elements:,"+(" "+t.length+", should be: "+a+"."));var i=e.size;if(!(e.rank===0||e.rank===1&&i===o))throw new Error("sparseValues has incorrect shape "+(e.shape+", should be [] or ["+o+"]"));if(e.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function p5(r,e,t,n){n===void 0&&(n=0);var o=F(r,"sparseIndices","sparseToDense","int32"),a=F(e,"sparseValues","sparseToDense"),i=F(n,"defaultValue","sparseToDense",a.dtype);c5(o,a,t,i);var s={sparseIndices:o,sparseValues:a,defaultValue:i},u={outputShape:t};return G.runKernel(l2,s,u)}var f5=U({sparseToDense_:p5});function d5(r,e){var t=F(e,"indices","gatherND","int32"),n=F(r,"x","gatherND","string_or_numeric"),o={params:n,indices:t};return G.runKernel(H_,o)}var m5=U({gatherND_:d5});function h5(r,e){if(e==null)return r.shape.slice();if(No(r.shape,e))return e;if(r.shape.length===e.length){for(var t=[],n=0;n<r.shape.length;n++)e[n]==null&&r.shape[n]!=null?t.push(r.shape[n]):t.push(e[n]);return t}return e}function g5(r,e,t,n){var o=F(r,"x","dropout");if(P(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be "+("scaled, but got a "+o.dtype+" tensor instead.")}),P(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return r instanceof ir?o.clone():o;var a=h5(o,t),i=1-e,s=Pt(GI(ze(iC(a,0,1,"float32",n),i)),i);return be(o,s)}var v5=U({dropout_:g5});function gC(r){return Math.floor(Math.pow(2,Math.ceil(Math.log(r)/Math.log(2))))}function Gx(r,e,t){for(var n=1-r%2,o=new Float32Array(r),a=0;a<r;++a){var i=2*Math.PI*a/(r+n-1);o[a]=e-t*Math.cos(i)}return Gn(o,"float32")}function x5(r,e,t){return t===void 0&&(t=1),De(this,void 0,void 0,function(){var n,o,a,i,s,u,l,c,p,f,d,m,h,g,g;return Re(this,function(v){switch(v.label){case 0:return n=F(r,"predictions","inTopK"),o=F(e,"targets","inTopK"),P(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+("but got "+n.rank)}),P(n.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+(n.rank+" and targets rank "+o.rank)}),$r(n.shape.slice(0,n.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=n.shape[n.shape.length-1],P(t>0&&t<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+("dimension ("+a+"), but got "+t)}),[4,n.data()];case 1:return i=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=Ee([i.length/a,a],2),l=u[0],c=u[1],p=$k("bool",l),f=0;f<l;f++){for(d=f*c,m=i.subarray(d,d+c),h=[],g=0;g<m.length;g++)h.push({value:m[g],index:g});for(h.sort(function(x,y){return y.value-x.value}),p[f]=0,g=0;g<t;g++)if(h[g].index===s[f]){p[f]=1;break}}return r!==n&&n.dispose(),e!==o&&o.dispose(),[2,Bu(p,o.shape,"bool")]}})})}var y5=x5;function b5(r,e,t,n,o,a,i){a===void 0&&(a="NHWC");var s=r;r.rank===3&&(s=ue(r,[1,r.shape[0],r.shape[1],r.shape[2]]));var u=e;u.rank===3&&(u=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]])),P(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+(s.shape+".")}),P(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+(u.shape+".")}),P(t.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+(t+".")});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];P(l===t[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must "+("match input depth in filter ("+t[2]+".")}),P(c===t[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must "+("match output depth for filter ("+t[3]+").")}),i!=null&&P(zr(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+o+".")});var p={x:s,dy:u},f={strides:n,pad:o,dataFormat:a,dimRoundingMode:i,filterShape:t};return G.runKernel(g_,p,f)}var w5=U({conv2DBackpropFilter_:b5});function hd(r,e,t){if(t==null||t==="linear")return r;if(t==="relu")return be(r,fC(e));throw new Error("Cannot compute gradient for fused activation "+t+".")}function gd(r,e){var t=e,n=VI(r.shape,e.shape);return n.length>0&&(t=Ot(t,n)),ue(t,r.shape)}function vd(r,e,t,n){if(e==="linear")return r;if(e==="relu")return dd(r);if(e==="elu")return zI(r);if(e==="relu6")return uC(r);if(e==="prelu")return sC(r,t);if(e==="leakyrelu")return qI(r,n);if(e==="sigmoid")return zu(r);throw new Error("Unknown fused activation "+e+".")}var xd=function(r,e){var t=r>0;return!t||e==="linear"};function k5(r){var e,t=r.x,n=r.filter,o=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,u=r.dilations,l=u===void 0?[1,1]:u,c=r.dimRoundingMode,p=r.bias,f=r.activation,d=f===void 0?"linear":f,m=r.preluActivationWeights,h=r.leakyreluAlpha;if(d=d||"linear",xd(G.state.gradientDepth,d)===!1){var g=sd(t,n,o,a,s,l,c);return p!=null&&(g=ze(g,p)),vd(g,d,m,h)}var v=F(t,"x","conv2d","float32"),x=F(n,"filter","conv2d","float32"),y=v,b=!1;v.rank===3&&(b=!0,y=ue(v,[1,v.shape[0],v.shape[1],v.shape[2]])),P(y.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+(y.rank+".")}),P(x.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+(x.rank+".")}),c!=null&&P(zr(a),function(){return"Error in fused conv2d: pad must be an integer when using, "+("dimRoundingMode "+c+" but got pad "+a+".")}),P(y.shape[3]===x.shape[2],function(){return"Error in conv2d: depth of input ("+y.shape[3]+") must match "+("input depth for filter "+x.shape[2]+".")}),P(Ao(o,l),function(){return"Error in conv2D: Either strides or dilations must be 1. "+("Got strides "+o+" and dilations '"+l+"'")}),P(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var k=Oc(y.shape,x.shape,o,l,a,c),N;p!=null&&(N=F(p,"bias","fused conv2d"),e=Ee(Yt(N,v),1),N=e[0],kr(k.outShape,N.shape));var E;m!=null&&(E=F(m,"prelu weights","fused conv2d"));var T=function(B,L){var H=Ee(L,4),W=H[0],K=H[1],J=H[2],Q=H[3],ee=hd(B,J,d);P(Mc(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+("are not yet supported in gradients. Got dilations '"+l+"'")});var Y=LI(K.shape,ee,W,o,a),ne=w5(K,ee,W.shape,o,a),te=[Y,ne];if(Q!=null){var ce=gd(Q,ee);te.push(ce)}return te},R={x:y,filter:x,bias:N,preluActivationWeights:E},$={strides:o,pad:a,dataFormat:s,dilations:l,dimRoundingMode:c,activation:d,leakyreluAlpha:h};if(p==null){var O=no(function(B,L,H){var W=G.runKernel(qv,R,$);return H([L,B,W]),b&&(W=ue(W,[W.shape[1],W.shape[2],W.shape[3]])),{value:W,gradFunc:T}});return O(y,x)}else{var M=no(function(B,L,H,W){var K=G.runKernel(qv,R,$);return W([L,B,K,H]),b&&(K=ue(K,[K.shape[1],K.shape[2],K.shape[3]])),{value:K,gradFunc:T}});return M(y,x,N)}}var _5=U({fusedConv2d_:k5});function S5(r,e,t,n,o,a,i){a===void 0&&(a=[1,1]);var s=r;r.rank===3&&(s=ue(r,[1,r.shape[0],r.shape[1],r.shape[2]]));var u=e;u.rank===3&&(u=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var l={x:s,dy:u},c={strides:n,pad:o,dimRoundingMode:i,dilations:a,filterShape:t};return G.runKernel(N_,l,c)}var I5=U({depthwiseConv2dNativeBackpropFilter_:S5});function C5(r,e,t,n,o,a,i){a===void 0&&(a=[1,1]);var s=e,u=!1;e.rank===3&&(u=!0,s=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var l={dy:s,filter:t},c={strides:n,pad:o,dimRoundingMode:i,dilations:a,inputShape:r},p=G.runKernel(E_,l,c);return u?ue(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var N5=U({depthwiseConv2dNativeBackpropInput_:C5});function E5(r){var e,t=r.x,n=r.filter,o=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,u=r.dilations,l=u===void 0?[1,1]:u,c=r.dimRoundingMode,p=r.bias,f=r.activation,d=f===void 0?"linear":f,m=r.preluActivationWeights,h=r.leakyreluAlpha;if(xd(G.state.gradientDepth,d)===!1){var g=Dx(t,n,o,a,s,l,c);return p!=null&&(g=ze(g,p)),vd(g,d,m,h)}var v=F(t,"x","depthwiseConv2d","float32"),x=F(n,"filter","depthwiseConv2d","float32"),y=v,b=!1;v.rank===3&&(b=!0,y=ue(v,[1,v.shape[0],v.shape[1],v.shape[2]])),P(y.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+("rank "+y.rank+".")}),P(x.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+("but got rank "+x.rank+".")}),P(y.shape[3]===x.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels "+("("+y.shape[3]+") must match the inChannels dimension in ")+("filter "+x.shape[2]+".")}),l==null&&(l=[1,1]),P(Ao(o,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+("be 1. Got strides "+o+" and dilations '"+l+"'")}),c!=null&&P(zr(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+("using dimRoundingMode "+c+" but got pad "+a+".")});var k=Oc(y.shape,x.shape,o,l,a,c,!0),N;p!=null&&(N=F(p,"bias","fused conv2d"),e=Ee(Yt(N,v),1),N=e[0],kr(k.outShape,N.shape));var E;m!=null&&(E=F(m,"prelu weights","fused depthwiseConv2d"));var T=function(B,L){P(Mc(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+("'"+l+"'")});var H=Ee(L,4),W=H[0],K=H[1],J=H[2],Q=H[3],ee=hd(B,J,d),Y=N5(K.shape,ee,W,o,a,l,c),ne=I5(K,ee,W.shape,o,a,l,c);if(Q!=null){var te=gd(N,ee);return[Y,ne,te]}return[Y,ne]},R={x:y,filter:x,bias:N,preluActivationWeights:E},$={strides:o,pad:a,dataFormat:s,dilations:l,dimRoundingMode:c,activation:d,leakyreluAlpha:h};if(p==null){var O=no(function(B,L,H){var W=G.runKernel(Kv,R,$);return H([L,B,W]),b&&(W=ue(W,[W.shape[1],W.shape[2],W.shape[3]])),{value:W,gradFunc:T}});return O(y,x)}else{var M=no(function(B,L,H,W){var K=G.runKernel(Kv,R,$);return W([L,B,K,H]),b&&(K=ue(K,[K.shape[1],K.shape[2],K.shape[3]])),{value:K,gradFunc:T}});return M(y,x,N)}}var T5=U({fusedDepthwiseConv2d_:E5});function A5(r){var e,t,n=r.a,o=r.b,a=r.transposeA,i=a===void 0?!1:a,s=r.transposeB,u=s===void 0?!1:s,l=r.bias,c=r.activation,p=c===void 0?"linear":c,f=r.preluActivationWeights,d=r.leakyreluAlpha;if(xd(G.state.gradientDepth,p)===!1){var m=vt(n,o,i,u);return l!=null&&(m=ze(m,l)),vd(m,p,f,d)}var h=F(n,"a","fused matMul"),g=F(o,"b","fused matMul");e=Ee(Yt(h,g),2),h=e[0],g=e[1];var v=i?h.shape[h.rank-2]:h.shape[h.rank-1],x=u?g.shape[g.rank-1]:g.shape[g.rank-2],y=i?h.shape[h.rank-1]:h.shape[h.rank-2],b=u?g.shape[g.rank-2]:g.shape[g.rank-1],k=h.shape.slice(0,-2),N=g.shape.slice(0,-2),E=sr(k),T=sr(N);P(h.rank>=2&&g.rank>=2&&h.rank===g.rank,function(){return"Error in fused matMul: inputs must have the same rank of at "+("least 2, got ranks "+h.rank+" and "+g.rank+".")}),P(No(k,N),function(){return"Error in fused matMul: outer dimensions ("+k+") and ("+(N+") of Tensors with shapes "+h.shape+" and ")+(g.shape+" must match.")}),P(v===x,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+(x+") of Tensors with shapes "+h.shape+" and ")+(g.shape+" and transposeA="+i)+(" and transposeB="+u+" must match.")});var R=h.shape.slice(0,-2).concat([y,b]),$=i?ue(h,[E,v,y]):ue(h,[E,y,v]),O=u?ue(g,[T,b,x]):ue(g,[T,x,b]),M;l!=null&&(M=F(l,"bias","fused matMul"),t=Ee(Yt(M,h),1),M=t[0],kr(R,M.shape));var B;f!=null&&(B=F(f,"prelu weights","fused matMul"));var L=function(Q,ee){var Y=Ee(ee,4),ne=Y[0],te=Y[1],ce=Y[2],pe=Y[3],se=hd(ue(Q,ce.shape),ce,p),fe,ye;if(!i&&!u?(fe=vt(se,te,!1,!0),ye=vt(ne,se,!0,!1)):!i&&u?(fe=vt(se,te,!1,!1),ye=vt(se,ne,!0,!1)):i&&!u?(fe=vt(te,se,!1,!0),ye=vt(ne,se,!1,!1)):(fe=vt(te,se,!0,!0),ye=vt(se,ne,!0,!0)),l!=null){var _e=gd(pe,se);return[fe,ye,_e]}else return[fe,ye]},H={a:$,b:O,bias:M,preluActivationWeights:B},W={transposeA:i,transposeB:u,activation:p,leakyreluAlpha:d};if(l==null){var K=no(function(Q,ee,Y){var ne=G.runKernel(Hv,H,W);return Y([Q,ee,ne]),{value:ue(ne,R),gradFunc:L}});return K($,O)}else{var J=no(function(Q,ee,Y,ne){var te=G.runKernel(Hv,H,W);return ne([Q,ee,te,Y]),{value:ue(te,R),gradFunc:L}});return J($,O,M)}}var F5=U({fusedMatMul_:A5});var D5={__proto__:null,conv2d:_5,depthwiseConv2d:T5,matMul:F5};function R5(r){return Gx(r,.54,.46)}var $5=U({hammingWindow_:R5});function P5(r){return Gx(r,.5,.5)}var vC=U({hannWindow_:P5});function O5(r,e,t,n,o){n===void 0&&(n=!1),o===void 0&&(o=0);for(var a=0,i=[];a+e<=r.size;)i.push(Ht(r,a,e)),a+=t;if(n)for(;a<r.size;){var s=a+e-r.size,u=en([Ht(r,a,e-s),id([s],o)]);i.push(u),a+=t}return i.length===0?Hc([],[0,e]):ue(en(i),[i.length,e])}var xC=U({frame_:O5});function M5(r,e,t,n,o){o===void 0&&(o=vC),n==null&&(n=gC(e));var a=xC(r,e,t),i=be(a,o(e));return Vx(i,n)}var B5=U({stft_:M5});function L5(r,e,t,n,o,a){o===void 0&&(o="bilinear"),a===void 0&&(a=0);var i=F(r,"image","cropAndResize"),s=F(e,"boxes","cropAndResize","float32"),u=F(t,"boxInd","cropAndResize","int32"),l=s.shape[0];P(i.rank===4,function(){return"Error in cropAndResize: image must be rank 4,"+("but got rank "+i.rank+".")}),P(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] "+("but had shape "+s.shape+".")}),P(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] "+("but had shape "+s.shape+".")}),P(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+("length "+n.length+".")}),P(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),P(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o});var c={image:i,boxes:s,boxInd:u},p={method:o,extrapolationValue:a,cropSize:n},f=G.runKernel(__,c,p);return f}var V5=U({cropAndResize_:L5});function W5(r){var e=F(r,"image","flipLeftRight","float32");P(e.rank===4,function(){return"Error in flipLeftRight: image must be rank 4,"+("but got rank "+e.rank+".")});var t={image:e},n=G.runKernel(W_,t,{});return n}var z5=U({flipLeftRight_:W5});function U5(r){var e=F(r,"image","grayscaleToRGB"),t=e.rank-1,n=e.shape[t];P(e.rank>=2,function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+("but got rank "+e.rank+".")}),P(n===1,function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+("should be size 1, but got size "+n+".")});var o=new Array(e.rank);return o.fill(1,0,t),o[t]=3,Bc(e,o)}var G5=U({grayscaleToRGB_:U5});function j5(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=.5);var o=F(r,"image","rotateWithOffset","float32");P(o.rank===4,function(){return"Error in rotateWithOffset: image must be rank 4,"+("but got rank "+o.rank+".")});var a={image:o},i={radians:e,fillValue:t,center:n},s=G.runKernel(C2,a,i);return s}var H5=U({rotateWithOffset_:j5});function Hu(r,e,t,n,o,a){n==null&&(n=.5),o==null&&(o=Number.NEGATIVE_INFINITY),a==null&&(a=0);var i=r.shape[0];return t=Math.min(t,i),P(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),P(r.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"}),P(r.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]}),P(e.rank===1,function(){return"scores must be a 1D tensor"}),P(e.shape[0]===i,function(){return"scores has incompatible shape with boxes. Expected "+i+", "+("but was "+e.shape[0])}),P(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:t,iouThreshold:n,scoreThreshold:o,softNmsSigma:a}}function q5(r,e,t,n,o){n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var a=F(r,"boxes","nonMaxSuppression","float32"),i=F(e,"scores","nonMaxSuppression","float32"),s=Hu(a,i,t,n,o);t=s.maxOutputSize,n=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:t,iouThreshold:n,scoreThreshold:o};return G.runKernel(SS,{boxes:a,scores:i},u)}var K5=U({nonMaxSuppression_:q5});function X5(r,e,t){var n=Y5(r,e,t),o=n<0?-(n+1):n;r.splice(o,0,e)}function Y5(r,e,t){return J5(r,e,t||Z5)}function Z5(r,e){return r>e?1:r<e?-1:0}function J5(r,e,t){for(var n=0,o=r.length,a=0,i=!1;n<o;){a=n+(o-n>>>1);var s=t(e,r[a]);s>0?n=a+1:(o=a,i=!s)}return i?n:-n-1}function yC(r,e,t,n,o){return jx(r,e,t,n,o,0)}function bC(r,e,t,n,o,a){return jx(r,e,t,n,o,0,!1,a,!0)}function wC(r,e,t,n,o,a){return jx(r,e,t,n,o,a,!0)}function jx(r,e,t,n,o,a,i,s,u){i===void 0&&(i=!1),s===void 0&&(s=!1),u===void 0&&(u=!1);for(var l=[],c=0;c<e.length;c++)e[c]>o&&l.push({score:e[c],boxIndex:c,suppressBeginIndex:0});l.sort(kC);for(var p=a>0?-.5/a:0,f=[],d=[];f.length<t&&l.length>0;){var m=l.pop(),h=m.score,g=m.boxIndex,v=m.suppressBeginIndex;if(h<o)break;for(var x=!1,y=f.length-1;y>=v;--y){var b=Q5(r,g,f[y]);if(b>=n){x=!0;break}if(m.score=m.score*e8(n,p,b),m.score<=o)break}m.suppressBeginIndex=f.length,x||(m.score===h?(f.push(g),d.push(m.score)):m.score>o&&X5(l,m,kC))}var k=f.length,N=t-k;s&&N>0&&(f.push.apply(f,gt(new Array(N).fill(0))),d.push.apply(d,gt(new Array(N).fill(0))));var E={selectedIndices:f};return i&&(E.selectedScores=d),u&&(E.validOutputs=k),E}function Q5(r,e,t){var n=r.subarray(e*4,e*4+4),o=r.subarray(t*4,t*4+4),a=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),p=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),d=(s-a)*(u-i),m=(p-l)*(f-c);if(d<=0||m<=0)return 0;var h=Math.max(a,l),g=Math.max(i,c),v=Math.min(s,p),x=Math.min(u,f),y=Math.max(v-h,0)*Math.max(x-g,0);return y/(d+m-y)}function e8(r,e,t){var n=Math.exp(e*t*t);return t<=r?n:0}function kC(r,e){return r.score-e.score||r.score===e.score&&e.boxIndex-r.boxIndex}function t8(r,e,t,n,o){return n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),De(this,void 0,void 0,function(){var a,i,s,u,l,c,p;return Re(this,function(f){switch(f.label){case 0:return a=F(r,"boxes","nonMaxSuppressionAsync"),i=F(e,"scores","nonMaxSuppressionAsync"),s=Hu(a,i,t,n,o),t=s.maxOutputSize,n=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([a.data(),i.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],p=yC(l,c,t,n,o).selectedIndices,a!==r&&a.dispose(),i!==e&&i.dispose(),[2,Gn(p,"int32")]}})})}var r8=t8;function n8(r,e,t,n,o,a){n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var i=F(r,"boxes","nonMaxSuppression"),s=F(e,"scores","nonMaxSuppression"),u=Hu(i,s,t,n,o,a);t=u.maxOutputSize,n=u.iouThreshold,o=u.scoreThreshold,a=u.softNmsSigma;var l={boxes:i,scores:s},c={maxOutputSize:t,iouThreshold:n,scoreThreshold:o,softNmsSigma:a},p=G.runKernel(CS,l,c);return{selectedIndices:p[0],selectedScores:p[1]}}var o8=U({nonMaxSuppressionWithScore_:n8});function a8(r,e,t,n,o,a){return n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),De(this,void 0,void 0,function(){var i,s,u,l,c,p,f,d,m;return Re(this,function(h){switch(h.label){case 0:return i=F(r,"boxes","nonMaxSuppressionAsync"),s=F(e,"scores","nonMaxSuppressionAsync"),u=Hu(i,s,t,n,o,a),t=u.maxOutputSize,n=u.iouThreshold,o=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([i.data(),s.data()])];case 1:return l=h.sent(),c=l[0],p=l[1],f=wC(c,p,t,n,o,a),d=f.selectedIndices,m=f.selectedScores,i!==r&&i.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:Gn(d,"int32"),selectedScores:Gn(m)}]}})})}var s8=a8;function i8(r,e,t,n,o,a){n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=!1);var i=F(r,"boxes","nonMaxSuppression"),s=F(e,"scores","nonMaxSuppression"),u=Hu(i,s,t,n,o,null),l=u.maxOutputSize,c=u.iouThreshold,p=u.scoreThreshold,f={boxes:i,scores:s},d={maxOutputSize:l,iouThreshold:c,scoreThreshold:p,padToMaxOutputSize:a},m=G.runKernel(IS,f,d);return{selectedIndices:m[0],validOutputs:m[1]}}var u8=U({nonMaxSuppressionPadded_:i8});function l8(r,e,t,n,o,a){return n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=!1),De(this,void 0,void 0,function(){var i,s,u,l,c,p,f,d,m,h,g,v;return Re(this,function(x){switch(x.label){case 0:return i=F(r,"boxes","nonMaxSuppressionAsync"),s=F(e,"scores","nonMaxSuppressionAsync"),u=Hu(i,s,t,n,o,null),l=u.maxOutputSize,c=u.iouThreshold,p=u.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return f=Ee.apply(void 0,[x.sent(),2]),d=f[0],m=f[1],h=bC(d,m,l,c,p,a),g=h.selectedIndices,v=h.validOutputs,i!==r&&i.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:Gn(g,"int32"),validOutputs:xt(v,"int32")}]}})})}var c8=l8;function p8(r,e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var o=F(r,"images","resizeBilinear");P(o.rank===3||o.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+("rank "+o.rank+".")}),P(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+(e+".")}),P(n===!1||t===!1,function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."});var a=o,i=!1;o.rank===3&&(i=!0,a=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Ee(e,0);var s={images:a},u={alignCorners:t,halfPixelCenters:n,size:e},l=G.runKernel(VS,s,u);return i?ue(l,[l.shape[1],l.shape[2],l.shape[3]]):l}var f8=U({resizeBilinear_:p8});function d8(r,e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var o=F(r,"images","resizeNearestNeighbor");P(o.rank===3||o.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+("rank "+o.rank+".")}),P(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+(e+".")}),P(o.dtype==="float32"||o.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"}),P(n===!1||t===!1,function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."});var a=o,i=!1;o.rank===3&&(i=!0,a=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Ee(e,0);var s={images:a},u={alignCorners:t,halfPixelCenters:n,size:e},l=G.runKernel(LS,s,u);return i?ue(l,[l.shape[1],l.shape[2],l.shape[3]]):l}var m8=U({resizeNearestNeighbor_:d8});function h8(r,e,t,n){var o;e===void 0&&(e="binary"),t===void 0&&(t=!1),n===void 0&&(n=.5);var a=F(r,"image","threshold"),i=.2989,s=.587,u=.114,l=a.shape[0]*a.shape[1],c=be(Gn([n]),255),p,f,d,m;if(P(a.rank===3,function(){return"Error in threshold: image must be rank 3,"+("but got rank "+a.rank+".")}),P(a.shape[2]===3||a.shape[2]===1,function(){return"Error in threshold: image color channel must be equal to 3 or 1"+("but got "+a.shape[2]+".")}),P(a.dtype==="int32"||a.dtype==="float32",function(){return"Error in dtype: image dtype must be int32 or float32,"+("but got dtype "+a.dtype+".")}),P(e==="otsu"||e==="binary",function(){return"Method must be binary or otsu, but was "+e}),a.shape[2]===3){o=Ee(Gc(a,[1,1,1],-1),3),p=o[0],f=o[1],d=o[2];var h=be(p,i),g=be(f,s),v=be(d,u);m=ze(ze(h,g),v)}else m=r;if(e==="otsu"){var x=BI(tr(lC(m),"int32"),Bu([]),256);c=g8(x,l)}var y=t?$x(m,c):ud(m,c),b=tr(be(y,255),"int32");return b}function g8(r,e){for(var t=Gn([-1]),n=Gn([0]),o=Gn([0]),a,i,s,u,l,c,p=0;p<r.size-1;p++){a=Ht(r,0,p+1),i=Ht(r,p+1),l=Pt(Ot(a),e),c=Pt(Ot(i),e);var f=Ot(be(a,Uc(0,a.size)));s=Pt(f,Ot(a));var d=id(i.shape,a.size),m=ze(Uc(0,i.size),d),h=be(i,m);u=Pt(Ot(h),Ot(i));var g=Je(s,u),v=Je(s,u),x=be(l,c);o=be(be(x,g),v);var y=ud(o,n);n=Uu(y,o,n),t=Uu(y,Gn([p]),t)}return t}var v8=U({threshold_:h8});function x8(r,e,t,n,o,a){t===void 0&&(t="nearest"),n===void 0&&(n="constant"),o===void 0&&(o=0);var i=F(r,"image","transform","float32"),s=F(e,"transforms","transform","float32");P(i.rank===4,function(){return"Error in transform: image must be rank 4,"+("but got rank "+i.rank+".")}),P(s.rank===2&&(s.shape[0]===i.shape[0]||s.shape[0]===1)&&s.shape[1]===8,function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"}),P(a==null||a.length===2,function(){return"Error in transform: outputShape must be [height, width] or null, "+("but got "+a+".")});var u={image:i,transforms:s},l={interpolation:t,fillMode:n,fillValue:o,outputShape:a};return G.runKernel(y2,u,l)}var y8=U({transform_:x8});function b8(r,e,t){P(e%1==0,function(){return"bandPart(): numLower must be an integer, got "+e+"."}),P(t%1==0,function(){return"bandPart(): numUpper must be an integer, got "+t+"."});var n=F(r,"a","bandPart");P(n.rank>=2,function(){return"bandPart(): Rank must be at least 2, got "+n.rank+"."});var o=n.shape,a=Ee(n.shape.slice(-2),2),i=a[0],s=a[1];if(!(e<=i))throw new Error("bandPart(): numLower ("+e+")"+(" must not be greater than the number of rows ("+i+")."));if(!(t<=s))throw new Error("bandPart(): numUpper ("+t+")"+(" must not be greater than the number of columns ("+s+")."));e<0&&(e=i),t<0&&(t=s);var u=ue(Uc(0,i,1,"int32"),[-1,1]),l=Uc(0,s,1,"int32"),c=Je(u,l),p=cd($x(c,xt(+e,"int32")),HI(c,xt(-t,"int32"))),f=ju([i,s],n.dtype);return ue(jc(zx(ue(n,[-1,i,s])).map(function(d){return Uu(p,d,f)})),o)}var w8=U({bandPart_:b8});function k8(r){var e;if(Array.isArray(r)){e=!1,P(r!=null&&r.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var t=r[0].shape[0],n=function(u){P(r[u].shape[0]===t,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+("("+r[u].shape[0]+" vs. "+t+")")})},o=1;o<r.length;++o)n(o)}else e=!0,r=Gc(r,r.shape[0],0).map(function(u){return Wx(u,[0])});P(r.length<=r[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds "+("number of dimensions ("+r[0].shape[0]+").")});for(var a=[],i=r,s=function(u){a.push(G.tidy(function(){var l=i[u];if(u>0)for(var c=0;c<u;++c){var p=be(Ot(be(a[c],l)),a[c]);l=Je(l,p)}return Pt(l,Ux(l,"euclidean"))}))},o=0;o<r.length;++o)s(o);return e?jc(a,0):a}var _8=U({gramSchmidt_:k8});function S8(r,e){if(e===void 0&&(e=!1),P(r.rank>=2,function(){return"qr() requires input tensor to have a rank >= 2, but got rank "+r.rank}),r.rank===2)return _C(r,e);var t=r.shape.slice(0,r.shape.length-2).reduce(function(u,l){return u*l}),n=zx(ue(r,[t,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),o=[],a=[];n.forEach(function(u){var l=Ee(_C(u,e),2),c=l[0],p=l[1];o.push(c),a.push(p)});var i=ue(jc(o,0),r.shape),s=ue(jc(a,0),r.shape);return[i,s]}function _C(r,e){return e===void 0&&(e=!1),G.tidy(function(){P(r.shape.length===2,function(){return"qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor."});for(var t=r.shape[0],n=r.shape[1],o=UI(t),a=ls(r),i=Hc([[1]],[1,1]),s=ls(i),u=t>=n?n:t,l=function(p){var f,d=a,m=s,h=o;f=Ee(G.tidy(function(){var g=Ht(a,[p,p],[t-p,1]),v=Ux(g),x=Ht(a,[p,p],[1,1]),y=Uu(ud(x,0),Hc([[-1]]),Hc([[1]])),b=Je(x,be(y,v)),k=Pt(g,b);k.shape[0]===1?s=ls(i):s=en([i,Ht(k,[1,0],[k.shape[0]-1,k.shape[1]])],0);var N=ba(Pt(vt(y,b),v)),E=Ht(a,[p,0],[t-p,n]),T=be(N,s),R=rd(s);if(p===0)a=Je(E,vt(T,vt(R,E)));else{var $=Je(E,vt(T,vt(R,E)));a=en([Ht(a,[0,0],[p,n]),$],0)}var O=rd(T),M=Ht(o,[0,p],[t,o.shape[1]-p]);if(p===0)o=Je(M,vt(vt(M,s),O));else{var B=Je(M,vt(vt(M,s),O));o=en([Ht(o,[0,0],[t,p]),B],1)}return[s,a,o]}),3),s=f[0],a=f[1],o=f[2],Ur([d,m,h])},c=0;c<u;++c)l(c);return!e&&t>n&&(o=Ht(o,[0,0],[t,n]),a=Ht(a,[0,0],[n,n])),[o,a]})}var I8=U({qr_:S8});I.Reduction=void 0;(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(I.Reduction||(I.Reduction={}));function C8(r,e,t){t===void 0&&(t=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var n=F(r,"losses","computeWeightedLoss"),o=null;e!=null&&(o=F(e,"weights","computeWeightedLoss"));var a=o==null?n:be(n,o);if(t===I.Reduction.NONE)return a;if(t===I.Reduction.SUM)return Ot(a);if(t===I.Reduction.MEAN){if(o==null)return pd(a);var i=n.size/o.size,s=Pt(Ot(a),Ot(o));return i>1?Pt(s,xt(i)):s}if(t===I.Reduction.SUM_BY_NONZERO_WEIGHTS){if(o==null)return Pt(Ot(a),xt(n.size));var u=be(o,ms(n.shape)),l=tr(Ot(oC(u,xt(0))),"float32");return Pt(Ot(a),l)}throw Error("Unknown reduction: "+t)}var Do=U({computeWeightedLoss_:C8});function N8(r,e,t,n){n===void 0&&(n=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=F(r,"labels","absoluteDifference"),a=F(e,"predictions","absoluteDifference"),i=null;t!=null&&(i=F(t,"weights","absoluteDifference")),$r(o.shape,a.shape,"Error in absoluteDifference: ");var s=dn(Je(o,a));return Do(s,i,n)}var E8=U({absoluteDifference_:N8});function T8(r,e,t,n,o){o===void 0&&(o=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=F(r,"labels","cosineDistance"),i=F(e,"predictions","cosineDistance"),s=null;n!=null&&(s=F(n,"weights","cosineDistance")),$r(a.shape,i.shape,"Error in cosineDistance: ");var u=xt(1),l=Je(u,Ot(be(a,i),t,!0));return Do(l,s,o)}var A8=U({cosineDistance_:T8});function F8(r,e,t,n){n===void 0&&(n=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=F(r,"labels","hingeLoss"),a=F(e,"predictions","hingeLoss"),i=null;t!=null&&(i=F(t,"weights","hingeLoss")),$r(o.shape,a.shape,"Error in hingeLoss: ");var s=xt(1);o=Je(be(xt(2),o),s);var u=dd(Je(s,be(o,a)));return Do(u,i,n)}var D8=U({hingeLoss_:F8});function R8(r,e,t,n,o){n===void 0&&(n=1),o===void 0&&(o=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=F(r,"labels","huberLoss"),i=F(e,"predictions","huberLoss"),s=null;t!=null&&(s=F(t,"weights","huberLoss")),$r(a.shape,i.shape,"Error in huberLoss: ");var u=xt(n),l=dn(Je(i,a)),c=nC(l,u),p=Je(l,c),f=ze(be(xt(.5),Un(c)),be(u,p));return Do(f,s,o)}var $8=U({huberLoss_:R8});function P8(r,e,t,n,o){n===void 0&&(n=1e-7),o===void 0&&(o=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=F(r,"labels","logLoss"),i=F(e,"predictions","logLoss"),s=null;t!=null&&(s=F(t,"weights","logLoss")),$r(a.shape,i.shape,"Error in logLoss: ");var u=xt(1),l=xt(n),c=ba(be(a,Lc(ze(i,l)))),p=be(Je(u,a),Lc(ze(Je(u,i),l))),f=Je(c,p);return Do(f,s,o)}var O8=U({logLoss_:P8});function M8(r,e,t,n){n===void 0&&(n=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var o=F(r,"labels","meanSquaredError"),a=F(e,"predictions","meanSquaredError"),i=null;t!=null&&(i=F(t,"weights","meanSquaredError")),$r(o.shape,a.shape,"Error in meanSquaredError: ");var s=pC(o,a);return Do(s,i,n)}var B8=U({meanSquaredError_:M8});function L8(r,e){var t=F(r,"labels","sigmoidCrossEntropyWithLogits"),n=F(e,"logits","sigmoidCrossEntropyWithLogits");$r(t.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=dd(n),a=be(n,t),i=KI(fs(ba(dn(n))));return ze(Je(o,a),i)}function V8(r,e,t,n,o){n===void 0&&(n=0),o===void 0&&(o=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=F(r,"multiClassLabels","sigmoidCrossEntropy"),i=F(e,"logits","sigmoidCrossEntropy"),s=null;if(t!=null&&(s=F(t,"weights","sigmoidCrossEntropy")),$r(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),n>0){var u=xt(n),l=xt(1),c=xt(.5);a=ze(be(a,Je(l,u)),be(c,u))}var p=L8(a,i);return Do(p,s,o)}var W8=U({sigmoidCrossEntropy_:V8});function z8(r,e,t){if(t===void 0&&(t=-1),t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+("supported. Labels / logits was rank "+e.rank+" ")+("and dim was "+t));var n=no(function(o,a,i){var s=!0,u=JI(a,[t],s),l=Je(tr(a,"float32"),u);i([o,l]);var c=ba(be(l,o)),p=Ot(c,[t]),f=function(d,m){var h=Ee(m,2),g=h[0],v=h[1],x=Vc(d.shape,[t]);return[be(ue(d,x),Je(tr(g,"float32"),fs(v))),be(ue(d,x),Je(fs(v),tr(g,"float32")))]};return{value:p,gradFunc:f}});return n(r,e)}function U8(r,e,t,n,o){n===void 0&&(n=0),o===void 0&&(o=I.Reduction.SUM_BY_NONZERO_WEIGHTS);var a=F(r,"onehotLabels","softmaxCrossEntropy"),i=F(e,"logits","softmaxCrossEntropy"),s=null;if(t!=null&&(s=F(t,"weights","softmaxCrossEntropy")),$r(a.shape,i.shape,"Error in softmaxCrossEntropy: "),n>0){var u=xt(n),l=xt(1),c=xt(a.shape[1]);a=ze(be(a,Je(l,u)),Pt(u,c))}var p=z8(a,i);return Do(p,s,o)}var G8=U({softmaxCrossEntropy_:U8});function j8(r,e,t,n){var o=F(r,"indices","sparseFillEmptyRows"),a=F(e,"values","sparseFillEmptyRows"),i=F(t,"denseShape","sparseFillEmptyRows"),s=F(n,"defaultValue","sparseFillEmptyRows",a.dtype);if(o.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        `+o.shape);if(a.rank!==1)throw new Error("Values should be Tensor1D but received shape "+a.shape);if(i.rank!==1)throw new Error("Dense shape should be Tensor1D but received shape "+i.shape);if(s.rank!==0)throw new Error("Default value should be a scalar but received shape "+s.shape);var u={indices:o,values:a,denseShape:i,defaultValue:s},l=G.runKernel(a2,u);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}var H8=U({sparseFillEmptyRows_:j8});function q8(r,e,t){var n=F(r,"inputIndices","sparseReshape"),o=F(e,"inputShape","sparseReshape"),a=F(t,"newShape","sparseReshape");if(n.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        `+n.shape);if(o.rank!==1)throw new Error("Input shape should be Tensor1D but received shape "+o.shape);if(a.rank!==1)throw new Error("New shape should be Tensor1D but received shape "+a.shape);var i={inputIndices:n,inputShape:o,newShape:a},s=G.runKernel(s2,i);return{outputIndices:s[0],outputShape:s[1]}}var K8=U({sparseReshape_:q8});function X8(r,e,t){var n=F(r,"data","sparseSegmentMean"),o=F(e,"indices","sparseSegmentMean"),a=F(t,"segmentIds","sparseSegmentMean");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          `+o.shape);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          `+a.shape);var i={data:n,indices:o,segmentIds:a};return G.runKernel(i2,i)}var Y8=U({sparseSegmentMean_:X8});function Z8(r,e,t){var n=F(r,"data","sparseSegmentSum"),o=F(e,"indices","sparseSegmentSum"),a=F(t,"segmentIds","sparseSegmentSum");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         `+o.shape);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         `+a.shape);var i={data:n,indices:o,segmentIds:a};return G.runKernel(u2,i)}var J8=U({sparseSegmentSum_:Z8});function Q8(r,e,t,n,o,a,i,s){var u=F(r,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error("Data must be a vector, saw: "+u.shape);var l=F(e,"dataSplits","stringNGrams");if(l.dtype!=="int32")throw new Error("Data splits must be of datatype int32");var c={separator:t,nGramWidths:n,leftPad:o,rightPad:a,padWidth:i,preserveShortSequences:s},p={data:u,dataSplits:l},f=G.runKernel(f2,p,c);return{nGrams:f[0],nGramsSplits:f[1]}}var e7=U({stringNGrams_:Q8});function t7(r,e,t){t===void 0&&(t=!0);var n=F(r,"input","stringSplit","string"),o=F(e,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error("Input should be Tensor1D but received shape "+n.shape);if(o.rank!==0)throw new Error("Delimiter should be a scalar but received shape "+o.shape);var a={skipEmpty:t},i={input:n,delimiter:o},s=G.runKernel(d2,i,a);return{indices:s[0],values:s[1],shape:s[2]}}var r7=U({stringSplit_:t7});function n7(r,e){var t=F(r,"input","stringToHashBucketFast","string"),n={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");var o={input:t};return G.runKernel(m2,o,n)}var o7=U({stringToHashBucketFast_:n7});var a7={fft:Lx,ifft:md,rfft:Vx,irfft:cC},s7={hammingWindow:$5,hannWindow:vC,frame:xC,stft:B5},i7={flipLeftRight:z5,grayscaleToRGB:G5,resizeNearestNeighbor:m8,resizeBilinear:f8,rotateWithOffset:H5,cropAndResize:V5,nonMaxSuppression:K5,nonMaxSuppressionAsync:r8,nonMaxSuppressionWithScore:o8,nonMaxSuppressionWithScoreAsync:s8,nonMaxSuppressionPadded:u8,nonMaxSuppressionPaddedAsync:c8,threshold:v8,transform:y8},u7={bandPart:w8,gramSchmidt:_8,qr:I8},l7={absoluteDifference:E8,computeWeightedLoss:Do,cosineDistance:A8,hingeLoss:D8,huberLoss:$8,logLoss:O8,meanSquaredError:B8,sigmoidCrossEntropy:W8,softmaxCrossEntropy:G8},c7={sparseFillEmptyRows:H8,sparseReshape:K8,sparseSegmentMean:Y8,sparseSegmentSum:J8},p7={stringNGrams:e7,stringSplit:r7,stringToHashBucketFast:o7},wa=function(r){Co(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.minimize=function(t,n,o){n===void 0&&(n=!1);var a=this.computeGradients(t,o),i=a.value,s=a.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Ur(s),n?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,n){return XI(t,n)},e.prototype.dispose=function(){this.iterations_!=null&&Ur(this.iterations_)},e.prototype.saveIterations=function(){return De(this,void 0,void 0,function(){return Re(this,function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:xt(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Re(this,function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){return Re(this,function(n){throw new Error("setWeights() is not implemented for this optimizer class "+(""+this.getClassName()))})})},e.prototype.extractIterations=function(t){return De(this,void 0,void 0,function(){var n;return Re(this,function(o){switch(o.label){case 0:return n=this,[4,t[0].tensor.data()];case 1:return n.iterations_=o.sent()[0],[2,t.slice(1)]}})})},e}(NI);Object.defineProperty(wa,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var yd=function(r){Co(e,r);function e(t,n,o){o===void 0&&(o=null);var a=r.call(this)||this;return a.learningRate=t,a.rho=n,a.epsilon=o,a.accumulatedGrads=[],a.accumulatedUpdates=[],o==null&&(a.epsilon=G.backend.epsilon()),a}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);o.forEach(function(a,i){var s=G.registeredVariables[a],u=!1;n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:dr(function(){return mn(s).variable(u)})}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:dr(function(){return mn(s).variable(u)})});var l=Array.isArray(t)?t[i].tensor:t[a];if(l!=null){var c=n.accumulatedGrads[i].variable,p=n.accumulatedUpdates[i].variable;dr(function(){var f=ze(be(c,n.rho),be(Un(l),1-n.rho)),d=be(Pt(Fo(ze(p,n.epsilon)),Fo(ze(c,n.epsilon))),l),m=ze(be(p,n.rho),be(Un(d),1-n.rho));c.assign(f),p.assign(m);var h=ze(be(d,-n.learningRate),s);s.assign(h)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Ur(this.accumulatedGrads.map(function(t){return t.variable})),Ur(this.accumulatedUpdates.map(function(t){return t.variable})))},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){var t;return Re(this,function(n){switch(n.label){case 0:return t=gt(this.accumulatedGrads,this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(t.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){var n,o;return Re(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(t)];case 1:return t=a.sent(),n=t.length/2,o=!1,this.accumulatedGrads=t.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(o)}}),this.accumulatedUpdates=t.slice(n,n*2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(o)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,n){return new t(n.learningRate,n.rho,n.epsilon)},e}(wa);yd.className="Adadelta";ya(yd);var bd=function(r){Co(e,r);function e(t,n){n===void 0&&(n=.1);var o=r.call(this)||this;return o.learningRate=t,o.initialAccumulatorValue=n,o.accumulatedGrads=[],o}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);o.forEach(function(a,i){var s=G.registeredVariables[a];if(n.accumulatedGrads[i]==null){var u=!1;n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:dr(function(){return id(s.shape,n.initialAccumulatorValue).variable(u)})}}var l=Array.isArray(t)?t[i].tensor:t[a];if(l!=null){var c=n.accumulatedGrads[i].variable;dr(function(){var p=ze(c,Un(l));c.assign(p);var f=ze(be(Pt(l,Fo(ze(p,G.backend.epsilon()))),-n.learningRate),s);s.assign(f)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&Ur(this.accumulatedGrads.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Re(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){var n;return Re(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),n=!1,this.accumulatedGrads=t.map(function(a){return{originalName:a.name,variable:a.tensor.variable(n)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,n){return new t(n.learningRate,n.initialAccumulatorValue)},e}(wa);bd.className="Adagrad";ya(bd);var wd=function(r){Co(e,r);function e(t,n,o,a){a===void 0&&(a=null);var i=r.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=o,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],dr(function(){i.accBeta1=xt(n).variable(),i.accBeta2=xt(o).variable()}),a==null&&(i.epsilon=G.backend.epsilon()),i}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);dr(function(){var a=Je(1,n.accBeta1),i=Je(1,n.accBeta2);o.forEach(function(s,u){var l=G.registeredVariables[s],c=!1;n.accumulatedFirstMoment[u]==null&&(n.accumulatedFirstMoment[u]={originalName:s+"/m",variable:dr(function(){return mn(l).variable(c)})}),n.accumulatedSecondMoment[u]==null&&(n.accumulatedSecondMoment[u]={originalName:s+"/v",variable:dr(function(){return mn(l).variable(c)})});var p=Array.isArray(t)?t[u].tensor:t[s];if(p!=null){var f=n.accumulatedFirstMoment[u].variable,d=n.accumulatedSecondMoment[u].variable,m=ze(be(f,n.beta1),be(p,1-n.beta1)),h=ze(be(d,n.beta2),be(Un(p),1-n.beta2)),g=Pt(m,a),v=Pt(h,i);f.assign(m),d.assign(h);var x=ze(be(Pt(g,ze(Fo(v),n.epsilon)),-n.learningRate),l);l.assign(x)}}),n.accBeta1.assign(be(n.accBeta1,n.beta1)),n.accBeta2.assign(be(n.accBeta2,n.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ur(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedSecondMoment!=null&&Ur(this.accumulatedSecondMoment.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){var t;return Re(this,function(n){switch(n.label){case 0:return t=gt(this.accumulatedFirstMoment,this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(t.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){var n,o,a=this;return Re(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),dr(function(){a.accBeta1.assign(zc(a.beta1,a.iterations_+1)),a.accBeta2.assign(zc(a.beta2,a.iterations_+1))}),n=t.length/2,o=!1,this.accumulatedFirstMoment=t.slice(0,n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(o)}}),this.accumulatedSecondMoment=t.slice(n,n*2).map(function(s){return{originalName:s.name,variable:s.tensor.variable(o)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)},e}(wa);wd.className="Adam";ya(wd);var kd=function(r){Co(e,r);function e(t,n,o,a,i){a===void 0&&(a=null),i===void 0&&(i=0);var s=r.call(this)||this;return s.learningRate=t,s.beta1=n,s.beta2=o,s.epsilon=a,s.decay=i,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],dr(function(){s.iteration=xt(0).variable(),s.accBeta1=xt(n).variable()}),a==null&&(s.epsilon=G.backend.epsilon()),s}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);dr(function(){var a=Je(1,n.accBeta1),i=Pt(-n.learningRate,ze(be(n.iteration,n.decay),1));o.forEach(function(s,u){var l=G.registeredVariables[s],c=!1;n.accumulatedFirstMoment[u]==null&&(n.accumulatedFirstMoment[u]={originalName:s+"/m",variable:mn(l).variable(c)}),n.accumulatedWeightedInfNorm[u]==null&&(n.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:mn(l).variable(c)});var p=Array.isArray(t)?t[u].tensor:t[s];if(p!=null){var f=n.accumulatedFirstMoment[u].variable,d=n.accumulatedWeightedInfNorm[u].variable,m=ze(be(f,n.beta1),be(p,1-n.beta1)),h=be(d,n.beta2),g=dn(p),v=rC(h,g);f.assign(m),d.assign(v);var x=ze(be(Pt(i,a),Pt(m,ze(v,n.epsilon))),l);l.assign(x)}}),n.iteration.assign(ze(n.iteration,1)),n.accBeta1.assign(be(n.accBeta1,n.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ur(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedWeightedInfNorm!=null&&Ur(this.accumulatedWeightedInfNorm.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Re(this,function(t){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){return Re(this,function(n){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},e}(wa);kd.className="Adamax";ya(kd);var qc=function(r){Co(e,r);function e(t){var n=r.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);o.forEach(function(a,i){var s=Array.isArray(t)?t[i].tensor:t[a];if(s!=null){var u=G.registeredVariables[a];dr(function(){var l=ze(be(n.c,s),u);u.assign(l)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=FI(xt(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Re(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){return Re(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:if(t=n.sent(),t.length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,n){return new t(n.learningRate)},e}(wa);qc.className="SGD";ya(qc);var _d=function(r){Co(e,r);function e(t,n,o){o===void 0&&(o=!1);var a=r.call(this,t)||this;return a.learningRate=t,a.momentum=n,a.useNesterov=o,a.accumulations=[],a.m=xt(a.momentum),a}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);o.forEach(function(a,i){var s=G.registeredVariables[a];if(n.accumulations[i]==null){var u=!1;n.accumulations[i]={originalName:a+"/momentum",variable:dr(function(){return mn(s).variable(u)})}}var l=n.accumulations[i].variable,c=Array.isArray(t)?t[i].tensor:t[a];c!=null&&dr(function(){var p,f=ze(be(n.m,l),c);n.useNesterov?p=ze(be(n.c,ze(c,be(f,n.m))),s):p=ze(be(n.c,f),s),l.assign(f),s.assign(p)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Ur(this.accumulations.map(function(t){return t.variable}))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Re(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){var n;return Re(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),n=!1,this.accumulations=t.map(function(a){return{originalName:a.name,variable:a.tensor.variable(n)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)},e}(qc);_d.className="Momentum";ya(_d);var Sd=function(r){Co(e,r);function e(t,n,o,a,i){n===void 0&&(n=.9),o===void 0&&(o=0),a===void 0&&(a=null),i===void 0&&(i=!1);var s=r.call(this)||this;if(s.learningRate=t,s.decay=n,s.momentum=o,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=i,a==null&&(s.epsilon=G.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return e.prototype.applyGradients=function(t){var n=this,o=Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t);o.forEach(function(a,i){var s=G.registeredVariables[a],u=!1;n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:dr(function(){return mn(s).variable(u)})}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:dr(function(){return mn(s).variable(u)})}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:dr(function(){return mn(s).variable(u)})});var l=Array.isArray(t)?t[i].tensor:t[a];if(l!=null){var c=n.accumulatedMeanSquares[i].variable,p=n.accumulatedMoments[i].variable;dr(function(){var f=ze(be(c,n.decay),be(Un(l),1-n.decay));if(n.centered){var d=n.accumulatedMeanGrads[i].variable,m=ze(be(d,n.decay),be(l,1-n.decay)),h=Pt(be(l,n.learningRate),Fo(Je(f,ze(Un(m),n.epsilon)))),g=ze(be(p,n.momentum),h);c.assign(f),d.assign(m),p.assign(g);var v=Je(s,g);s.assign(v)}else{var x=ze(be(c,n.decay),be(Un(l),1-n.decay)),g=ze(be(p,n.momentum),Pt(be(l,n.learningRate),Fo(ze(x,n.epsilon))));c.assign(x),p.assign(g);var v=Je(s,g);s.assign(v)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Ur(this.accumulatedMeanSquares.map(function(t){return t.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Ur(this.accumulatedMeanGrads.map(function(t){return t.variable})),this.accumulatedMoments!=null&&Ur(this.accumulatedMoments.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return De(this,void 0,void 0,function(){var t;return Re(this,function(n){switch(n.label){case 0:return t=gt(this.accumulatedMeanSquares,this.accumulatedMoments),this.centered&&t.push.apply(t,gt(this.accumulatedMeanGrads)),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(t.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(t){return De(this,void 0,void 0,function(){var n,o;return Re(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(t)];case 1:return t=a.sent(),n=this.centered?t.length/3:t.length/2,o=!1,this.accumulatedMeanSquares=t.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(o)}}),this.accumulatedMoments=t.slice(n,n*2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(o)}}),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(function(i){return{originalName:i.name,variable:i.tensor.variable(o)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},e}(wa);Sd.className="RMSProp";ya(Sd);var ka=function(){function r(){}return r.sgd=function(e){return new qc(e)},r.momentum=function(e,t,n){return n===void 0&&(n=!1),new _d(e,t,n)},r.rmsprop=function(e,t,n,o,a){return t===void 0&&(t=.9),n===void 0&&(n=0),o===void 0&&(o=null),a===void 0&&(a=!1),new Sd(e,t,n,o,a)},r.adam=function(e,t,n,o){return e===void 0&&(e=.001),t===void 0&&(t=.9),n===void 0&&(n=.999),o===void 0&&(o=null),new wd(e,t,n,o)},r.adadelta=function(e,t,n){return e===void 0&&(e=.001),t===void 0&&(t=.95),n===void 0&&(n=null),new yd(e,t,n)},r.adamax=function(e,t,n,o,a){return e===void 0&&(e=.002),t===void 0&&(t=.9),n===void 0&&(n=.999),o===void 0&&(o=null),a===void 0&&(a=0),new kd(e,t,n,o,a)},r.adagrad=function(e,t){return t===void 0&&(t=.1),new bd(e,t)},r}();var f7={sgd:ka.sgd,momentum:ka.momentum,adadelta:ka.adadelta,adagrad:ka.adagrad,rmsprop:ka.rmsprop,adamax:ka.adamax,adam:ka.adam};var d7=function(){return typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:function(r){return r()}}();function m7(){return new Promise(function(r){return d7(function(){return r()})})}function h7(r,e){var t=r[0].length;r.forEach(function(o,a){P(o.length===t,function(){return"Error in concat"+t+"D: rank of tensors["+a+"] must be the same "+("as the rank of the rest ("+t+")")})}),P(e>=0&&e<t,function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."});var n=r[0];r.forEach(function(o,a){for(var i=0;i<t;i++)P(i===e||o[i]===n[i],function(){return"Error in concat"+t+"D: Shape of tensors["+a+"] ("+o+") "+("does not match the shape of the rest ("+n+") ")+("along the non-concatenated axis "+a+".")})})}function g7(r,e){for(var t=r[0].slice(),n=1;n<r.length;n++)t[e]+=r[n][e];return t}var Hx=30;function v7(r){return r<=Hx?r:zf(r,Math.floor(Math.sqrt(r)))}function x7(r,e,t){var n=t*(typeof r=="number"?r:r[0]),o=e*(typeof r=="number"?r:r[1]);return[n,o]}function y7(r,e,t,n){n===void 0&&(n=!0);var o=[];if(n)o=o.concat(e.slice(0)),o.push(r[0]/t),o=o.concat(r.slice(1));else{o=o.concat(r[0]);for(var a=e.length,i=0;i<a;++i)o=o.concat([r[i+1]/e[i],e[i]]);o=o.concat(r.slice(a+1))}return o}function b7(r,e,t){t===void 0&&(t=!0);var n=[];if(t){n.push(e);for(var o=e+1;o<r;++o)o<=2*e?(n.push(o),n.push(o-(e+1))):n.push(o)}else{for(var a=[],i=[],o=1;o<r;++o)o>=e*2+1||o%2==1?i.push(o):a.push(o);n.push.apply(n,gt(a)),n.push(0),n.push.apply(n,gt(i))}return n}function w7(r,e,t,n){n===void 0&&(n=!0);var o=[];n?o.push(r[0]/t):o.push(r[0]*t);for(var a=1;a<r.length;++a)a<=e.length?n?o.push(e[a-1]*r[a]):o.push(r[a]/e[a-1]):o.push(r[a]);return o}function k7(r,e){for(var t=[0],n=0;n<e;++n)t.push(r[n][0]);return t}function _7(r,e,t){for(var n=r.slice(0,1),o=0;o<t;++o)n.push(r[o+1]-e[o][0]-e[o][1]);return n}var S7=1.7580993408473768,I7=1.0507009873554805;var C7=.3275911,N7=.254829592,E7=-.284496736,T7=1.421413741,A7=-1.453152027,F7=1.061405429;function D7(r,e){if(r.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+(r.length+", imag: "+e.length+"."));for(var t=new Float32Array(r.length*2),n=0;n<t.length;n+=2)t[n]=r[n/2],t[n+1]=e[n/2];return t}function R7(r){for(var e=new Float32Array(r.length/2),t=new Float32Array(r.length/2),n=0;n<r.length;n+=2)e[n/2]=r[n],t[n/2]=r[n+1];return{real:e,imag:t}}function $7(r){for(var e=Math.ceil(r.length/4),t=new Float32Array(e),n=new Float32Array(e),o=0;o<r.length;o+=4)t[Math.floor(o/4)]=r[o],n[Math.floor(o/4)]=r[o+1];return{real:t,imag:n}}function P7(r){for(var e=Math.floor(r.length/4),t=new Float32Array(e),n=new Float32Array(e),o=2;o<r.length;o+=4)t[Math.floor(o/4)]=r[o],n[Math.floor(o/4)]=r[o+1];return{real:t,imag:n}}function O7(r,e){var t=r[e*2],n=r[e*2+1];return{real:t,imag:n}}function M7(r,e,t,n){r[n*2]=e,r[n*2+1]=t}function B7(r,e){for(var t=new Float32Array(r/2),n=new Float32Array(r/2),o=0;o<Math.ceil(r/2);o++){var a=(e?2:-2)*Math.PI*(o/r);t[o]=Math.cos(a),n[o]=Math.sin(a)}return{real:t,imag:n}}function L7(r,e,t){var n=(t?2:-2)*Math.PI*(r/e),o=Math.cos(n),a=Math.sin(n);return{real:o,imag:a}}var qx="->",V7=/->/g,SC=",",IC="...";function W7(r,e){r=r.replace(/\s/g,"");var t=(r.length-r.replace(V7,"").length)/qx.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error('Equation must contain exactly one arrow ("'+qx+'").');var n=Ee(r.split(qx),2),o=n[0],a=n[1];P(o.indexOf(IC)===-1,function(){return'The ellipsis notation ("'+IC+'") is not supported yet.'});var i=o.split(SC),s=i.length;if(e!==s)throw new Error("Expected "+s+" input tensors, received "+e);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var u=[],l=function(v){var x=a[v];if(!i.some(function(y){return y.indexOf(x)!==-1}))throw new Error("Output subscripts contain the label "+x+" not present in the input subscripts.");u.indexOf(x)===-1&&u.push(x)},c=0;c<a.length;++c)l(c);for(var c=0;c<o.length;++c){var p=o[c];u.indexOf(p)===-1&&p!==SC&&u.push(p)}for(var f=new Array(i.length),c=0;c<s;++c){if(new Set(i[c].split("")).size!==i[c].length)throw new Error("Found duplicate axes in input component "+i[c]+". Support for duplicate axes in input is not implemented yet.");f[c]=[];for(var d=0;d<i[c].length;++d)f[c].push(u.indexOf(i[c][d]))}for(var m=u.length,h=a.length,g=[],c=h;c<m;++c)g.push(c);return{allDims:u,summedDims:g,idDims:f}}function z7(r,e){var t=new Array(r);t.fill(-1);for(var n=0;n<e.length;++n)t[e[n]]=n;for(var o=[],n=0;n<r;++n)t[n]===-1&&o.push(n);return t=t.filter(function(a){return a!==-1}),{permutationIndices:t,expandDims:o}}function U7(r,e,t){for(var n=new Array(r),o=function(i){for(var s=t[i].shape,u=function(c){n[e[i][c]]===void 0?n[e[i][c]]=s[c]:P(n[e[i][c]]===s[c],function(){return"Expected dimension "+n[e[i][c]]+" at axis "+c+" "+("of input shaped "+JSON.stringify(s)+", ")+("but got dimension "+s[c])})},l=0;l<e[i].length;++l)u(l)},a=0;a<t.length;++a)o(a)}function G7(r,e){var t,n,o=r,a=[],i=0;r.length===0&&o.push(-1),i=r.length+1;for(var s=0;s<i;++s)a.push([]);for(var u=[],s=0;s<o.length;++s){var l=o[s],c=H7(e,l);try{for(var p=(t=void 0,Zr(c)),f=p.next();!f.done;f=p.next()){var d=f.value;u.indexOf(d)===-1&&(a[s].push(d),u.push(d))}}catch(h){t={error:h}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}}return{path:o,steps:a}}function j7(r){return r.every(function(e,t){return e===t})}function H7(r,e){for(var t=[],n=0;n<r.length;++n)(r[n].length===0||r[n].indexOf(e)!==-1||e===-1)&&t.push(n);return t}function q7(r,e,t){t===void 0&&(t=0);var n=[];if(typeof e=="number")P(r.shape[t]%e==0,function(){return"Number of splits must evenly divide the axis."}),n=new Array(e).fill(r.shape[t]/e);else{var o=e.reduce(function(s,u){return u===-1&&(s+=1),s},0);P(o<=1,function(){return"There should be only one negative value in split array."});var a=e.indexOf(-1);if(a!==-1){var i=e.reduce(function(s,u){return u>0?s+u:s});e[a]=r.shape[t]-i}P(r.shape[t]===e.reduce(function(s,u){return s+u}),function(){return"The sum of sizes must match the size of the axis dimension."}),n=e}return n}function K7(r,e){var t=!1,n;for(r<=Hx?(n=r,t=!0):n=zf(r,Math.floor(Math.sqrt(r)));!t;)n>e||n===r?t=!0:n=zf(r,n+1);return n}function X7(r,e,t){for(var n=[],o=r.length,a=0;a<o;a++)a!==e?n.push(r[a]):n.push(t);return n}function Y7(r,e,t,n){var o=e.shape.length,a=r.shape.length;if(n!==0&&(n<-o||n>o))throw new Error("Expect batchDims in the range of [-"+o+", "+o+"], but got "+n);if(n<0&&(n+=o),n>a)throw new Error("batchDims ("+n+`) must be less than rank(x) (
    `+a+").");if(t<n)throw new Error("batchDims ("+n+") must be less than or equal to axis ("+t+").");for(var i=0;i<n;++i)if(r.shape[i]!==e.shape[i])throw new Error("x.shape["+i+"]: "+r.shape[i]+" should be equal to indices.shape["+i+"]: "+e.shape[i]+".");for(var s=r.shape[t],u=[],l=1,c=1,p=1,i=0;i<n;++i)u.push(r.shape[i]),l*=r.shape[i];for(var i=n;i<t;i++)u.push(r.shape[i]),c*=r.shape[i];for(var i=n;i<o;i++)u.push(e.shape[i]);for(var i=t+1;i<a;i++)u.push(r.shape[i]),p*=r.shape[i];return{batchSize:l,sliceSize:p,outerSize:c,dimSize:s,outputShape:u}}var Z7={__proto__:null,segOpComputeOptimalWindowSize:K7,computeOutShape:X7,collectGatherOpShapeInfo:Y7};function J7(r){try{return r.map(function(e){return Xf(e)})}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8, error: "+e)}}function Q7(r){return r.map(function(e){return Tc(e)})}var eX={__proto__:null,slice_util:CI,segment_util:Z7,fromUint8ToStringArray:J7,fromStringArrayToUint8:Q7,upcastType:Jf,axesAreInnerMostDims:Px,combineLocations:ZI,computeOutAndReduceShapes:EH,expandShapeToKeepDim:Vc,assertAxesAreInnerMostDims:TH,getAxesPermutation:AH,getUndoAxesPermutation:FH,getInnerMostAxes:DH,getBroadcastDims:Aj,getReductionAxes:VI,assertAndGetBroadcastShape:kr,assertParamsConsistent:h7,computeOutShape:g7,computeDilation2DInfo:g6,computePool2DInfo:RI,computePool3DInfo:v6,computeConv2DInfo:Oc,computeConv3DInfo:$I,computeDefaultPad:Tx,tupleValuesAreOne:Mc,eitherStridesOrDilationsAreOne:Ao,convertConv2DDataFormat:PI,getFusedDyActivation:hd,getFusedBiasGradient:gd,applyActivation:vd,shouldFuse:xd,PARALLELIZE_THRESHOLD:Hx,computeOptimalWindowSize:v7,getImageCenter:x7,getReshaped:y7,getPermuted:b7,getReshapedPermuted:w7,getSliceBeginCoords:k7,getSliceSize:_7,prepareAndValidate:hI,validateUpdateShape:_x,validateInput:Sx,calculateShapes:gI,SELU_SCALEALPHA:S7,SELU_SCALE:I7,ERF_P:C7,ERF_A1:N7,ERF_A2:E7,ERF_A3:T7,ERF_A4:A7,ERF_A5:F7,warn:eo,log:zW,mergeRealAndImagArrays:D7,splitRealAndImagArrays:R7,complexWithEvenIndex:$7,complexWithOddIndex:P7,getComplexWithIndex:O7,assignToTypedArray:M7,exponents:B7,exponent:L7,decodeEinsumEquation:W7,getEinsumPermutation:z7,checkEinsumDimSizes:U7,getEinsumComputePath:G7,isIdentityPermutation:j7,prepareSplitSize:q7};var tX={__proto__:null,nonMaxSuppressionV3Impl:yC,nonMaxSuppressionV4Impl:bC,nonMaxSuppressionV5Impl:wC,whereImpl:dC};I.Abs=jk;I.Acos=Hk;I.Acosh=qk;I.AdadeltaOptimizer=yd;I.AdagradOptimizer=bd;I.AdamOptimizer=wd;I.AdamaxOptimizer=kd;I.Add=Wv;I.AddN=Kk;I.All=Xk;I.Any=Yk;I.ArgMax=Zk;I.ArgMin=Jk;I.Asin=Qk;I.Asinh=e_;I.Atan=t_;I.Atan2=n_;I.Atanh=r_;I.AvgPool=o_;I.AvgPool3D=a_;I.AvgPool3DGrad=XW;I.AvgPoolGrad=KW;I.BatchMatMul=s_;I.BatchToSpaceND=i_;I.Bincount=u_;I.BroadcastArgs=l_;I.BroadcastTo=YW;I.Cast=zv;I.Ceil=c_;I.ClipByValue=p_;I.Complex=f_;I.ComplexAbs=d_;I.Concat=m_;I.Conv2D=h_;I.Conv2DBackpropFilter=g_;I.Conv2DBackpropInput=v_;I.Conv3D=x_;I.Conv3DBackpropFilterV2=ZW;I.Conv3DBackpropInputV2=y_;I.Cos=b_;I.Cosh=w_;I.CropAndResize=__;I.Cumsum=k_;I.DataStorage=CW;I.DenseBincount=S_;I.DepthToSpace=I_;I.DepthwiseConv2dNative=C_;I.DepthwiseConv2dNativeBackpropFilter=N_;I.DepthwiseConv2dNativeBackpropInput=E_;I.Diag=T_;I.Dilation2D=A_;I.Dilation2DBackpropFilter=QW;I.Dilation2DBackpropInput=JW;I.Einsum=D_;I.Elu=R_;I.EluGrad=ez;I.Environment=Uk;I.Equal=P_;I.Erf=$_;I.Exp=O_;I.ExpandDims=M_;I.Expm1=B_;I.FFT=L_;I.Fill=V_;I.FlipLeftRight=W_;I.Floor=z_;I.FloorDiv=U_;I.FromPixels=jv;I.FusedBatchNorm=G_;I.FusedConv2D=qv;I.FusedDepthwiseConv2D=Kv;I.GatherNd=H_;I.GatherV2=j_;I.Greater=q_;I.GreaterEqual=K_;I.IFFT=X_;I.Identity=Uv;I.Imag=Y_;I.IsFinite=Z_;I.IsInf=J_;I.IsNan=Q_;I.KernelBackend=Fk;I.LRN=lS;I.LRNGrad=rz;I.LeakyRelu=eS;I.Less=tS;I.LessEqual=rS;I.LinSpace=nS;I.Log=oS;I.Log1p=aS;I.LogSoftmax=tz;I.LogicalAnd=sS;I.LogicalNot=iS;I.LogicalOr=uS;I.Max=cS;I.MaxPool=fS;I.MaxPool3D=dS;I.MaxPool3DGrad=oz;I.MaxPoolGrad=nz;I.MaxPoolWithArgmax=mS;I.Maximum=pS;I.Mean=hS;I.Min=gS;I.Minimum=vS;I.MirrorPad=xS;I.Mod=yS;I.MomentumOptimizer=_d;I.Multinomial=bS;I.Multiply=wS;I.Neg=kS;I.NonMaxSuppressionV3=SS;I.NonMaxSuppressionV4=IS;I.NonMaxSuppressionV5=CS;I.NotEqual=_S;I.OP_SCOPE_SUFFIX=X2;I.OneHot=ES;I.OnesLike=NS;I.Optimizer=wa;I.OptimizerConstructors=ka;I.Pack=TS;I.PadV2=AS;I.Pool=az;I.Pow=FS;I.Prelu=DS;I.Prod=RS;I.RMSPropOptimizer=Sd;I.Range=$S;I.Real=PS;I.RealDiv=F_;I.Reciprocal=OS;I.Relu=MS;I.Relu6=WS;I.Reshape=BS;I.ResizeBilinear=VS;I.ResizeBilinearGrad=iz;I.ResizeNearestNeighbor=LS;I.ResizeNearestNeighborGrad=sz;I.Reverse=zS;I.RotateWithOffset=C2;I.Round=US;I.Rsqrt=GS;I.SGDOptimizer=qc;I.ScatterNd=jS;I.Select=HS;I.Selu=qS;I.Sigmoid=JS;I.Sign=ZS;I.Sin=XS;I.Sinh=YS;I.Slice=KS;I.Softmax=o2;I.Softplus=QS;I.SpaceToBatchND=r2;I.SparseFillEmptyRows=a2;I.SparseReshape=s2;I.SparseSegmentMean=i2;I.SparseSegmentSum=u2;I.SparseToDense=l2;I.SplitV=n2;I.Sqrt=e2;I.Square=uz;I.SquaredDifference=c2;I.Step=I2;I.StridedSlice=p2;I.StringNGrams=f2;I.StringSplit=d2;I.StringToHashBucketFast=m2;I.Sub=h2;I.Sum=t2;I.Tan=g2;I.Tanh=v2;I.Tensor=ir;I.TensorBuffer=Zf;I.Tile=Gv;I.TopK=x2;I.Transform=y2;I.Transpose=b2;I.Unique=w2;I.Unpack=k2;I.UnsortedSegmentSum=_2;I.Variable=Rc;I.ZerosLike=S2;I._FusedMatMul=Hv;I.abs=dn;I.acos=qG;I.acosh=XG;I.add=ze;I.addN=ZG;I.all=QG;I.any=t6;I.argMax=n6;I.argMin=a6;I.asin=i6;I.asinh=l6;I.atan=p6;I.atan2=d6;I.atanh=h6;I.avgPool=OI;I.avgPool3d=I6;I.backend=LG;I.backend_util=eX;I.basicLSTMCell=F6;I.batchNorm=od;I.batchNorm2d=O6;I.batchNorm3d=B6;I.batchNorm4d=V6;I.batchToSpaceND=MI;I.bincount=BI;I.booleanMaskAsync=o5;I.broadcastArgs=U6;I.broadcastTo=ad;I.browser=eG;I.buffer=To;I.cast=tr;I.ceil=H6;I.clipByValue=K6;I.clone=ls;I.complex=as;I.concat=en;I.concat1d=Y6;I.concat2d=J6;I.concat3d=ej;I.concat4d=rj;I.conv1d=aj;I.conv2d=sd;I.conv2dTranspose=uj;I.conv3d=cj;I.conv3dTranspose=mj;I.copyRegisteredKernels=fz;I.cos=gj;I.cosh=xj;I.cosineWindow=Gx;I.cumsum=bj;I.customGrad=no;I.denseBincount=kj;I.deprecationWarn=CG;I.depthToSpace=Sj;I.depthwiseConv2d=Dx;I.device_util=Gz;I.diag=Nj;I.dilation2d=Tj;I.disableDeprecationWarnings=IG;I.dispose=Ur;I.disposeVariables=NG;I.div=Pt;I.divNoNan=Pj;I.dot=Mj;I.dropout=v5;I.einsum=Lj;I.elu=zI;I.enableDebugMode=SG;I.enableProdMode=_G;I.enclosingPowerOfTwo=gC;I.engine=EG;I.env=at;I.equal=WI;I.erf=zj;I.exp=fs;I.expandDims=ds;I.expm1=Hj;I.eye=UI;I.fft=Lx;I.fill=id;I.findBackend=OG;I.findBackendFactory=MG;I.floor=GI;I.floorDiv=DI;I.fused=D5;I.gather=jI;I.gatherND=m5;I.gather_util=tG;I.getBackend=$G;I.getGradient=Xv;I.getKernel=Gf;I.getKernelsForBackend=jf;I.grad=hH;I.grads=gH;I.greater=ud;I.greaterEqual=HI;I.ifft=md;I.imag=Rx;I.image=i7;I.inTopKAsync=y5;I.io=VU;I.irfft=cC;I.isFinite=tH;I.isInf=nH;I.isNaN=aH;I.keep=FI;I.kernel_impls=tX;I.leakyRelu=qI;I.less=uH;I.lessEqual=$x;I.linalg=u7;I.linspace=cH;I.localResponseNormalization=fH;I.log=Lc;I.log1p=KI;I.logSigmoid=kH;I.logSoftmax=NH;I.logSumExp=JI;I.logicalAnd=cd;I.logicalNot=QI;I.logicalOr=eC;I.logicalXor=BH;I.losses=l7;I.matMul=vt;I.math=HU;I.max=Gu;I.maxPool=tC;I.maxPool3d=WH;I.maxPoolWithArgmax=UH;I.maximum=rC;I.mean=pd;I.memory=TG;I.meshgrid=HH;I.min=Ox;I.minimum=nC;I.mirrorPad=YH;I.mod=JH;I.moments=tq;I.movingAverage=i5;I.mul=be;I.multiRNNCell=nq;I.multinomial=aq;I.neg=ba;I.nextFrame=m7;I.norm=Ux;I.notEqual=oC;I.oneHot=kx;I.ones=ms;I.onesLike=uq;I.op=U;I.outerProduct=cq;I.pad=Wc;I.pad1d=dq;I.pad2d=hq;I.pad3d=vq;I.pad4d=yq;I.pool=Sq;I.pow=zc;I.prelu=sC;I.print=iI;I.prod=Eq;I.profile=AG;I.rand=Aq;I.randomGamma=Vq;I.randomNormal=zq;I.randomUniform=iC;I.range=Uc;I.ready=RG;I.real=fd;I.reciprocal=Hq;I.registerBackend=BG;I.registerGradient=lz;I.registerKernel=N2;I.relu=dd;I.relu6=uC;I.removeBackend=PG;I.reshape=ue;I.reverse=xs;I.reverse1d=Zq;I.reverse2d=Qq;I.reverse3d=tK;I.reverse4d=nK;I.rfft=Vx;I.round=lC;I.rsqrt=sK;I.scalar=xt;I.scatterND=l5;I.scatter_util=rG;I.selu=uK;I.separableConv2d=cK;I.serialization=dG;I.setBackend=DG;I.setPlatform=VG;I.setdiff1dAsync=fK;I.sigmoid=zu;I.sign=mK;I.signal=s7;I.sin=gK;I.sinh=xK;I.slice=Ht;I.slice1d=bK;I.slice2d=kK;I.slice3d=SK;I.slice4d=CK;I.slice_util=CI;I.softmax=EK;I.softplus=YI;I.spaceToBatchND=aC;I.sparse=c7;I.sparseToDense=f5;I.spectral=a7;I.split=Gc;I.sqrt=Fo;I.square=Un;I.squaredDifference=pC;I.squeeze=Wx;I.stack=jc;I.step=fC;I.stridedSlice=VK;I.string=p7;I.sub=Je;I.sum=Ot;I.sumOutType=Pz;I.tan=zK;I.tanh=Fx;I.tensor=Bu;I.tensor1d=Gn;I.tensor2d=Hc;I.tensor3d=dI;I.tensor4d=UK;I.tensor5d=GK;I.tensor6d=jK;I.tensor_util=Bz;I.test_util=wG;I.tidy=dr;I.tile=Bc;I.time=FG;I.topk=qK;I.train=f7;I.transpose=rd;I.truncatedNormal=XK;I.unique=ZK;I.unregisterGradient=pz;I.unregisterKernel=cz;I.unsortedSegmentSum=QK;I.unstack=zx;I.upcastType=Jf;I.util=_z;I.valueAndGrad=vH;I.valueAndGrads=xH;I.variable=t5;I.variableGrads=XI;I.version_core=kG;I.where=Uu;I.whereAsync=mC;I.zeros=ju;I.zerosLike=mn});var zE=jt(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});var Ce=Id();function rX(r){if(r&&r.__esModule)return r;var e=Object.create(null);return r&&Object.keys(r).forEach(function(t){if(t!=="default"){var n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:function(){return r[t]}})}}),e.default=r,e}var Tr=rX(Ce);var Kx=function(r,e){return Kx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},Kx(r,e)};function nX(r,e){Kx(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function wt(r,e,t,n){function o(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function s(c){try{l(n.next(c))}catch(p){i(p)}}function u(c){try{l(n.throw(c))}catch(p){i(p)}}function l(c){c.done?a(c.value):o(c.value).then(s,u)}l((n=n.apply(r,e||[])).next())})}function yt(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,o=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(c){l=[6,c],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Cd(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function we(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,a=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)a.push(o.value)}catch(s){i={error:s}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(i)throw i.error}}return a}function _r(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(we(arguments[e]));return r}var jn;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(jn||(jn={}));var CC;(function(r){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(CC||(CC={}));var Xx={};function oX(r,e){var t={tfOpName:r,category:"custom",inputs:[],attrs:[],customExecutor:e};Xx[r]=t}function NC(r){return Xx[r]}function aX(r){delete Xx[r]}function _(r,e,t,n,o){var a=e.inputParams[r];if(a&&a.inputIndexStart!==void 0){var i=a.inputIndexStart,s=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?i+1:a.inputIndexEnd;if(a.type==="tensor")return Or(e.inputNames[a.inputIndexStart],t,n,o);if(a.type==="tensors"){var u=e.inputNames.slice(i,s);return u.map(function(f){return Or(f,t,n,o)})}var l=Or(e.inputNames.slice(i)[0],t,n,o),c=l.dataSync();return a.type==="number"?c[0]:Ce.util.toNestedArray(l.shape,c)}var p=e.attrParams[r];return p&&p.value}function Or(r,e,t,n){var o=we(tn(r),2),a=o[0],i=o[1];if(n!=null){var s=n.getHashTableHandleByName(a);if(s!=null)return s}var u=t.currentContextIds.find(function(l){return!!e[Nd(a,l)]});return u!==void 0?e[Nd(a,u)][i]:void 0}function sX(r,e,t){return e[Nd(r,t.currentContextId)]}function Ro(r,e){var t=we(tn(r),3),n=t[0],o=t[1],a=t[2];return[Nd(n,e&&e.currentContextId),o,a]}function Nd(r,e){return e?r+"-"+e:r}function tn(r){var e=r.split(":");if(e.length===1)return[r,0,void 0];var t=e[0],n=e.length===3?e[1]:void 0,o=Number(e[e.length-1]);return[t,o,n]}function Ed(r,e,t){var n=_("pad",r,e,t);if(n==="explicit"){n=_("explicitPaddings",r,e,t);for(var o=[[0,0],[0,0],[0,0],[0,0]],a=0;a<4;a++)o[a][0]=n[a*2],o[a][1]=n[a*2+1];return o}return n}function $o(r){return r.kept?r:Ce.clone(r)}var iX=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],uX={__proto__:null,json:iX};var lX=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],cX={__proto__:null,json:lX};var pX=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],fX={__proto__:null,json:pX};var dX=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],mX={__proto__:null,json:dX};var hX=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],gX={__proto__:null,json:hX};var vX=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],xX={__proto__:null,json:vX};var yX=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],bX={__proto__:null,json:yX};var wX=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],kX={__proto__:null,json:wX};var _X=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],SX={__proto__:null,json:_X};var IX=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],CX={__proto__:null,json:IX};var NX=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],EX={__proto__:null,json:NX};var TX=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],AX={__proto__:null,json:TX};var FX=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],DX={__proto__:null,json:FX};var RX=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],$X={__proto__:null,json:RX};var PX=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],OX={__proto__:null,json:PX};var MX=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],BX={__proto__:null,json:MX};var LX=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],VX={__proto__:null,json:LX};var WX=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],zX={__proto__:null,json:WX};var UX=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],GX={__proto__:null,json:UX},EC=function(){function r(){var e=[uX,cX,fX,mX,gX,xX,bX,kX,SX,CX,EX,AX,DX,$X,OX,BX,VX,zX,GX],t=[].concat.apply([],_r(e.map(function(n){return n.json})));this.opMappers=t.reduce(function(n,o){return n[o.tfOpName]=o,n},{})}return Object.defineProperty(r,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),r.prototype.transformGraph=function(e,t){var n=this;t===void 0&&(t={});var o=e.node,a=[],i=[],s=[],u=o.reduce(function(g,v){return g[v.name]=n.mapNode(v),v.op.startsWith("Placeholder")?a.push(g[v.name]):v.op==="Const"?i.push(g[v.name]):(v.input==null||v.input.length===0)&&s.push(g[v.name]),g},{}),l=[],c=[],p={},f={};t!=null&&(p=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));var d=Object.keys(u);d.forEach(function(g){var v=u[g];v.inputNames.forEach(function(x,y){var b=we(Ro(x),3),k=b[0],N=b[2],E=u[k];if(E.outputs!=null){var T=E.outputs.indexOf(N);if(T!==-1){var R=k+":"+T;v.inputNames[y]=R}}v.inputs.push(E),E.children.push(v)})}),Object.keys(f).length===0?d.forEach(function(g){var v=u[g];v.children.length===0&&c.push(v)}):Object.keys(f).forEach(function(g){var v=we(Ro(g),1),x=v[0],y=u[x];y!=null&&(y.signatureKey=f[g],c.push(y))}),Object.keys(p).length>0?Object.keys(p).forEach(function(g){var v=we(Ro(g),1),x=v[0],y=u[x];y&&(y.signatureKey=p[g],l.push(y))}):l=a;var m={};e.library!=null&&e.library.function!=null&&(m=e.library.function.reduce(function(g,v){return g[v.signature.name]=n.mapFunction(v),g},{}));var h={nodes:u,inputs:l,outputs:c,weights:i,placeholders:a,signature:t,functions:m};return s.length>0&&(h.initNodes=s),h},r.prototype.mapSignatureEntries=function(e){return Object.keys(e||{}).reduce(function(t,n){return t[e[n].name]=n,t},{})},r.prototype.mapNode=function(e){var t=NC(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(function(o){return o.startsWith("^")?o.substr(1):o}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce(function(o,a){return o[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},o},{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce(function(o,a){var i=a.type,s=void 0;switch(a.type){case"string":s=Yx(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=Yx(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":s=oy(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=oy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":s=Jx(e.attr,a.tfName,a.defaultValue||0),s===void 0&&!!a.tfDeprecatedName&&(s=Jx(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":s=ny(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=ny(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":s=Zx(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=Zx(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":s=sy(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=sy(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":s=ry(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=ry(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":s=ay(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=ay(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":s=ey(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=ey(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":s=ty(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=ty(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":s=AC(e.attr,a.tfName,a.defaultValue),s===void 0&&!!a.tfDeprecatedName&&(s=AC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+e.op)}return o[a.name]={value:s,type:i},o},{})),n},r.prototype.mapFunction=function(e){var t=this,n=e.nodeDef,o=[],a=[],i={};n!=null&&(i=n.reduce(function(f,d){return f[d.name]=t.mapNode(d),d.op==="Const"&&a.push(f[d.name]),f},{}));var s=[],u=[];e.signature.inputArg.forEach(function(f){var d=we(Ro(f.name),1),m=d[0],h={name:m,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Qx(f.type),type:"dtype"}},children:[]};h.signatureKey=f.name,s.push(h),i[m]=h});var l=Object.keys(i);l.forEach(function(f){var d=i[f];d.inputNames.forEach(function(m,h){var g=we(Ro(m),3),v=g[0],x=g[2],y=i[v];if(y.outputs!=null){var b=y.outputs.indexOf(x);if(b!==-1){var k=v+":"+b;d.inputNames[h]=k}}d.inputs.push(y),y.children.push(d)})});var c=e.ret;e.signature.outputArg.forEach(function(f){var d=we(Ro(c[f.name]),2),m=d[0],h=d[1],g=i[m];g!=null&&(g.defaultOutput=h,u.push(g))});var p=this.mapArgsToSignature(e);return{nodes:i,inputs:s,outputs:u,weights:a,placeholders:o,signature:p}},r.prototype.mapArgsToSignature=function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(function(n,o){return n[o.name]=t.mapArgToTensorInfo(o),n},{}),outputs:e.signature.outputArg.reduce(function(n,o){return n[o.name]=t.mapArgToTensorInfo(o,e.ret),n},{})}},r.prototype.mapArgToTensorInfo=function(e,t){var n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}},r}();function jX(r){var e=Ce.env().global;if(typeof e.atob!="undefined")return e.atob(r);if(typeof Buffer!="undefined")return new Buffer(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function TC(r,e){var t=Array.isArray(r)?String.fromCharCode.apply(null,r):jX(r);return e?t:t.toLowerCase()}function Yx(r,e,t,n){n===void 0&&(n=!1);var o=r[e];return o!=null?TC(o.s,n):t}function Zx(r,e,t){var n=r[e];return n?n.b:t}function Jx(r,e,t){var n=r[e]||{},o=n.i!=null?n.i:n.f!=null?n.f:t;return typeof o=="number"?o:parseInt(o,10)}function Qx(r){switch(typeof r=="string"&&(r=jn[r]),r){case jn.DT_FLOAT:return"float32";case jn.DT_INT32:case jn.DT_INT64:case jn.DT_INT8:case jn.DT_UINT8:return"int32";case jn.DT_BOOL:return"bool";case jn.DT_DOUBLE:return"float32";case jn.DT_STRING:return"string";default:return null}}function AC(r,e,t){var n=r[e];return n&&n.func?n.func.name:t}function ey(r,e,t){var n=r[e];return n&&n.type?Qx(n.type):t}function ty(r,e,t){var n=r[e];return n&&n.list&&n.list.type?n.list.type.map(function(o){return Qx(o)}):t}function FC(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(function(e){return typeof e.size=="number"?e.size:parseInt(e.size,10)}):[]}function ry(r,e,t){var n=r[e];return n&&n.shape?FC(n.shape):t}function ny(r,e,t){var n=r[e];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(function(o){return typeof o=="number"?o:parseInt(o,10)}):t}function oy(r,e,t,n){n===void 0&&(n=!1);var o=r[e];return o&&o.list&&o.list.s?o.list.s.map(function(a){return TC(a,n)}):t}function ay(r,e,t){var n=r[e];return n&&n.list&&n.list.shape?n.list.shape.map(function(o){return FC(o)}):t}function sy(r,e,t){var n=r[e];return n&&n.list&&n.list.b?n.list.b:t}var HX=function(){function r(e,t,n){var o=this;this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(function(a){return o.getInput(a)}),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce(function(a,i){return a[i]=o.getAttr(i),a},{}))}return r.prototype.getInput=function(e){return Or(e,this.tensorMap,this.context)},r.prototype.getAttr=function(e,t){var n=this.node.rawAttrs[e];if(n.tensor!=null)return Or(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return Jx(this.node.rawAttrs,e,t);if(n.s!=null)return Yx(this.node.rawAttrs,e,t);if(n.b!=null)return Zx(this.node.rawAttrs,e,t);if(n.shape!=null)return ry(this.node.rawAttrs,e,t);if(n.type!=null)return ey(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return ny(this.node.rawAttrs,e,t);if(n.list.s!=null)return oy(this.node.rawAttrs,e,t);if(n.list.shape!=null)return ay(this.node.rawAttrs,e,t);if(n.list.b!=null)return sy(this.node.rawAttrs,e,t);if(n.list.type!=null)return ty(this.node.rawAttrs,e,t)}return t},r}();var qX=1e-7,KX=1e-4,XX=function(){function r(){}return r.prototype.refCount=function(e){return Sn("refCount")},r.prototype.incRef=function(e){return Sn("incRef")},r.prototype.timerAvailable=function(){return!0},r.prototype.time=function(e){return Sn("time")},r.prototype.read=function(e){return Sn("read")},r.prototype.readSync=function(e){return Sn("readSync")},r.prototype.numDataIds=function(){return Sn("numDataIds")},r.prototype.disposeData=function(e,t){return Sn("disposeData")},r.prototype.write=function(e,t,n){return Sn("write")},r.prototype.move=function(e,t,n,o,a){return Sn("move")},r.prototype.memory=function(){return Sn("memory")},r.prototype.floatPrecision=function(){return Sn("floatPrecision")},r.prototype.epsilon=function(){return this.floatPrecision()===32?qX:KX},r.prototype.dispose=function(){return Sn("dispose")},r}();function Sn(r){throw new Error("'"+r+"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen")}function z(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function In(r,e,t){t===void 0&&(t=""),z(ys(r,e),function(){return t+(" Shapes "+r+" and "+e+" must match")})}function qu(r){z(r!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Td(r,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(r)||oo(r)&&!t)for(var n=0;n<r.length;++n)Td(r[n],e,t);else e.push(r);return e}function rn(r){if(r.length===0)return 1;for(var e=r[0],t=1;t<r.length;t++)e*=r[t];return e}function ys(r,e){if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function nn(r){return r%1==0}function Ad(r,e){return e<=r.length?r:r+" ".repeat(e-r.length)}function Fd(r,e){var t=e.length;return r=r==null?e.map(function(n,o){return o}):[].concat(r),z(r.every(function(n){return n>=-t&&n<t}),function(){return"All values in axis param must be in range [-"+t+", "+t+") but "+("got axis "+r)}),z(r.every(function(n){return nn(n)}),function(){return"All values in axis param must be integers but "+("got axis "+r)}),r.map(function(n){return n<0?t+n:n})}function YX(r,e){for(var t=[],n=[],o=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||o?null:Fd(e,r).sort(),i=0,s=0;s<r.length;++s){if(a!=null){if(a[i]===s&&r[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+r[s]+"' is not 1");(a[i]==null||a[i]>s)&&r[s]===1&&(t.push(r[s]),n.push(s)),a[i]<=s&&i++}r[s]!==1&&(t.push(r[s]),n.push(s))}return{newShape:t,keptDims:n}}function ZX(r,e){var t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else throw new Error("Unknown data type "+r);return t}function JX(r,e){var t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else if(r==="string")t=new Array(e);else throw new Error("Unknown data type "+r);return t}function QX(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+e+" being uploaded contains "+n+".")}}function e9(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function oo(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray}function DC(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function t9(r){if(r==null)return 0;var e=0;return r.forEach(function(t){return e+=t.length}),e}function iy(r){return typeof r=="string"||r instanceof String}function r9(r){return typeof r=="boolean"}function n9(r){return typeof r=="number"}function uy(r){return Array.isArray(r)?uy(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray?"int32":n9(r)?"float32":iy(r)?"string":r9(r)?"bool":"float32"}function RC(r){return!!(r&&r.constructor&&r.call&&r.apply)}function ly(r){var e=r.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=r[e-1];for(var n=e-3;n>=0;--n)t[n]=t[n+1]*r[n+1];return t}function $C(r,e,t,n){n===void 0&&(n=!1);var o=new Array;if(e.length===1)for(var a=e[0]*(n?2:1),i=0;i<a;i++)o[i]=t[r+i];else for(var a=e[0],s=e.slice(1),u=s.reduce(function(c,p){return c*p})*(n?2:1),i=0;i<a;i++)o[i]=$C(r+i*u,s,t,n);return o}function PC(r,e,t){if(t===void 0&&(t=!1),r.length===0)return e[0];var n=r.reduce(function(o,a){return o*a})*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error("["+r+"] does not match the input size "+e.length+(t?" for a complex tensor":"")+".");return $C(0,r,e,t)}function OC(r,e){for(var t=cy(r,e),n=0;n<t.length;n++)t[n]=1;return t}function cy(r,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+e)}function MC(r){r.forEach(function(e){z(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+r+"].")})})}function BC(r){return r&&r.then&&typeof r.then=="function"}function bs(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];_a().getBool("IS_TEST")||_a().getBool("PROD")||console.warn.apply(console,_r(r))}var LC="tfjsflags",o9=function(){function r(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=a9,this.populateURLFlags()}return r.prototype.setPlatform=function(e,t){this.platform!=null&&bs("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+t+".")),this.platformName=e,this.platform=t},r.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){var o=this.urlFlags[e];bs("Setting feature override from URL "+e+": "+o+"."),this.set(e,o)}},r.prototype.getAsync=function(e){return wt(this,void 0,void 0,function(){var t,n;return yt(this,function(o){switch(o.label){case 0:return e in this.flags?[2,this.flags[e]]:(t=this.flags,n=e,[4,this.evaluateFlag(e)]);case 1:return t[n]=o.sent(),[2,this.flags[e]]}})})},r.prototype.get=function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(BC(t))throw new Error("Flag "+e+" cannot be synchronously evaluated. Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]},r.prototype.getNumber=function(e){return this.get(e)},r.prototype.getBool=function(e){return this.get(e)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},r.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},r.prototype.setFlags=function(e){this.flags=Object.assign({},e)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var e=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var t=this.getQueryParams(this.global.location.search);if(LC in t){var n=t[LC].split(",");n.forEach(function(o){var a=we(o.split(":"),2),i=a[0],s=a[1];e.urlFlags[i]=i9(i,s)})}}},r}();function a9(r){var e={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return s9(e,n[0],n[1]),n.join("=")}),e}function s9(r,e,t){r[decodeURIComponent(e)]=decodeURIComponent(t||"")}function i9(r,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+r+".")}function _a(){return VC}var VC=null;function u9(r){VC=r}var py;function WC(){if(py==null){var r=void 0;if(typeof window!="undefined")r=window;else if(typeof global!="undefined")r=global;else if(typeof process!="undefined")r=process;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");py=r}return py}function l9(){var r=WC();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function fy(r,e){var t=l9();if(t.has(r))return t.get(r);var n=e();return t.set(r,n),t.get(r)}var c9="Abs",p9="Acos",f9="Acosh",zC="Add",d9="AddN",m9="All",h9="Any",g9="ArgMax",v9="ArgMin",x9="Asin",y9="Asinh",b9="Atan",w9="Atanh",k9="Atan2",_9="AvgPool",S9="AvgPool3D",I9="BatchMatMul",C9="BatchToSpaceND",N9="Bincount",E9="BroadcastArgs",UC="Cast",T9="Ceil",A9="ClipByValue",F9="Complex",D9="ComplexAbs",R9="Concat",$9="Conv2D",P9="Conv2DBackpropFilter",O9="Conv2DBackpropInput",M9="Conv3D",B9="Conv3DBackpropInputV2",L9="Cos",V9="Cosh",W9="Cumsum",z9="CropAndResize",U9="DenseBincount",G9="DepthToSpace",j9="DepthwiseConv2dNative",H9="DepthwiseConv2dNativeBackpropFilter",q9="DepthwiseConv2dNativeBackpropInput",K9="Diag",X9="Dilation2D",Y9="RealDiv",Z9="Einsum",J9="Elu",Q9="Erf",eY="Equal",tY="Exp",rY="ExpandDims",nY="Expm1",oY="FFT",aY="Fill",sY="FlipLeftRight",iY="Floor",uY="FloorDiv",lY="FusedBatchNorm",cY="GatherV2",pY="GatherNd",fY="Greater",dY="GreaterEqual",GC="Identity",mY="IFFT",hY="Imag",gY="IsFinite",vY="IsInf",xY="IsNan",yY="LeakyRelu",bY="Less",wY="LessEqual",kY="LinSpace",_Y="Log",SY="Log1p",IY="LogicalAnd",CY="LogicalNot",NY="LogicalOr",EY="LRN",TY="Max",AY="Maximum",FY="MaxPool",DY="MaxPool3D",RY="MaxPoolWithArgmax",$Y="Mean",PY="Min",OY="Minimum",MY="MirrorPad",BY="Mod",LY="Multinomial",VY="Multiply",WY="Neg",zY="NotEqual",UY="NonMaxSuppressionV3",GY="NonMaxSuppressionV4",jY="NonMaxSuppressionV5",HY="OnesLike",qY="OneHot",KY="Pack",XY="PadV2",YY="Pow",ZY="Prelu",JY="Prod",QY="Range",eZ="Real",tZ="Reciprocal",rZ="Relu",nZ="Reshape",oZ="ResizeNearestNeighbor",aZ="ResizeBilinear",sZ="Relu6",iZ="Reverse",uZ="Round",lZ="Rsqrt",cZ="ScatterNd",pZ="Select",fZ="Selu",dZ="Slice",mZ="Sin",hZ="Sinh",gZ="Sign",vZ="Sigmoid",xZ="Softplus",yZ="Sqrt",bZ="Sum",wZ="SpaceToBatchND",kZ="SplitV",_Z="Softmax",SZ="SparseFillEmptyRows",IZ="SparseReshape",CZ="SparseSegmentMean",NZ="SparseSegmentSum",EZ="SparseToDense",TZ="SquaredDifference",AZ="StridedSlice",FZ="StringNGrams",DZ="StringSplit",RZ="StringToHashBucketFast",$Z="Sub",PZ="Tan",OZ="Tanh",jC="Tile",MZ="TopK",BZ="Transform",LZ="Transpose",VZ="Unique",WZ="Unpack",zZ="UnsortedSegmentSum",UZ="ZerosLike",GZ="Step",jZ="RotateWithOffset",HC="_FusedMatMul",qC="FusedConv2D",KC="FusedDepthwiseConv2D",XC=fy("kernelRegistry",function(){return new Map}),HZ=fy("gradRegistry",function(){return new Map});function YC(r,e){var t=qZ(r,e);return XC.get(t)}function ZC(r){return HZ.get(r)}function JC(r){for(var e=XC.entries(),t=[];;){var n=e.next(),o=n.done,a=n.value;if(o)break;var i=we(a,2),s=i[0],u=i[1],l=we(s.split("_"),1),c=l[0];c===r&&t.push(u)}return t}function qZ(r,e){return e+"_"+r}var dy=Mt,Cn=null;try{Cn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function Mt(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Mt.prototype.__isLong__;Object.defineProperty(Mt.prototype,"__isLong__",{value:!0});function on(r){return(r&&r.__isLong__)===!0}Mt.isLong=on;var QC={},eN={};function ws(r,e){var t,n,o;return e?(r>>>=0,(o=0<=r&&r<256)&&(n=eN[r],n)?n:(t=Bt(r,(r|0)<0?-1:0,!0),o&&(eN[r]=t),t)):(r|=0,(o=-128<=r&&r<128)&&(n=QC[r],n)?n:(t=Bt(r,r<0?-1:0,!1),o&&(QC[r]=t),t))}Mt.fromInt=ws;function Nn(r,e){if(isNaN(r))return e?ks:En;if(e){if(r<0)return ks;if(r>=rN)return iN}else{if(r<=-nN)return an;if(r+1>=nN)return sN}return r<0?Nn(-r,e).neg():Bt(r%Ku|0,r/Ku|0,e)}Mt.fromNumber=Nn;function Bt(r,e,t){return new Mt(r,e,t)}Mt.fromBits=Bt;var Dd=Math.pow;function my(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return En;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return my(r.substring(1),e,t).neg();for(var o=Nn(Dd(t,8)),a=En,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),u=parseInt(r.substring(i,i+s),t);if(s<8){var l=Nn(Dd(t,s));a=a.mul(l).add(Nn(u))}else a=a.mul(o),a=a.add(Nn(u))}return a.unsigned=e,a}Mt.fromString=my;function Hn(r,e){return typeof r=="number"?Nn(r,e):typeof r=="string"?my(r,e):Bt(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Mt.fromValue=Hn;var tN=1<<16,KZ=1<<24,Ku=tN*tN,rN=Ku*Ku,nN=rN/2,oN=ws(KZ),En=ws(0);Mt.ZERO=En;var ks=ws(0,!0);Mt.UZERO=ks;var Xu=ws(1);Mt.ONE=Xu;var aN=ws(1,!0);Mt.UONE=aN;var hy=ws(-1);Mt.NEG_ONE=hy;var sN=Bt(4294967295|0,2147483647|0,!1);Mt.MAX_VALUE=sN;var iN=Bt(4294967295|0,4294967295|0,!0);Mt.MAX_UNSIGNED_VALUE=iN;var an=Bt(0,2147483648|0,!1);Mt.MIN_VALUE=an;var ve=Mt.prototype;ve.toInt=function(){return this.unsigned?this.low>>>0:this.low};ve.toNumber=function(){return this.unsigned?(this.high>>>0)*Ku+(this.low>>>0):this.high*Ku+(this.low>>>0)};ve.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(an)){var t=Nn(e),n=this.div(t),o=n.mul(t).sub(this);return n.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var a=Nn(Dd(e,6),this.unsigned),i=this,s="";;){var u=i.div(a),l=i.sub(u.mul(a)).toInt()>>>0,c=l.toString(e);if(i=u,i.isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}};ve.getHighBits=function(){return this.high};ve.getHighBitsUnsigned=function(){return this.high>>>0};ve.getLowBits=function(){return this.low};ve.getLowBitsUnsigned=function(){return this.low>>>0};ve.getNumBitsAbs=function(){if(this.isNegative())return this.eq(an)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};ve.isZero=function(){return this.high===0&&this.low===0};ve.eqz=ve.isZero;ve.isNegative=function(){return!this.unsigned&&this.high<0};ve.isPositive=function(){return this.unsigned||this.high>=0};ve.isOdd=function(){return(this.low&1)==1};ve.isEven=function(){return(this.low&1)==0};ve.equals=function(e){return on(e)||(e=Hn(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};ve.eq=ve.equals;ve.notEquals=function(e){return!this.eq(e)};ve.neq=ve.notEquals;ve.ne=ve.notEquals;ve.lessThan=function(e){return this.comp(e)<0};ve.lt=ve.lessThan;ve.lessThanOrEqual=function(e){return this.comp(e)<=0};ve.lte=ve.lessThanOrEqual;ve.le=ve.lessThanOrEqual;ve.greaterThan=function(e){return this.comp(e)>0};ve.gt=ve.greaterThan;ve.greaterThanOrEqual=function(e){return this.comp(e)>=0};ve.gte=ve.greaterThanOrEqual;ve.ge=ve.greaterThanOrEqual;ve.compare=function(e){if(on(e)||(e=Hn(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ve.comp=ve.compare;ve.negate=function(){return!this.unsigned&&this.eq(an)?an:this.not().add(Xu)};ve.neg=ve.negate;ve.add=function(e){on(e)||(e=Hn(e));var t=this.high>>>16,n=this.high&65535,o=this.low>>>16,a=this.low&65535,i=e.high>>>16,s=e.high&65535,u=e.low>>>16,l=e.low&65535,c=0,p=0,f=0,d=0;return d+=a+l,f+=d>>>16,d&=65535,f+=o+u,p+=f>>>16,f&=65535,p+=n+s,c+=p>>>16,p&=65535,c+=t+i,c&=65535,Bt(f<<16|d,c<<16|p,this.unsigned)};ve.subtract=function(e){return on(e)||(e=Hn(e)),this.add(e.neg())};ve.sub=ve.subtract;ve.multiply=function(e){if(this.isZero())return En;if(on(e)||(e=Hn(e)),Cn){var t=Cn.mul(this.low,this.high,e.low,e.high);return Bt(t,Cn.get_high(),this.unsigned)}if(e.isZero())return En;if(this.eq(an))return e.isOdd()?an:En;if(e.eq(an))return this.isOdd()?an:En;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(oN)&&e.lt(oN))return Nn(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=this.high&65535,a=this.low>>>16,i=this.low&65535,s=e.high>>>16,u=e.high&65535,l=e.low>>>16,c=e.low&65535,p=0,f=0,d=0,m=0;return m+=i*c,d+=m>>>16,m&=65535,d+=a*c,f+=d>>>16,d&=65535,d+=i*l,f+=d>>>16,d&=65535,f+=o*c,p+=f>>>16,f&=65535,f+=a*l,p+=f>>>16,f&=65535,f+=i*u,p+=f>>>16,f&=65535,p+=n*c+o*l+a*u+i*s,p&=65535,Bt(d<<16|m,p<<16|f,this.unsigned)};ve.mul=ve.multiply;ve.divide=function(e){if(on(e)||(e=Hn(e)),e.isZero())throw Error("division by zero");if(Cn){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Cn.div_u:Cn.div_s)(this.low,this.high,e.low,e.high);return Bt(t,Cn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ks:En;var n,o,a;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ks;if(e.gt(this.shru(1)))return aN;a=ks}else{if(this.eq(an)){if(e.eq(Xu)||e.eq(hy))return an;if(e.eq(an))return Xu;var i=this.shr(1);return n=i.div(e).shl(1),n.eq(En)?e.isNegative()?Xu:hy:(o=this.sub(e.mul(n)),a=n.add(o.div(e)),a)}else if(e.eq(an))return this.unsigned?ks:En;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=En}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),u=s<=48?1:Dd(2,s-48),l=Nn(n),c=l.mul(e);c.isNegative()||c.gt(o);)n-=u,l=Nn(n,this.unsigned),c=l.mul(e);l.isZero()&&(l=Xu),a=a.add(l),o=o.sub(c)}return a};ve.div=ve.divide;ve.modulo=function(e){if(on(e)||(e=Hn(e)),Cn){var t=(this.unsigned?Cn.rem_u:Cn.rem_s)(this.low,this.high,e.low,e.high);return Bt(t,Cn.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ve.mod=ve.modulo;ve.rem=ve.modulo;ve.not=function(){return Bt(~this.low,~this.high,this.unsigned)};ve.and=function(e){return on(e)||(e=Hn(e)),Bt(this.low&e.low,this.high&e.high,this.unsigned)};ve.or=function(e){return on(e)||(e=Hn(e)),Bt(this.low|e.low,this.high|e.high,this.unsigned)};ve.xor=function(e){return on(e)||(e=Hn(e)),Bt(this.low^e.low,this.high^e.high,this.unsigned)};ve.shiftLeft=function(e){return on(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?Bt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Bt(0,this.low<<e-32,this.unsigned)};ve.shl=ve.shiftLeft;ve.shiftRight=function(e){return on(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?Bt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Bt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ve.shr=ve.shiftRight;ve.shiftRightUnsigned=function(e){if(on(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var n=this.low;return Bt(n>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Bt(t,0,this.unsigned):Bt(t>>>e-32,0,this.unsigned)};ve.shru=ve.shiftRightUnsigned;ve.shr_u=ve.shiftRightUnsigned;ve.toSigned=function(){return this.unsigned?Bt(this.low,this.high,!1):this};ve.toUnsigned=function(){return this.unsigned?this:Bt(this.low,this.high,!0)};ve.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ve.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ve.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Mt.fromBytes=function(e,t,n){return n?Mt.fromBytesLE(e,t):Mt.fromBytesBE(e,t)};Mt.fromBytesLE=function(e,t){return new Mt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Mt.fromBytesBE=function(e,t){return new Mt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var XZ=Object.assign(Object.create(null),dy,{default:dy}),YZ=dy||XZ;function gy(r){return YZ.fromString(r,!0,16)}gy("c3a5c85c97cb3127");gy("b492b66fbe98f273");gy("9ae16a3b2f90404f");function ZZ(r,e){return r instanceof Float32Array&&e==="float32"||r instanceof Int32Array&&e==="int32"||r instanceof Uint8Array&&e==="bool"}function uN(r,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Td(r)),_a().getBool("DEBUG")&&QX(r,e),ZZ(r,e))return r;if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool"){for(var t=new Uint8Array(r.length),n=0;n<t.length;++n)Math.round(r[n])!==0&&(t[n]=1);return t}else throw new Error("Unknown data type "+e)}function Rd(){return _a().platform.now()}function JZ(r,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",_a().platform.encode(r,e)}function lN(r,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",_a().platform.decode(r,e)}var QZ=function(){function r(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new tJ)}return r.prototype.profileKernel=function(e,t,n){var o,a,i,s=function(){i=n()},u,l=Rd();if(this.backendTimer.timerAvailable())u=this.backendTimer.time(s);else{s();try{for(var c=Cd(i),p=c.next();!p.done;p=c.next()){var f=p.value;f.dataSync()}}catch(g){o={error:g}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}u=Promise.resolve({kernelMs:Rd()-l})}if(_a().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var d=function(g){var v=i[g];v.data().then(function(x){eJ(x,v.dtype,e)})},m=0;m<i.length;m++)d(m);var h={kernelName:e,outputs:i,inputs:t,timeMs:u.then(function(g){return g.kernelMs}),extraInfo:u.then(function(g){return g.getExtraProfileInfo!=null?g.getExtraProfileInfo():""})};return h},r.prototype.logKernelProfile=function(e){var t=this,n=e.kernelName,o=e.outputs,a=e.timeMs,i=e.inputs,s=e.extraInfo;o.forEach(function(u){Promise.all([u.data(),a,s]).then(function(l){t.logger.logKernelProfile(n,u,l[0],l[1],i,l[2])})})},r}();function eJ(r,e,t){if(e!=="float32")return!1;for(var n=0;n<r.length;n++){var o=r[n];if(isNaN(o)||!isFinite(o))return console.warn("Found "+o+" in the result of '"+t+"'"),!0}return!1}var tJ=function(){function r(){}return r.prototype.logKernelProfile=function(e,t,n,o,a,i){var s=typeof o=="number"?Ad(o+"ms",9):o.error,u=Ad(e,25),l=t.rank,c=t.size,p=Ad(t.shape.toString(),14),f="";for(var d in a){var m=a[d];if(m!=null){var h=m.shape||t.shape,g=h.length;f+=d+": "+g+"D "+(g>0?h:"")+" "}}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+p+"	%c"+c+"	%c"+f+"	%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r}();function rJ(r,e,t){for(var n={},o={},a=0;a<e.length;a++)n[e[a].id]=!0;for(var a=0;a<r.length;a++){var i=r[a],s=i.inputs;for(var u in s){for(var l=s[u],c=!1,p=0;p<e.length;p++)if(n[l.id]){i.outputs.forEach(function(y){return n[y.id]=!0}),c=!0,o[i.id]=!0;break}if(c)break}}var f={};f[t.id]=!0;for(var d={},a=r.length-1;a>=0;a--)for(var i=r[a],s=i.inputs,p=0;p<i.outputs.length;p++)if(f[i.outputs[p].id]){for(var u in s)f[s[u].id]=!0,d[i.id]=!0;break}for(var m=[],a=0;a<r.length;a++){var i=r[a];if(o[i.id]&&d[i.id]){var h={};for(var u in i.inputs){var g=i.inputs[u];n[g.id]&&(h[u]=g)}var v=Object.assign({},i);v.inputs=h,v.outputs=i.outputs,m.push(v)}}return m}function nJ(r,e,t,n){for(var o=function(i){var s=e[i],u=[];if(s.outputs.forEach(function(f){var d=r[f.id];d!=null?u.push(d):u.push(null)}),s.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+s.kernelName+"."));var l=s.gradient(u),c=function(f){if(!(f in l))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(l)+"."));var d=t(function(){return l[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+s.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var m=s.inputs[f];if(!ys(d.shape,m.shape))throw new Error("Error in gradient for op "+s.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+m.shape+"'"));if(r[m.id]==null)r[m.id]=d;else{var h=r[m.id];r[m.id]=n(h,d),h.dispose()}};for(var p in s.inputs)c(p)},a=e.length-1;a>=0;a--)o(a)}var cN=20,Kc=3,vy=7;function oJ(r,e,t,n){var o=ly(e),a=aJ(r,e,t,o),i=e.length,s=$d(r,e,t,o,a),u=["Tensor"];return n&&(u.push("  dtype: "+t),u.push("  rank: "+i),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function aJ(r,e,t,n){var o=rn(e),a=n[n.length-1],i=new Array(a).fill(0),s=e.length,u=t==="complex64"?Yc(r):r;if(s>1)for(var l=0;l<o/a;l++)for(var c=l*a,p=0;p<a;p++)i[p]=Math.max(i[p],Xc(u[c+p],0,t).length);return i}function Xc(r,e,t){var n;return Array.isArray(r)?n=parseFloat(r[0].toFixed(vy))+" + "+(parseFloat(r[1].toFixed(vy))+"j"):iy(r)?n="'"+r+"'":t==="bool"?n=pN(r):n=parseFloat(r.toFixed(vy)).toString(),Ad(n,e)}function pN(r){return r===0?"false":"true"}function $d(r,e,t,n,o,a){a===void 0&&(a=!0);var i=t==="complex64"?2:1,s=e[0],u=e.length;if(u===0){if(t==="complex64"){var l=Yc(r);return[Xc(l[0],0,t)]}return t==="bool"?[pN(r[0])]:[r[0].toString()]}if(u===1){if(s>cN){var c=Kc*i,p=Array.from(r.slice(0,c)),f=Array.from(r.slice((s-Kc)*i,s*i));return t==="complex64"&&(p=Yc(p),f=Yc(f)),["["+p.map(function(E,T){return Xc(E,o[T],t)}).join(", ")+", ..., "+f.map(function(E,T){return Xc(E,o[s-Kc+T],t)}).join(", ")+"]"]}var d=t==="complex64"?Yc(r):Array.from(r);return["["+d.map(function(E,T){return Xc(E,o[T],t)}).join(", ")+"]"]}var m=e.slice(1),h=n.slice(1),g=n[0]*i,v=[];if(s>cN){for(var x=0;x<Kc;x++){var y=x*g,b=y+g;v.push.apply(v,_r($d(r.slice(y,b),m,t,h,o,!1)))}v.push("...");for(var x=s-Kc;x<s;x++){var y=x*g,b=y+g;v.push.apply(v,_r($d(r.slice(y,b),m,t,h,o,x===s-1)))}}else for(var x=0;x<s;x++){var y=x*g,b=y+g;v.push.apply(v,_r($d(r.slice(y,b),m,t,h,o,x===s-1)))}var k=u===2?",":"";v[0]="["+v[0]+k;for(var x=1;x<v.length-1;x++)v[x]=" "+v[x]+k;for(var N=`,
`,x=2;x<u;x++)N+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":N),v}function Yc(r){for(var e=[],t=0;t<r.length;t+=2)e.push([r[t],r[t+1]]);return e}var xy=function(){function r(e,t,n){var o=this;if(this.dtype=t,this.shape=e.slice(),this.size=rn(e),n!=null){var a=n.length;z(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+o.size+"'.")})}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||JX(t,this.size),this.strides=ly(e)}return r.prototype.set=function(e){for(var t=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];n.length===0&&(n=[0]),z(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must "+("match the rank ("+t.rank+")")});var a=this.locToIndex(n);this.values[a]=e},r.prototype.get=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];n.length===0&&(n=[0]);var a=0;try{for(var i=Cd(n),s=i.next();!s.done;s=i.next()){var u=s.value;if(u<0||u>=this.shape[a]){var l="Requested out of range element at "+n+". "+("  Buffer shape="+this.shape);throw new Error(l)}a++}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var c=n[n.length-1],p=0;p<n.length-1;++p)c+=this.strides[p]*n[p];return this.values[c]},r.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},r.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return ao().makeTensor(this.values,this.shape,this.dtype)},r}(),ao=null,Zc=null;function sJ(r){ao=r}var Gr=function(){function r(e,t,n,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=rn(e),this.strides=ly(e),this.dataId=n,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return wt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Zc.buffer(this.shape,this.dtype,e)]}})})},r.prototype.bufferSync=function(){return Zc.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return wt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,PC(this.shape,e,this.dtype==="complex64")]}})})},r.prototype.arraySync=function(){return PC(this.shape,this.dataSync(),this.dtype==="complex64")},r.prototype.data=function(){return wt(this,void 0,void 0,function(){var e,t;return yt(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=ao().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(o){return lN(o)})]}catch(o){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}})})},r.prototype.dataSync=function(){this.throwIfDisposed();var e=ao().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(t){return lN(t)})}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},r.prototype.bytes=function(){return wt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,ao().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},r.prototype.dispose=function(){this.isDisposed||(ao().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.print=function(e){return e===void 0&&(e=!1),Zc.print(this,e)},r.prototype.clone=function(){return this.throwIfDisposed(),Zc.clone(this)},r.prototype.toString=function(e){e===void 0&&(e=!1);var t=this.dataSync();return oJ(t,this.shape,this.dtype,e)},r.prototype.cast=function(e){return this.throwIfDisposed(),Zc.cast(this,e)},r.prototype.variable=function(e,t,n){return e===void 0&&(e=!0),this.throwIfDisposed(),ao().makeVariable(this,e,t,n)},r}();Object.defineProperty(Gr,Symbol.hasInstance,{value:function(r){return!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null}});function iJ(){return fy("Tensor",function(){return Gr})}iJ();var yy=function(r){nX(e,r);function e(t,n,o,a){var i=r.call(this,t.shape,t.dtype,t.dataId,a)||this;return i.trainable=n,i.name=o,i}return e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!ys(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and "+("previous value ("+this.shape+") must match"));ao().disposeTensor(this),this.dataId=t.dataId,ao().incRef(this,null)},e.prototype.dispose=function(){ao().disposeVariable(this),this.isDisposedInternal=!0},e}(Gr);Object.defineProperty(yy,Symbol.hasInstance,{value:function(r){return r instanceof Gr&&r.assign!=null&&r.assign instanceof Function}});var fN;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(fN||(fN={}));var by;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(by||(by={}));var wy;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(wy||(wy={}));var ky;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(ky||(ky={}));var _y;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(_y||(_y={}));var uJ={float32:ky,int32:by,bool:wy,complex64:_y};function lJ(r,e){if(r==="string"||e==="string"){if(r==="string"&&e==="string")return"string";throw new Error("Can not upcast "+r+" with "+e)}return uJ[r][e]}function rr(r,e){if(r.dtype===e.dtype)return[r,e];var t=lJ(r.dtype,e.dtype);return[r.cast(t),e.cast(t)]}function cJ(r,e){z(r.dtype===e.dtype,function(){return"The dtypes of the first("+r.dtype+") and"+(" second("+e.dtype+") input must match")})}function dN(r){var e=[],t=new Set;return mN(r,e,t),e}function mN(r,e,t){if(r!=null){if(r instanceof Gr){e.push(r);return}if(!!pJ(r)){var n=r;for(var o in n){var a=n[o];t.has(a)||(t.add(a),mN(a,e,t))}}}}function pJ(r){return Array.isArray(r)||typeof r=="object"}function Sy(r){return r.kernelName!=null}var hN=function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(function(e){return e.name})))}}}return r.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},r}(),Iy=function(){function r(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new hN}return r.prototype.ready=function(){return wt(this,void 0,void 0,function(){var e,t,n,o;return yt(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,a.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return o=a.sent(),o?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name,n=e.asyncInit;if(n)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(e){if(!(e in this.registry))if(e in this.registryFactory){var t=this.initializeBackend(e).asyncInit;if(t)return null}else return null;return this.registry[e]},r.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},r.prototype.registerBackend=function(e,t,n){return n===void 0&&(n=1),e in this.registryFactory?(bs(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},r.prototype.setBackend=function(e){return wt(this,void 0,void 0,function(){var t,n,o,a,i;return yt(this,function(s){switch(s.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,o=t.asyncInit,o?[4,n]:[3,2]);case 1:return i=s.sent(),[3,3];case 2:i=n,s.label=3;case 3:if(a=i,!a)return[2,!1];s.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new QZ(this.backendInstance),[2,!0]}})})},r.prototype.setupRegisteredKernels=function(){var e=this,t=JC(this.backendName);t.forEach(function(n){n.setupFunc!=null&&n.setupFunc(e.backendInstance)})},r.prototype.disposeRegisteredKernels=function(e){var t=this,n=JC(e);n.forEach(function(o){o.disposeFunc!=null&&o.disposeFunc(t.registry[e])})},r.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(n==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var o=n.factory();if(o&&!(o instanceof XX)&&typeof o.then=="function"){var a=++this.pendingBackendInitId,i=o.then(function(s){return a<t.pendingBackendInitId?!1:(t.registry[e]=s,t.pendingBackendInit=null,!0)}).catch(function(s){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,bs("Initialization of backend "+e+" failed"),bs(s.stack||s.message)),!1});return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(s){return bs("Initialization of backend "+e+" failed"),bs(s.stack||s.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},r.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],o=this.initializeBackend(n),a=o.success,i=o.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),o=n.backend,a=this.readSync(t),i=o.refCount(t);o.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(e,t){var n=this,o=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}var a;return this.scopedRun(function(){return n.startScope(o)},function(){return n.endScope(a)},function(){return a=t(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a})},r.prototype.scopedRun=function(e,t,n){e();try{var o=n();return t(),o}catch(a){throw t(),a}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(e){var t=q.runKernel(GC,{x:e}),n={x:e},o=function(i){return{x:function(){var s="float32",u={x:i},l={dtype:s};return q.runKernel(UC,u,l)}}},a=[];return this.addTapeNode(this.state.activeScope.name,n,[t],o,a,{}),t},r.prototype.runKernel=function(e,t,n){this.backendName==null&&this.backend;var o=YC(e,this.backendName)!=null;if(!o)throw new Error("Kernel '"+e+"' not registered for backend '"+this.backendName+"'");return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(e,t,n){var o=this.backend.numDataIds(),a=0;n.forEach(function(u){a+=u.dtype==="complex64"?3:1});var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-t-a-i;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+s+" data ids) after running '"+e+"'"))},r.prototype.runKernelFunc=function(e){var t=this,n,o=[],a=this.isTapeOn(),i=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var u;this.backendName==null&&this.backend;var l,c=Sy(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Sy(e)){var p=e.kernelName,f=e.inputs,d=e.attrs;this.backendName==null&&this.backend;var m=YC(p,this.backendName);z(m!=null,function(){return"Cannot find registered kernel '"+p+"' for backend '"+t.backendName+"'"}),u=function(){var k=t.backend.numDataIds();l=m.kernelFunc({inputs:f,attrs:d,backend:t.backend});var N=Array.isArray(l)?l:[l];t.shouldCheckForMemLeaks()&&t.checkKernelForMemLeak(p,k,N);var E=N.map(function(R){if(R.rank!=null)return R;var $=R.dataId,O=R.shape,M=R.dtype;return t.makeTensorFromDataId($,O,M)});if(a){var T=t.getTensorsForGradient(p,f,E);o=t.saveTensorsForBackwardMode(T)}return E}}else{var h=e.forwardFunc,g=function(k){!a||(o=k.map(function(N){return t.keep(t.clone(N))}))};u=function(){var k=t.backend.numDataIds();l=t.tidy(function(){return h(t.backend,g)});var N=Array.isArray(l)?l:[l];return t.shouldCheckForMemLeaks()&&t.checkKernelForMemLeak(c,k,N),N}}var v=e.inputs,x=e.attrs,y=Sy(e)?null:e.backwardsFunc,b;return this.scopedRun(function(){return t.state.kernelDepth++},function(){return t.state.kernelDepth--},function(){!t.ENV.getBool("DEBUG")&&!t.state.profiling?n=u():(b=t.profiler.profileKernel(c,v,function(){return u()}),t.ENV.getBool("DEBUG")&&t.profiler.logKernelProfile(b),n=b.outputs)}),a&&this.addTapeNode(c,v,n,y,o,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(v).map(function(k){return v[k]!=null?v[k].shape:null}),outputShapes:n.map(function(k){return k.shape}),kernelTimeMs:b.timeMs,extraInfo:b.extraInfo}),Array.isArray(l)?n:n[0]},r.prototype.saveTensorsForBackwardMode=function(e){var t=this,n=e.map(function(o){return t.keep(t.clone(o))});return n},r.prototype.getTensorsForGradient=function(e,t,n){var o=ZC(e);if(o!=null){var a=o.inputsToSave||[],i=o.outputsToSave||[],s=void 0;o.saveAllInputs?(z(Array.isArray(t),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(t).map(function(l){return t[l]})):s=a.map(function(l){return t[l]});var u=n.filter(function(l,c){return i[c]});return s.concat(u)}return[]},r.prototype.makeTensor=function(e,t,n,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",o=o||this.backend;var a=e;n==="string"&&iy(e[0])&&(a=e.map(function(c){return JZ(c)}));var i=o.write(a,t,n),s=new Gr(t,n,i,this.nextTensorId());if(this.trackTensor(s,o),n==="string"){var u=this.state.tensorInfo.get(i),l=t9(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},r.prototype.makeTensorFromDataId=function(e,t,n,o){n=n||"float32";var a=new Gr(t,n,e,this.nextTensorId());return this.trackTensor(a,o),a},r.prototype.makeVariable=function(e,t,n,o){t===void 0&&(t=!0),n=n||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));var a=new yy(e,t,n,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},r.prototype.trackTensor=function(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;var n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*DC(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof yy||this.track(e)},r.prototype.incRef=function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)},r.prototype.removeDataId=function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)},r.prototype.disposeTensor=function(e){if(!!this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){var n=e.size*DC(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}},r.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},r.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},r.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},r.prototype.profile=function(e){return wt(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,p,f;return yt(this,function(d){switch(d.label){case 0:return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],o=this.state.activeProfile,[4,e()];case 1:o.result=d.sent(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,_r(this.state.activeProfile.kernels.map(function(m){return m.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,d.label=2;case 2:d.trys.push([2,8,9,10]),a=Cd(this.state.activeProfile.kernels),i=a.next(),d.label=3;case 3:return i.done?[3,7]:(s=i.value,u=s,[4,s.kernelTimeMs]);case 4:return u.kernelTimeMs=d.sent(),l=s,[4,s.extraInfo];case 5:l.extraInfo=d.sent(),d.label=6;case 6:return i=a.next(),[3,3];case 7:return[3,10];case 8:return c=d.sent(),p={error:c},[3,10];case 9:try{i&&!i.done&&(f=a.return)&&f.call(a)}finally{if(p)throw p.error}return[7];case 10:return[2,this.state.activeProfile]}})})},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(e,t,n,o,a,i){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},l=ZC(e);l!=null&&(o=l.gradFunc),o!=null&&(u.gradient=function(c){return c=c.map(function(p,f){if(p==null){var d=n[f],m=cy(d.size,d.dtype);return s.makeTensor(m,d.shape,d.dtype)}return p}),o(c.length>1?c:c[0],a,i)}),this.state.activeTape.push(u)},r.prototype.keep=function(e){return e.kept=!0,e},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},r.prototype.endScope=function(e){for(var t=this,n=dN(e),o=new Set(n.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];!i.kept&&!o.has(i.id)&&i.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(u){!u.kept&&u.scopeId===s.id&&t.track(u)})},r.prototype.gradients=function(e,t,n,o){var a=this;if(o===void 0&&(o=!1),z(t.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",e)});z(i instanceof Gr,function(){return"The result y returned by f() must be a tensor."});var s=rJ(this.state.activeTape,t,i);if(!o&&s.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u={};u[i.id]=n==null?fJ(i.shape):n,nJ(u,s,function(c){return a.tidy(c)},mJ);var l=t.map(function(c){return u[c.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(c){var p,f;try{for(var d=Cd(c.saved),m=d.next();!m.done;m=d.next()){var h=m.value;h.dispose()}}catch(g){p={error:g}}finally{try{m&&!m.done&&(f=d.return)&&f.call(d)}finally{if(p)throw p.error}}}),a.state.activeTape=null),{value:i,grads:l}})},r.prototype.customGrad=function(e){var t=this;return z(RC(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];z(n.every(function(l){return l instanceof Gr}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a,i={};n.forEach(function(l,c){i[c]=l});var s=function(l,c){return a=e.apply(void 0,_r(n,[c])),z(a.value instanceof Gr,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),z(RC(a.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),a.value},u=function(l,c){var p=a.gradFunc(l,c),f=Array.isArray(p)?p:[p];z(f.length===n.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),z(f.every(function(m){return m instanceof Gr}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return f.forEach(function(m,h){d[h]=function(){return m}}),d};return t.runKernelFunc({forwardFunc:s,backwardsFunc:u,inputs:i})}},r.prototype.readSync=function(e){var t=this.state.tensorInfo.get(e);return t.backend.readSync(e)},r.prototype.read=function(e){var t=this.state.tensorInfo.get(e);return t.backend.read(e)},r.prototype.time=function(e){return wt(this,void 0,void 0,function(){var t,n;return yt(this,function(o){switch(o.label){case 0:return t=Rd(),[4,this.backend.time(e)];case 1:return n=o.sent(),n.wallMs=Rd()-t,[2,n]}})})},r.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new hN;for(var e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r}();Iy.nextTensorId=0;Iy.nextVariableId=0;function fJ(r){var e=OC(rn(r),"float32");return q.makeTensor(e,r,"float32")}function dJ(){var r=WC();if(r._tfengine==null){var e=new o9(r);r._tfengine=new Iy(e)}return u9(r._tfengine.ENV),sJ(function(){return r._tfengine}),r._tfengine}var q=dJ();function mJ(r,e){var t={a:r,b:e};return q.runKernel(zC,t)}function Sa(r,e){var t=r;if(oo(r))return e==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(t)||oo(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(r)&&_a().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&gN(r,n,[]),n}function gN(r,e,t){if(t=t||[],!Array.isArray(r)&&!oo(r)){z(e.length===0,function(){return"Element arr["+t.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+e[0]+" elements")});return}z(e.length>0,function(){return"Element arr["+t.join("][")+"] should be a primitive, "+("but is an array of "+r.length+" elements")}),z(r.length===e[0],function(){return"Element arr["+t.join("][")+"] should have "+e[0]+" "+("elements, but has "+r.length+" elements")});for(var n=e.slice(1),o=0;o<r.length;++o)gN(r[o],n,t.concat(o))}function vN(r,e,t,n){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==e||r==="numeric"&&e==="string")throw new Error("Argument '"+t+"' passed to '"+n+"' must "+("be "+r+" tensor, but got "+e+" tensor"))}}function D(r,e,t,n){if(n===void 0&&(n="numeric"),r instanceof Gr)return vN(n,r.dtype,e,t),r;var o=uy(r);if(o!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(o=n),vN(n,o,e,t),r==null||!oo(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var a=r==null?"null":r.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var i=Sa(r,o);!oo(r)&&!Array.isArray(r)&&(r=[r]);var s=!0,u=o!=="string"?uN(r,o):Td(r,[],s);return q.makeTensor(u,i,o)}function Pd(r,e,t,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");var o=r;return o.map(function(a,i){return D(a,e+"["+i+"]",t,n)})}var xN="__op";function j(r){var e=Object.keys(r);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(e.length+" keys."));var t=e[0],n=r[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+xN;var o=function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];q.startScope(t);try{var s=n.apply(void 0,_r(a));return BC(s)&&console.error("Cannot return a Promise inside of tidy."),q.endScope(s),s}catch(u){throw q.endScope(null),u}};return Object.defineProperty(o,"name",{value:t,configurable:!0}),o}function hJ(r){var e=D(r,"x","abs");if(e.dtype==="complex64"){var t={x:e};return q.runKernel(D9,t)}else{var t={x:e};return q.runKernel(c9,t)}}var hn=j({abs_:hJ});function gJ(r){var e=D(r,"x","acos"),t={x:e};return q.runKernel(p9,t)}var yN=j({acos_:gJ});function vJ(r){var e=D(r,"x","acosh"),t={x:e};return q.runKernel(f9,t)}var bN=j({acosh_:vJ});function xJ(r,e){var t,n=D(r,"a","add"),o=D(e,"b","add");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel(zC,a)}var mr=j({add_:xJ});function yJ(r){z(Array.isArray(r),function(){return"The argument passed to tf.addN() must be a list of tensors"}),z(r.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+(""+r.length)});var e=r.map(function(o,a){return D(o,"tensors"+a,"addN")}),t=e[0];e.forEach(function(o){if(o.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(o){if(!ys(o.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=e;return q.runKernel(d9,n)}var wN=j({addN_:yJ});function bJ(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","all","bool"),o={x:n},a={axis:e,keepDims:t};return q.runKernel(m9,o,a)}var kN=j({all_:bJ});function wJ(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","any","bool"),o={x:n},a={axis:e,keepDims:t};return q.runKernel(h9,o,a)}var _N=j({any_:wJ});function kJ(r,e){e===void 0&&(e=0);var t=D(r,"x","argMax"),n={x:t},o={axis:e};return q.runKernel(g9,n,o)}var SN=j({argMax_:kJ});function _J(r,e){e===void 0&&(e=0);var t=D(r,"x","argMin"),n={x:t},o={axis:e};return q.runKernel(v9,n,o)}var IN=j({argMin_:_J});function SJ(r){var e=D(r,"x","asin"),t={x:e};return q.runKernel(x9,t)}var CN=j({asin_:SJ});function IJ(r){var e=D(r,"x","asinh"),t={x:e};return q.runKernel(y9,t)}var NN=j({asinh_:IJ});function CJ(r){var e=D(r,"x","atan"),t={x:e};return q.runKernel(b9,t)}var EN=j({atan_:CJ});function NJ(r,e){var t,n=D(r,"a","atan2"),o=D(e,"b","atan2");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel(k9,a)}var TN=j({atan2_:NJ});function EJ(r){var e=D(r,"x","atanh"),t={x:e};return q.runKernel(w9,t)}var AN=j({atanh_:EJ});function TJ(r,e){var t=D(r,"x","cast");if(!e9(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var n={x:t},o={dtype:e};return q.runKernel(UC,n,o)}var nr=j({cast_:TJ});function AJ(r,e,t,n,o,a,i){i===void 0&&(i="channelsLast");var s=we(Od(e),2),u=s[0],l=s[1],c;if(i==="channelsLast")c=[u,l,r[3],r[3]];else if(i==="channelsFirst")c=[u,l,r[1],r[1]];else throw new Error("Unknown dataFormat "+i);return Cy(r,c,t,n,o,a,!1,i)}function Cy(r,e,t,n,o,a,i,s){var u,l;i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var c=we([-1,-1,-1,-1],4),p=c[0],f=c[1],d=c[2],m=c[3];if(s==="channelsLast")u=we(r,4),p=u[0],f=u[1],d=u[2],m=u[3];else if(s==="channelsFirst")l=we(r,4),p=l[0],m=l[1],f=l[2],d=l[3];else throw new Error("Unknown dataFormat "+s);var h=we(e,4),g=h[0],v=h[1],x=h[3],y=we(Od(t),2),b=y[0],k=y[1],N=we(Od(n),2),E=N[0],T=N[1],R=Ny(g,E),$=Ny(v,T),O=RJ(o,f,d,b,k,R,$,a,s),M=O.padInfo,B=O.outHeight,L=O.outWidth,H=i?x*m:x,W;return s==="channelsFirst"?W=[p,H,B,L]:s==="channelsLast"&&(W=[p,B,L,H]),{batchSize:p,dataFormat:s,inHeight:f,inWidth:d,inChannels:m,outHeight:B,outWidth:L,outChannels:H,padInfo:M,strideHeight:b,strideWidth:k,filterHeight:g,filterWidth:v,effectiveFilterHeight:R,effectiveFilterWidth:$,dilationHeight:E,dilationWidth:T,inShape:r,outShape:W,filterShape:e}}function FJ(r,e,t,n,o){n==null&&(n=DJ(r,e,t));var a=r[0],i=r[1],s=Md((a-e+2*n)/t+1,o),u=Md((i-e+2*n)/t+1,o);return[s,u]}function DJ(r,e,t,n){n===void 0&&(n=1);var o=Ny(e,n);return Math.floor((r[0]*(t-1)-t+o)/2)}function Od(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Ny(r,e){return e<=1?r:r+(r-1)*(e-1)}function RJ(r,e,t,n,o,a,i,s,u){var l,c,p;if(typeof r=="number"){var f=r===0?"VALID":"NUMBER";l={top:r,bottom:r,left:r,right:r,type:f};var d=FJ([e,t],a,n,r,s);c=d[0],p=d[1]}else if(r==="same"){c=Math.ceil(e/n),p=Math.ceil(t/o);var m=Math.max(0,(c-1)*n+a-e),h=Math.max(0,(p-1)*o+i-t),g=Math.floor(m/2),v=m-g,x=Math.floor(h/2),y=h-x;l={top:g,bottom:v,left:x,right:y,type:"SAME"}}else if(r==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-a+1)/n),p=Math.ceil((t-i+1)/o);else if(typeof r=="object"){var g=u==="channelsLast"?r[1][0]:r[2][0],v=u==="channelsLast"?r[1][1]:r[2][1],x=u==="channelsLast"?r[2][0]:r[3][0],y=u==="channelsLast"?r[2][1]:r[3][1],f=g===0&&v===0&&x===0&&y===0?"VALID":"EXPLICIT";l={top:g,bottom:v,left:x,right:y,type:f},c=Md((e-a+g+v)/n+1,s),p=Md((t-i+x+y)/o+1,s)}else throw Error("Unknown padding parameter: "+r);return{padInfo:l,outHeight:c,outWidth:p}}function Md(r,e){if(!e)return Math.trunc(r);switch(e){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+e)}}function Bd(r){var e=we(Od(r),3),t=e[0],n=e[1],o=e[2];return t===1&&n===1&&o===1}function Ia(r,e){return Bd(r)||Bd(e)}function $J(r,e){var t=D(r,"x","reshape","string_or_numeric"),n={x:t},o={shape:e};return q.runKernel(nZ,n,o)}var ie=j({reshape_:$J});function PJ(r,e,t,n,o){var a=D(r,"x","avgPool","float32"),i=1;z(Ia(t,i),function(){return"Error in avgPool: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+i+"'")});var s=a,u=!1;a.rank===3&&(u=!0,s=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]])),z(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),o!=null&&z(nn(n),function(){return"Error in avgPool: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o},p=q.runKernel(_9,l,c);return p=nr(p,a.dtype),u?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Ey=j({avgPool_:PJ});function OJ(r,e,t,n,o,a){a===void 0&&(a="NDHWC");var i=D(r,"x","avgPool3d","float32"),s=i,u=!1;i.rank===4&&(u=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),z(s.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+s.rank+"."}),z(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+("but got dataFormat of "+a)}),o!=null&&z(nn(n),function(){return"Error in avgPool3d: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o,dataFormat:a},p=q.runKernel(S9,l,c);return p=nr(p,s.dtype),u?ie(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var FN=j({avgPool3d_:OJ});function MJ(r){var e=D(r,"x","clone","string_or_numeric"),t={x:e};return q.runKernel(GC,t)}var Yu=j({clone_:MJ});function BJ(r,e){e===void 0&&(e=0),z(r.length>=1,function(){return"Pass at least one tensor to concat"});var t=Pd(r,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")}),t.length===1)return Yu(t[0]);var n=t,o={axis:e};return q.runKernel(R9,n,o)}var jr=j({concat_:BJ});function LJ(r,e,t,n){var o;t===void 0&&(t=!1),n===void 0&&(n=!1);var a=D(r,"a","matMul"),i=D(e,"b","matMul");o=we(rr(a,i),2),a=o[0],i=o[1];var s={a,b:i},u={transposeA:t,transposeB:n};return q.runKernel(I9,s,u)}var bt=j({matMul_:LJ});function VJ(r,e){var t,n=D(r,"a","mul"),o=D(e,"b","mul");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel(VY,a)}var He=j({mul_:VJ});function WJ(r){var e=D(r,"x","sigmoid","float32"),t={x:e};return q.runKernel(vZ,t)}var _s=j({sigmoid_:WJ});function zJ(r,e,t){var n=D(r,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");var o={x:n},a={begin:e,size:t};return q.runKernel(dZ,o,a)}var Lt=j({slice_:zJ});function UJ(r){var e=D(r,"x","tanh","float32"),t={x:e};return q.runKernel(OZ,t)}var Ld=j({tanh_:UJ});function GJ(r,e,t,n,o,a){var i=D(r,"forgetBias","basicLSTMCell"),s=D(e,"lstmKernel","basicLSTMCell"),u=D(t,"lstmBias","basicLSTMCell"),l=D(n,"data","basicLSTMCell"),c=D(o,"c","basicLSTMCell"),p=D(a,"h","basicLSTMCell"),f=jr([l,p],1),d=bt(f,s),m=mr(d,u),h=m.shape[0],g=m.shape[1]/4,v=[h,g],x=Lt(m,[0,0],v),y=Lt(m,[0,g],v),b=Lt(m,[0,g*2],v),k=Lt(m,[0,g*3],v),N=mr(He(_s(x),Ld(y)),He(c,_s(mr(i,b)))),E=He(Ld(N),_s(k));return[N,E]}var jJ=j({basicLSTMCell_:GJ});function HJ(r,e,t){var n=D(r,"x","batchToSpaceND"),o=e.reduce(function(s,u){return s*u});z(n.rank>=1+e.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+e.length}),z(t.length===e.length,function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length}),z(n.shape[0]%o==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+e.join(" * ")+" === "+o)});var a={x:n},i={blockShape:e,crops:t};return q.runKernel(C9,a,i)}var Ty=j({batchToSpaceND_:HJ});function qJ(r){var e;return r.rank===0||r.rank===1?e=ie(r,[1,1,1,r.size]):r.rank===2?e=ie(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?e=ie(r,[1,r.shape[0],r.shape[1],r.shape[2]]):e=r,e}function KJ(r,e,t,n,o,a){a==null&&(a=.001);var i=D(r,"x","batchNorm"),s=D(e,"mean","batchNorm"),u=D(t,"variance","batchNorm"),l;o!=null&&(l=D(o,"scale","batchNorm"));var c;n!=null&&(c=D(n,"offset","batchNorm")),z(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),z(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),z(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var p=qJ(i),f={x:p,scale:l,offset:c,mean:s,variance:u},d={varianceEpsilon:a},m=q.runKernel(lY,f,d);return ie(m,i.shape)}var Zu=j({batchNorm_:KJ});function XJ(r,e,t,n,o,a){var i=D(r,"x","batchNorm"),s=D(e,"mean","batchNorm"),u=D(t,"variance","batchNorm"),l;o!=null&&(l=D(o,"scale","batchNorm"));var c;return n!=null&&(c=D(n,"offset","batchNorm")),z(i.rank===2,function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+(i.rank+".")}),z(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+("got rank "+s.rank+".")}),z(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+("but got rank "+u.rank+".")}),l!=null&&z(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+("but got rank "+l.rank+".")}),c!=null&&z(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+("but got rank "+c.rank+".")}),Zu(i,s,u,c,l,a)}var YJ=j({batchNorm2d_:XJ});function ZJ(r,e,t,n,o,a){var i=D(r,"x","batchNorm"),s=D(e,"mean","batchNorm"),u=D(t,"variance","batchNorm"),l;o!=null&&(l=D(o,"scale","batchNorm"));var c;return n!=null&&(c=D(n,"offset","batchNorm")),z(i.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+(i.rank+".")}),z(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+("got rank "+s.rank+".")}),z(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+("but got rank "+u.rank+".")}),l!=null&&z(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+("but got rank "+l.rank+".")}),c!=null&&z(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+("but got rank "+c.rank+".")}),Zu(i,s,u,c,l,a)}var JJ=j({batchNorm3d_:ZJ});function QJ(r,e,t,n,o,a){var i=D(r,"x","batchNorm"),s=D(e,"mean","batchNorm"),u=D(t,"variance","batchNorm"),l;o!=null&&(l=D(o,"scale","batchNorm"));var c;return n!=null&&(c=D(n,"offset","batchNorm")),z(i.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+(i.rank+".")}),z(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+("got rank "+s.rank+".")}),z(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+("but got rank "+u.rank+".")}),l!=null&&z(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+("but got rank "+l.rank+".")}),c!=null&&z(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+("but got rank "+c.rank+".")}),Zu(i,s,u,c,l,a)}var eQ=j({batchNorm4d_:QJ});function tQ(r,e,t){var n=D(r,"x","bincount"),o=D(e,"weights","bincount");z(n.dtype==="int32",function(){return"Error in bincount: input "+("dtype must be int32, but got "+n.dtype)}),z(t>=0,function(){return"size must be non-negative, but got "+t+"."}),z(o.size===n.size||o.size===0,function(){return"Error in bincount: weights must have the same size as input or"+("0-length, but got input shape: "+n.shape+", weights shape: ")+(o.shape+".")});var a={x:n,weights:o},i={size:t};return q.runKernel(N9,a,i)}var Ay=j({bincount_:tQ});function rQ(r,e){var t=D(r,"s0","broadcastArgs","int32"),n=D(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+("Has rank "+t.rank));if(n.rank!==1)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+("Has rank "+n.rank));var o={s0:t,s1:n};return q.runKernel(E9,o)}var DN=j({broadcastArgs_:rQ});function nQ(r,e){var t=D(r,"broadcastTo","x"),n=t.shape;if(e.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<t.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+t.rank+".");if(e.length>t.rank){for(var o=t.shape.slice();o.length<e.length;)o.unshift(1);t=ie(t,o)}for(var a=t.shape,i=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])i[s]=1;else if(t.shape[s]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+e+"].");var u=i.map(function(p,f){return p>1?f:-1}).filter(function(p){return p>=0});if(u.length===0)return Yu(t);var l={x:t},c={reps:i};return q.runKernel(jC,l,c)}var Jc=j({broadcastTo_:nQ});function Ca(r,e,t){return e===void 0&&(e="float32"),e=e||"float32",MC(r),new xy(r,e,t)}function oQ(r){var e=D(r,"x","ceil","float32"),t={x:e};return q.runKernel(T9,t)}var RN=j({ceil_:oQ});function aQ(r,e,t){var n=D(r,"x","clipByValue");z(e<=t,function(){return"Error in clip: min ("+e+") must be "+("less than or equal to max ("+t+").")});var o={x:n},a={clipValueMin:e,clipValueMax:t};return q.runKernel(A9,o,a)}var $N=j({clipByValue_:aQ});function sQ(r,e){var t=D(r,"real","complex"),n=D(e,"imag","complex");In(t.shape,n.shape,"real and imag shapes, "+t.shape+" and "+n.shape+", must match in call to tf.complex().");var o={real:t,imag:n};return q.runKernel(F9,o)}var Ss=j({complex_:sQ});function iQ(r){return jr(r,0)}var uQ=j({concat1d_:iQ});function lQ(r,e){return jr(r,e)}var cQ=j({concat2d_:lQ});function pQ(r,e){return jr(r,e)}var fQ=j({concat3d_:pQ});function dQ(r,e){return jr(r,e)}var mQ=j({concat4d_:dQ});function hQ(r,e,t,n,o,a,i){o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]);var s=D(r,"x","conv2d","float32"),u=D(e,"filter","conv2d","float32"),l=s,c=!1;s.rank===3&&(c=!0,l=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),z(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),z(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+(u.rank+".")}),i!=null&&z(nn(n),function(){return"Error in conv2d: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+n+".")});var p=o==="NHWC"?l.shape[3]:l.shape[1];z(p===u.shape[2],function(){return"Error in conv2d: depth of input ("+p+") must match "+("input depth for filter "+u.shape[2]+".")}),z(Ia(t,a),function(){return"Error in conv2D: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+a+"'")});var f={x:l,filter:u},d={strides:t,pad:n,dataFormat:o,dilations:a,dimRoundingMode:i},m=q.runKernel($9,f,d);return c?ie(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var Qc=j({conv2d_:hQ});function gQ(r,e,t,n,o,a,i){o===void 0&&(o="NWC"),a===void 0&&(a=1);var s=D(r,"x","conv1d"),u=D(e,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=ie(s,[1,s.shape[0],s.shape[1]])),z(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),z(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+(u.rank+".")}),i!=null&&z(nn(n),function(){return"Error in conv1d: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+n+".")}),z(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match "+("input depth for filter "+u.shape[1]+".")}),z(Ia(t,a),function(){return"Error in conv1D: Either stride or dilation must be 1. "+("Got stride "+t+" and dilation '"+a+"'")}),z(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var p=ie(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=ie(l,[l.shape[0],1,l.shape[1],l.shape[2]]),d=[1,t],m=[1,a],h="NHWC",g=Qc(f,p,d,n,h,m,i);return c?ie(g,[g.shape[2],g.shape[3]]):ie(g,[g.shape[0],g.shape[2],g.shape[3]])}var PN=j({conv1d_:gQ});function vQ(r,e,t,n,o,a,i){a===void 0&&(a="NHWC"),z(r.length===e.rank,function(){return"Length of inShape "+("("+r.length+") and rank of dy ("+e.rank+") must match")});var s=r,u=e,l=!1;e.rank===3&&(l=!0,u=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,r[0],r[1],r[2]]),z(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+(s.length+".")}),z(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+("rank "+u.rank)}),z(t.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+("rank "+t.rank)});var c=a==="NHWC"?s[3]:s[1],p=a==="NHWC"?u.shape[3]:u.shape[1];z(c===t.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must "+("match input depth for filter "+t.shape[2]+".")}),z(p===t.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+p+") must "+("match output depth for filter "+t.shape[3]+".")}),i!=null&&z(nn(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+o+".")});var f={dy:u,filter:t},d={strides:n,pad:o,dataFormat:a,dimRoundingMode:i,inputShape:s},m=q.runKernel(O9,f,d);return l?ie(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var ON=j({conv2DBackpropInput_:vQ});function xQ(r,e,t,n,o,a){var i=D(r,"x","conv2dTranspose"),s=D(e,"filter","conv2dTranspose");return ON(t,i,s,n,o,"NHWC",a)}var MN=j({conv2dTranspose_:xQ});function yQ(r,e,t,n,o,a){o===void 0&&(o="NDHWC"),a===void 0&&(a=[1,1,1]);var i=D(r,"x","conv3d"),s=D(e,"filter","conv3d"),u=i,l=!1;i.rank===4&&(l=!0,u=ie(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),z(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),z(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+(s.rank+".")}),z(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match "+("input depth for filter "+s.shape[3]+".")}),z(Ia(t,a),function(){return"Error in conv3D: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+a+"'")}),z(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c={x:u,filter:s},p={strides:t,pad:n,dataFormat:o,dilations:a},f=q.runKernel(M9,c,p);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var BN=j({conv3d_:yQ});function bQ(r,e,t,n,o){z(r.length===e.rank,function(){return"Length of inShape "+("("+r.length+") and rank of dy ("+e.rank+") must match")});var a=r,i=e,s=!1;e.rank===4&&(s=!0,i=ie(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,r[0],r[1],r[2],r[3]]);var u=a[4],l=i.shape[4];z(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+(a.length+".")}),z(i.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+("rank "+i.rank)}),z(t.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+("rank "+t.rank)}),z(u===t.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must "+("match input depth for filter "+t.shape[3]+".")}),z(l===t.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must "+("match output depth for filter "+t.shape[4]+".")});var c={dy:i,filter:t},p={pad:o,strides:n,inputShape:a},f=q.runKernel(B9,c,p);return s?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var wQ=j({conv3DBackpropInput_:bQ});function kQ(r,e,t,n,o){var a=D(r,"x","conv3dTranspose"),i=D(e,"filter","conv3dTranspose");return wQ(t,a,i,n,o)}var _Q=j({conv3dTranspose_:kQ});function SQ(r){var e=D(r,"x","cos","float32"),t={x:e};return q.runKernel(L9,t)}var LN=j({cos_:SQ});function IQ(r){var e=D(r,"x","cosh","float32"),t={x:e};return q.runKernel(V9,t)}var VN=j({cosh_:IQ});function CQ(r,e,t,n){e===void 0&&(e=0),t===void 0&&(t=!1),n===void 0&&(n=!1);var o=D(r,"x","cumsum"),a={x:o},i={axis:e,exclusive:t,reverse:n};return q.runKernel(W9,a,i)}var WN=j({cumsum_:CQ});function NQ(r,e,t,n){n===void 0&&(n=!1);var o=D(r,"x","denseBincount"),a=D(e,"weights","denseBincount");z(o.dtype==="int32",function(){return"Error in denseBincount: input "+("dtype must be int32, but got "+o.dtype)}),z(o.rank<=2,function(){return"Error in denseBincount: input must be at most rank 2, but got "+("rank "+o.rank+".")}),z(t>=0,function(){return"size must be non-negative, but got "+t+"."}),z(a.size===o.size||a.size===0,function(){return"Error in denseBincount: weights must have the same shape as x or "+("0-length, but got x shape: "+o.shape+", weights shape: ")+(a.shape+".")});var i={x:o,weights:a},s={size:t,binaryOutput:n};return q.runKernel(U9,i,s)}var zN=j({denseBincount_:NQ});function EQ(r,e,t){t===void 0&&(t="NHWC");var n=D(r,"x","depthToSpace","float32"),o=t==="NHWC"?n.shape[1]:n.shape[2],a=t==="NHWC"?n.shape[2]:n.shape[3],i=t==="NHWC"?n.shape[3]:n.shape[1];z(e>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}),z(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
    `+o+" and "+e+`  for depthToSpace with input shape
    `+n.shape}),z(a*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
    `+a+" and "+e+` for depthToSpace with input shape
        `+n.shape}),z(i%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+i+" for depthToSpace with input shape "+n.shape});var s={x:n},u={blockSize:e,dataFormat:t};return q.runKernel(G9,s,u)}var UN=j({depthToSpace_:EQ});function TQ(r,e,t,n,o,a,i){o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]);var s=D(r,"x","depthwiseConv2d","float32"),u=D(e,"filter","depthwiseConv2d","float32"),l=s,c=!1;s.rank===3&&(c=!0,l=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),z(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+("rank "+l.rank+".")}),z(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+(u.rank+".")}),z(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels "+("("+l.shape[3]+") must match the inChannels dimension in ")+("filter "+u.shape[2]+".")}),i!=null&&z(nn(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+n+".")});var p={x:l,filter:u},f={strides:t,pad:n,dataFormat:o,dilations:a,dimRoundingMode:i},d=q.runKernel(j9,p,f);return c?ie(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Vd=j({depthwiseConv2d_:TQ});function AQ(r){var e=D(r,"x","diag"),t={x:e};return q.runKernel(K9,t)}var FQ=j({diag_:AQ});function DQ(r,e,t,n,o,a){o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC");var i=D(r,"x","dilation2d"),s=D(e,"filter","dilation2d");z(i.rank===3||i.rank===4,function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+(i.rank+".")}),z(s.rank===3,function(){return"Error in dilation2d: filter must be rank 3, but got rank "+(s.rank+".")}),z(a==="NHWC",function(){return"Error in dilation2d: Only NHWC is currently supported, "+("but got dataFormat of "+a)});var u=i,l=!1;i.rank===3&&(u=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=!0);var c={x:u,filter:s},p={strides:t,pad:n,dilations:o},f=q.runKernel(X9,c,p);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var GN=j({dilation2d_:DQ});function RQ(r,e){var t,n=D(r,"a","floorDiv"),o=D(e,"b","floorDiv");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel(uY,a)}var Fy=j({floorDiv_:RQ});function $Q(r,e){var t,n=D(r,"a","div"),o=D(e,"b","div");if(t=we(rr(n,o),2),n=t[0],o=t[1],n.dtype==="int32"&&o.dtype==="int32")return Fy(n,o);var a={a:n,b:o},i={};return q.runKernel(Y9,a,i)}var Ar=j({div_:$Q});function PQ(r,e){for(var t=[],n=0;n<e.length;n++){var o=r[r.length-n-1],a=e.length-n-1,i=e[a];(o==null||o===1&&i>1)&&t.unshift(a)}return t}function Fr(r,e){for(var t=[],n=Math.max(r.length,e.length),o=0;o<n;o++){var a=r[r.length-o-1];a==null&&(a=1);var i=e[e.length-o-1];if(i==null&&(i=1),a===1)t.unshift(i);else if(i===1)t.unshift(a);else if(a!==i){var s="Operands could not be broadcast together with shapes "+(r+" and "+e+".");throw Error(s)}else t.unshift(a)}return t}function OQ(r,e){var t,n=D(r,"a","equal","string_or_numeric"),o=D(e,"b","equal","string_or_numeric");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(eY,a)}var Dy=j({equal_:OQ});function MQ(r,e,t){var n=D(e,"a","where"),o=D(t,"b","where"),a=D(r,"condition","where","bool"),i=Fr(Fr(a.shape,n.shape),o.shape),s=Jc(a,i),u=Jc(n,i),l=Jc(o,i),c={condition:s,t:u,e:l};return q.runKernel(pZ,c)}var Is=j({where_:MQ});function BQ(r){var e=D(r,"x","zerosLike"),t={x:e};return q.runKernel(UZ,t)}var Wd=j({zerosLike_:BQ});function LQ(r,e){var t,n=D(r,"a","div"),o=D(e,"b","div");t=we(rr(n,o),2),n=t[0],o=t[1];var a=Ar(n,o),i=Wd(a),s=Dy(o,i);return Is(s,i,a)}var jN=j({divNoNan_:LQ});function VQ(r,e){var t=D(r,"t1","dot"),n=D(e,"t2","dot");z((t.rank===1||t.rank===2)&&(n.rank===1||n.rank===2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+(t.rank+" and "+n.rank+".")});var o=t.rank===1?t.size:t.shape[1],a=n.rank===1?n.size:n.shape[0];if(z(o===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+(o+" and "+a+".")}),t.rank===1&&n.rank===1){var i=ie(t,[1,-1]),s=ie(n,[-1,1]),u=bt(i,s);return ie(u,[])}else if(t.rank===1&&n.rank===2){var i=ie(t,[1,-1]),s=ie(n,[n.shape[0],n.shape[1]]),u=bt(i,s);return ie(u,[u.size])}else if(t.rank===2&&n.rank===1){var s=ie(n,[-1,1]),u=bt(t,s);return ie(u,[u.size])}else{var s=ie(n,[n.shape[0],n.shape[1]]),u=bt(t,s);return u}}var WQ=j({dot_:VQ});function zQ(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var n=e.map(function(a,i){return D(a,"tensors"+i,"einsum")}),o={equation:r};return q.runKernel(Z9,n,o)}var HN=j({einsum_:zQ});function UQ(r){var e=D(r,"x","elu","float32"),t={x:e};return q.runKernel(J9,t)}var Ry=j({elu_:UQ});function GQ(r){var e=D(r,"x","erf");z(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=nr(e,"float32"));var t={x:e};return q.runKernel(Q9,t)}var qN=j({erf_:GQ});function jQ(r){var e=D(r,"x","exp"),t={x:e};return q.runKernel(tY,t)}var Na=j({exp_:jQ});function HQ(r,e){e===void 0&&(e=0);var t=D(r,"x","expandDims","string_or_numeric");z(e<=t.rank,function(){return"Axis must be <= rank of the tensor"});var n={input:t},o={dim:e};return q.runKernel(rY,n,o)}var Ea=j({expandDims_:HQ});function qQ(r){var e=D(r,"x","expm1"),t={x:e};return q.runKernel(nY,t)}var KN=j({expm1_:qQ});function KQ(r,e){var t=D(r,"x","tile","string_or_numeric");z(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" "+("must match length of reps "+e+".")});var n={x:t},o={reps:e};return q.runKernel(jC,n,o)}var Ju=j({tile_:KQ});function XQ(r,e,t,n){n===void 0&&(n="float32"),e==null&&(e=r);for(var o=Ca([r,e],n),a=r<=e?r:e,i=0;i<a;++i)o.set(1,i,i);var s=ie(o.toTensor(),[r,e]);if(t==null)return s;if(t.length===1)return Ju(Ea(s,0),[t[0],1,1]);if(t.length===2)return Ju(Ea(Ea(s,0),0),[t[0],t[1],1,1]);if(t.length===3)return Ju(Ea(Ea(Ea(s,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+("batchShapes, but received "+t.length+"D."))}var XN=j({eye_:XQ});function zd(r,e,t){var n={shape:r,value:e,dtype:t};return q.runKernel(aY,{},n)}function YQ(r){var e=D(r,"x","floor","float32"),t={x:e};return q.runKernel(iY,t)}var $y=j({floor_:YQ});function ZQ(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=0);var o=D(r,"x","gather"),a=D(e,"indices","gather","int32"),i={x:o,indices:a},s={axis:t,batchDims:n};return q.runKernel(cY,i,s)}var Ud=j({gather_:ZQ});function JQ(r,e){var t,n=D(r,"a","greater","string_or_numeric"),o=D(e,"b","greater","string_or_numeric");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(fY,a)}var ep=j({greater_:JQ});function QQ(r,e){var t,n=D(r,"a","greaterEqual","string_or_numeric"),o=D(e,"b","greaterEqual","string_or_numeric");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(dY,a)}var Py=j({greaterEqual_:QQ});function eee(r){var e=D(r,"input","imag"),t={input:e};return q.runKernel(hY,t)}var Gd=j({imag_:eee});function tee(r){var e=D(r,"x","isFinite"),t={x:e};return q.runKernel(gY,t)}var ree=j({isFinite_:tee});function nee(r){var e=D(r,"x","isInf"),t={x:e};return q.runKernel(vY,t)}var oee=j({isInf_:nee});function aee(r){var e=D(r,"x","isNaN"),t={x:e};return q.runKernel(xY,t)}var YN=j({isNaN_:aee});function see(r,e){e===void 0&&(e=.2);var t=D(r,"x","leakyRelu"),n={x:t},o={alpha:e};return q.runKernel(yY,n,o)}var Oy=j({leakyRelu_:see});function iee(r,e){var t,n=D(r,"a","less","string_or_numeric"),o=D(e,"b","less","string_or_numeric");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(bY,a)}var ZN=j({less_:iee});function uee(r,e){var t,n=D(r,"a","lessEqual","string_or_numeric"),o=D(e,"b","lessEqual","string_or_numeric");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(wY,a)}var jd=j({lessEqual_:uee});function JN(r,e,t){if(t<=0)throw new Error("The number of values should be positive.");var n={start:r,stop:e,num:t};return q.runKernel(kY,{},n)}function lee(r,e,t,n,o){e===void 0&&(e=5),t===void 0&&(t=1),n===void 0&&(n=1),o===void 0&&(o=.5);var a=D(r,"x","localResponseNormalization");z(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),z(nn(e),function(){return"Error in localResponseNormalization: depthRadius must be an "+("integer but got depthRadius "+e+".")});var i=a,s=!1;a.rank===3&&(s=!0,i=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]]));var u={x:i},l={depthRadius:e,bias:t,alpha:n,beta:o},c=q.runKernel(EY,u,l);return s?ie(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var QN=j({localResponseNormalization_:lee});function cee(r){var e=D(r,"x","log","float32"),t={x:e};return q.runKernel(_Y,t)}var Qu=j({log_:cee});function pee(r){var e=D(r,"x","log1p"),t={x:e};return q.runKernel(SY,t)}var My=j({log1p_:pee});function Po(r){return q.customGrad(r)}function fee(r){var e=D(r,"x","neg"),t={x:e};return q.runKernel(WY,t)}var Oo=j({neg_:fee});function dee(r){var e=D(r,"x","softplus"),t={x:e};return q.runKernel(xZ,t)}var By=j({softplus_:dee});function mee(r){var e=D(r,"x","logSigmoid"),t=Po(function(n){var o=Oo(By(Oo(n))),a=function(i){var s=He(i,_s(Oo(n)));return s};return{value:o,gradFunc:a}});return t(e)}var hee=j({logSigmoid_:mee});function gee(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","max"),o={x:n},a={reductionIndices:e,keepDims:t};return q.runKernel(TY,o,a)}var Cs=j({max_:gee});function vee(r,e){var t,n=D(r,"a","sub"),o=D(e,"b","sub");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel($Z,a)}var it=j({sub_:vee});function xee(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","sum");n.dtype==="bool"&&(n=nr(n,"int32"));var o={x:n},a={axis:e,keepDims:t};return q.runKernel(bZ,o,a)}var Ct=j({sum_:xee});function yee(r,e){e===void 0&&(e=-1);var t=D(r,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+("Logits was rank "+t.rank+" and axis was "+e));var n=Po(function(o,a){var i=!0,s=Cs(o,e,!0),u=it(o,s),l=it(nr(u,"float32"),Qu(Ct(Na(u),e,i)));a([l]);var c=function(p,f){var d=we(f,1),m=d[0],h=!0,g=Na(m);return it(p,He(Ct(p,e,h),g))};return{value:l,gradFunc:c}});return n(t)}var eE=j({logSoftmax_:yee});function bee(r,e,t){for(var n=r.length+e.length,o=[],a=0,i=0,s=0;s<n;s++)t.indexOf(s)===-1?o.push(r[a++]):o.push(e[i++]);return o}function Hd(r,e){var t=e.map(function(n){return 1});return bee(r,t,e)}function wee(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","logSumExp"),o=Fd(e,n.shape),a=Cs(n,o,!0),i=it(n,a),s=Na(i),u=Ct(s,o),l=Qu(u),c=mr(ie(a,l.shape),l);if(t){var p=Hd(c.shape,o);return ie(c,p)}return c}var tE=j({logSumExp_:wee});function kee(r,e){var t=D(r,"a","logicalAnd","bool"),n=D(e,"b","logicalAnd","bool");Fr(t.shape,n.shape);var o={a:t,b:n};return q.runKernel(IY,o)}var tp=j({logicalAnd_:kee});function _ee(r){var e=D(r,"x","logicalNot","bool"),t={x:e};return q.runKernel(CY,t)}var Ly=j({logicalNot_:_ee});function See(r,e){var t=D(r,"a","logicalOr","bool"),n=D(e,"b","logicalOr","bool");Fr(t.shape,n.shape);var o={a:t,b:n};return q.runKernel(NY,o)}var Vy=j({logicalOr_:See});function Iee(r,e){var t=D(r,"a","logicalXor","bool"),n=D(e,"b","logicalXor","bool");return Fr(t.shape,n.shape),tp(Vy(r,e),Ly(tp(r,e)))}var Cee=j({logicalXor_:Iee});function Nee(r,e,t,n,o){var a=D(r,"x","maxPool"),i=1,s=a,u=!1;a.rank===3&&(u=!0,s=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]])),z(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),z(Ia(t,i),function(){return"Error in maxPool: Either strides or dilations must be 1. "+("Got strides "+t+" and dilations '"+i+"'")}),o!=null&&z(nn(n),function(){return"Error in maxPool: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o},p=q.runKernel(FY,l,c);return u?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Wy=j({maxPool_:Nee});function Eee(r,e,t,n,o,a){e===void 0&&(e=[1,1,1]),a===void 0&&(a="NDHWC");var i=D(r,"x","maxPool3d"),s=i,u=!1;i.rank===4&&(u=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),z(s.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+s.rank+"."}),z(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+("but got dataFormat of "+a)}),o!=null&&z(nn(n),function(){return"Error in maxPool3d: pad must be an integer when using, "+("dimRoundingMode "+o+" but got pad "+n+".")});var l={x:s},c={filterSize:e,strides:t,pad:n,dimRoundingMode:o,dataFormat:a},p=q.runKernel(DY,l,c);return u?ie(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var rE=j({maxPool3d_:Eee});function Tee(r,e,t,n,o){o===void 0&&(o=!1);var a=D(r,"x","maxPoolWithArgmax"),i={x:a},s={filterSize:e,strides:t,pad:n,includeBatchInIndex:o},u=q.runKernel(RY,i,s);return{result:u[0],indexes:u[1]}}var nE=j({maxPoolWithArgmax_:Tee});function Aee(r,e){var t,n=D(r,"a","maximum"),o=D(e,"b","maximum");t=we(rr(n,o),2),n=t[0],o=t[1],n.dtype==="bool"&&(n=nr(n,"int32"),o=nr(o,"int32")),Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(AY,a)}var oE=j({maximum_:Aee});function Fee(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","mean"),o={x:n},a={axis:e,keepDims:t};return q.runKernel($Y,o,a)}var rp=j({mean_:Fee});function Ns(r,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Ns(r,"float32"),n=Ns(r,"float32");return Ss(t,n)}var o=cy(rn(r),e);return q.makeTensor(o,r,e)}function Ta(r,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Ta(r,"float32"),n=Ns(r,"float32");return Ss(t,n)}var o=OC(rn(r),e);return q.makeTensor(o,r,e)}function Dee(r,e,t){var n=(t===void 0?{}:t).indexing,o=n===void 0?"xy":n;if(o!=="xy"&&o!=="ij")throw new TypeError(o+" is not a valid third argument to meshgrid");if(r===void 0)return[];var a=D(r,"x","meshgrid",r instanceof Gr?r.dtype:"float32");if(e===void 0)return[a];var i=D(e,"y","meshgrid",e instanceof Gr?e.dtype:"float32"),s=rn(a.shape),u=rn(i.shape);return o==="xy"?(a=ie(a,[1,-1]),i=ie(i,[-1,1]),[bt(Ta([u,1],a.dtype),a),bt(i,Ta([1,s],i.dtype))]):(a=ie(a,[-1,1]),i=ie(i,[1,-1]),[bt(a,Ta([1,u],a.dtype)),bt(Ta([s,1],i.dtype),i)])}function Ree(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","min"),o={x:n},a={axis:e,keepDims:t};return q.runKernel(PY,o,a)}var qd=j({min_:Ree});function $ee(r,e){var t,n=D(r,"a","minimum"),o=D(e,"b","minimum");t=we(rr(n,o),2),n=t[0],o=t[1],n.dtype==="bool"&&(n=nr(n,"int32"),o=nr(o,"int32")),Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(OY,a)}var zy=j({minimum_:$ee});function Pee(r,e,t){z(t==="reflect"||t==="symmetric",function(){return"Invalid mode. Mode must be either reflect or symmetric. "+("Got "+t+".")});var n=D(r,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");z(e.length===n.rank,function(){return"Padding doesn't match input. Must be "+n.rank+". "+("Got "+e.length+".")});for(var o=t==="reflect"?1:0,a=function(l){z(e[l].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),z(e[l][0]>=0&&e[l][0]<=n.shape[l]-o&&e[l][1]>=0&&e[l][1]<=n.shape[l]-o,function(){return"Padding in dimension "+l+" cannot be greater than or equal "+("to "+(n.shape[l]-o)+" or less than 0 for input of ")+("shape "+n.shape)})},i=0;i<n.rank;i++)a(i);var s={paddings:e,mode:t},u={x:n};return q.runKernel(MY,u,s)}var aE=j({mirrorPad_:Pee});function Oee(r,e){var t,n=D(r,"a","mod"),o=D(e,"b","mod");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel(BY,a)}var sE=j({mod_:Oee});function Mee(r){var e=D(r,"x","square"),t={};return q.runKernel("Square",{x:e},t)}var np=j({square_:Mee});function Bee(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1),r=D(r,"x","moments");var n=Fd(e,r.shape),o=rp(r,n,t),a=o.shape;t||(a=Hd(o.shape,n));var i=np(it(nr(r,"float32"),ie(o,a))),s=rp(i,n,t);return{mean:o,variance:s}}var Lee=j({moments_:Bee});function Vee(r,e,t,n){for(var o=D(e,"data","multiRNNCell"),a=Pd(t,"c","multiRNNCell"),i=Pd(n,"h","multiRNNCell"),s=o,u=[],l=0;l<r.length;l++){var c=r[l](s,a[l],i[l]);u.push(c[0]),u.push(c[1]),s=c[1]}for(var p=[],f=[],l=0;l<u.length;l+=2)p.push(u[l]),f.push(u[l+1]);return[p,f]}var Wee=j({multiRNNCell_:Vee});function zee(r,e,t,n){n===void 0&&(n=!1);var o=D(r,"logits","multinomial"),a=o.size,i=o.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+(a+"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+i);t=t||Math.random();var s=i===1?ie(o,[1,-1]):o,u={logits:s},l={numSamples:e,seed:t,normalized:n},c=q.runKernel(LY,u,l);return i===1?ie(c,[c.size]):c}var iE=j({multinomial_:zee});function Uee(r,e){var t,n=D(r,"a","notEqual","string_or_numeric"),o=D(e,"b","notEqual","string_or_numeric");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o};return q.runKernel(zY,a)}var Uy=j({notEqual_:Uee});function Gee(r,e,t,n){if(t===void 0&&(t=1),n===void 0&&(n=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var o=D(r,"indices","oneHot","int32"),a={indices:o},i={depth:e,onValue:t,offValue:n};return q.runKernel(qY,a,i)}var uE=j({oneHot_:Gee});function jee(r){var e=D(r,"x","onesLike"),t={x:e};return q.runKernel(HY,t)}var lE=j({onesLike_:jee});function Hee(r,e){var t=D(r,"v1","outerProduct"),n=D(e,"v2","outerProduct");z(t.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+(t.rank+" and "+n.rank+".")});var o=ie(t,[-1,1]),a=ie(n,[1,-1]);return bt(o,a)}var qee=j({outerProduct_:Hee});function Kee(r,e,t){t===void 0&&(t=0);var n=D(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:e,constantValue:t},a={x:n};return q.runKernel(XY,a,o)}var el=j({pad_:Kee});function Xee(r,e,t){return t===void 0&&(t=0),z(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),el(r,[e],t)}var Yee=j({pad1d_:Xee});function Zee(r,e,t){return t===void 0&&(t=0),z(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),el(r,e,t)}var Jee=j({pad2d_:Zee});function Qee(r,e,t){return t===void 0&&(t=0),z(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),el(r,e,t)}var ete=j({pad3d_:Qee});function tte(r,e,t){return t===void 0&&(t=0),z(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),el(r,e,t)}var rte=j({pad4d_:tte});function nte(r,e,t){var n=D(r,"x","spaceToBatchND");z(n.rank>=1+e.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+e.length}),z(t.length===e.length,function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length}),z(n.shape.reduce(function(i,s,u){return u>0&&u<=e.length?i&&(s+t[u-1][0]+t[u-1][1])%e[u-1]==0:i},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()});var o={x:n},a={blockShape:e,paddings:t};return q.runKernel(wZ,o,a)}var Gy=j({spaceToBatchND_:nte});function ote(r,e,t,n,o,a){o==null&&(o=[1,1]),a==null&&(a=1),n===0&&(n="valid");var i=D(r,"x","maxPool"),s=i,u=!1;i.rank===3&&(u=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]])),z(Ia(a,o),function(){return"Error in pool: Either strides or dilations must be 1. "+("Got strides "+a+" and dilations '"+o+"'")});var l=AJ(s.shape,e,a,o,n),c=[l.dilationHeight,l.dilationWidth],p;n==="same"?p=ste([l.filterHeight,l.filterWidth],c):p=[[0,0],[0,0]];var f=c[0]===1&&c[1]===1,d=we(ate([l.inHeight,l.inWidth],c,p),2),m=d[0],h=d[1],g=f?n:"valid",v=f?s:Gy(s,c,m),x=t==="avg"?function(){return Ey(v,e,a,g)}:function(){return Wy(v,e,a,g)},y=x(),b=f?y:Ty(y,c,h);return u?ie(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function ate(r,e,t){var n=t.map(function(c){return c[0]}),o=t.map(function(c){return c[1]}),a=r.concat(n,o),i=e.map(function(c,p){return(c-a[p]%c)%c}),s=o.map(function(c,p){return c+i[p]}),u=e.map(function(c,p){return[n[p],s[p]]}),l=e.map(function(c,p){return[0,i[p]]});return[u,l]}function ste(r,e){var t=r.map(function(i,s){return i+(i-1)*(e[s]-1)}),n=t.map(function(i){return i-1}),o=n.map(function(i){return Math.floor(i/2)}),a=n.map(function(i,s){return i-o[s]});return n.map(function(i,s){return[o[s],a[s]]})}var ite=j({pool_:ote});function ute(r,e){var t,n=D(r,"base","pow"),o=D(e,"exp","pow");t=we(rr(n,o),2),n=t[0],o=t[1];var a={a:n,b:o};return q.runKernel(YY,a)}var Kd=j({pow_:ute});function lte(r,e){var t=D(r,"x","prelu"),n=D(e,"alpha","prelu"),o={x:t,alpha:n};return q.runKernel(ZY,o)}var jy=j({prelu_:lte});function cte(r,e){e===void 0&&(e=!1),console.log(r.toString(e))}function pte(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=D(r,"x","prod");n.dtype==="bool"&&(n=nr(n,"int32"));var o={x:n},a={axis:e,keepDims:t};return q.runKernel(JY,o,a)}var Hy=j({prod_:pte});function fte(r,e,t){var n=rn(r),o=null;if(t==null||t==="float32")o=new Float32Array(n);else if(t==="int32")o=new Int32Array(n);else if(t==="bool")o=new Uint8Array(n);else throw new Error("Unknown data type "+t);for(var a=0;a<n;a++)o[a]=e();return q.makeTensor(o,r,t)}var dte=j({rand_:fte}),Es=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function mte(r){if(r.__esModule)return r;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(r).forEach(function(t){var n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:function(){return r[t]}})}),e}function Ts(r){var e={exports:{}};return r(e,e.exports),e.exports}var hte=Ts(function(r){(function(e,t,n){function o(u){var l=this,c=s();l.next=function(){var p=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=p-(l.c=p|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function a(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function i(u,l){var c=new o(u),p=l&&l.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&a(p,c),f.state=function(){return a(c,{})}),f}function s(){var u=4022871197,l=function(c){c=String(c);for(var p=0;p<c.length;p++){u+=c.charCodeAt(p);var f=.02519603282416938*u;u=f>>>0,f-=u,f*=u,u=f>>>0,f-=u,u+=f*4294967296}return(u>>>0)*23283064365386963e-26};return l}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.alea=i})(Es,r,!1)}),gte=Ts(function(r){(function(e,t,n){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var p=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^p^p>>>8},s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function i(s,u){var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(typeof c=="object"&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xor128=i})(Es,r,!1)}),vte=Ts(function(r){(function(e,t,n){function o(s){var u=this,l="";u.next=function(){var p=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(p^p<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function i(s,u){var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(typeof c=="object"&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xorwow=i})(Es,r,!1)}),xte=Ts(function(r){(function(e,t,n){function o(s){var u=this;u.next=function(){var c=u.x,p=u.i,f,d;return f=c[p],f^=f>>>7,d=f^f<<24,f=c[p+1&7],d^=f^f>>>10,f=c[p+3&7],d^=f^f>>>3,f=c[p+4&7],d^=f^f<<7,f=c[p+7&7],f=f^f<<13,d^=f^f<<9,c[p]=d,u.i=p+1&7,d};function l(c,p){var f,d=[];if(p===(p|0))d[0]=p;else for(p=""+p,f=0;f<p.length;++f)d[f&7]=d[f&7]<<15^p.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8&&(d[7]=-1),c.x=d,c.i=0,f=256;f>0;--f)c.next()}l(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function i(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(c.x&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xorshift7=i})(Es,r,!1)}),yte=Ts(function(r){(function(e,t,n){function o(s){var u=this;u.next=function(){var c=u.w,p=u.X,f=u.i,d,m;return u.w=c=c+1640531527|0,m=p[f+34&127],d=p[f=f+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,m=p[f]=m^d,u.i=f,m+(c^c>>>16)|0};function l(c,p){var f,d,m,h,g,v=[],x=128;for(p===(p|0)?(d=p,p=null):(p=p+"\0",d=0,x=Math.max(x,p.length)),m=0,h=-32;h<x;++h)p&&(d^=p.charCodeAt((h+32)%p.length)),h===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,h>=0&&(g=g+1640531527|0,f=v[h&127]^=d+g,m=f==0?m+1:0);for(m>=128&&(v[(p&&p.length||0)&127]=-1),m=127,h=4*128;h>0;--h)d=v[m+34&127],f=v[m=m+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,v[m]=d^f;c.w=g,c.X=v,c.i=m}l(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function i(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(c.X&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xor4096=i})(Es,r,!1)}),bte=Ts(function(r){(function(e,t,n){function o(s){var u=this,l="";u.next=function(){var p=u.b,f=u.c,d=u.d,m=u.a;return p=p<<25^p>>>7^f,f=f-d|0,d=d<<24^d>>>8^m,m=m-p|0,u.b=p=p<<20^p>>>12^f,u.c=f=f-d|0,u.d=d<<16^f>>>16^m,u.a=m-p|0},u.a=0,u.b=0,u.c=2654435769|0,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=s|0):l+=s;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function i(s,u){var l=new o(s),c=u&&u.state,p=function(){return(l.next()>>>0)/4294967296};return p.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,m=(f+d)/(1<<21);while(m===0);return m},p.int32=l.next,p.quick=p,c&&(typeof c=="object"&&a(c,l),p.state=function(){return a(l,{})}),p}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.tychei=i})(Es,r,!1)}),wte={},kte={__proto__:null,default:wte},_te=mte(kte),As=Ts(function(r){(function(e,t,n){var o=256,a=6,i=52,s="random",u=n.pow(o,a),l=n.pow(2,i),c=l*2,p=o-1,f;function d(b,k,N){var E=[];k=k==!0?{entropy:!0}:k||{};var T=v(g(k.entropy?[b,y(t)]:b==null?x():b,3),E),R=new m(E),$=function(){for(var O=R.g(a),M=u,B=0;O<l;)O=(O+B)*o,M*=o,B=R.g(1);for(;O>=c;)O/=2,M/=2,B>>>=1;return(O+B)/M};return $.int32=function(){return R.g(4)|0},$.quick=function(){return R.g(4)/4294967296},$.double=$,v(y(R.S),t),(k.pass||N||function(O,M,B,L){return L&&(L.S&&h(L,R),O.state=function(){return h(R,{})}),B?(n[s]=O,M):O})($,T,"global"in k?k.global:this==n,k.state)}function m(b){var k,N=b.length,E=this,T=0,R=E.i=E.j=0,$=E.S=[];for(N||(b=[N++]);T<o;)$[T]=T++;for(T=0;T<o;T++)$[T]=$[R=p&R+b[T%N]+(k=$[T])],$[R]=k;(E.g=function(O){for(var M,B=0,L=E.i,H=E.j,W=E.S;O--;)M=W[L=p&L+1],B=B*o+W[p&(W[L]=W[H=p&H+M])+(W[H]=M)];return E.i=L,E.j=H,B})(o)}function h(b,k){return k.i=b.i,k.j=b.j,k.S=b.S.slice(),k}function g(b,k){var N=[],E=typeof b,T;if(k&&E=="object")for(T in b)try{N.push(g(b[T],k-1))}catch(R){}return N.length?N:E=="string"?b:b+"\0"}function v(b,k){for(var N=b+"",E,T=0;T<N.length;)k[p&T]=p&(E^=k[p&T]*19)+N.charCodeAt(T++);return y(k)}function x(){try{var b;return f&&(b=f.randomBytes)?b=b(o):(b=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(b)),y(b)}catch(E){var k=e.navigator,N=k&&k.plugins;return[+new Date,e,N,e.screen,y(t)]}}function y(b){return String.fromCharCode.apply(0,b)}if(v(n.random(),t),r.exports){r.exports=d;try{f=_te}catch(b){}}else n["seed"+s]=d})(typeof self!="undefined"?self:Es,[],Math)});As.alea=hte;As.xor128=gte;As.xorwow=vte;As.xorshift7=xte;As.xor4096=yte;As.tychei=bte;var qy=As;var Ky=function(){function r(e,t,n,o,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);var i=a||Math.random();this.random=qy.alea(i.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,o=!1;!o;){var a=void 0,i=void 0,s=void 0;do a=2*this.random()-1,i=2*this.random()-1,s=a*a+i*i;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*i*u,(!this.truncated||this.isValidTruncated(t))&&(o=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)},r.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},r.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},r}(),Ste=function(){function r(e,t,n,o){this.alpha=e,this.beta=1/t,this.dtype=n;var a=o||Math.random();this.randu=qy.alea(a.toString()),this.randn=new Ky(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var e,t,n,o,a,i;;){do o=this.randn.nextValue(),i=1+this.c*o;while(i<=0);if(i*=i*i,e=o*o,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},r.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},r}(),Ite=function(){function r(e,t,n,o){var a=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=n,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=qy.alea(o)}return r.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r}();function Cte(r,e,t,n,o){if(t===void 0&&(t=1),n===void 0&&(n="float32"),t==null&&(t=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var a=new Ste(e,t,n,o),i=Ca(r,n),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}var Nte=j({randomGamma_:Cte});function Ete(r,e,t,n,o){if(e===void 0&&(e=0),t===void 0&&(t=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var a=new Ky(e,t,n,!1,o),i=Ca(r,n),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}var Tte=j({randomNormal_:Ete});function Ate(r,e,t,n,o){e===void 0&&(e=0),t===void 0&&(t=1),n===void 0&&(n="float32");for(var a=Ca(r,n),i=new Ite(e,t,null,o),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}var Xy=j({randomUniform_:Ate});function tl(r,e,t,n){if(t===void 0&&(t=1),n===void 0&&(n="float32"),t===0)throw new Error("Cannot have a step of zero");var o={start:r,stop:e,step:t,dtype:n};return q.runKernel(QY,{},o)}function Fte(r){var e=D(r,"input","real"),t={input:e};return q.runKernel(eZ,t)}var op=j({real_:Fte});function Dte(r){var e=D(r,"x","reciprocal"),t={x:e};return q.runKernel(tZ,t)}var cE=j({reciprocal_:Dte});function Rte(r){var e=D(r,"x","relu"),t={x:e};return q.runKernel(rZ,t)}var ap=j({relu_:Rte});function $te(r){var e=D(r,"x","relu6"),t={x:e};return q.runKernel(sZ,t)}var Yy=j({relu6_:$te});function Pte(r,e){var t=D(r,"x","reverse"),n={x:t},o={dims:e};return q.runKernel(iZ,n,o)}var Mo=j({reverse_:Pte});function Ote(r){var e=D(r,"x","reverse");return z(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),Mo(e,0)}var Mte=j({reverse1d_:Ote});function Bte(r,e){var t=D(r,"x","reverse");return z(t.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."}),Mo(t,e)}var Lte=j({reverse2d_:Bte});function Vte(r,e){var t=D(r,"x","reverse");return z(t.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."}),Mo(t,e)}var Wte=j({reverse3d_:Vte});function zte(r,e){var t=D(r,"x","reverse");return z(t.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."}),Mo(t,e)}var Ute=j({reverse4d_:zte});function Gte(r){var e=D(r,"x","round"),t={x:e};return q.runKernel(uZ,t)}var Zy=j({round_:Gte});function jte(r){var e=D(r,"x","rsqrt","float32"),t={x:e};return q.runKernel(lZ,t)}var pE=j({rsqrt_:jte});function Aa(r,e,t,n){if(n==null&&(n=uy(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!oo(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){MC(e);var o=rn(e),a=rn(t);z(o===a,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+(o+" values but has "+a)});for(var i=0;i<t.length;++i){var s=t[i],u=i===t.length-1?s!==rn(e.slice(i)):!0;z(t[i]===e[i]||!u,function(){return"Error creating a new Tensor. Inferred shape "+("("+t+") does not match the provided ")+("shape ("+e+"). ")})}}return!oo(r)&&!Array.isArray(r)&&(r=[r]),e=e||t,r=n!=="string"?uN(r,n):Td(r,[],!0),q.makeTensor(r,e,n)}function Nt(r,e){if((oo(r)&&e!=="string"||Array.isArray(r))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&oo(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var t=[],n=[];return Aa(r,t,n,e)}function Hte(r){var e=D(r,"x","selu"),t={x:e};return q.runKernel(fZ,t)}var fE=j({selu_:Hte});function qte(r,e,t,n,o,a,i){a===void 0&&(a=[1,1]),i===void 0&&(i="NHWC");var s=D(r,"x","separableConv2d"),u=D(e,"depthwiseFilter","separableConv2d"),l=D(t,"pointwiseFilter","separableConv2d"),c=s,p=!1;if(s.rank===3&&(p=!0,c=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");z(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got "+("rank "+c.rank+".")}),z(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+("got rank "+u.rank+".")}),z(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+("got rank "+u.rank+".")}),z(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter "+(" must be 1, but got "+l.shape[0]+".")}),z(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise "+("filter must be 1, but got "+l.shape[1]+".")});var f=u.shape[2],d=u.shape[3];z(l.shape[2]===f*d,function(){return"Error in separableConv2d: the third dimension of pointwise filter "+("must be "+f*d+", ")+("but got "+l.shape[2]+".")});var m=Vd(c,u,n,o,i,a),h=1,g=Qc(m,l,h,"valid",i);return p?ie(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var Kte=j({separableConv2d_:qte});function Xte(r,e){return wt(this,void 0,void 0,function(){var t,n,o,a,i,s,u,l,c,u,p;return yt(this,function(f){switch(f.label){case 0:return t=D(r,"x","setdiff1d"),n=D(e,"y","setdiff1d"),z(t.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+n.dtype+")."}),z(t.rank===1,function(){return"x should be 1D tensor, but got x ("+t.shape+")."}),z(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,t.data()];case 1:return o=f.sent(),[4,n.data()];case 2:for(a=f.sent(),i=new Set(a),s=0,u=0;u<o.length;u++)i.has(o[u])||s++;for(l=new xy([s],t.dtype),c=new xy([s],"int32"),u=0,p=0;u<o.length;u++)i.has(o[u])||(l.values[p]=o[u],c.values[p]=u,p++);return[2,[l.toTensor(),c.toTensor()]]}})})}var dE=Xte;function Yte(r){var e=D(r,"x","sign"),t={x:e};return q.runKernel(gZ,t)}var mE=j({sign_:Yte});function Zte(r){var e=D(r,"x","sin","float32"),t={x:e};return q.runKernel(mZ,t)}var hE=j({sin_:Zte});function Jte(r){var e=D(r,"x","sinh"),t={x:e};return q.runKernel(hZ,t)}var gE=j({sinh_:Jte});function Qte(r,e,t){var n=D(r,"x","slice1d");return z(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),Lt(n,[e],[t])}var ere=j({slice1d_:Qte});function tre(r,e,t){var n=D(r,"x","slice2d");return z(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),Lt(n,e,t)}var rre=j({slice2d_:tre});function nre(r,e,t){var n=D(r,"x","slice3d");return z(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),Lt(n,e,t)}var ore=j({slice3d_:nre});function are(r,e,t){var n=D(r,"x","slice4d");return z(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),Lt(n,e,t)}var sre=j({slice4d_:are});function ire(r,e){e===void 0&&(e=-1);var t=D(r,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+("Logits was rank "+t.rank+" and dim was "+e));var n={logits:t},o={dim:e};return q.runKernel(_Z,n,o)}var vE=j({softmax_:ire});function ure(r){z(r.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 "+("but got "+r.dtype+".")});var e={input:r};return q.runKernel(oY,e)}var Xd=j({fft_:ure});function lre(r){z(r.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 "+("but got "+r.dtype+".")});var e={input:r};return q.runKernel(mY,e)}var sp=j({ifft_:lre});function cre(r){var e=r.shape[r.shape.length-1],t=r.size/e,n;if(e<=2){var o=ie(r,[t,e]);n=sp(o)}else{var a=[t,2*(e-1)],i=ie(op(r),[t,e]),s=ie(Gd(r),[t,e]),u=Mo(Lt(i,[0,1],[t,e-2]),1),l=He(Mo(Lt(s,[0,1],[t,e-2]),1),Nt(-1)),c=jr([i,u],1),p=jr([s,l],1),o=ie(Ss(c,p),[a[0],a[1]]);n=sp(o)}if(n=op(n),r.rank===3&&r.shape[0]!==0){var f=n,d=r.shape[0];n=ie(n,[d,n.shape[0]/d,n.shape[1]]),f.dispose()}return n}var Jy=j({irfft_:cre});function pre(r,e,t){t===void 0&&(t=0);var n=D(r,"x","split"),o={x:n},a={numOrSizeSplits:e,axis:t};return q.runKernel(kZ,o,a)}var rl=j({split_:pre});function fre(r,e){z(r.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+r.dtype});var t=r.shape[r.shape.length-1],n=r.size/t,o;if(e!=null&&e<t){var a=r.shape.map(function(v){return 0}),i=r.shape.map(function(v){return v});i[r.shape.length-1]=e,o=Lt(r,a,i),t=e}else if(e!=null&&e>t){var s=r.shape.map(function(v){return v});s[r.shape.length-1]=e-t,o=jr([r,Ns(s)],r.shape.length-1),t=e}else o=r;var u=Wd(o),l=ie(Ss(o,u),[n,t]),c=Xd(l),p=Math.floor(t/2)+1,f=op(c),d=Gd(c),m=rl(f,[p,t-p],f.shape.length-1),h=rl(d,[p,t-p],d.shape.length-1),g=o.shape.slice();return g[o.shape.length-1]=p,ie(Ss(m[0],h[0]),g)}var Yd=j({rfft_:fre});function dre(r){var e=D(r,"x","sqrt","float32"),t={x:e};return q.runKernel(yZ,t)}var Zd=j({sqrt_:dre});function mre(r,e){var t,n=D(r,"a","squaredDifference"),o=D(e,"b","squaredDifference");t=we(rr(n,o),2),n=t[0],o=t[1],Fr(n.shape,o.shape);var a={a:n,b:o},i={};return q.runKernel(TZ,a,i)}var Qy=j({squaredDifference_:mre});function hre(r,e){var t=D(r,"x","squeeze");return ie(t,YX(t.shape,e).newShape)}var nl=j({squeeze_:hre});function gre(r,e){e===void 0&&(e=0);var t=Pd(r,"tensors","stack","string_or_numeric");z(t.length>=1,function(){return"Pass at least one tensor to tf.stack"}),t.length>0&&z(e<=t[0].rank,function(){return"Axis must be <= rank of the tensor"});var n=t,o={axis:e};return q.runKernel(KY,n,o)}var ol=j({stack_:gre});function vre(r,e){e===void 0&&(e=0);var t=D(r,"x","step"),n={x:t},o={alpha:e};return q.runKernel(GZ,n,o)}var xE=j({step_:vre});function xre(r,e,t,n,o,a,i,s,u){o===void 0&&(o=0),a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),u===void 0&&(u=0);var l=D(r,"x","stridedSlice","string_or_numeric"),c={x:l},p={begin:e,end:t,strides:n,beginMask:o,endMask:a,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:u};return q.runKernel(AZ,c,p)}var yE=j({stridedSlice_:xre});function yre(r){var e=D(r,"x","tan","float32"),t={x:e};return q.runKernel(PZ,t)}var bE=j({tan_:yre});function eb(r,e,t){var n=Sa(r,t);return Aa(r,e,n,t)}function gn(r,e){qu(r);var t=Sa(r,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var n=null;return Aa(r,n,t,e)}function ip(r,e,t){if(qu(r),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=Sa(r,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Aa(r,e,n,t)}function bre(r,e,t){if(qu(r),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=Sa(r,t);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Aa(r,e,n,t)}function wre(r,e,t){if(qu(r),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=Sa(r,t);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Aa(r,e,n,t)}function kre(r,e,t){if(qu(r),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=Sa(r,t);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Aa(r,e,n,t)}function _re(r,e,t){if(qu(r),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=Sa(r,t);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||n,Aa(r,e,n,t)}function Sre(r,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var n=D(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=n.shape[n.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got "+e);if(e>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") "+("but got "+e));var a={x:n},i={k:e,sorted:t},s=we(q.runKernel(MZ,a,i),2),u=s[0],l=s[1];return{values:u,indices:l}}var wE=j({topk_:Sre});function Ire(r,e,t,n,o){if(e===void 0&&(e=0),t===void 0&&(t=1),n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new Ky(e,t,n,!0,o),i=Ca(r,n),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}var kE=j({truncatedNormal_:Ire});function Cre(r,e){e===void 0&&(e=0);var t=D(r,"x","unique","string_or_numeric");z(t.rank>0,function(){return"The input tensor must be at least 1D"});var n={x:t},o={axis:e},a=we(q.runKernel(VZ,n,o),2),i=a[0],s=a[1];return{values:i,indices:s}}var tb=j({unique_:Cre});function Nre(r,e,t){var n=D(r,"x","unsortedSegmentSum"),o=D(e,"segmentIds","unsortedSegmentSum","int32");z(nn(t),function(){return"numSegments must be of dtype int"});var a={x:n,segmentIds:o},i={numSegments:t};return q.runKernel(zZ,a,i)}var Ere=j({unsortedSegmentSum_:Nre});function Tre(r,e){e===void 0&&(e=0);var t=D(r,"x","unstack","string_or_numeric");z(e>=-t.shape.length&&e<t.shape.length,function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"});var n={value:t},o={axis:e};return q.runKernel(WZ,n,o)}var Jd=j({unstack_:Tre});function Are(r,e,t,n){return e===void 0&&(e=!0),q.makeVariable(r,e,t,n)}function Fre(r,e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(n);for(var o=Ca(r,"int32"),a=Ca([t.length,r.length],"int32"),n=0;n<t.length;n++){var i=o.indexToLoc(t[n]),s=n*r.length;a.values.set(i,s)}return a.toTensor()}function Dre(r){return wt(this,void 0,void 0,function(){var e,t,n;return yt(this,function(o){switch(o.label){case 0:return e=D(r,"condition","whereAsync","bool"),[4,e.data()];case 1:return t=o.sent(),n=Fre(e.shape,t),r!==e&&e.dispose(),[2,n]}})})}var rb=Dre;function Rre(r,e,t){return wt(this,void 0,void 0,function(){var n,o,a,i,s,u,l,c,p,f,d,m,h;return yt(this,function(g){switch(g.label){case 0:for(n=D(r,"tensor","boolMask"),o=D(e,"mask","boolMask","bool"),a=t==null?0:t,i=o.rank,s=n.shape,z(i>0,function(){return"mask cannot be scalar"}),In(s.slice(a,a+i),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+i;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+i)),p=ie(n,c),f=ie(o,[-1]),[4,rb(f)];case 1:return d=g.sent(),m=nl(d,[1]),h=Ud(p,m,a),r!==n&&n.dispose(),e!==o&&o.dispose(),m.dispose(),p.dispose(),f.dispose(),d.dispose(),[2,h]}})})}var $re=Rre;function Pre(r,e){var t=D(r,"x","transpose");if(e==null&&(e=t.shape.map(function(a,i){return i}).reverse()),z(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" "+("must match length of perm "+e+".")}),e.forEach(function(a){z(a>=0&&a<t.rank,function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+(" but got "+e)})}),t.rank<=1)return t.clone();var n={x:t},o={perm:e};return q.runKernel(LZ,n,o)}var Qd=j({transpose_:Pre});function Ore(r,e,t,n){e===void 0&&(e="euclidean"),t===void 0&&(t=null),n===void 0&&(n=!1),r=D(r,"x","norm");var o=_E(r,e,t),a=o.shape;if(n){var i=Fd(t,r.shape);a=Hd(o.shape,i)}return ie(o,a)}function _E(r,e,t){if(t===void 0&&(t=null),r.rank===0)return hn(r);if(r.rank!==1&&t===null)return _E(ie(r,[-1]),e,t);if(r.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Ct(hn(r),t);if(e===1/0)return Cs(hn(r),t);if(e===-1/0)return qd(hn(r),t);if(e==="euclidean"||e===2)return Zd(Ct(Kd(hn(r),Nt(2,"int32")),t));throw new Error("Error in norm: invalid ord value: "+e)}if(Array.isArray(t)&&t.length===2){if(e===1)return Cs(Ct(hn(r),t[0]),t[1]-1);if(e===1/0)return Cs(Ct(hn(r),t[1]),t[0]);if(e===-1/0)return qd(Ct(hn(r),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Zd(Ct(np(r),t));throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+t)}var nb=j({norm_:Ore});function Mre(r,e,t,n,o){o===void 0&&(o=!0);var a=D(r,"v","movingAverage"),i=D(e,"x","movingAverage"),s=D(t,"decay","movingAverage");cJ(a,i),z(ys(a.shape,i.shape),function(){return"Shape mismatch in v and x"});var u=Nt(1),l=it(u,s),c=He(it(i,a),l);if(o){z(n!=null,function(){return"When using zeroDebias: true, step is required."});var p=D(n,"step","movingAverage");c=Ar(c,it(u,Kd(s,p)))}return mr(a,c)}var Bre=j({movingAverage_:Mre});function Lre(r,e,t){var n=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+("shape[sliceDim:], got updates.shape: "+t.shape)+(", indices.shape: "+e.shape+", shape: "+r)+(", sliceDim: "+n+", and batchDim: "+o+".");if(t.rank<o)throw new Error(a+(" update.rank < "+o+". "));if(r.length<n+(t.rank-o))throw new Error(a+(" Output shape length < "+(n+(t.rank-o))));if(t.rank!==o+r.length-n)throw new Error(a+(" update.rank != "+(o+r.length-n)));for(var i=0;i<o;++i)if(t.shape[i]!==e.shape[i])throw new Error(a+(" updates.shape["+i+"] ("+t.shape[i]+") != indices.shape["+i+"] ("+e.shape[i]+")."));for(var i=0;i<t.rank-o;++i)if(t.shape[i+o]!==r[i+n])throw new Error(a+(" updates.shape["+(i+o)+"] ("+t.shape[i+o]+") != shape["+(i+o)+"] ("+r[i+o]+")"))}function Vre(r,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+(" but the rank was "+e.rank+"."));if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+(" but the rank was "+r.rank+"."));if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}Lre(t,e,r)}function Wre(r,e,t){var n=D(r,"indices","scatterND","int32"),o=D(e,"updates","scatterND");Vre(o,n,t);var a={indices:n,updates:o},i={shape:t};return q.runKernel(cZ,a,i)}var SE=j({scatterND_:Wre});function zre(r,e,t,n){if(r.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+(" but the dtype was "+r.dtype+"."));if(r.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+(" but got shape "+r.shape+"."));var o=r.rank>0?r.shape[0]:1,a=r.rank>1?r.shape[1]:1;if(t.length!==a)throw new Error("outputShape has incorrect number of elements:,"+(" "+t.length+", should be: "+a+"."));var i=e.size;if(!(e.rank===0||e.rank===1&&i===o))throw new Error("sparseValues has incorrect shape "+(e.shape+", should be [] or ["+o+"]"));if(e.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function Ure(r,e,t,n){n===void 0&&(n=0);var o=D(r,"sparseIndices","sparseToDense","int32"),a=D(e,"sparseValues","sparseToDense"),i=D(n,"defaultValue","sparseToDense",a.dtype);zre(o,a,t,i);var s={sparseIndices:o,sparseValues:a,defaultValue:i},u={outputShape:t};return q.runKernel(EZ,s,u)}var ob=j({sparseToDense_:Ure});function Gre(r,e){var t=D(e,"indices","gatherND","int32"),n=D(r,"x","gatherND","string_or_numeric"),o={params:n,indices:t};return q.runKernel(pY,o)}var IE=j({gatherND_:Gre});function jre(r,e){if(e==null)return r.shape.slice();if(ys(r.shape,e))return e;if(r.shape.length===e.length){for(var t=[],n=0;n<r.shape.length;n++)e[n]==null&&r.shape[n]!=null?t.push(r.shape[n]):t.push(e[n]);return t}return e}function Hre(r,e,t,n){var o=D(r,"x","dropout");if(z(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be "+("scaled, but got a "+o.dtype+" tensor instead.")}),z(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return r instanceof Gr?o.clone():o;var a=jre(o,t),i=1-e,s=Ar($y(mr(Xy(a,0,1,"float32",n),i)),i);return He(o,s)}var qre=j({dropout_:Hre});function CE(r){return Math.floor(Math.pow(2,Math.ceil(Math.log(r)/Math.log(2))))}function ab(r,e,t){for(var n=1-r%2,o=new Float32Array(r),a=0;a<r;++a){var i=2*Math.PI*a/(r+n-1);o[a]=e-t*Math.cos(i)}return gn(o,"float32")}function Kre(r,e,t){return t===void 0&&(t=1),wt(this,void 0,void 0,function(){var n,o,a,i,s,u,l,c,p,f,d,m,h,g,g;return yt(this,function(v){switch(v.label){case 0:return n=D(r,"predictions","inTopK"),o=D(e,"targets","inTopK"),z(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+("but got "+n.rank)}),z(n.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+(n.rank+" and targets rank "+o.rank)}),In(n.shape.slice(0,n.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=n.shape[n.shape.length-1],z(t>0&&t<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+("dimension ("+a+"), but got "+t)}),[4,n.data()];case 1:return i=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=we([i.length/a,a],2),l=u[0],c=u[1],p=ZX("bool",l),f=0;f<l;f++){for(d=f*c,m=i.subarray(d,d+c),h=[],g=0;g<m.length;g++)h.push({value:m[g],index:g});for(h.sort(function(x,y){return y.value-x.value}),p[f]=0,g=0;g<t;g++)if(h[g].index===s[f]){p[f]=1;break}}return r!==n&&n.dispose(),e!==o&&o.dispose(),[2,eb(p,o.shape,"bool")]}})})}var Xre=Kre;function Yre(r,e,t,n,o,a,i){a===void 0&&(a="NHWC");var s=r;r.rank===3&&(s=ie(r,[1,r.shape[0],r.shape[1],r.shape[2]]));var u=e;u.rank===3&&(u=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]])),z(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+(s.shape+".")}),z(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+(u.shape+".")}),z(t.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+(t+".")});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];z(l===t[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must "+("match input depth in filter ("+t[2]+".")}),z(c===t[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must "+("match output depth for filter ("+t[3]+").")}),i!=null&&z(nn(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+("dimRoundingMode "+i+" but got pad "+o+".")});var p={x:s,dy:u},f={strides:n,pad:o,dataFormat:a,dimRoundingMode:i,filterShape:t};return q.runKernel(P9,p,f)}var Zre=j({conv2DBackpropFilter_:Yre});function sb(r,e,t){if(t==null||t==="linear")return r;if(t==="relu")return He(r,xE(e));throw new Error("Cannot compute gradient for fused activation "+t+".")}function ib(r,e){var t=e,n=PQ(r.shape,e.shape);return n.length>0&&(t=Ct(t,n)),ie(t,r.shape)}function ub(r,e,t,n){if(e==="linear")return r;if(e==="relu")return ap(r);if(e==="elu")return Ry(r);if(e==="relu6")return Yy(r);if(e==="prelu")return jy(r,t);if(e==="leakyrelu")return Oy(r,n);if(e==="sigmoid")return _s(r);throw new Error("Unknown fused activation "+e+".")}var lb=function(r,e){var t=r>0;return!t||e==="linear"};function Jre(r){var e,t=r.x,n=r.filter,o=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,u=r.dilations,l=u===void 0?[1,1]:u,c=r.dimRoundingMode,p=r.bias,f=r.activation,d=f===void 0?"linear":f,m=r.preluActivationWeights,h=r.leakyreluAlpha;if(d=d||"linear",lb(q.state.gradientDepth,d)===!1){var g=Qc(t,n,o,a,s,l,c);return p!=null&&(g=mr(g,p)),ub(g,d,m,h)}var v=D(t,"x","conv2d","float32"),x=D(n,"filter","conv2d","float32"),y=v,b=!1;v.rank===3&&(b=!0,y=ie(v,[1,v.shape[0],v.shape[1],v.shape[2]])),z(y.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+(y.rank+".")}),z(x.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+(x.rank+".")}),c!=null&&z(nn(a),function(){return"Error in fused conv2d: pad must be an integer when using, "+("dimRoundingMode "+c+" but got pad "+a+".")}),z(y.shape[3]===x.shape[2],function(){return"Error in conv2d: depth of input ("+y.shape[3]+") must match "+("input depth for filter "+x.shape[2]+".")}),z(Ia(o,l),function(){return"Error in conv2D: Either strides or dilations must be 1. "+("Got strides "+o+" and dilations '"+l+"'")}),z(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var k=Cy(y.shape,x.shape,o,l,a,c),N;p!=null&&(N=D(p,"bias","fused conv2d"),e=we(rr(N,v),1),N=e[0],Fr(k.outShape,N.shape));var E;m!=null&&(E=D(m,"prelu weights","fused conv2d"));var T=function(B,L){var H=we(L,4),W=H[0],K=H[1],J=H[2],Q=H[3],ee=sb(B,J,d);z(Bd(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+("are not yet supported in gradients. Got dilations '"+l+"'")});var Y=ON(K.shape,ee,W,o,a),ne=Zre(K,ee,W.shape,o,a),te=[Y,ne];if(Q!=null){var ce=ib(Q,ee);te.push(ce)}return te},R={x:y,filter:x,bias:N,preluActivationWeights:E},$={strides:o,pad:a,dataFormat:s,dilations:l,dimRoundingMode:c,activation:d,leakyreluAlpha:h};if(p==null){var O=Po(function(B,L,H){var W=q.runKernel(qC,R,$);return H([L,B,W]),b&&(W=ie(W,[W.shape[1],W.shape[2],W.shape[3]])),{value:W,gradFunc:T}});return O(y,x)}else{var M=Po(function(B,L,H,W){var K=q.runKernel(qC,R,$);return W([L,B,K,H]),b&&(K=ie(K,[K.shape[1],K.shape[2],K.shape[3]])),{value:K,gradFunc:T}});return M(y,x,N)}}var NE=j({fusedConv2d_:Jre});function Qre(r,e,t,n,o,a,i){a===void 0&&(a=[1,1]);var s=r;r.rank===3&&(s=ie(r,[1,r.shape[0],r.shape[1],r.shape[2]]));var u=e;u.rank===3&&(u=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var l={x:s,dy:u},c={strides:n,pad:o,dimRoundingMode:i,dilations:a,filterShape:t};return q.runKernel(H9,l,c)}var ene=j({depthwiseConv2dNativeBackpropFilter_:Qre});function tne(r,e,t,n,o,a,i){a===void 0&&(a=[1,1]);var s=e,u=!1;e.rank===3&&(u=!0,s=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var l={dy:s,filter:t},c={strides:n,pad:o,dimRoundingMode:i,dilations:a,inputShape:r},p=q.runKernel(q9,l,c);return u?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var rne=j({depthwiseConv2dNativeBackpropInput_:tne});function nne(r){var e,t=r.x,n=r.filter,o=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,u=r.dilations,l=u===void 0?[1,1]:u,c=r.dimRoundingMode,p=r.bias,f=r.activation,d=f===void 0?"linear":f,m=r.preluActivationWeights,h=r.leakyreluAlpha;if(lb(q.state.gradientDepth,d)===!1){var g=Vd(t,n,o,a,s,l,c);return p!=null&&(g=mr(g,p)),ub(g,d,m,h)}var v=D(t,"x","depthwiseConv2d","float32"),x=D(n,"filter","depthwiseConv2d","float32"),y=v,b=!1;v.rank===3&&(b=!0,y=ie(v,[1,v.shape[0],v.shape[1],v.shape[2]])),z(y.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+("rank "+y.rank+".")}),z(x.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+("but got rank "+x.rank+".")}),z(y.shape[3]===x.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels "+("("+y.shape[3]+") must match the inChannels dimension in ")+("filter "+x.shape[2]+".")}),l==null&&(l=[1,1]),z(Ia(o,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+("be 1. Got strides "+o+" and dilations '"+l+"'")}),c!=null&&z(nn(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+("using dimRoundingMode "+c+" but got pad "+a+".")});var k=Cy(y.shape,x.shape,o,l,a,c,!0),N;p!=null&&(N=D(p,"bias","fused conv2d"),e=we(rr(N,v),1),N=e[0],Fr(k.outShape,N.shape));var E;m!=null&&(E=D(m,"prelu weights","fused depthwiseConv2d"));var T=function(B,L){z(Bd(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+("'"+l+"'")});var H=we(L,4),W=H[0],K=H[1],J=H[2],Q=H[3],ee=sb(B,J,d),Y=rne(K.shape,ee,W,o,a,l,c),ne=ene(K,ee,W.shape,o,a,l,c);if(Q!=null){var te=ib(N,ee);return[Y,ne,te]}return[Y,ne]},R={x:y,filter:x,bias:N,preluActivationWeights:E},$={strides:o,pad:a,dataFormat:s,dilations:l,dimRoundingMode:c,activation:d,leakyreluAlpha:h};if(p==null){var O=Po(function(B,L,H){var W=q.runKernel(KC,R,$);return H([L,B,W]),b&&(W=ie(W,[W.shape[1],W.shape[2],W.shape[3]])),{value:W,gradFunc:T}});return O(y,x)}else{var M=Po(function(B,L,H,W){var K=q.runKernel(KC,R,$);return W([L,B,K,H]),b&&(K=ie(K,[K.shape[1],K.shape[2],K.shape[3]])),{value:K,gradFunc:T}});return M(y,x,N)}}var EE=j({fusedDepthwiseConv2d_:nne});function one(r){var e,t,n=r.a,o=r.b,a=r.transposeA,i=a===void 0?!1:a,s=r.transposeB,u=s===void 0?!1:s,l=r.bias,c=r.activation,p=c===void 0?"linear":c,f=r.preluActivationWeights,d=r.leakyreluAlpha;if(lb(q.state.gradientDepth,p)===!1){var m=bt(n,o,i,u);return l!=null&&(m=mr(m,l)),ub(m,p,f,d)}var h=D(n,"a","fused matMul"),g=D(o,"b","fused matMul");e=we(rr(h,g),2),h=e[0],g=e[1];var v=i?h.shape[h.rank-2]:h.shape[h.rank-1],x=u?g.shape[g.rank-1]:g.shape[g.rank-2],y=i?h.shape[h.rank-1]:h.shape[h.rank-2],b=u?g.shape[g.rank-2]:g.shape[g.rank-1],k=h.shape.slice(0,-2),N=g.shape.slice(0,-2),E=rn(k),T=rn(N);z(h.rank>=2&&g.rank>=2&&h.rank===g.rank,function(){return"Error in fused matMul: inputs must have the same rank of at "+("least 2, got ranks "+h.rank+" and "+g.rank+".")}),z(ys(k,N),function(){return"Error in fused matMul: outer dimensions ("+k+") and ("+(N+") of Tensors with shapes "+h.shape+" and ")+(g.shape+" must match.")}),z(v===x,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+(x+") of Tensors with shapes "+h.shape+" and ")+(g.shape+" and transposeA="+i)+(" and transposeB="+u+" must match.")});var R=h.shape.slice(0,-2).concat([y,b]),$=i?ie(h,[E,v,y]):ie(h,[E,y,v]),O=u?ie(g,[T,b,x]):ie(g,[T,x,b]),M;l!=null&&(M=D(l,"bias","fused matMul"),t=we(rr(M,h),1),M=t[0],Fr(R,M.shape));var B;f!=null&&(B=D(f,"prelu weights","fused matMul"));var L=function(Q,ee){var Y=we(ee,4),ne=Y[0],te=Y[1],ce=Y[2],pe=Y[3],se=sb(ie(Q,ce.shape),ce,p),fe,ye;if(!i&&!u?(fe=bt(se,te,!1,!0),ye=bt(ne,se,!0,!1)):!i&&u?(fe=bt(se,te,!1,!1),ye=bt(se,ne,!0,!1)):i&&!u?(fe=bt(te,se,!1,!0),ye=bt(ne,se,!1,!1)):(fe=bt(te,se,!0,!0),ye=bt(se,ne,!0,!0)),l!=null){var _e=ib(pe,se);return[fe,ye,_e]}else return[fe,ye]},H={a:$,b:O,bias:M,preluActivationWeights:B},W={transposeA:i,transposeB:u,activation:p,leakyreluAlpha:d};if(l==null){var K=Po(function(Q,ee,Y){var ne=q.runKernel(HC,H,W);return Y([Q,ee,ne]),{value:ie(ne,R),gradFunc:L}});return K($,O)}else{var J=Po(function(Q,ee,Y,ne){var te=q.runKernel(HC,H,W);return ne([Q,ee,te,Y]),{value:ie(te,R),gradFunc:L}});return J($,O,M)}}var TE=j({fusedMatMul_:one});var ane={__proto__:null,conv2d:NE,depthwiseConv2d:EE,matMul:TE};function sne(r){return ab(r,.54,.46)}var ine=j({hammingWindow_:sne});function une(r){return ab(r,.5,.5)}var AE=j({hannWindow_:une});function lne(r,e,t,n,o){n===void 0&&(n=!1),o===void 0&&(o=0);for(var a=0,i=[];a+e<=r.size;)i.push(Lt(r,a,e)),a+=t;if(n)for(;a<r.size;){var s=a+e-r.size,u=jr([Lt(r,a,e-s),zd([s],o)]);i.push(u),a+=t}return i.length===0?ip([],[0,e]):ie(jr(i),[i.length,e])}var FE=j({frame_:lne});function cne(r,e,t,n,o){o===void 0&&(o=AE),n==null&&(n=CE(e));var a=FE(r,e,t),i=He(a,o(e));return Yd(i,n)}var pne=j({stft_:cne});function fne(r,e,t,n,o,a){o===void 0&&(o="bilinear"),a===void 0&&(a=0);var i=D(r,"image","cropAndResize"),s=D(e,"boxes","cropAndResize","float32"),u=D(t,"boxInd","cropAndResize","int32"),l=s.shape[0];z(i.rank===4,function(){return"Error in cropAndResize: image must be rank 4,"+("but got rank "+i.rank+".")}),z(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] "+("but had shape "+s.shape+".")}),z(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] "+("but had shape "+s.shape+".")}),z(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+("length "+n.length+".")}),z(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),z(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o});var c={image:i,boxes:s,boxInd:u},p={method:o,extrapolationValue:a,cropSize:n},f=q.runKernel(z9,c,p);return f}var dne=j({cropAndResize_:fne});function mne(r){var e=D(r,"image","flipLeftRight","float32");z(e.rank===4,function(){return"Error in flipLeftRight: image must be rank 4,"+("but got rank "+e.rank+".")});var t={image:e},n=q.runKernel(sY,t,{});return n}var hne=j({flipLeftRight_:mne});function gne(r){var e=D(r,"image","grayscaleToRGB"),t=e.rank-1,n=e.shape[t];z(e.rank>=2,function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+("but got rank "+e.rank+".")}),z(n===1,function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+("should be size 1, but got size "+n+".")});var o=new Array(e.rank);return o.fill(1,0,t),o[t]=3,Ju(e,o)}var vne=j({grayscaleToRGB_:gne});function xne(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=.5);var o=D(r,"image","rotateWithOffset","float32");z(o.rank===4,function(){return"Error in rotateWithOffset: image must be rank 4,"+("but got rank "+o.rank+".")});var a={image:o},i={radians:e,fillValue:t,center:n},s=q.runKernel(jZ,a,i);return s}var yne=j({rotateWithOffset_:xne});function al(r,e,t,n,o,a){n==null&&(n=.5),o==null&&(o=Number.NEGATIVE_INFINITY),a==null&&(a=0);var i=r.shape[0];return t=Math.min(t,i),z(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),z(r.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"}),z(r.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]}),z(e.rank===1,function(){return"scores must be a 1D tensor"}),z(e.shape[0]===i,function(){return"scores has incompatible shape with boxes. Expected "+i+", "+("but was "+e.shape[0])}),z(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:t,iouThreshold:n,scoreThreshold:o,softNmsSigma:a}}function bne(r,e,t,n,o){n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var a=D(r,"boxes","nonMaxSuppression","float32"),i=D(e,"scores","nonMaxSuppression","float32"),s=al(a,i,t,n,o);t=s.maxOutputSize,n=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:t,iouThreshold:n,scoreThreshold:o};return q.runKernel(UY,{boxes:a,scores:i},u)}var wne=j({nonMaxSuppression_:bne});function kne(r,e,t){var n=_ne(r,e,t),o=n<0?-(n+1):n;r.splice(o,0,e)}function _ne(r,e,t){return Ine(r,e,t||Sne)}function Sne(r,e){return r>e?1:r<e?-1:0}function Ine(r,e,t){for(var n=0,o=r.length,a=0,i=!1;n<o;){a=n+(o-n>>>1);var s=t(e,r[a]);s>0?n=a+1:(o=a,i=!s)}return i?n:-n-1}function Cne(r,e,t,n,o){return cb(r,e,t,n,o,0)}function Nne(r,e,t,n,o,a){return cb(r,e,t,n,o,0,!1,a,!0)}function Ene(r,e,t,n,o,a){return cb(r,e,t,n,o,a,!0)}function cb(r,e,t,n,o,a,i,s,u){i===void 0&&(i=!1),s===void 0&&(s=!1),u===void 0&&(u=!1);for(var l=[],c=0;c<e.length;c++)e[c]>o&&l.push({score:e[c],boxIndex:c,suppressBeginIndex:0});l.sort(DE);for(var p=a>0?-.5/a:0,f=[],d=[];f.length<t&&l.length>0;){var m=l.pop(),h=m.score,g=m.boxIndex,v=m.suppressBeginIndex;if(h<o)break;for(var x=!1,y=f.length-1;y>=v;--y){var b=Tne(r,g,f[y]);if(b>=n){x=!0;break}if(m.score=m.score*Ane(n,p,b),m.score<=o)break}m.suppressBeginIndex=f.length,x||(m.score===h?(f.push(g),d.push(m.score)):m.score>o&&kne(l,m,DE))}var k=f.length,N=t-k;s&&N>0&&(f.push.apply(f,_r(new Array(N).fill(0))),d.push.apply(d,_r(new Array(N).fill(0))));var E={selectedIndices:f};return i&&(E.selectedScores=d),u&&(E.validOutputs=k),E}function Tne(r,e,t){var n=r.subarray(e*4,e*4+4),o=r.subarray(t*4,t*4+4),a=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),p=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),d=(s-a)*(u-i),m=(p-l)*(f-c);if(d<=0||m<=0)return 0;var h=Math.max(a,l),g=Math.max(i,c),v=Math.min(s,p),x=Math.min(u,f),y=Math.max(v-h,0)*Math.max(x-g,0);return y/(d+m-y)}function Ane(r,e,t){var n=Math.exp(e*t*t);return t<=r?n:0}function DE(r,e){return r.score-e.score||r.score===e.score&&e.boxIndex-r.boxIndex}function Fne(r,e,t,n,o){return n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),wt(this,void 0,void 0,function(){var a,i,s,u,l,c,p;return yt(this,function(f){switch(f.label){case 0:return a=D(r,"boxes","nonMaxSuppressionAsync"),i=D(e,"scores","nonMaxSuppressionAsync"),s=al(a,i,t,n,o),t=s.maxOutputSize,n=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([a.data(),i.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],p=Cne(l,c,t,n,o).selectedIndices,a!==r&&a.dispose(),i!==e&&i.dispose(),[2,gn(p,"int32")]}})})}var Dne=Fne;function Rne(r,e,t,n,o,a){n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var i=D(r,"boxes","nonMaxSuppression"),s=D(e,"scores","nonMaxSuppression"),u=al(i,s,t,n,o,a);t=u.maxOutputSize,n=u.iouThreshold,o=u.scoreThreshold,a=u.softNmsSigma;var l={boxes:i,scores:s},c={maxOutputSize:t,iouThreshold:n,scoreThreshold:o,softNmsSigma:a},p=q.runKernel(jY,l,c);return{selectedIndices:p[0],selectedScores:p[1]}}var $ne=j({nonMaxSuppressionWithScore_:Rne});function Pne(r,e,t,n,o,a){return n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),wt(this,void 0,void 0,function(){var i,s,u,l,c,p,f,d,m;return yt(this,function(h){switch(h.label){case 0:return i=D(r,"boxes","nonMaxSuppressionAsync"),s=D(e,"scores","nonMaxSuppressionAsync"),u=al(i,s,t,n,o,a),t=u.maxOutputSize,n=u.iouThreshold,o=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([i.data(),s.data()])];case 1:return l=h.sent(),c=l[0],p=l[1],f=Ene(c,p,t,n,o,a),d=f.selectedIndices,m=f.selectedScores,i!==r&&i.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:gn(d,"int32"),selectedScores:gn(m)}]}})})}var One=Pne;function Mne(r,e,t,n,o,a){n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=!1);var i=D(r,"boxes","nonMaxSuppression"),s=D(e,"scores","nonMaxSuppression"),u=al(i,s,t,n,o,null),l=u.maxOutputSize,c=u.iouThreshold,p=u.scoreThreshold,f={boxes:i,scores:s},d={maxOutputSize:l,iouThreshold:c,scoreThreshold:p,padToMaxOutputSize:a},m=q.runKernel(GY,f,d);return{selectedIndices:m[0],validOutputs:m[1]}}var Bne=j({nonMaxSuppressionPadded_:Mne});function Lne(r,e,t,n,o,a){return n===void 0&&(n=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=!1),wt(this,void 0,void 0,function(){var i,s,u,l,c,p,f,d,m,h,g,v;return yt(this,function(x){switch(x.label){case 0:return i=D(r,"boxes","nonMaxSuppressionAsync"),s=D(e,"scores","nonMaxSuppressionAsync"),u=al(i,s,t,n,o,null),l=u.maxOutputSize,c=u.iouThreshold,p=u.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return f=we.apply(void 0,[x.sent(),2]),d=f[0],m=f[1],h=Nne(d,m,l,c,p,a),g=h.selectedIndices,v=h.validOutputs,i!==r&&i.dispose(),s!==e&&s.dispose(),[2,{selectedIndices:gn(g,"int32"),validOutputs:Nt(v,"int32")}]}})})}var Vne=Lne;function Wne(r,e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var o=D(r,"images","resizeBilinear");z(o.rank===3||o.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+("rank "+o.rank+".")}),z(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+(e+".")}),z(n===!1||t===!1,function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."});var a=o,i=!1;o.rank===3&&(i=!0,a=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),we(e,0);var s={images:a},u={alignCorners:t,halfPixelCenters:n,size:e},l=q.runKernel(aZ,s,u);return i?ie(l,[l.shape[1],l.shape[2],l.shape[3]]):l}var zne=j({resizeBilinear_:Wne});function Une(r,e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var o=D(r,"images","resizeNearestNeighbor");z(o.rank===3||o.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+("rank "+o.rank+".")}),z(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+(e+".")}),z(o.dtype==="float32"||o.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"}),z(n===!1||t===!1,function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."});var a=o,i=!1;o.rank===3&&(i=!0,a=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),we(e,0);var s={images:a},u={alignCorners:t,halfPixelCenters:n,size:e},l=q.runKernel(oZ,s,u);return i?ie(l,[l.shape[1],l.shape[2],l.shape[3]]):l}var Gne=j({resizeNearestNeighbor_:Une});function jne(r,e,t,n){var o;e===void 0&&(e="binary"),t===void 0&&(t=!1),n===void 0&&(n=.5);var a=D(r,"image","threshold"),i=.2989,s=.587,u=.114,l=a.shape[0]*a.shape[1],c=He(gn([n]),255),p,f,d,m;if(z(a.rank===3,function(){return"Error in threshold: image must be rank 3,"+("but got rank "+a.rank+".")}),z(a.shape[2]===3||a.shape[2]===1,function(){return"Error in threshold: image color channel must be equal to 3 or 1"+("but got "+a.shape[2]+".")}),z(a.dtype==="int32"||a.dtype==="float32",function(){return"Error in dtype: image dtype must be int32 or float32,"+("but got dtype "+a.dtype+".")}),z(e==="otsu"||e==="binary",function(){return"Method must be binary or otsu, but was "+e}),a.shape[2]===3){o=we(rl(a,[1,1,1],-1),3),p=o[0],f=o[1],d=o[2];var h=He(p,i),g=He(f,s),v=He(d,u);m=mr(mr(h,g),v)}else m=r;if(e==="otsu"){var x=Ay(nr(Zy(m),"int32"),eb([]),256);c=Hne(x,l)}var y=t?jd(m,c):ep(m,c),b=nr(He(y,255),"int32");return b}function Hne(r,e){for(var t=gn([-1]),n=gn([0]),o=gn([0]),a,i,s,u,l,c,p=0;p<r.size-1;p++){a=Lt(r,0,p+1),i=Lt(r,p+1),l=Ar(Ct(a),e),c=Ar(Ct(i),e);var f=Ct(He(a,tl(0,a.size)));s=Ar(f,Ct(a));var d=zd(i.shape,a.size),m=mr(tl(0,i.size),d),h=He(i,m);u=Ar(Ct(h),Ct(i));var g=it(s,u),v=it(s,u),x=He(l,c);o=He(He(x,g),v);var y=ep(o,n);n=Is(y,o,n),t=Is(y,gn([p]),t)}return t}var qne=j({threshold_:jne});function Kne(r,e,t,n,o,a){t===void 0&&(t="nearest"),n===void 0&&(n="constant"),o===void 0&&(o=0);var i=D(r,"image","transform","float32"),s=D(e,"transforms","transform","float32");z(i.rank===4,function(){return"Error in transform: image must be rank 4,"+("but got rank "+i.rank+".")}),z(s.rank===2&&(s.shape[0]===i.shape[0]||s.shape[0]===1)&&s.shape[1]===8,function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"}),z(a==null||a.length===2,function(){return"Error in transform: outputShape must be [height, width] or null, "+("but got "+a+".")});var u={image:i,transforms:s},l={interpolation:t,fillMode:n,fillValue:o,outputShape:a};return q.runKernel(BZ,u,l)}var Xne=j({transform_:Kne});function Yne(r,e,t){z(e%1==0,function(){return"bandPart(): numLower must be an integer, got "+e+"."}),z(t%1==0,function(){return"bandPart(): numUpper must be an integer, got "+t+"."});var n=D(r,"a","bandPart");z(n.rank>=2,function(){return"bandPart(): Rank must be at least 2, got "+n.rank+"."});var o=n.shape,a=we(n.shape.slice(-2),2),i=a[0],s=a[1];if(!(e<=i))throw new Error("bandPart(): numLower ("+e+")"+(" must not be greater than the number of rows ("+i+")."));if(!(t<=s))throw new Error("bandPart(): numUpper ("+t+")"+(" must not be greater than the number of columns ("+s+")."));e<0&&(e=i),t<0&&(t=s);var u=ie(tl(0,i,1,"int32"),[-1,1]),l=tl(0,s,1,"int32"),c=it(u,l),p=tp(jd(c,Nt(+e,"int32")),Py(c,Nt(-t,"int32"))),f=Ns([i,s],n.dtype);return ie(ol(Jd(ie(n,[-1,i,s])).map(function(d){return Is(p,d,f)})),o)}var Zne=j({bandPart_:Yne});function Jne(r){var e;if(Array.isArray(r)){e=!1,z(r!=null&&r.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var t=r[0].shape[0],n=function(u){z(r[u].shape[0]===t,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+("("+r[u].shape[0]+" vs. "+t+")")})},o=1;o<r.length;++o)n(o)}else e=!0,r=rl(r,r.shape[0],0).map(function(u){return nl(u,[0])});z(r.length<=r[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds "+("number of dimensions ("+r[0].shape[0]+").")});for(var a=[],i=r,s=function(u){a.push(q.tidy(function(){var l=i[u];if(u>0)for(var c=0;c<u;++c){var p=He(Ct(He(a[c],l)),a[c]);l=it(l,p)}return Ar(l,nb(l,"euclidean"))}))},o=0;o<r.length;++o)s(o);return e?ol(a,0):a}var Qne=j({gramSchmidt_:Jne});function eoe(r){var e=dN(r);e.forEach(function(t){return t.dispose()})}function toe(r,e){if(e===void 0&&(e=!1),z(r.rank>=2,function(){return"qr() requires input tensor to have a rank >= 2, but got rank "+r.rank}),r.rank===2)return RE(r,e);var t=r.shape.slice(0,r.shape.length-2).reduce(function(u,l){return u*l}),n=Jd(ie(r,[t,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),o=[],a=[];n.forEach(function(u){var l=we(RE(u,e),2),c=l[0],p=l[1];o.push(c),a.push(p)});var i=ie(ol(o,0),r.shape),s=ie(ol(a,0),r.shape);return[i,s]}function RE(r,e){return e===void 0&&(e=!1),q.tidy(function(){z(r.shape.length===2,function(){return"qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor."});for(var t=r.shape[0],n=r.shape[1],o=XN(t),a=Yu(r),i=ip([[1]],[1,1]),s=Yu(i),u=t>=n?n:t,l=function(p){var f,d=a,m=s,h=o;f=we(q.tidy(function(){var g=Lt(a,[p,p],[t-p,1]),v=nb(g),x=Lt(a,[p,p],[1,1]),y=Is(ep(x,0),ip([[-1]]),ip([[1]])),b=it(x,He(y,v)),k=Ar(g,b);k.shape[0]===1?s=Yu(i):s=jr([i,Lt(k,[1,0],[k.shape[0]-1,k.shape[1]])],0);var N=Oo(Ar(bt(y,b),v)),E=Lt(a,[p,0],[t-p,n]),T=He(N,s),R=Qd(s);if(p===0)a=it(E,bt(T,bt(R,E)));else{var $=it(E,bt(T,bt(R,E)));a=jr([Lt(a,[0,0],[p,n]),$],0)}var O=Qd(T),M=Lt(o,[0,p],[t,o.shape[1]-p]);if(p===0)o=it(M,bt(bt(M,s),O));else{var B=it(M,bt(bt(M,s),O));o=jr([Lt(o,[0,0],[t,p]),B],1)}return[s,a,o]}),3),s=f[0],a=f[1],o=f[2],eoe([d,m,h])},c=0;c<u;++c)l(c);return!e&&t>n&&(o=Lt(o,[0,0],[t,n]),a=Lt(a,[0,0],[n,n])),[o,a]})}var roe=j({qr_:toe});var Hr;(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Hr||(Hr={}));function noe(r,e,t){t===void 0&&(t=Hr.SUM_BY_NONZERO_WEIGHTS);var n=D(r,"losses","computeWeightedLoss"),o=null;e!=null&&(o=D(e,"weights","computeWeightedLoss"));var a=o==null?n:He(n,o);if(t===Hr.NONE)return a;if(t===Hr.SUM)return Ct(a);if(t===Hr.MEAN){if(o==null)return rp(a);var i=n.size/o.size,s=Ar(Ct(a),Ct(o));return i>1?Ar(s,Nt(i)):s}if(t===Hr.SUM_BY_NONZERO_WEIGHTS){if(o==null)return Ar(Ct(a),Nt(n.size));var u=He(o,Ta(n.shape)),l=nr(Ct(Uy(u,Nt(0))),"float32");return Ar(Ct(a),l)}throw Error("Unknown reduction: "+t)}var Bo=j({computeWeightedLoss_:noe});function ooe(r,e,t,n){n===void 0&&(n=Hr.SUM_BY_NONZERO_WEIGHTS);var o=D(r,"labels","absoluteDifference"),a=D(e,"predictions","absoluteDifference"),i=null;t!=null&&(i=D(t,"weights","absoluteDifference")),In(o.shape,a.shape,"Error in absoluteDifference: ");var s=hn(it(o,a));return Bo(s,i,n)}var aoe=j({absoluteDifference_:ooe});function soe(r,e,t,n,o){o===void 0&&(o=Hr.SUM_BY_NONZERO_WEIGHTS);var a=D(r,"labels","cosineDistance"),i=D(e,"predictions","cosineDistance"),s=null;n!=null&&(s=D(n,"weights","cosineDistance")),In(a.shape,i.shape,"Error in cosineDistance: ");var u=Nt(1),l=it(u,Ct(He(a,i),t,!0));return Bo(l,s,o)}var ioe=j({cosineDistance_:soe});function uoe(r,e,t,n){n===void 0&&(n=Hr.SUM_BY_NONZERO_WEIGHTS);var o=D(r,"labels","hingeLoss"),a=D(e,"predictions","hingeLoss"),i=null;t!=null&&(i=D(t,"weights","hingeLoss")),In(o.shape,a.shape,"Error in hingeLoss: ");var s=Nt(1);o=it(He(Nt(2),o),s);var u=ap(it(s,He(o,a)));return Bo(u,i,n)}var loe=j({hingeLoss_:uoe});function coe(r,e,t,n,o){n===void 0&&(n=1),o===void 0&&(o=Hr.SUM_BY_NONZERO_WEIGHTS);var a=D(r,"labels","huberLoss"),i=D(e,"predictions","huberLoss"),s=null;t!=null&&(s=D(t,"weights","huberLoss")),In(a.shape,i.shape,"Error in huberLoss: ");var u=Nt(n),l=hn(it(i,a)),c=zy(l,u),p=it(l,c),f=mr(He(Nt(.5),np(c)),He(u,p));return Bo(f,s,o)}var poe=j({huberLoss_:coe});function foe(r,e,t,n,o){n===void 0&&(n=1e-7),o===void 0&&(o=Hr.SUM_BY_NONZERO_WEIGHTS);var a=D(r,"labels","logLoss"),i=D(e,"predictions","logLoss"),s=null;t!=null&&(s=D(t,"weights","logLoss")),In(a.shape,i.shape,"Error in logLoss: ");var u=Nt(1),l=Nt(n),c=Oo(He(a,Qu(mr(i,l)))),p=He(it(u,a),Qu(mr(it(u,i),l))),f=it(c,p);return Bo(f,s,o)}var doe=j({logLoss_:foe});function moe(r,e,t,n){n===void 0&&(n=Hr.SUM_BY_NONZERO_WEIGHTS);var o=D(r,"labels","meanSquaredError"),a=D(e,"predictions","meanSquaredError"),i=null;t!=null&&(i=D(t,"weights","meanSquaredError")),In(o.shape,a.shape,"Error in meanSquaredError: ");var s=Qy(o,a);return Bo(s,i,n)}var hoe=j({meanSquaredError_:moe});function goe(r,e){var t=D(r,"labels","sigmoidCrossEntropyWithLogits"),n=D(e,"logits","sigmoidCrossEntropyWithLogits");In(t.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=ap(n),a=He(n,t),i=My(Na(Oo(hn(n))));return mr(it(o,a),i)}function voe(r,e,t,n,o){n===void 0&&(n=0),o===void 0&&(o=Hr.SUM_BY_NONZERO_WEIGHTS);var a=D(r,"multiClassLabels","sigmoidCrossEntropy"),i=D(e,"logits","sigmoidCrossEntropy"),s=null;if(t!=null&&(s=D(t,"weights","sigmoidCrossEntropy")),In(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),n>0){var u=Nt(n),l=Nt(1),c=Nt(.5);a=mr(He(a,it(l,u)),He(c,u))}var p=goe(a,i);return Bo(p,s,o)}var xoe=j({sigmoidCrossEntropy_:voe});function yoe(r,e,t){if(t===void 0&&(t=-1),t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+("supported. Labels / logits was rank "+e.rank+" ")+("and dim was "+t));var n=Po(function(o,a,i){var s=!0,u=tE(a,[t],s),l=it(nr(a,"float32"),u);i([o,l]);var c=Oo(He(l,o)),p=Ct(c,[t]),f=function(d,m){var h=we(m,2),g=h[0],v=h[1],x=Hd(d.shape,[t]);return[He(ie(d,x),it(nr(g,"float32"),Na(v))),He(ie(d,x),it(Na(v),nr(g,"float32")))]};return{value:p,gradFunc:f}});return n(r,e)}function boe(r,e,t,n,o){n===void 0&&(n=0),o===void 0&&(o=Hr.SUM_BY_NONZERO_WEIGHTS);var a=D(r,"onehotLabels","softmaxCrossEntropy"),i=D(e,"logits","softmaxCrossEntropy"),s=null;if(t!=null&&(s=D(t,"weights","softmaxCrossEntropy")),In(a.shape,i.shape,"Error in softmaxCrossEntropy: "),n>0){var u=Nt(n),l=Nt(1),c=Nt(a.shape[1]);a=mr(He(a,it(l,u)),Ar(u,c))}var p=yoe(a,i);return Bo(p,s,o)}var woe=j({softmaxCrossEntropy_:boe});function koe(r,e,t,n){var o=D(r,"indices","sparseFillEmptyRows"),a=D(e,"values","sparseFillEmptyRows"),i=D(t,"denseShape","sparseFillEmptyRows"),s=D(n,"defaultValue","sparseFillEmptyRows",a.dtype);if(o.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        `+o.shape);if(a.rank!==1)throw new Error("Values should be Tensor1D but received shape "+a.shape);if(i.rank!==1)throw new Error("Dense shape should be Tensor1D but received shape "+i.shape);if(s.rank!==0)throw new Error("Default value should be a scalar but received shape "+s.shape);var u={indices:o,values:a,denseShape:i,defaultValue:s},l=q.runKernel(SZ,u);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}var _oe=j({sparseFillEmptyRows_:koe});function Soe(r,e,t){var n=D(r,"inputIndices","sparseReshape"),o=D(e,"inputShape","sparseReshape"),a=D(t,"newShape","sparseReshape");if(n.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        `+n.shape);if(o.rank!==1)throw new Error("Input shape should be Tensor1D but received shape "+o.shape);if(a.rank!==1)throw new Error("New shape should be Tensor1D but received shape "+a.shape);var i={inputIndices:n,inputShape:o,newShape:a},s=q.runKernel(IZ,i);return{outputIndices:s[0],outputShape:s[1]}}var Ioe=j({sparseReshape_:Soe});function Coe(r,e,t){var n=D(r,"data","sparseSegmentMean"),o=D(e,"indices","sparseSegmentMean"),a=D(t,"segmentIds","sparseSegmentMean");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          `+o.shape);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          `+a.shape);var i={data:n,indices:o,segmentIds:a};return q.runKernel(CZ,i)}var Noe=j({sparseSegmentMean_:Coe});function Eoe(r,e,t){var n=D(r,"data","sparseSegmentSum"),o=D(e,"indices","sparseSegmentSum"),a=D(t,"segmentIds","sparseSegmentSum");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         `+o.shape);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         `+a.shape);var i={data:n,indices:o,segmentIds:a};return q.runKernel(NZ,i)}var Toe=j({sparseSegmentSum_:Eoe});function Aoe(r,e,t,n,o,a,i,s){var u=D(r,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error("Data must be a vector, saw: "+u.shape);var l=D(e,"dataSplits","stringNGrams");if(l.dtype!=="int32")throw new Error("Data splits must be of datatype int32");var c={separator:t,nGramWidths:n,leftPad:o,rightPad:a,padWidth:i,preserveShortSequences:s},p={data:u,dataSplits:l},f=q.runKernel(FZ,p,c);return{nGrams:f[0],nGramsSplits:f[1]}}var Foe=j({stringNGrams_:Aoe});function Doe(r,e,t){t===void 0&&(t=!0);var n=D(r,"input","stringSplit","string"),o=D(e,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error("Input should be Tensor1D but received shape "+n.shape);if(o.rank!==0)throw new Error("Delimiter should be a scalar but received shape "+o.shape);var a={skipEmpty:t},i={input:n,delimiter:o},s=q.runKernel(DZ,i,a);return{indices:s[0],values:s[1],shape:s[2]}}var Roe=j({stringSplit_:Doe});function $oe(r,e){var t=D(r,"input","stringToHashBucketFast","string"),n={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");var o={input:t};return q.runKernel(RZ,o,n)}var Poe=j({stringToHashBucketFast_:$oe});var Ooe={fft:Xd,ifft:sp,rfft:Yd,irfft:Jy},Moe={hammingWindow:ine,hannWindow:AE,frame:FE,stft:pne},Fs={flipLeftRight:hne,grayscaleToRGB:vne,resizeNearestNeighbor:Gne,resizeBilinear:zne,rotateWithOffset:yne,cropAndResize:dne,nonMaxSuppression:wne,nonMaxSuppressionAsync:Dne,nonMaxSuppressionWithScore:$ne,nonMaxSuppressionWithScoreAsync:One,nonMaxSuppressionPadded:Bne,nonMaxSuppressionPaddedAsync:Vne,threshold:qne,transform:Xne},Boe={bandPart:Zne,gramSchmidt:Qne,qr:roe},Loe={absoluteDifference:aoe,computeWeightedLoss:Bo,cosineDistance:ioe,hingeLoss:loe,huberLoss:poe,logLoss:doe,meanSquaredError:hoe,sigmoidCrossEntropy:xoe,softmaxCrossEntropy:woe},up={sparseFillEmptyRows:_oe,sparseReshape:Ioe,sparseSegmentMean:Noe,sparseSegmentSum:Toe},em={stringNGrams:Foe,stringSplit:Roe,stringToHashBucketFast:Poe};var Voe={__proto__:null,abs:hn,acos:yN,acosh:bN,add:mr,addN:wN,all:kN,any:_N,argMax:SN,argMin:IN,asin:CN,asinh:NN,atan:EN,atan2:TN,atanh:AN,avgPool:Ey,avgPool3d:FN,basicLSTMCell:jJ,batchToSpaceND:Ty,batchNorm:Zu,batchNorm2d:YJ,batchNorm3d:JJ,batchNorm4d:eQ,bincount:Ay,broadcastArgs:DN,broadcastTo:Jc,buffer:Ca,cast:nr,ceil:RN,clipByValue:$N,clone:Yu,complex:Ss,concat:jr,concat1d:uQ,concat2d:cQ,concat3d:fQ,concat4d:mQ,conv1d:PN,conv2d:Qc,conv2dTranspose:MN,conv3d:BN,conv3dTranspose:_Q,cos:LN,cosh:VN,cumsum:WN,denseBincount:zN,depthToSpace:UN,depthwiseConv2d:Vd,diag:FQ,dilation2d:GN,div:Ar,divNoNan:jN,dot:WQ,einsum:HN,elu:Ry,equal:Dy,erf:qN,exp:Na,expandDims:Ea,expm1:KN,eye:XN,fill:zd,floor:$y,floorDiv:Fy,gather:Ud,greater:ep,greaterEqual:Py,imag:Gd,isFinite:ree,isInf:oee,isNaN:YN,leakyRelu:Oy,less:ZN,lessEqual:jd,linspace:JN,localResponseNormalization:QN,log:Qu,log1p:My,logSigmoid:hee,logSoftmax:eE,logSumExp:tE,logicalAnd:tp,logicalNot:Ly,logicalOr:Vy,logicalXor:Cee,matMul:bt,max:Cs,maxPool:Wy,maxPool3d:rE,maxPoolWithArgmax:nE,maximum:oE,mean:rp,meshgrid:Dee,min:qd,minimum:zy,mirrorPad:aE,mod:sE,moments:Lee,mul:He,multiRNNCell:Wee,multinomial:iE,neg:Oo,notEqual:Uy,oneHot:uE,ones:Ta,onesLike:lE,outerProduct:qee,pad:el,pad1d:Yee,pad2d:Jee,pad3d:ete,pad4d:rte,pool:ite,pow:Kd,prelu:jy,print:cte,prod:Hy,rand:dte,randomGamma:Nte,randomNormal:Tte,randomUniform:Xy,range:tl,real:op,reciprocal:cE,relu:ap,relu6:Yy,reshape:ie,reverse:Mo,reverse1d:Mte,reverse2d:Lte,reverse3d:Wte,reverse4d:Ute,round:Zy,rsqrt:pE,scalar:Nt,selu:fE,separableConv2d:Kte,setdiff1dAsync:dE,sigmoid:_s,sign:mE,sin:hE,sinh:gE,slice:Lt,slice1d:ere,slice2d:rre,slice3d:ore,slice4d:sre,softmax:vE,softplus:By,spaceToBatchND:Gy,fft:Xd,ifft:sp,irfft:Jy,rfft:Yd,split:rl,sqrt:Zd,square:np,squaredDifference:Qy,squeeze:nl,stack:ol,step:xE,stridedSlice:yE,sub:it,sum:Ct,tan:bE,tanh:Ld,tensor:eb,tensor1d:gn,tensor2d:ip,tensor3d:bre,tensor4d:wre,tensor5d:kre,tensor6d:_re,tile:Ju,topk:wE,truncatedNormal:kE,unique:tb,unsortedSegmentSum:Ere,unstack:Jd,variable:Are,where:Is,whereAsync:rb,zeros:Ns,zerosLike:Wd,op:j,OP_SCOPE_SUFFIX:xN,booleanMaskAsync:$re,transpose:Qd,norm:nb,movingAverage:Bre,scatterND:SE,sparseToDense:ob,gatherND:IE,dropout:qre,enclosingPowerOfTwo:CE,cosineWindow:ab,inTopKAsync:Xre,image:Fs,linalg:Boe,losses:Loe,spectral:Ooe,fused:ane,signal:Moe,sparse:up,string:em};var Woe=function(r,e,t){switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[mr(_("a",r,e,t),_("b",r,e,t))];case"AddN":return[wN(_("tensors",r,e,t))];case"FloorMod":case"Mod":return[sE(_("a",r,e,t),_("b",r,e,t))];case"Mul":return[He(_("a",r,e,t),_("b",r,e,t))];case"RealDiv":case"Div":return[Ar(_("a",r,e,t),_("b",r,e,t))];case"DivNoNan":return[jN(_("a",r,e,t),_("b",r,e,t))];case"FloorDiv":return[Fy(_("a",r,e,t),_("b",r,e,t))];case"Sub":return[it(_("a",r,e,t),_("b",r,e,t))];case"Minimum":return[zy(_("a",r,e,t),_("b",r,e,t))];case"Maximum":return[oE(_("a",r,e,t),_("b",r,e,t))];case"Pow":return[Kd(_("a",r,e,t),_("b",r,e,t))];case"SquaredDifference":return[Qy(_("a",r,e,t),_("b",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}};var zoe=function(r,e,t){switch(r.op){case"Abs":case"ComplexAbs":return[hn(_("x",r,e,t))];case"Acos":return[yN(_("x",r,e,t))];case"Acosh":return[bN(_("x",r,e,t))];case"Asin":return[CN(_("x",r,e,t))];case"Asinh":return[NN(_("x",r,e,t))];case"Atan":return[EN(_("x",r,e,t))];case"Atan2":return[TN(_("x",r,e,t),_("y",r,e,t))];case"Atanh":return[AN(_("x",r,e,t))];case"Ceil":return[RN(_("x",r,e,t))];case"Complex":return[Ss(_("real",r,e,t),_("imag",r,e,t))];case"Cos":return[LN(_("x",r,e,t))];case"Cosh":return[VN(_("x",r,e,t))];case"Elu":return[Ry(_("x",r,e,t))];case"Erf":return[qN(_("x",r,e,t))];case"Exp":return[Na(_("x",r,e,t))];case"Expm1":return[KN(_("x",r,e,t))];case"Floor":return[$y(_("x",r,e,t))];case"Log":return[Qu(_("x",r,e,t))];case"Log1p":return[My(_("x",r,e,t))];case"Imag":return[Gd(_("x",r,e,t))];case"Neg":return[Oo(_("x",r,e,t))];case"Reciprocal":return[cE(_("x",r,e,t))];case"Real":return[op(_("x",r,e,t))];case"Relu":return[ap(_("x",r,e,t))];case"Round":return[Zy(_("x",r,e,t))];case"Selu":return[fE(_("x",r,e,t))];case"Sigmoid":return[_s(_("x",r,e,t))];case"Sin":return[hE(_("x",r,e,t))];case"Sign":return[mE(_("x",r,e,t))];case"Sinh":return[gE(_("x",r,e,t))];case"Softplus":return[By(_("x",r,e,t))];case"Sqrt":return[Zd(_("x",r,e,t))];case"Square":return[np(_("x",r,e,t))];case"Tanh":return[Ld(_("x",r,e,t))];case"Tan":return[bE(_("x",r,e,t))];case"ClipByValue":return[$N(_("x",r,e,t),_("clipValueMin",r,e,t),_("clipValueMax",r,e,t))];case"Relu6":return[Yy(_("x",r,e,t))];case"Rsqrt":return[pE(Or(r.inputNames[0],e,t))];case"Prod":return[Hy(_("x",r,e,t),_("axes",r,e,t))];case"LeakyRelu":return[Oy(_("x",r,e,t),_("alpha",r,e,t))];case"Prelu":return[jy(_("x",r,e,t),_("alpha",r,e,t))];case"IsNan":return[YN(Or(r.inputNames[0],e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}};function Tn(r,e,t){if(t===void 0&&(t=""),!(typeof r=="number"||typeof e=="number")){Ce.util.assert(r.length===e.length,function(){return t+(" Shapes "+r+" and "+e+" must match")});for(var n=0;n<r.length;n++){var o=r[n],a=e[n];Ce.util.assert(o<0||a<0||o===a,function(){return t+(" Shapes "+r+" and "+e+" must match")})}}}function $E(r){return!(typeof r=="number"||r.some(function(e){return e<0}))}function lp(r,e,t){var n=pb(r,t),o=!$E(n);if(o&&e.length===0)throw new Error("Tried to calculate elements of an empty list"+(" with non-fully-defined elementShape: "+n));if(o&&e.forEach(function(a){n=pb(a.shape,n)}),!$E(n))throw new Error("Non-fully-defined elementShape: "+n);return n}function pb(r,e){if(typeof r=="number")return e;if(typeof e=="number")return r;if(r.length!==e.length)throw new Error("Incompatible ranks during merge: "+r+" vs. "+e);for(var t=[],n=0;n<r.length;++n){var o=r[n],a=e[n];if(o>=0&&a>=0&&o!==a)throw new Error("Incompatible shape during merge: "+r+" vs. "+e);t[n]=o>=0?o:a}return t}var Uoe=function(){function r(e,t,n,o,a,i,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=o,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=Ce.scalar(0),Ce.keep(this.idTensor)}return Object.defineProperty(r.prototype,"id",{get:function(){return this.idTensor.id},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),r.prototype.clearAndClose=function(e){this.tensors.forEach(function(t){(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()},r.prototype.size=function(){return this.tensors.length},r.prototype.read=function(e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||e>=this.size())throw new Error("Tried to read from index "+e+", but array size is: "+this.size());var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+e+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor},r.prototype.readMany=function(e){var t=this;return e.map(function(n){return t.read(n)})},r.prototype.write=function(e,t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index "+e+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+`,
          because the value dtype is `+t.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Tn(this.elementShape,t.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+e+"."),n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been read.");if(n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been written.");n.tensor=t,Ce.keep(t),n.written=!0,this.tensors[e]=n},r.prototype.writeMany=function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,"+("because the index size: "+e.length+" is not the same as tensors size: "+t.length+"."));e.forEach(function(o,a){return n.write(o,t[a])})},r.prototype.gather=function(e,t){if(!!t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+t);if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(e.length===0)return Ce.tensor([],[0].concat(this.elementShape));var o=this.readMany(e);return Tn(this.elementShape,o[0].shape,"TensorArray shape mismatch: "),Ce.stack(o,0)},r.prototype.concat=function(e){if(!!e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+e);if(this.size()===0)return Ce.tensor([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var o=this.readMany(t);return Tn(this.elementShape,o[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+o[0].shape+")"),Ce.concat(o,0)},r.prototype.scatter=function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+t.shape[0]);var n=Math.max.apply(Math,_r(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(e,Ce.unstack(t,0))},r.prototype.split=function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);var o=0,a=e.map(function(c){return o+=c,o});if(o!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+o+", and tensor's shape is: "+t.shape);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+e.length+"), and the TensorArray is not marked as dynamically resizeable");var i=o===0?0:t.size/o,s=[];Ce.tidy(function(){t=Ce.reshape(t,[1,o,i]);for(var c=0;c<e.length;++c){var p=c===0?0:a[c-1],f=[0,p,0],d=[1,e[c],i];s[c]=Ce.reshape(Ce.slice(t,f,d),n.elementShape)}return s});for(var u=[],l=0;l<e.length;l++)u[l]=l;this.writeMany(u,s)},r}(),tm=function(){function r(e,t,n,o){o===void 0&&(o=-1),this.tensors=e,this.elementShape=t,this.elementDtype=n,e!=null&&e.forEach(function(a){if(n!==a.dtype)throw new Error("Invalid data types; op elements "+n+", but list elements "+a.dtype);Tn(t,a.shape,"TensorList shape mismatch: "),Ce.keep(a)}),this.idTensor=Ce.scalar(0),this.maxNumElements=o,Ce.keep(this.idTensor)}return Object.defineProperty(r.prototype,"id",{get:function(){return this.idTensor.id},enumerable:!0,configurable:!0}),r.prototype.copy=function(){return new r(_r(this.tensors),this.elementShape,this.elementDtype)},r.prototype.clearAndClose=function(e){this.tensors.forEach(function(t){(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()},r.prototype.size=function(){return this.tensors.length},r.prototype.stack=function(e,t,n){var o=this;if(n===void 0&&(n=-1),t!==this.elementDtype)throw new Error("Invalid data types; op elements "+t+", but list elements "+this.elementDtype);if(n!==-1&&this.tensors.length!==n)throw new Error("Operation expected a list with "+n+" elements but got a list with "+this.tensors.length+" elements.");Tn(e,this.elementShape,"TensorList shape mismatch: ");var a=lp(this.elementShape,this.tensors,e);return Ce.tidy(function(){var i=o.tensors.map(function(s){return Ce.reshape(s,a)});return Ce.stack(i,0)})},r.prototype.popBack=function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements "+t+", but list elements "+this.elementDtype);if(this.size()===0)throw new Error("Trying to pop from an empty list.");var n=lp(this.elementShape,this.tensors,e),o=this.tensors.pop();return Tn(o.shape,e,"TensorList shape mismatch: "),Ce.reshape(o,n)},r.prototype.pushBack=function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements "+e.dtype+", but list elements "+this.elementDtype);if(Tn(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ce.keep(e),this.tensors.push(e)},r.prototype.resize=function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: "+e);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error("TensorListResize input size "+e+" is greater maxNumElement "+this.maxNumElements+".");this.tensors.length=e},r.prototype.getItem=function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements "+n+", but list elements "+this.elementDtype);if(e<0||e>this.tensors.length)throw new Error("Trying to access element "+e+" in a list with "+this.tensors.length+" elements.");if(this.tensors[e]==null)throw new Error("element at index "+e+" is null.");Tn(this.tensors[e].shape,t,"TensorList shape mismatch: ");var o=lp(this.elementShape,this.tensors,t);return Ce.reshape(this.tensors[e],o)},r.prototype.setItem=function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements "+t.dtype+", but list elements "+this.elementDtype);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error("Trying to set element "+e+" in a list with max "+this.maxNumElements+" elements.");Tn(this.elementShape,t.shape,"TensorList shape mismatch: "),Ce.keep(t),this.tensors[e]=t},r.prototype.gather=function(e,t,n){var o=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements "+t+", but list elements "+this.elementDtype);Tn(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var a=lp(this.elementShape,this.tensors,n);return e.length===0?Ce.tensor([],[0].concat(a)):Ce.tidy(function(){var i=e.map(function(s){return Ce.reshape(o.tensors[s],a)});return Ce.stack(i,0)})},r.prototype.concat=function(e,t){var n=this;if(!!e&&e!==this.elementDtype)throw new Error("TensorList dtype is "+this.elementDtype+" but concat requested dtype "+e);Tn(this.elementShape,t,"TensorList shape mismatch: ");var o=lp(this.elementShape,this.tensors,t);return this.size()===0?Ce.tensor([],[0].concat(o)):Ce.tidy(function(){var a=n.tensors.map(function(i){return Ce.reshape(i,o)});return Ce.concat(a,0)})},r}();function Goe(r,e,t){var n=r.dtype;if(r.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: "+r.shape);if(r.dtype!==t)throw new Error("Invalid data types; op elements "+r.dtype+", but list elements "+t);var o=r.shape.slice(1);Tn(o,e,"TensorList shape mismatch: ");var a=Ce.unstack(r);return new tm(a,e,n)}function joe(r,e,t){return new tm([],r,e,t)}function Hoe(r,e,t,n){if(e.length!==r.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+r.shape[0]);var o=Math.max.apply(Math,_r(e));if(n!=null&&n!==-1&&o>=n)throw new Error("Max index must be < array size ("+o+"  vs. "+n+")");var a=new tm([],t,r.dtype,n),i=Ce.unstack(r,0);return e.forEach(function(s,u){a.setItem(s,i[u])}),a}function qoe(r,e,t){var n=0,o=e.map(function(p){return n+=p,n});if(n!==r.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+n+", and tensor's shape is: "+r.shape);for(var a=r.shape.slice(1),i=pb(a,t),s=n===0?0:r.size/n,u=Ce.tidy(function(){var p=[];r=Ce.reshape(r,[1,n,s]);for(var f=0;f<e.length;++f){var d=f===0?0:o[f-1],m=[0,d,0],h=[1,e[f],s];p[f]=Ce.reshape(Ce.slice(r,m,h),i)}return r.dispose(),p}),l=new tm([],t,r.dtype,e.length),c=0;c<u.length;c++)l.setItem(c,u[c]);return l}var Koe=void 0,Xoe=function(r,e,t){return wt(Koe,void 0,void 0,function(){var n,o,a,i,s,u,l,c,s,p,f,u,d,m,h,h,g,v,g,x,g,g,g,y,b,k,N,E,T,R,$,O,M,B,L,H,W,K,J,Q,ee,Y,ne,te,ce,pe,se,fe,ye,_e,Ae,We,Ze,ut,lt,tt,Ue,Ge,M,B,Ie,Ge,W,k,cr,Ie,te,ce,k,ft,Ie,k,St,Qt,ft,Ie,J,Q,k,St,Ie,Ge,k,St,ft,Ie,Xr,k,St,Ie,se,Ie,ye,k,Ge,B,Ie,Ge,k,cr,Ie,Ae,k,We,Ie;return yt(this,function(Xt){switch(Xt.label){case 0:switch(n=r.op,n){case"If":return[3,1];case"StatelessIf":return[3,1];case"While":return[3,3];case"StatelessWhile":return[3,3];case"LoopCond":return[3,9];case"Switch":return[3,10];case"Merge":return[3,12];case"Enter":return[3,13];case"Exit":return[3,14];case"NextIteration":return[3,15];case"TensorArrayV3":return[3,16];case"TensorArrayWriteV3":return[3,17];case"TensorArrayReadV3":return[3,18];case"TensorArrayGatherV3":return[3,19];case"TensorArrayScatterV3":return[3,20];case"TensorArrayConcatV3":return[3,21];case"TensorArraySplitV3":return[3,22];case"TensorArraySizeV3":return[3,23];case"TensorArrayCloseV3":return[3,24];case"TensorListSetItem":return[3,25];case"TensorListGetItem":return[3,26];case"TensorListScatterV2":return[3,27];case"TensorListScatter":return[3,27];case"TensorListReserve":return[3,28];case"EmptyTensorList":return[3,28];case"TensorListGather":return[3,29];case"TensorListStack":return[3,30];case"TensorListFromTensor":return[3,31];case"TensorListConcat":return[3,32];case"TensorListPushBack":return[3,33];case"TensorListPopBack":return[3,34];case"TensorListSplit":return[3,35]}return[3,36];case 1:return o=_("thenBranch",r,e,t),a=_("elseBranch",r,e,t),i=_("cond",r,e,t),s=_("args",r,e,t),[4,i.data()];case 2:return u=Xt.sent(),u[0]?[2,t.functionMap[o].executeFunctionAsync(s,t.tensorArrayMap,t.tensorListMap)]:[2,t.functionMap[a].executeFunctionAsync(s,t.tensorArrayMap,t.tensorListMap)];case 3:return l=_("body",r,e,t),c=_("cond",r,e,t),s=_("args",r,e,t),[4,t.functionMap[c].executeFunctionAsync(s,t.tensorArrayMap,t.tensorListMap)];case 4:return p=Xt.sent(),f=s.map(function(ht){return ht.id}),[4,p[0].data()];case 5:u=Xt.sent(),p.forEach(function(ht){!ht.kept&&f.indexOf(ht.id)===-1&&ht.dispose()}),d=s,m=function(){var ht,Nr,Ft;return yt(this,function(pr){switch(pr.label){case 0:return ht=d,[4,t.functionMap[l].executeFunctionAsync(d,t.tensorArrayMap,t.tensorListMap)];case 1:return d=pr.sent(),Nr=d.map(function(Dt){return Dt.id}),ht.forEach(function(Dt){!Dt.kept&&f.indexOf(Dt.id)===-1&&Nr.indexOf(Dt.id)===-1&&Dt.dispose()}),[4,t.functionMap[c].executeFunctionAsync(d,t.tensorArrayMap,t.tensorListMap)];case 2:return Ft=pr.sent(),[4,Ft[0].data()];case 3:return u=pr.sent(),Ft.forEach(function(Dt){!Dt.kept&&f.indexOf(Dt.id)===-1&&Nr.indexOf(Dt.id)===-1&&Dt.dispose()}),[2]}})},Xt.label=6;case 6:return u[0]?[5,m()]:[3,8];case 7:return Xt.sent(),[3,6];case 8:return[2,d];case 9:return h=_("pred",r,e,t),[2,[$o(h)]];case 10:return h=_("pred",r,e,t),g=_("data",r,e,t),g.kept||(g=$o(g)),[4,h.data()];case 11:return[2,Xt.sent()[0]?[void 0,g]:[g,void 0]];case 12:return v=r.inputNames.find(function(ht){return Or(ht,e,t)!==void 0}),v?(g=Or(v,e,t),[2,[$o(g)]]):[2,void 0];case 13:return x=_("frameName",r,e,t),g=_("tensor",r,e,t),t.enterFrame(x),[2,[$o(g)]];case 14:return g=_("tensor",r,e,t),t.exitFrame(),[2,[$o(g)]];case 15:return g=_("tensor",r,e,t),t.nextIteration(),[2,[$o(g)]];case 16:return y=_("size",r,e,t),b=_("dtype",r,e,t),k=_("elementShape",r,e,t),N=_("dynamicSize",r,e,t),E=_("clearAfterRead",r,e,t),T=_("identicalElementShapes",r,e,t),R=_("name",r,e,t),$=new Uoe(R,b,y,k,T,N,E),t.addTensorArray($),[2,[$.idTensor,Ce.scalar(1)]];case 17:return O=_("tensorArrayId",r,e,t),M=_("index",r,e,t),B=_("tensor",r,e,t),L=t.getTensorArray(O.id),L.write(M,B),[2,[L.idTensor]];case 18:return H=_("tensorArrayId",r,e,t),W=_("index",r,e,t),K=t.getTensorArray(H.id),[2,[K.read(W)]];case 19:return J=_("tensorArrayId",r,e,t),Q=_("indices",r,e,t),ee=_("dtype",r,e,t),Y=t.getTensorArray(J.id),[2,[Y.gather(Q,ee)]];case 20:return ne=_("tensorArrayId",r,e,t),te=_("indices",r,e,t),ce=_("tensor",r,e,t),pe=t.getTensorArray(ne.id),pe.scatter(te,ce),[2,[pe.idTensor]];case 21:return se=_("tensorArrayId",r,e,t),fe=t.getTensorArray(se.id),ye=_("dtype",r,e,t),[2,[fe.concat(ye)]];case 22:return _e=_("tensorArrayId",r,e,t),Ae=_("tensor",r,e,t),We=_("lengths",r,e,t),Ze=t.getTensorArray(_e.id),Ze.split(We,Ae),[2,[Ze.idTensor]];case 23:return ut=_("tensorArrayId",r,e,t),lt=t.getTensorArray(ut.id),[2,[Ce.scalar(lt.size(),"int32")]];case 24:return tt=_("tensorArrayId",r,e,t),Ue=t.getTensorArray(tt.id),Ue.clearAndClose(),[2,[Ue.idTensor]];case 25:return Ge=_("tensorListId",r,e,t),M=_("index",r,e,t),B=_("tensor",r,e,t),Ie=t.getTensorList(Ge.id),Ie.setItem(M,B),[2,[Ie.idTensor]];case 26:return Ge=_("tensorListId",r,e,t),W=_("index",r,e,t),k=_("elementShape",r,e,t),cr=_("elementDType",r,e,t),Ie=t.getTensorList(Ge.id),[2,[Ie.getItem(W,k,cr)]];case 27:return te=_("indices",r,e,t),ce=_("tensor",r,e,t),k=_("elementShape",r,e,t),ft=_("numElements",r,e,t),Ie=Hoe(ce,te,k,ft),t.addTensorList(Ie),[2,[Ie.idTensor]];case 28:return k=_("elementShape",r,e,t),St=_("elementDType",r,e,t),Qt=void 0,r.op==="TensorListReserve"?Qt="numElements":Qt="maxNumElements",ft=_(Qt,r,e,t),Ie=joe(k,St,ft),t.addTensorList(Ie),[2,[Ie.idTensor]];case 29:return J=_("tensorListId",r,e,t),Q=_("indices",r,e,t),k=_("elementShape",r,e,t),St=_("elementDType",r,e,t),Ie=t.getTensorList(J.id),[2,[Ie.gather(Q,St,k)]];case 30:return Ge=_("tensorListId",r,e,t),k=_("elementShape",r,e,t),St=_("elementDType",r,e,t),ft=_("numElements",r,e,t),Ie=t.getTensorList(Ge.id),[2,[Ie.stack(k,St,ft)]];case 31:return Xr=_("tensor",r,e,t),k=_("elementShape",r,e,t),St=_("elementDType",r,e,t),Ie=Goe(Xr,k,St),t.addTensorList(Ie),[2,[Ie.idTensor]];case 32:return se=_("tensorListId",r,e,t),Ie=t.getTensorList(se.id),ye=_("dtype",r,e,t),k=_("elementShape",r,e,t),[2,[Ie.concat(ye,k)]];case 33:return Ge=_("tensorListId",r,e,t),B=_("tensor",r,e,t),Ie=t.getTensorList(Ge.id),Ie.pushBack(B),[2,[Ie.idTensor]];case 34:return Ge=_("tensorListId",r,e,t),k=_("elementShape",r,e,t),cr=_("elementDType",r,e,t),Ie=t.getTensorList(Ge.id),[2,[Ie.popBack(k,cr)]];case 35:return Ae=_("tensor",r,e,t),k=_("elementShape",r,e,t),We=_("lengths",r,e,t),Ie=qoe(Ae,We,k),t.addTensorList(Ie),[2,[Ie.idTensor]];case 36:throw TypeError("Node type "+r.op+" is not implemented")}})})};function PE(r,e,t){var n=we(_("fusedOps",r,e,t),2),o=n[0],a=n[1],i=o==="biasadd",s=!i,u=a==="prelu",l=o==="fusedbatchnorm",c=_("numArgs",r,e,t);if(i){if(u&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var p=_("strides",r,e,t),f=Ed(r,e,t),d=_("dataFormat",r,e,t).toUpperCase(),m=_("dilations",r,e,t),h=we(_("args",r,e,t),2),g=h[0],v=h[1];s&&(v=g,g=void 0);var x=_("leakyreluAlpha",r,e,t);return{stride:p,pad:f,dataFormat:d,dilations:m,biasArg:g,preluArg:v,activationFunc:a,leakyreluAlpha:x}}var Yoe=function(r,e,t){switch(r.op){case"Conv1D":{var n=_("stride",r,e,t),o=_("pad",r,e,t),a=_("dataFormat",r,e,t).toUpperCase(),i=_("dilation",r,e,t);return[PN(_("x",r,e,t),_("filter",r,e,t),n,o,a,i)]}case"Conv2D":{var n=_("strides",r,e,t),o=Ed(r,e,t),a=_("dataFormat",r,e,t).toUpperCase(),s=_("dilations",r,e,t);return[Qc(_("x",r,e,t),_("filter",r,e,t),[n[1],n[2]],o,a,[s[1],s[2]])]}case"_FusedConv2D":{var u=PE(r,e,t),n=u.stride,o=u.pad,a=u.dataFormat,s=u.dilations,l=u.biasArg,c=u.preluArg,p=u.activationFunc,f=u.leakyreluAlpha;return[NE({x:_("x",r,e,t),filter:_("filter",r,e,t),strides:[n[1],n[2]],pad:o,dataFormat:a,dilations:[s[1],s[2]],bias:l,activation:p,preluActivationWeights:c,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{var d=PE(r,e,t),n=d.stride,o=d.pad,a=d.dataFormat,s=d.dilations,l=d.biasArg,c=d.preluArg,p=d.activationFunc,f=d.leakyreluAlpha;return[EE({x:_("x",r,e,t),filter:_("filter",r,e,t),strides:[n[1],n[2]],pad:o,dataFormat:a,dilations:[s[1],s[2]],bias:l,activation:p,preluActivationWeights:c,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{var m=_("outputShape",r,e,t),n=_("strides",r,e,t),o=Ed(r,e,t);return[MN(_("x",r,e,t),_("filter",r,e,t),m,[n[1],n[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{var n=_("strides",r,e,t),o=Ed(r,e,t),s=_("dilations",r,e,t),a=_("dataFormat",r,e,t).toUpperCase();return[Vd(_("input",r,e,t),_("filter",r,e,t),[n[1],n[2]],o,a,[s[1],s[2]])]}case"Conv3D":{var n=_("strides",r,e,t),o=_("pad",r,e,t),a=_("dataFormat",r,e,t).toUpperCase(),s=_("dilations",r,e,t);return[BN(_("x",r,e,t),_("filter",r,e,t),[n[1],n[2],n[3]],o,a,[s[1],s[2],s[3]])]}case"AvgPool":{var n=_("strides",r,e,t),o=_("pad",r,e,t),h=_("kernelSize",r,e,t);return[Ey(_("x",r,e,t),[h[1],h[2]],[n[1],n[2]],o)]}case"MaxPool":{var n=_("strides",r,e,t),o=_("pad",r,e,t),h=_("kernelSize",r,e,t);return[Wy(_("x",r,e,t),[h[1],h[2]],[n[1],n[2]],o)]}case"MaxPoolWithArgmax":{var n=_("strides",r,e,t),o=_("pad",r,e,t),h=_("kernelSize",r,e,t),g=_("includeBatchInIndex",r,e,t),v=nE(_("x",r,e,t),[h[1],h[2]],[n[1],n[2]],o,g),x=v.result,y=v.indexes;return[x,y]}case"AvgPool3D":{var n=_("strides",r,e,t),o=_("pad",r,e,t),h=_("kernelSize",r,e,t);return[FN(_("x",r,e,t),[h[1],h[2],h[3]],[n[1],n[2],n[3]],o)]}case"MaxPool3D":{var n=_("strides",r,e,t),o=_("pad",r,e,t),h=_("kernelSize",r,e,t);return[rE(_("x",r,e,t),[h[1],h[2],h[3]],[n[1],n[2],n[3]],o)]}case"Dilation2D":{var b=_("strides",r,e,t),o=_("pad",r,e,t),s=_("dilations",r,e,t),k=b[1],N=b[2],E=s[1],T=s[2];return[GN(_("x",r,e,t),_("filter",r,e,t),[k,N],o,[E,T],"NHWC")]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var Zoe=function(r,e,t){switch(r.op){case"Fill":{var n=_("shape",r,e,t),o=_("dtype",r,e,t),a=_("value",r,e,t);return[zd(n,a,o)]}case"LinSpace":{var i=_("start",r,e,t),s=_("stop",r,e,t),u=_("num",r,e,t);return[JN(i,s,u)]}case"Multinomial":{var l=_("logits",r,e,t),c=_("numSamples",r,e,t),p=_("seed",r,e,t);return[iE(l,c,p)]}case"OneHot":{var f=_("indices",r,e,t),d=_("depth",r,e,t),m=_("onValue",r,e,t),h=_("offValue",r,e,t);return[uE(f,d,m,h)]}case"Ones":return[Ta(_("shape",r,e,t),_("dtype",r,e,t))];case"OnesLike":return[lE(_("x",r,e,t))];case"RandomUniform":return[Xy(_("shape",r,e,t),_("minval",r,e,t),_("maxval",r,e,t),_("dtype",r,e,t))];case"Range":{var i=_("start",r,e,t),s=_("stop",r,e,t),g=_("step",r,e,t);return[tl(i,s,g,_("dtype",r,e,t))]}case"TruncatedNormal":{var n=_("shape",r,e,t),v=_("mean",r,e,t),x=_("stdDev",r,e,t),p=_("seed",r,e,t);return[kE(n,v,x,_("dtype",r,e,t),p)]}case"Zeros":return[Ns(_("shape",r,e,t),_("dtype",r,e,t))];case"ZerosLike":return[Wd(_("x",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},Joe=void 0;function fb(r,e,t){var n=_("boxes",r,e,t),o=_("scores",r,e,t),a=_("maxOutputSize",r,e,t),i=_("iouThreshold",r,e,t),s=_("scoreThreshold",r,e,t),u=_("softNmsSigma",r,e,t);return{boxes:n,scores:o,maxOutputSize:a,iouThreshold:i,scoreThreshold:s,softNmsSigma:u}}var Qoe=function(r,e,t){return wt(Joe,void 0,void 0,function(){var n,o,a,i,s,u,l,c,p,f,a,i,s,u,l,d,p,m,a,i,s,u,l,h,p;return yt(this,function(g){switch(g.label){case 0:switch(n=r.op,n){case"NonMaxSuppressionV5":return[3,1];case"NonMaxSuppressionV4":return[3,3];case"NonMaxSuppressionV3":return[3,5];case"NonMaxSuppressionV2":return[3,5];case"Where":return[3,7];case"ListDiff":return[3,9]}return[3,10];case 1:return o=fb(r,e,t),a=o.boxes,i=o.scores,s=o.maxOutputSize,u=o.iouThreshold,l=o.scoreThreshold,c=o.softNmsSigma,[4,Fs.nonMaxSuppressionWithScoreAsync(a,i,s,u,l,c)];case 2:return p=g.sent(),[2,[p.selectedIndices,p.selectedScores]];case 3:return f=fb(r,e,t),a=f.boxes,i=f.scores,s=f.maxOutputSize,u=f.iouThreshold,l=f.scoreThreshold,d=_("padToMaxOutputSize",r,e,t),[4,Fs.nonMaxSuppressionPaddedAsync(a,i,s,u,l,d)];case 4:return p=g.sent(),[2,[p.selectedIndices,p.validOutputs]];case 5:return m=fb(r,e,t),a=m.boxes,i=m.scores,s=m.maxOutputSize,u=m.iouThreshold,l=m.scoreThreshold,[4,Fs.nonMaxSuppressionAsync(a,i,s,u,l)];case 6:return[2,[g.sent()]];case 7:return h=nr(_("condition",r,e,t),"bool"),[4,rb(h)];case 8:return p=[g.sent()],h.dispose(),[2,p];case 9:return[2,dE(_("x",r,e,t),_("y",r,e,t))];case 10:throw TypeError("Node type "+r.op+" is not implemented")}})})};var eae=function(r,e,t){switch(r.op){case"TopKV2":{var n=_("x",r,e,t),o=_("k",r,e,t),a=_("sorted",r,e,t),i=wE(n,o,a);return[i.values,i.indices]}case"Unique":{var n=_("x",r,e,t),i=tb(n);return[i.values,i.indices]}case"UniqueV2":{var n=_("x",r,e,t),s=_("axis",r,e,t),i=tb(n,s);return[i.values,i.indices]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var tae=function(r,e,t){switch(r.op){case"Const":return e[r.name];case"PlaceholderWithDefault":var n=_("default",r,e,t);return[Or(r.name,e,t)||n];case"Placeholder":return[Or(r.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{var o=_("x",r,e,t);return[$o(o)]}case"IdentityN":return _("x",r,e,t).map(function(p){return $o(p)});case"Snapshot":var a=_("x",r,e,t);return[$o(a)];case"Shape":return[gn(_("x",r,e,t).shape,"int32")];case"ShapeN":return _("x",r,e,t).map(function(p){return gn(p.shape)});case"Size":return[Nt(_("x",r,e,t).size,"int32")];case"Rank":return[Nt(_("x",r,e,t).rank,"int32")];case"NoOp":return[Nt(1)];case"Print":var i=_("x",r,e,t),s=_("data",r,e,t),u=_("message",r,e,t),l=_("summarize",r,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(var c=0;c<s.length;c++)console.log(Array.prototype.slice.call(s[c].dataSync()).slice(0,l));return[i];default:throw TypeError("Node type "+r.op+" is not implemented")}},rae=function(){function r(e,t){this.keyDType=e,this.valueDType=t,this.handle=Ce.scalar(0),this.tensorMap=new Map,Ce.keep(this.handle)}return Object.defineProperty(r.prototype,"id",{get:function(){return this.handle.id},enumerable:!0,configurable:!0}),r.prototype.clearAndClose=function(){this.tensorMap.forEach(function(e){return e.dispose()}),this.tensorMap.clear(),this.handle.dispose()},r.prototype.size=function(){return this.tensorMap.size},r.prototype.tensorSize=function(){return Nt(this.size(),"int32")},r.prototype.import=function(e,t){return wt(this,void 0,void 0,function(){var n,o=this;return yt(this,function(a){switch(a.label){case 0:return this.checkKeyAndValueTensor(e,t),[4,e.data()];case 1:return n=a.sent(),this.tensorMap.forEach(function(i){return i.dispose()}),this.tensorMap.clear(),[2,Ce.tidy(function(){var i=Ce.unstack(t),s=n.length,u=i.length;Ce.util.assert(s===u,function(){return"The number of elements doesn't match, keys has "+(s+" elements, the values has "+u+" ")+"elements."});for(var l=0;l<s;l++){var c=n[l],p=i[l];Ce.keep(p),o.tensorMap.set(c,p)}return o.handle})]}})})},r.prototype.find=function(e,t){return wt(this,void 0,void 0,function(){var n,o=this;return yt(this,function(a){switch(a.label){case 0:return this.checkKeyAndValueTensor(e,t),[4,e.data()];case 1:return n=a.sent(),[2,Ce.tidy(function(){for(var i=[],s=0;s<n.length;s++){var u=n[s],l=o.findWithDefault(u,t);i.push(l)}return Ce.stack(i)})]}})})},r.prototype.findWithDefault=function(e,t){var n=this.tensorMap.get(e);return n!=null?n:t},r.prototype.checkKeyAndValueTensor=function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype "+this.keyDType+", but got "+(""+e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype "+this.valueDType+", but got "+(""+t.dtype))},r}(),nae=void 0,oae=function(r,e,t,n){return wt(nae,void 0,void 0,function(){var o,a,i,s,u,l,c,s,u,l,p,s,u,s;return yt(this,function(f){switch(f.label){case 0:switch(o=r.op,o){case"HashTable":return[3,1];case"HashTableV2":return[3,1];case"LookupTableImport":return[3,2];case"LookupTableImportV2":return[3,2];case"LookupTableFind":return[3,4];case"LookupTableFindV2":return[3,4];case"LookupTableSize":return[3,6];case"LookupTableSizeV2":return[3,6]}return[3,7];case 1:return a=_("keyDType",r,e,t),i=_("valueDType",r,e,t),s=new rae(a,i),n.addHashTable(r.name,s),[2,[s.handle]];case 2:return u=_("tableHandle",r,e,t,n),l=_("keys",r,e,t),c=_("values",r,e,t),s=n.getHashTableById(u.id),[4,s.import(l,c)];case 3:return[2,[f.sent()]];case 4:return u=_("tableHandle",r,e,t,n),l=_("keys",r,e,t),p=_("defaultValue",r,e,t),s=n.getHashTableById(u.id),[4,s.find(l,p)];case 5:return[2,[f.sent()]];case 6:return u=_("tableHandle",r,e,t,n),s=n.getHashTableById(u.id),[2,[s.tensorSize()]];case 7:throw TypeError("Node type "+r.op+" is not implemented")}})})};var aae=function(r,e,t){switch(r.op){case"ResizeBilinear":{var n=_("images",r,e,t),o=_("size",r,e,t),a=_("alignCorners",r,e,t),i=_("halfPixelCenters",r,e,t);return[Fs.resizeBilinear(n,[o[0],o[1]],a,i)]}case"ResizeNearestNeighbor":{var n=_("images",r,e,t),o=_("size",r,e,t),a=_("alignCorners",r,e,t),i=_("halfPixelCenters",r,e,t);return[Fs.resizeNearestNeighbor(n,[o[0],o[1]],a,i)]}case"CropAndResize":{var s=_("image",r,e,t),u=_("boxes",r,e,t),l=_("boxInd",r,e,t),c=_("cropSize",r,e,t),p=_("method",r,e,t),f=_("extrapolationValue",r,e,t);return[Fs.cropAndResize(s,u,l,c,p,f)]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var sae=function(r,e,t){switch(r.op){case"Equal":return[Dy(_("a",r,e,t),_("b",r,e,t))];case"NotEqual":return[Uy(_("a",r,e,t),_("b",r,e,t))];case"Greater":return[ep(_("a",r,e,t),_("b",r,e,t))];case"GreaterEqual":return[Py(_("a",r,e,t),_("b",r,e,t))];case"Less":return[ZN(_("a",r,e,t),_("b",r,e,t))];case"LessEqual":return[jd(_("a",r,e,t),_("b",r,e,t))];case"LogicalAnd":return[tp(_("a",r,e,t),_("b",r,e,t))];case"LogicalNot":return[Ly(_("a",r,e,t))];case"LogicalOr":return[Vy(_("a",r,e,t),_("b",r,e,t))];case"Select":case"SelectV2":return[Is(_("condition",r,e,t),_("a",r,e,t),_("b",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},iae=function(r,e,t){switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[bt(_("a",r,e,t),_("b",r,e,t),_("transposeA",r,e,t),_("transposeB",r,e,t))];case"Einsum":return[HN.apply(Voe,_r([_("equation",r,e,t)],_("tensors",r,e,t)))];case"Transpose":return[Qd(_("x",r,e,t),_("perm",r,e,t))];case"_FusedMatMul":var n=we(_("fusedOps",r,e,t),2),o=n[0],a=n[1],i=o==="biasadd",s=a==="prelu",u=_("numArgs",r,e,t),l=_("leakyreluAlpha",r,e,t);if(i){if(s&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var c=we(_("args",r,e,t),2),p=c[0],f=c[1];return[TE({a:_("a",r,e,t),b:_("b",r,e,t),transposeA:_("transposeA",r,e,t),transposeB:_("transposeB",r,e,t),bias:p,activation:a,preluActivationWeights:f,leakyreluAlpha:l})];default:throw TypeError("Node type "+r.op+" is not implemented")}};var uae=function(r,e,t){switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[Zu(_("x",r,e,t),_("mean",r,e,t),_("variance",r,e,t),_("offset",r,e,t),_("scale",r,e,t),_("epsilon",r,e,t))];case"FusedBatchNormV3":return[Zu(_("x",r,e,t),_("mean",r,e,t),_("variance",r,e,t),_("offset",r,e,t),_("scale",r,e,t),_("epsilon",r,e,t))];case"LRN":return[QN(_("x",r,e,t),_("radius",r,e,t),_("bias",r,e,t),_("alpha",r,e,t),_("beta",r,e,t))];case"Softmax":return[vE(_("x",r,e,t))];case"LogSoftmax":return[eE(_("x",r,e,t))];case"SparseToDense":return[ob(_("sparseIndices",r,e,t),_("outputShape",r,e,t),_("sparseValues",r,e,t),_("defaultValue",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}};var lae=function(r,e,t){switch(r.op){case"Max":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[Cs(_("x",r,e,t),n,o)]}case"Mean":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[rp(_("x",r,e,t),n,o)]}case"Min":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[qd(_("x",r,e,t),n,o)]}case"Sum":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[Ct(_("x",r,e,t),n,o)]}case"All":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[kN(_("x",r,e,t),n,o)]}case"Any":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[_N(_("x",r,e,t),n,o)]}case"ArgMax":{var n=_("axis",r,e,t);return[SN(_("x",r,e,t),n)]}case"ArgMin":{var n=_("axis",r,e,t);return[IN(_("x",r,e,t),n)]}case"Prod":{var n=_("axis",r,e,t),o=_("keepDims",r,e,t);return[Hy(_("x",r,e,t),n,o)]}case"Cumsum":{var n=_("axis",r,e,t),a=_("exclusive",r,e,t),i=_("reverse",r,e,t);return[WN(_("x",r,e,t),n,a,i)]}case"Bincount":var s=_("x",r,e,t),u=_("weights",r,e,t),l=_("size",r,e,t);return[Ay(s,u,l)];case"DenseBincount":{var c=_("x",r,e,t),p=_("weights",r,e,t),f=_("size",r,e,t),d=_("binaryOutput",r,e,t);return[zN(c,p,f,d)]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var cae=function(r,e,t){switch(r.op){case"ConcatV2":case"Concat":{var n=_("n",r,e,t),o=_("axis",r,e,t),a=_("tensors",r,e,t);return a=a.slice(0,n),[jr(a,o)]}case"Gather":{var i=_("x",r,e,t),s=_("indices",r,e,t);return[Ud(i,nr(s,"int32"),0)]}case"GatherV2":{var o=_("axis",r,e,t),u=_("batchDims",r,e,t),i=_("x",r,e,t),s=_("indices",r,e,t);return[Ud(i,nr(s,"int32"),o,u)]}case"Reverse":{for(var l=_("dims",r,e,t),o=[],c=0;c<l.length;c++)l[c]&&o.push(c);var i=_("x",r,e,t);return[Mo(i,o)]}case"ReverseV2":{var o=_("axis",r,e,t),i=_("x",r,e,t);return[Mo(i,o)]}case"Slice":{var p=_("begin",r,e,t),f=_("size",r,e,t);return[Lt(_("x",r,e,t),p,f)]}case"StridedSlice":{var p=_("begin",r,e,t),d=_("end",r,e,t),m=_("strides",r,e,t),h=_("beginMask",r,e,t),g=_("endMask",r,e,t),v=_("ellipsisMask",r,e,t),x=_("newAxisMask",r,e,t),y=_("shrinkAxisMask",r,e,t),b=_("x",r,e,t);return[yE(b,p,d,m,h,g,v,x,y)]}case"Pack":return Ce.tidy(function(){var M=_("axis",r,e,t),B=_("tensors",r,e,t),L=B[0].shape,H=nl(B[0]).shape,W=B.map(function(K){var J=Ce.util.arraysEqual(K.shape,L);if(!J&&!Ce.util.arraysEqual(nl(K).shape,H))throw new Error("the input tensors shape does not match");return J?K:ie(K,L)});return[ol(W,M)]});case"Unpack":{var o=_("axis",r,e,t),b=_("tensor",r,e,t);return Jd(b,o)}case"Tile":{var k=_("reps",r,e,t);return[Ju(_("x",r,e,t),k)]}case"Split":case"SplitV":{var o=_("axis",r,e,t),N=_("numOrSizeSplits",r,e,t),b=_("x",r,e,t);return rl(b,N,o)}case"ScatterNd":{var s=_("indices",r,e,t),E=_("values",r,e,t),T=_("shape",r,e,t);return[SE(s,E,T)]}case"GatherNd":{var R=_("x",r,e,t),s=_("indices",r,e,t);return[IE(R,s)]}case"SparseToDense":{var s=_("sparseIndices",r,e,t),T=_("outputShape",r,e,t),$=_("sparseValues",r,e,t),O=_("defaultValue",r,e,t);return[ob(s,$,T,$.dtype===O.dtype?O:nr(O,$.dtype))]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var pae=function(r,e,t){switch(r.op){case"SparseFillEmptyRows":{var n=up.sparseFillEmptyRows(_("indices",r,e,t),_("values",r,e,t),_("denseShape",r,e,t),_("defaultValue",r,e,t)),o=n.outputIndices,a=n.outputValues,i=n.emptyRowIndicator,s=n.reverseIndexMap;return[o,a,i,s]}case"SparseReshape":{var u=up.sparseReshape(_("inputIndices",r,e,t),_("inputShape",r,e,t),_("newShape",r,e,t)),o=u.outputIndices,l=u.outputShape;return[o,l]}case"SparseSegmentMean":{var c=up.sparseSegmentMean(_("data",r,e,t),_("indices",r,e,t),_("segmentIds",r,e,t));return[c]}case"SparseSegmentSum":{var c=up.sparseSegmentSum(_("data",r,e,t),_("indices",r,e,t),_("segmentIds",r,e,t));return[c]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var fae=function(r,e,t){switch(r.op){case"FFT":return[Xd(_("x",r,e,t))];case"IFFT":return[sp(_("x",r,e,t))];case"RFFT":return[Yd(_("x",r,e,t))];case"IRFFT":return[Jy(_("x",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}};var dae=function(r,e,t){switch(r.op){case"StringNGrams":{var n=em.stringNGrams(_("data",r,e,t),_("dataSplits",r,e,t),_("separator",r,e,t),_("nGramWidths",r,e,t),_("leftPad",r,e,t),_("rightPad",r,e,t),_("padWidth",r,e,t),_("preserveShortSequences",r,e,t)),o=n.nGrams,a=n.nGramsSplits;return[o,a]}case"StringSplit":{var i=em.stringSplit(_("input",r,e,t),_("delimiter",r,e,t),_("skipEmpty",r,e,t)),s=i.indices,u=i.values,l=i.shape;return[s,u,l]}case"StringToHashBucketFast":{var c=em.stringToHashBucketFast(_("input",r,e,t),_("numBuckets",r,e,t));return[c]}default:throw TypeError("Node type "+r.op+" is not implemented")}};var mae=function(r,e,t){switch(r.op){case"Cast":return[nr(_("x",r,e,t),_("dtype",r,e,t))];case"ExpandDims":{var n=_("axis",r,e,t);return[Ea(_("x",r,e,t),n)]}case"Squeeze":{var n=_("axis",r,e,t);return[nl(_("x",r,e,t),n)]}case"Reshape":return[ie(_("x",r,e,t),_("shape",r,e,t))];case"MirrorPad":return[aE(_("x",r,e,t),_("padding",r,e,t),_("mode",r,e,t))];case"PadV2":case"Pad":return[el(_("x",r,e,t),_("padding",r,e,t),_("constantValue",r,e,t))];case"SpaceToBatchND":{var o=_("blockShape",r,e,t),a=_("paddings",r,e,t);return[Gy(_("x",r,e,t),o,a)]}case"BatchToSpaceND":{var o=_("blockShape",r,e,t),i=_("crops",r,e,t);return[Ty(_("x",r,e,t),o,i)]}case"DepthToSpace":{var s=_("blockSize",r,e,t),u=_("dataFormat",r,e,t).toUpperCase();return[UN(_("x",r,e,t),s,u)]}case"BroadcastTo":return[Jc(_("x",r,e,t),_("shape",r,e,t))];case"BroadcastArgs":return[DN(_("s0",r,e,t),_("s1",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}};function OE(r,e,t,n){var o=function(a,i,s){switch(a.category){case"arithmetic":return Tr.tidy(function(){return Woe(a,i,s)});case"basic_math":return Tr.tidy(function(){return zoe(a,i,s)});case"control":return Xoe(a,i,s);case"convolution":return Tr.tidy(function(){return Yoe(a,i,s)});case"creation":return Tr.tidy(function(){return Zoe(a,i,s)});case"dynamic":return Qoe(a,i,s);case"evaluation":return Tr.tidy(function(){return eae(a,i,s)});case"image":return Tr.tidy(function(){return aae(a,i,s)});case"graph":return Tr.tidy(function(){return tae(a,i,s)});case"logical":return Tr.tidy(function(){return sae(a,i,s)});case"matrices":return Tr.tidy(function(){return iae(a,i,s)});case"normalization":return Tr.tidy(function(){return uae(a,i,s)});case"reduction":return Tr.tidy(function(){return lae(a,i,s)});case"slice_join":return Tr.tidy(function(){return cae(a,i,s)});case"sparse":return Tr.tidy(function(){return pae(a,i,s)});case"spectral":return Tr.tidy(function(){return fae(a,i,s)});case"string":return Tr.tidy(function(){return dae(a,i,s)});case"transformation":return Tr.tidy(function(){return mae(a,i,s)});case"hash_table":return oae(a,i,s,n);case"custom":var u=NC(a.op);if(u&&u.customExecutor)return u.customExecutor(new HX(a,i,s));throw TypeError("Custom op "+a.op+" is not registered.");default:throw TypeError("Unknown op '"+a.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(r,e,t);return Tr.util.isPromise(o)?o.then(function(a){return[].concat(a)}):[].concat(o)}var ME=function(){function r(e,t,n,o){e===void 0&&(e={}),t===void 0&&(t={}),n===void 0&&(n={}),o===void 0&&(o={}),this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return r.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(r.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),r.prototype.generateCurrentContextIds=function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e},r.prototype.contextIdforContexts=function(e){return e?e.map(function(t){return t.id===0&&t.iterationId===0?"":t.frameName+"-"+t.iterationId}).join("/"):""},r.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},r.prototype.exitFrame=function(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")},r.prototype.nextIteration=function(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")},r.prototype.getWeight=function(e){return this.weightMap[e]},r.prototype.addTensorArray=function(e){this.tensorArrayMap[e.id]=e},r.prototype.getTensorArray=function(e){return this.tensorArrayMap[e]},r.prototype.addTensorList=function(e){this.tensorListMap[e.id]=e},r.prototype.getTensorList=function(e){return this.tensorListMap[e]},r.prototype.dispose=function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)},r}();function BE(r,e,t,n){var o=new Set,a=[],i=null,s=null,u=new Set,l=Object.keys(r).map(function(d){return tn(d)[0]}),c=[];n!=null&&(c=n.map(function(d){return tn(d.name)[0]}));for(var p=_r(e);p.length>0;){var f=p.pop();if((LE(f)||yae(f)||bae(f))&&i==null&&(i=f,s=i.children.map(function(d){return d.name}).filter(function(d){return o.has(d)})),o.add(f.name),t[f.name]==null&&l.indexOf(f.name)===-1&&c.indexOf(f.name)===-1){if(f.inputs.length===0){a.push(f.name);continue}f.inputs.forEach(function(d){u.has(d.name)||(u.add(d.name),p.push(d))})}}return{inputs:r,outputs:e,usedNodes:o,missingInputs:a,dynamicNode:i,syncInputs:s}}function hae(r,e,t){var n=t.usedNodes,o=t.inputs,a=[],i=Object.keys(o).map(function(p){return tn(p)[0]}).map(function(p){return r.nodes[p]}),s=r.initNodes;i.forEach(function(p){n.has(p.name)&&a.push(p)}),r.weights.forEach(function(p){n.has(p.name)&&a.push(p)}),s!=null&&s.forEach(function(p){n.has(p.name)&&a.push(p)});for(var u=new Set,l=[];a.length>0;){var c=a.pop();u.add(c.name),e[c.name]||l.push(c),c.children.forEach(function(p){!u.has(p.name)&&n.has(p.name)&&p.inputs.every(function(f){return u.has(f.name)})&&a.push(p)})}return l}var gae=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],vae=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],xae=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function LE(r){return gae.indexOf(r.op)>=0}function yae(r){return vae.indexOf(r.op)>=0}function bae(r){return xae.indexOf(r.op)>=0}var VE=function(){function r(e,t){var n=this;this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(function(o){n._functionExecutorMap[o]=new r(e.functions[o],n)})}return Object.defineProperty(r.prototype,"weightIds",{get:function(){return this.parent?this.parent.weightIds:this._weightIds},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"functionExecutorMap",{get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"weightMap",{get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t=Object.keys(e).map(function(n){return e[n].map(function(o){return o.id})});this._weightIds=[].concat.apply([],_r(t)),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"resourceManager",{set:function(e){this._resourceManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputs",{get:function(){return this._inputs.map(function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputs",{get:function(){return this._outputs.map(function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputNodes",{get:function(){return this._inputs.map(function(e){return e.signatureKey||e.name})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputNodes",{get:function(){return this._outputs.map(function(e){var t=e.signatureKey||e.name;return e.defaultOutput?t+":"+e.defaultOutput:t})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"functions",{get:function(){var e=this;return Object.keys(this._functions).reduce(function(t,n){return t[n]=e._functions[n].signature,t},{})},enumerable:!0,configurable:!0}),r.prototype.getCompilationKey=function(e,t){var n=e.map(function(a){return a.name}).sort(),o=t.map(function(a){return a.name}).sort();return n.join(this.SEPERATOR)+"--"+o.join(this.SEPERATOR)},r.prototype.compile=function(e,t){var n=BE(e,t,this.weightMap,this._initNodes),o=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(a!=null)throw new Error("This execution contains the node '"+a.name+"', which has "+("the dynamic op '"+a.op+"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+("dynamic ops, specify the inputs ["+i+"]"));if(o.length>0){var s=t.map(function(l){return l.name}),u=Object.keys(e);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs "+("["+u+"]. Missing the following inputs: ["+o+"]"))}return hae(this.graph,this.weightMap,n)},r.prototype.execute=function(e,t){var n=this;e=this.mapInputs(e);var o=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=o.map(function(f){return n.graph.nodes[tn(f)[0]]}),i=t.map(function(f){return tn(f)[0]}),s=i.map(function(f){return n.graph.nodes[f]});s.length===0&&(s=this._outputs);var u=this.getCompilationKey(a,s),l=this.compiledMap.get(u);l==null&&(l=this.compile(e,s),this.compiledMap.set(u,l));var c={},p={};return Ce.tidy(function(){var f=new ME(n.weightMap,c,p,n.functionExecutorMap),d=Object.assign({},n.weightMap);Object.keys(e).forEach(function(y){var b=we(tn(y),2),k=b[0],N=b[1],E=[];E[N]=e[y],d[k]=E});for(var m=n.getFrozenTensorIds(d),h={},g=0;g<l.length;g++){var v=l[g];if(!d[v.name]){var x=OE(v,d,f,n._resourceManager);if(Ce.util.isPromise(x))throw new Error("The execution of the op '"+v.op+"' returned a promise. Please use model.executeAsync() instead.");d[v.name]=x,n.checkTensorForDisposal(v.name,v,d,f,m,i,h)}}return n.parent==null&&f.dispose(m),t.map(function(y){return Or(y,d,f)})})},r.prototype.getFrozenTensorIds=function(e){var t=[].concat.apply([],Object.keys(e).map(function(n){return e[n]}).map(function(n){return n.map(function(o){return o.id})}));return new Set(t)},r.prototype.checkTensorForDisposal=function(e,t,n,o,a,i,s){t.category==="control"||i.indexOf(e)!==-1||(n[e].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+t.children.length)}),t.inputs.forEach(function(u){if(u.category!=="control"){var l=sX(u.name,n,o);l!=null&&l.forEach(function(c){if(c&&!c.kept&&!a.has(c.id)){var p=s[c.id];p===1?(c.dispose(),delete s[c.id]):p!=null&&s[c.id]--}})}}))},r.prototype.executeAsync=function(e,t){return wt(this,void 0,void 0,function(){return yt(this,function(n){return[2,this._executeAsync(e,t)]})})},r.prototype._executeAsync=function(e,t,n,o,a){return n===void 0&&(n=!1),o===void 0&&(o={}),a===void 0&&(a={}),wt(this,void 0,void 0,function(){var i,s,u,l,c,p;return yt(this,function(f){switch(f.label){case 0:return n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t)),i=new ME(this.weightMap,o,a,this.functionExecutorMap),[4,this.executeWithControlFlow(e,i,t,n)];case 1:return s=f.sent(),u=t.map(function(d){return Or(d,s,i)}),l=u.map(function(d){return d.id}),c=Object.keys(e).map(function(d){return e[d].id}),p=new Set(_r(l,c,this.weightIds)),Object.keys(s).forEach(function(d){var m=s[d];m.forEach(function(h){h&&!h.kept&&!h.isDisposed&&!p.has(h.id)&&h.dispose()})}),this.parent==null&&i.dispose(p),[2,u]}})})},r.prototype.executeFunctionAsync=function(e,t,n){return wt(this,void 0,void 0,function(){var o,a=this;return yt(this,function(i){return o=e.reduce(function(s,u,l){return s[a.inputs[l].name]=u,s},{}),[2,this._executeAsync(o,this.outputNodes,!0,t,n)]})})},r.prototype.executeWithControlFlow=function(e,t,n,o){return wt(this,void 0,void 0,function(){var a,i,s,u,l,c,p,f,d,m,h,g,v,x,y,b,k,N=this;return yt(this,function(E){switch(E.label){case 0:a=Object.keys(e),i=a.map(function(T){return N.graph.nodes[tn(T)[0]]}),s=n.map(function(T){return tn(T)[0]}),u=s.map(function(T){return N.graph.nodes[T]}),u.length===0&&(u=this._outputs),l=BE(e,u,this.weightMap,this._initNodes),c=l.usedNodes,p=l.missingInputs,f=l.dynamicNode,d=l.syncInputs,m=_r(i,this.graph.weights,this._initNodes||[]).map(function(T){return{node:T,contexts:t.currentContext}}),h=Object.assign({},this.weightMap),Object.keys(e).forEach(function(T){var R=we(tn(T),2),$=R[0],O=R[1],M=[];M[O]=e[T],h[$]=M}),g={},v=this.getFrozenTensorIds(h),x={},E.label=1;case 1:return m.length>0?(y=this.processStack(i,m,t,h,x,v,s,g,c),[4,Promise.all(y)]):[3,3];case 2:return E.sent(),[3,1];case 3:if(f==null&&!o&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),b=u.filter(function(T){return!LE(T)&&!Or(T.name,h,t)}).map(function(T){return T.name}),b.length>0)throw k="",f!=null&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+("and specify the inputs ["+d+"]")),new Error("Cannot compute the outputs ["+b+"] from the provided "+("inputs ["+a+"]. Consider providing the following inputs: ")+("["+p+"]. "+k));return[2,h]}})})},r.prototype.processStack=function(e,t,n,o,a,i,s,u,l){for(var c=this,p=[],f=function(){var m,h,g=t.pop();n.currentContext=g.contexts;var v="";if(g.node.op==="Enter"&&_("isConstant",g.node,o,n)&&(m=we(Ro(g.node.name,n),1),v=m[0]),o[g.node.name]==null){var x=OE(g.node,o,n,d._resourceManager);v||(h=we(Ro(g.node.name,n),1),v=h[0]);var y=n.currentContext;Ce.util.isPromise(x)?p.push(x.then(function(b){return o[v]=b,n.currentContext=y,c.checkTensorForDisposal(v,g.node,o,n,i,s,u),c.processChildNodes(g.node,t,n,o,a,l),b})):(o[v]=x,d.checkTensorForDisposal(v,g.node,o,n,i,s,u),d.processChildNodes(g.node,t,n,o,a,l))}else d.processChildNodes(g.node,t,n,o,a,l)},d=this;t.length>0;)f();return p},r.prototype.processChildNodes=function(e,t,n,o,a,i){e.children.forEach(function(s){var u=we(Ro(s.name,n),1),l=u[0];a[l]||!i.has(s.name)||(s.op==="Merge"?s.inputNames.some(function(c){return!!Or(c,o,n)})&&(a[l]=!0,t.push({contexts:n.currentContext,node:s})):s.inputNames.every(function(c){return!!Or(c,o,n)})&&(a[l]=!0,t.push({contexts:n.currentContext,node:s})))})},r.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach(function(t){return e.weightMap[t].forEach(function(n){return n.dispose()})})},r.prototype.checkInputShapeAndType=function(e){var t=this;Object.keys(e).forEach(function(n){var o=e[n],a=we(tn(n),1),i=a[0],s=t.graph.nodes[i];if(s.attrParams.shape&&s.attrParams.shape.value){var u=s.attrParams.shape.value,l=u.length===o.shape.length&&o.shape.every(function(c,p){return u[p]===-1||u[p]===c});Ce.util.assert(l,function(){return"The shape of dict['"+s.name+"'] provided in "+("model.execute(dict) must be ["+u+"], but was ")+("["+o.shape+"]")})}s.attrParams.dtype&&s.attrParams.dtype.value&&Ce.util.assert(o.dtype===s.attrParams.dtype.value,function(){return"The dtype of dict['"+s.name+"'] provided in model.execute(dict) must be "+(s.attrParams.dtype.value+", but was "+o.dtype)})})},r.prototype.mapInputs=function(e){var t={};for(var n in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[n]!=null){var o=this._signature.inputs[n];t[o.name]=e[n]}else t[n]=e[n];return t},r.prototype.checkInputs=function(e){var t=this,n=Object.keys(e).filter(function(o){var a=we(tn(o),1),i=a[0];return t.graph.nodes[i]==null});if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+("keys: ["+n+"] that are not part of graph"))},r.prototype.mapOutputs=function(e){var t=this;return e.map(function(n){if(t._signature!=null&&t._signature.outputs!=null&&t._signature.outputs[n]!=null){var o=t._signature.outputs[n];return o.name}return n},{})},r.prototype.checkOutputs=function(e){var t=this;e.forEach(function(n){var o=we(tn(n),1),a=o[0];if(!t.graph.nodes[a])throw new Error("The output '"+n+"' is not found in the graph")})},r}(),wae=function(){function r(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.hashTableNameToHandle=e,this.hashTableMap=t}return r.prototype.addHashTable=function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t},r.prototype.getHashTableHandleByName=function(e){return this.hashTableNameToHandle[e]},r.prototype.getHashTableById=function(e){return this.hashTableMap[e]},r.prototype.dispose=function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]},r}(),kae="?tfjs-format=file",_ae="model.json",WE=function(){function r(e,t){t===void 0&&(t={}),this.modelUrl=e,this.loadOptions=t,this.version="n/a",t==null&&(this.loadOptions={}),this.resourceManager=new wae}return Object.defineProperty(r.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"metadata",{get:function(){return this.artifacts.userDefinedMetadata},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"modelSignature",{get:function(){return this.signature},enumerable:!0,configurable:!0}),r.prototype.findIOHandler=function(){var e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=Ce.io.browserHTTPRequest(e,this.loadOptions);else{var t=Ce.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(Ce.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one ("+t.length+") load handlers for "+("URL '"+[e]+"'"));this.handler=t[0]}},r.prototype.load=function(){return wt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return e=t.sent(),[2,this.loadSync(e)]}})})},r.prototype.loadSync=function(e){this.artifacts=e;var t=this.artifacts.modelTopology,n;this.artifacts.userDefinedMetadata!=null&&this.artifacts.userDefinedMetadata.signature!=null?n=this.artifacts.userDefinedMetadata.signature:n=this.artifacts.signature,this.signature=n,this.version=t.versions.producer+"."+t.versions.minConsumer;var o=Ce.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new VE(EC.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(o),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){var a=EC.Instance.transformGraph(e.modelInitializer);this.initializer=new VE(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0},r.prototype.save=function(e,t){return wt(this,void 0,void 0,function(){var n;return yt(this,function(o){if(typeof e=="string"){if(n=Ce.io.getSaveHandlers(e),n.length===0)throw new Error("Cannot find any save handlers for URL '"+e+"'");if(n.length>1)throw new Error("Found more than one ("+n.length+") save handlers for "+("URL '"+e+"'"));e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,e.save(this.artifacts)]})})},r.prototype.predict=function(e,t){return this.execute(e,this.outputNodes)},r.prototype.normalizeInputs=function(e){if(!(e instanceof Ce.Tensor)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+("the graph model has "+this.inputNodes.length+" placeholders, ")+("while there are "+e.length+" input tensors."));return this.inputNodes.reduce(function(t,n,o){return t[n]=e[o],t},{})},r.prototype.normalizeOutputs=function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]},r.prototype.execute=function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]},r.prototype.executeAsync=function(e,t){return wt(this,void 0,void 0,function(){var n;return yt(this,function(o){switch(o.label){case 0:return e=this.normalizeInputs(e),t=this.normalizeOutputs(t),[4,this.executor.executeAsync(e,t)];case 1:return n=o.sent(),[2,n.length>1?n:n[0]]}})})},r.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce(function(t,n){return t[n]=[e[n]],t},{})},r.prototype.dispose=function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()},r}();function Sae(r,e){return e===void 0&&(e={}),wt(this,void 0,void 0,function(){var t;return yt(this,function(n){switch(n.label){case 0:if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return e==null&&(e={}),e.fromTFHub&&r.load==null&&(r.endsWith("/")||(r=r+"/"),r=""+r+_ae+kae),t=new WE(r,e),[4,t.load()];case 1:return n.sent(),[2,t]}})})}var Iae="3.11.0";Ds.GraphModel=WE;Ds.deregisterOp=aX;Ds.loadGraphModel=Sae;Ds.registerOp=oX;Ds.version_converter=Iae});var UE=jt(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var cp=Id();sl.disposeBox=function(r){r.startEndTensor.dispose(),r.startPoint.dispose(),r.endPoint.dispose()};sl.createBox=function(r){return{startEndTensor:r,startPoint:cp.slice(r,[0,0],[-1,2]),endPoint:cp.slice(r,[0,2],[-1,2])}};sl.scaleBox=function(r,e){var t=cp.mul(r.startPoint,e),n=cp.mul(r.endPoint,e),o=cp.concat2d([t,n],1);return sl.createBox(o)}});var db=jt(Rs=>{"use strict";var pp=Rs&&Rs.__awaiter||function(r,e,t,n){return new(t||(t=Promise))(function(o,a){function i(l){try{u(n.next(l))}catch(c){a(c)}}function s(l){try{u(n.throw(l))}catch(c){a(c)}}function u(l){l.done?o(l.value):new t(function(c){c(l.value)}).then(i,s)}u((n=n.apply(r,e||[])).next())})},fp=Rs&&Rs.__generator||function(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,o=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(c){l=[6,c],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Rs,"__esModule",{value:!0});var $e=Id(),rm=UE(),Cae={strides:[8,16],anchors:[2,6]},GE=6;function Nae(r,e,t){for(var n=[],o=0;o<t.strides.length;o++)for(var a=t.strides[o],i=Math.floor((e+a-1)/a),s=Math.floor((r+a-1)/a),u=t.anchors[o],l=0;l<i;l++)for(var c=a*(l+.5),p=0;p<s;p++)for(var f=a*(p+.5),d=0;d<u;d++)n.push([f,c]);return n}function Eae(r,e,t){var n=$e.slice(r,[0,1],[-1,2]),o=$e.add(n,e),a=$e.slice(r,[0,3],[-1,2]),i=$e.div(a,t),s=$e.div(o,t),u=$e.div(i,2),l=$e.sub(s,u),c=$e.add(s,u),p=$e.mul(l,t),f=$e.mul(c,t),d=1;return $e.concat2d([p,f],d)}function Tae(r){return r instanceof $e.Tensor?[r.shape[0],r.shape[1]]:[r.height,r.width]}function jE(r,e){var t,n,o;if(r.topLeft instanceof $e.Tensor&&r.bottomRight instanceof $e.Tensor){var a=$e.tidy(function(){return[$e.concat([$e.slice($e.sub(e-1,r.topLeft),0,1),$e.slice(r.topLeft,1,1)]),$e.concat([$e.sub(e-1,$e.slice(r.bottomRight,0,1)),$e.slice(r.bottomRight,1,1)])]}),i=a[0],s=a[1];t=i,n=s,r.landmarks!=null&&(o=$e.tidy(function(){var h=$e.sub($e.tensor1d([e-1,0]),r.landmarks),g=$e.tensor1d([1,-1]),v=$e.mul(h,g);return v}))}else{var u=r.topLeft,l=u[0],c=u[1],p=r.bottomRight,f=p[0],d=p[1];t=[e-1-l,c],n=[e-1-f,d],r.landmarks!=null&&(o=r.landmarks.map(function(h){return[e-1-h[0],h[1]]}))}var m={topLeft:t,bottomRight:n};return o!=null&&(m.landmarks=o),r.probability!=null&&(m.probability=r.probability instanceof $e.Tensor?r.probability.clone():r.probability),m}function HE(r,e){return $e.tidy(function(){var t;return r.hasOwnProperty("box")?t=r.box:t=r,$e.squeeze(rm.scaleBox(t,e).startEndTensor)})}var Aae=function(){function r(e,t,n,o,a,i){this.blazeFaceModel=e,this.width=t,this.height=n,this.maxFaces=o,this.anchorsData=Nae(t,n,Cae),this.anchors=$e.tensor2d(this.anchorsData),this.inputSizeData=[t,n],this.inputSize=$e.tensor1d([t,n]),this.iouThreshold=a,this.scoreThreshold=i}return r.prototype.getBoundingBoxes=function(e,t,n){return n===void 0&&(n=!0),pp(this,void 0,void 0,function(){var o,a,i,s,u,l,c,p,f,d,m,h,g,v,x=this;return fp(this,function(y){switch(y.label){case 0:return o=$e.tidy(function(){var b=$e.image.resizeBilinear(e,[x.width,x.height]),k=$e.mul($e.sub($e.div(b,255),.5),2),N=x.blazeFaceModel.predict(k),E=$e.squeeze(N),T=Eae(E,x.anchors,x.inputSize),R=$e.slice(E,[0,0],[-1,1]),$=$e.squeeze($e.sigmoid(R));return[E,T,$]}),a=o[0],i=o[1],s=o[2],u=console.warn,console.warn=function(){},l=$e.image.nonMaxSuppression(i,s,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=u,[4,l.array()];case 1:return c=y.sent(),l.dispose(),p=c.map(function(b){return $e.slice(i,[b,0],[1,-1])}),t?[3,3]:[4,Promise.all(p.map(function(b){return pp(x,void 0,void 0,function(){var k;return fp(this,function(N){switch(N.label){case 0:return[4,b.array()];case 1:return k=N.sent(),b.dispose(),[2,k]}})})}))];case 2:p=y.sent(),y.label=3;case 3:for(f=e.shape[1],d=e.shape[2],t?m=$e.div([d,f],this.inputSize):m=[d/this.inputSizeData[0],f/this.inputSizeData[1]],h=[],g=function(b){var k=p[b],N=$e.tidy(function(){var E=k instanceof $e.Tensor?rm.createBox(k):rm.createBox($e.tensor2d(k));if(!n)return E;var T=c[b],R;t?R=$e.slice(x.anchors,[T,0],[1,2]):R=x.anchorsData[T];var $=$e.reshape($e.squeeze($e.slice(a,[T,GE-1],[1,-1])),[GE,-1]),O=$e.slice(s,[T],[1]);return{box:E,landmarks:$,probability:O,anchor:R}});h.push(N)},v=0;v<p.length;v++)g(v);return i.dispose(),s.dispose(),a.dispose(),[2,{boxes:h,scaleFactor:m}]}})})},r.prototype.estimateFaces=function(e,t,n,o){return t===void 0&&(t=!1),n===void 0&&(n=!1),o===void 0&&(o=!0),pp(this,void 0,void 0,function(){var a,i,s,u,l,c,p=this;return fp(this,function(f){switch(f.label){case 0:return a=Tae(e),i=a[1],s=$e.tidy(function(){return e instanceof $e.Tensor||(e=$e.browser.fromPixels(e)),$e.expandDims($e.cast(e,"float32"),0)}),[4,this.getBoundingBoxes(s,t,o)];case 1:return u=f.sent(),l=u.boxes,c=u.scaleFactor,s.dispose(),t?[2,l.map(function(d){var m=HE(d,c),h={topLeft:$e.slice(m,[0],[2]),bottomRight:$e.slice(m,[2],[2])};if(o){var g=d,v=g.landmarks,x=g.probability,y=g.anchor,b=$e.mul($e.add(v,y),c);h.landmarks=b,h.probability=x}return n&&(h=jE(h,i)),h})]:[2,Promise.all(l.map(function(d){return pp(p,void 0,void 0,function(){var m,h,g,v,x,g,y,b,k,N,E,T,R=this;return fp(this,function($){switch($.label){case 0:return m=HE(d,c),o?[3,2]:[4,m.array()];case 1:return g=$.sent(),h={topLeft:g.slice(0,2),bottomRight:g.slice(2)},[3,4];case 2:return[4,Promise.all([d.landmarks,m,d.probability].map(function(O){return pp(R,void 0,void 0,function(){return fp(this,function(M){return[2,O.array()]})})}))];case 3:v=$.sent(),x=v[0],g=v[1],y=v[2],b=d.anchor,k=c,N=k[0],E=k[1],T=x.map(function(O){return[(O[0]+b[0])*N,(O[1]+b[1])*E]}),h={topLeft:g.slice(0,2),bottomRight:g.slice(2),landmarks:T,probability:y},rm.disposeBox(d.box),d.landmarks.dispose(),d.probability.dispose(),$.label=4;case 4:return m.dispose(),n&&(h=jE(h,i)),[2,h]}})})}))]}})})},r.prototype.dispose=function(){this.blazeFaceModel!=null&&this.blazeFaceModel.dispose()},r}();Rs.BlazeFaceModel=Aae});var KE=jt(Fa=>{"use strict";var Fae=Fa&&Fa.__awaiter||function(r,e,t,n){return new(t||(t=Promise))(function(o,a){function i(l){try{u(n.next(l))}catch(c){a(c)}}function s(l){try{u(n.throw(l))}catch(c){a(c)}}function u(l){l.done?o(l.value):new t(function(c){c(l.value)}).then(i,s)}u((n=n.apply(r,e||[])).next())})},Dae=Fa&&Fa.__generator||function(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,o=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(c){l=[6,c],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Fa,"__esModule",{value:!0});var qE=zE(),Rae=db(),$ae="https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1";function Pae(r){var e=r===void 0?{}:r,t=e.maxFaces,n=t===void 0?10:t,o=e.inputWidth,a=o===void 0?128:o,i=e.inputHeight,s=i===void 0?128:i,u=e.iouThreshold,l=u===void 0?.3:u,c=e.scoreThreshold,p=c===void 0?.75:c,f=e.modelUrl;return Fae(this,void 0,void 0,function(){var d,m;return Dae(this,function(h){switch(h.label){case 0:return f==null?[3,2]:[4,qE.loadGraphModel(f)];case 1:return d=h.sent(),[3,4];case 2:return[4,qE.loadGraphModel($ae,{fromTFHub:!0})];case 3:d=h.sent(),h.label=4;case 4:return m=new Rae.BlazeFaceModel(d,a,s,n,l,p),[2,m]}})})}Fa.load=Pae;var Oae=db();Fa.BlazeFaceModel=Oae.BlazeFaceModel});var hT=jt((zye,mT)=>{mT.exports=Vt;var Dn=null;try{Dn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function Vt(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Vt.prototype.__isLong__;Object.defineProperty(Vt.prototype,"__isLong__",{value:!0});function un(r){return(r&&r.__isLong__)===!0}Vt.isLong=un;var aT={},sT={};function qi(r,e){var t,n,o;return e?(r>>>=0,(o=0<=r&&r<256)&&(n=sT[r],n)?n:(t=Wt(r,(r|0)<0?-1:0,!0),o&&(sT[r]=t),t)):(r|=0,(o=-128<=r&&r<128)&&(n=aT[r],n)?n:(t=Wt(r,r<0?-1:0,!1),o&&(aT[r]=t),t))}Vt.fromInt=qi;function Rn(r,e){if(isNaN(r))return e?Ki:$n;if(e){if(r<0)return Ki;if(r>=uT)return dT}else{if(r<=-lT)return ln;if(r+1>=lT)return fT}return r<0?Rn(-r,e).neg():Wt(r%Dl|0,r/Dl|0,e)}Vt.fromNumber=Rn;function Wt(r,e,t){return new Vt(r,e,t)}Vt.fromBits=Wt;var Zm=Math.pow;function Eb(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return $n;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return Eb(r.substring(1),e,t).neg();for(var o=Rn(Zm(t,8)),a=$n,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),u=parseInt(r.substring(i,i+s),t);if(s<8){var l=Rn(Zm(t,s));a=a.mul(l).add(Rn(u))}else a=a.mul(o),a=a.add(Rn(u))}return a.unsigned=e,a}Vt.fromString=Eb;function qn(r,e){return typeof r=="number"?Rn(r,e):typeof r=="string"?Eb(r,e):Wt(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Vt.fromValue=qn;var iT=1<<16,lse=1<<24,Dl=iT*iT,uT=Dl*Dl,lT=uT/2,cT=qi(lse),$n=qi(0);Vt.ZERO=$n;var Ki=qi(0,!0);Vt.UZERO=Ki;var Rl=qi(1);Vt.ONE=Rl;var pT=qi(1,!0);Vt.UONE=pT;var Tb=qi(-1);Vt.NEG_ONE=Tb;var fT=Wt(4294967295|0,2147483647|0,!1);Vt.MAX_VALUE=fT;var dT=Wt(4294967295|0,4294967295|0,!0);Vt.MAX_UNSIGNED_VALUE=dT;var ln=Wt(0,2147483648|0,!1);Vt.MIN_VALUE=ln;var xe=Vt.prototype;xe.toInt=function(){return this.unsigned?this.low>>>0:this.low};xe.toNumber=function(){return this.unsigned?(this.high>>>0)*Dl+(this.low>>>0):this.high*Dl+(this.low>>>0)};xe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ln)){var t=Rn(e),n=this.div(t),o=n.mul(t).sub(this);return n.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var a=Rn(Zm(e,6),this.unsigned),i=this,s="";;){var u=i.div(a),l=i.sub(u.mul(a)).toInt()>>>0,c=l.toString(e);if(i=u,i.isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}};xe.getHighBits=function(){return this.high};xe.getHighBitsUnsigned=function(){return this.high>>>0};xe.getLowBits=function(){return this.low};xe.getLowBitsUnsigned=function(){return this.low>>>0};xe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ln)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};xe.isZero=function(){return this.high===0&&this.low===0};xe.eqz=xe.isZero;xe.isNegative=function(){return!this.unsigned&&this.high<0};xe.isPositive=function(){return this.unsigned||this.high>=0};xe.isOdd=function(){return(this.low&1)==1};xe.isEven=function(){return(this.low&1)==0};xe.equals=function(e){return un(e)||(e=qn(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};xe.eq=xe.equals;xe.notEquals=function(e){return!this.eq(e)};xe.neq=xe.notEquals;xe.ne=xe.notEquals;xe.lessThan=function(e){return this.comp(e)<0};xe.lt=xe.lessThan;xe.lessThanOrEqual=function(e){return this.comp(e)<=0};xe.lte=xe.lessThanOrEqual;xe.le=xe.lessThanOrEqual;xe.greaterThan=function(e){return this.comp(e)>0};xe.gt=xe.greaterThan;xe.greaterThanOrEqual=function(e){return this.comp(e)>=0};xe.gte=xe.greaterThanOrEqual;xe.ge=xe.greaterThanOrEqual;xe.compare=function(e){if(un(e)||(e=qn(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};xe.comp=xe.compare;xe.negate=function(){return!this.unsigned&&this.eq(ln)?ln:this.not().add(Rl)};xe.neg=xe.negate;xe.add=function(e){un(e)||(e=qn(e));var t=this.high>>>16,n=this.high&65535,o=this.low>>>16,a=this.low&65535,i=e.high>>>16,s=e.high&65535,u=e.low>>>16,l=e.low&65535,c=0,p=0,f=0,d=0;return d+=a+l,f+=d>>>16,d&=65535,f+=o+u,p+=f>>>16,f&=65535,p+=n+s,c+=p>>>16,p&=65535,c+=t+i,c&=65535,Wt(f<<16|d,c<<16|p,this.unsigned)};xe.subtract=function(e){return un(e)||(e=qn(e)),this.add(e.neg())};xe.sub=xe.subtract;xe.multiply=function(e){if(this.isZero())return $n;if(un(e)||(e=qn(e)),Dn){var t=Dn.mul(this.low,this.high,e.low,e.high);return Wt(t,Dn.get_high(),this.unsigned)}if(e.isZero())return $n;if(this.eq(ln))return e.isOdd()?ln:$n;if(e.eq(ln))return this.isOdd()?ln:$n;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(cT)&&e.lt(cT))return Rn(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=this.high&65535,a=this.low>>>16,i=this.low&65535,s=e.high>>>16,u=e.high&65535,l=e.low>>>16,c=e.low&65535,p=0,f=0,d=0,m=0;return m+=i*c,d+=m>>>16,m&=65535,d+=a*c,f+=d>>>16,d&=65535,d+=i*l,f+=d>>>16,d&=65535,f+=o*c,p+=f>>>16,f&=65535,f+=a*l,p+=f>>>16,f&=65535,f+=i*u,p+=f>>>16,f&=65535,p+=n*c+o*l+a*u+i*s,p&=65535,Wt(d<<16|m,p<<16|f,this.unsigned)};xe.mul=xe.multiply;xe.divide=function(e){if(un(e)||(e=qn(e)),e.isZero())throw Error("division by zero");if(Dn){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Dn.div_u:Dn.div_s)(this.low,this.high,e.low,e.high);return Wt(t,Dn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ki:$n;var n,o,a;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ki;if(e.gt(this.shru(1)))return pT;a=Ki}else{if(this.eq(ln)){if(e.eq(Rl)||e.eq(Tb))return ln;if(e.eq(ln))return Rl;var i=this.shr(1);return n=i.div(e).shl(1),n.eq($n)?e.isNegative()?Rl:Tb:(o=this.sub(e.mul(n)),a=n.add(o.div(e)),a)}else if(e.eq(ln))return this.unsigned?Ki:$n;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=$n}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),u=s<=48?1:Zm(2,s-48),l=Rn(n),c=l.mul(e);c.isNegative()||c.gt(o);)n-=u,l=Rn(n,this.unsigned),c=l.mul(e);l.isZero()&&(l=Rl),a=a.add(l),o=o.sub(c)}return a};xe.div=xe.divide;xe.modulo=function(e){if(un(e)||(e=qn(e)),Dn){var t=(this.unsigned?Dn.rem_u:Dn.rem_s)(this.low,this.high,e.low,e.high);return Wt(t,Dn.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};xe.mod=xe.modulo;xe.rem=xe.modulo;xe.not=function(){return Wt(~this.low,~this.high,this.unsigned)};xe.and=function(e){return un(e)||(e=qn(e)),Wt(this.low&e.low,this.high&e.high,this.unsigned)};xe.or=function(e){return un(e)||(e=qn(e)),Wt(this.low|e.low,this.high|e.high,this.unsigned)};xe.xor=function(e){return un(e)||(e=qn(e)),Wt(this.low^e.low,this.high^e.high,this.unsigned)};xe.shiftLeft=function(e){return un(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?Wt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Wt(0,this.low<<e-32,this.unsigned)};xe.shl=xe.shiftLeft;xe.shiftRight=function(e){return un(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?Wt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Wt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};xe.shr=xe.shiftRight;xe.shiftRightUnsigned=function(e){if(un(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var n=this.low;return Wt(n>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Wt(t,0,this.unsigned):Wt(t>>>e-32,0,this.unsigned)};xe.shru=xe.shiftRightUnsigned;xe.shr_u=xe.shiftRightUnsigned;xe.toSigned=function(){return this.unsigned?Wt(this.low,this.high,!1):this};xe.toUnsigned=function(){return this.unsigned?this:Wt(this.low,this.high,!0)};xe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};xe.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};xe.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Vt.fromBytes=function(e,t,n){return n?Vt.fromBytesLE(e,t):Vt.fromBytesBE(e,t)};Vt.fromBytesLE=function(e,t){return new Vt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Vt.fromBytesBE=function(e,t){return new Vt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var qT=jt(()=>{});var CA=jt((IA,i0)=>{(function(r,e,t){function n(s){var u=this,l=i();u.next=function(){var c=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=c-(u.c=c|0)},u.c=1,u.s0=l(" "),u.s1=l(" "),u.s2=l(" "),u.s0-=l(s),u.s0<0&&(u.s0+=1),u.s1-=l(s),u.s1<0&&(u.s1+=1),u.s2-=l(s),u.s2<0&&(u.s2+=1),l=null}function o(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new n(s),c=u&&u.state,p=l.next;return p.int32=function(){return l.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,c&&(typeof c=="object"&&o(c,l),p.state=function(){return o(l,{})}),p}function i(){var s=4022871197,u=function(l){l=l.toString();for(var c=0;c<l.length;c++){s+=l.charCodeAt(c);var p=.02519603282416938*s;s=p>>>0,p-=s,p*=s,s=p>>>0,p-=s,s+=p*4294967296}return(s>>>0)*23283064365386963e-26};return u}e&&e.exports?e.exports=a:t&&t.amd?t(function(){return a}):this.alea=a})(IA,typeof i0=="object"&&i0,typeof define=="function"&&define)});var EA=jt((NA,u0)=>{(function(r,e,t){function n(i){var s=this,u="";s.x=0,s.y=0,s.z=0,s.w=0,s.next=function(){var c=s.x^s.x<<11;return s.x=s.y,s.y=s.z,s.z=s.w,s.w^=s.w>>>19^c^c>>>8},i===(i|0)?s.x=i:u+=i;for(var l=0;l<u.length+64;l++)s.x^=u.charCodeAt(l)|0,s.next()}function o(i,s){return s.x=i.x,s.y=i.y,s.z=i.z,s.w=i.w,s}function a(i,s){var u=new n(i),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,d=(p+f)/(1<<21);while(d===0);return d},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&o(l,u),c.state=function(){return o(u,{})}),c}e&&e.exports?e.exports=a:t&&t.amd?t(function(){return a}):this.xor128=a})(NA,typeof u0=="object"&&u0,typeof define=="function"&&define)});var AA=jt((TA,l0)=>{(function(r,e,t){function n(i){var s=this,u="";s.next=function(){var c=s.x^s.x>>>2;return s.x=s.y,s.y=s.z,s.z=s.w,s.w=s.v,(s.d=s.d+362437|0)+(s.v=s.v^s.v<<4^(c^c<<1))|0},s.x=0,s.y=0,s.z=0,s.w=0,s.v=0,i===(i|0)?s.x=i:u+=i;for(var l=0;l<u.length+64;l++)s.x^=u.charCodeAt(l)|0,l==u.length&&(s.d=s.x<<10^s.x>>>4),s.next()}function o(i,s){return s.x=i.x,s.y=i.y,s.z=i.z,s.w=i.w,s.v=i.v,s.d=i.d,s}function a(i,s){var u=new n(i),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,d=(p+f)/(1<<21);while(d===0);return d},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&o(l,u),c.state=function(){return o(u,{})}),c}e&&e.exports?e.exports=a:t&&t.amd?t(function(){return a}):this.xorwow=a})(TA,typeof l0=="object"&&l0,typeof define=="function"&&define)});var DA=jt((FA,c0)=>{(function(r,e,t){function n(i){var s=this;s.next=function(){var l=s.x,c=s.i,p,f,d;return p=l[c],p^=p>>>7,f=p^p<<24,p=l[c+1&7],f^=p^p>>>10,p=l[c+3&7],f^=p^p>>>3,p=l[c+4&7],f^=p^p<<7,p=l[c+7&7],p=p^p<<13,f^=p^p<<9,l[c]=f,s.i=c+1&7,f};function u(l,c){var p,f,d=[];if(c===(c|0))f=d[0]=c;else for(c=""+c,p=0;p<c.length;++p)d[p&7]=d[p&7]<<15^c.charCodeAt(p)+d[p+1&7]<<13;for(;d.length<8;)d.push(0);for(p=0;p<8&&d[p]===0;++p);for(p==8?f=d[7]=-1:f=d[p],l.x=d,l.i=0,p=256;p>0;--p)l.next()}u(s,i)}function o(i,s){return s.x=i.x.slice(),s.i=i.i,s}function a(i,s){i==null&&(i=+new Date);var u=new n(i),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,d=(p+f)/(1<<21);while(d===0);return d},c.int32=u.next,c.quick=c,l&&(l.x&&o(l,u),c.state=function(){return o(u,{})}),c}e&&e.exports?e.exports=a:t&&t.amd?t(function(){return a}):this.xorshift7=a})(FA,typeof c0=="object"&&c0,typeof define=="function"&&define)});var $A=jt((RA,p0)=>{(function(r,e,t){function n(i){var s=this;s.next=function(){var l=s.w,c=s.X,p=s.i,f,d;return s.w=l=l+1640531527|0,d=c[p+34&127],f=c[p=p+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,d=c[p]=d^f,s.i=p,d+(l^l>>>16)|0};function u(l,c){var p,f,d,m,h,g=[],v=128;for(c===(c|0)?(f=c,c=null):(c=c+"\0",f=0,v=Math.max(v,c.length)),d=0,m=-32;m<v;++m)c&&(f^=c.charCodeAt((m+32)%c.length)),m===0&&(h=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(h=h+1640531527|0,p=g[m&127]^=f+h,d=p==0?d+1:0);for(d>=128&&(g[(c&&c.length||0)&127]=-1),d=127,m=4*128;m>0;--m)f=g[d+34&127],p=g[d=d+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,g[d]=f^p;l.w=h,l.X=g,l.i=d}u(s,i)}function o(i,s){return s.i=i.i,s.w=i.w,s.X=i.X.slice(),s}function a(i,s){i==null&&(i=+new Date);var u=new n(i),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,d=(p+f)/(1<<21);while(d===0);return d},c.int32=u.next,c.quick=c,l&&(l.X&&o(l,u),c.state=function(){return o(u,{})}),c}e&&e.exports?e.exports=a:t&&t.amd?t(function(){return a}):this.xor4096=a})(RA,typeof p0=="object"&&p0,typeof define=="function"&&define)});var OA=jt((PA,f0)=>{(function(r,e,t){function n(i){var s=this,u="";s.next=function(){var c=s.b,p=s.c,f=s.d,d=s.a;return c=c<<25^c>>>7^p,p=p-f|0,f=f<<24^f>>>8^d,d=d-c|0,s.b=c=c<<20^c>>>12^p,s.c=p=p-f|0,s.d=f<<16^p>>>16^d,s.a=d-c|0},s.a=0,s.b=0,s.c=2654435769|0,s.d=1367130551,i===Math.floor(i)?(s.a=i/4294967296|0,s.b=i|0):u+=i;for(var l=0;l<u.length+20;l++)s.b^=u.charCodeAt(l)|0,s.next()}function o(i,s){return s.a=i.a,s.b=i.b,s.c=i.c,s.d=i.d,s}function a(i,s){var u=new n(i),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,d=(p+f)/(1<<21);while(d===0);return d},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&o(l,u),c.state=function(){return o(u,{})}),c}e&&e.exports?e.exports=a:t&&t.amd?t(function(){return a}):this.tychei=a})(PA,typeof f0=="object"&&f0,typeof define=="function"&&define)});var MA=jt((F1e,uh)=>{(function(r,e){var t=this,n=256,o=6,a=52,i="random",s=e.pow(n,o),u=e.pow(2,a),l=u*2,c=n-1,p;function f(y,b,k){var N=[];b=b==!0?{entropy:!0}:b||{};var E=g(h(b.entropy?[y,x(r)]:y==null?v():y,3),N),T=new d(N),R=function(){for(var $=T.g(o),O=s,M=0;$<u;)$=($+M)*n,O*=n,M=T.g(1);for(;$>=l;)$/=2,O/=2,M>>>=1;return($+M)/O};return R.int32=function(){return T.g(4)|0},R.quick=function(){return T.g(4)/4294967296},R.double=R,g(x(T.S),r),(b.pass||k||function($,O,M,B){return B&&(B.S&&m(B,T),$.state=function(){return m(T,{})}),M?(e[i]=$,O):$})(R,E,"global"in b?b.global:this==e,b.state)}e["seed"+i]=f;function d(y){var b,k=y.length,N=this,E=0,T=N.i=N.j=0,R=N.S=[];for(k||(y=[k++]);E<n;)R[E]=E++;for(E=0;E<n;E++)R[E]=R[T=c&T+y[E%k]+(b=R[E])],R[T]=b;(N.g=function($){for(var O,M=0,B=N.i,L=N.j,H=N.S;$--;)O=H[B=c&B+1],M=M*n+H[c&(H[B]=H[L=c&L+O])+(H[L]=O)];return N.i=B,N.j=L,M})(n)}function m(y,b){return b.i=y.i,b.j=y.j,b.S=y.S.slice(),b}function h(y,b){var k=[],N=typeof y,E;if(b&&N=="object")for(E in y)try{k.push(h(y[E],b-1))}catch(T){}return k.length?k:N=="string"?y:y+"\0"}function g(y,b){for(var k=y+"",N,E=0;E<k.length;)b[c&E]=c&(N^=b[c&E]*19)+k.charCodeAt(E++);return x(b)}function v(){try{var y;return p&&(y=p.randomBytes)?y=y(n):(y=new Uint8Array(n),(t.crypto||t.msCrypto).getRandomValues(y)),x(y)}catch(N){var b=t.navigator,k=b&&b.plugins;return[+new Date,t,k,t.screen,x(r)]}}function x(y){return String.fromCharCode.apply(0,y)}if(g(e.random(),r),typeof uh=="object"&&uh.exports){uh.exports=f;try{p=Dv()}catch(y){}}else typeof define=="function"&&define.amd&&define(function(){return f})})([],Math)});var LA=jt((D1e,BA)=>{var Pie=CA(),Oie=EA(),Mie=AA(),Bie=DA(),Lie=$A(),Vie=OA(),nu=MA();nu.alea=Pie;nu.xor128=Oie;nu.xorwow=Mie;nu.xorshift7=Bie;nu.xor4096=Lie;nu.tychei=Vie;BA.exports=nu});var Kl=jt(()=>{});var Ch=jt(()=>{});var c3=jt(()=>{});var p3=jt(()=>{});var f3=jt(()=>{});var d3=jt((Nh,q0)=>{var H0=function(){var r=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename!="undefined"&&(r=r||__filename),function(e){e=e||{};function t(){return Y.buffer!=Ue&&ht(Y.buffer),Ge}function n(){return Y.buffer!=Ue&&ht(Y.buffer),Ie}function o(){return Y.buffer!=Ue&&ht(Y.buffer),St}function a(){return Y.buffer!=Ue&&ht(Y.buffer),Qt}function i(){return Y.buffer!=Ue&&ht(Y.buffer),Xt}var s=typeof e!="undefined"?e:{},u,l;s.ready=new Promise(function(C,A){u=C,l=A});var c={},p;for(p in s)s.hasOwnProperty(p)&&(c[p]=s[p]);var f=[],d="./this.program",m=function(C,A){throw A},h=!1,g=!1,v=!1,x=!1;h=typeof window=="object",g=typeof importScripts=="function",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",x=!h&&!v&&!g;var y=s.ENVIRONMENT_IS_PTHREAD||!1;y&&(Ue=s.buffer);var b="";function k(C){return s.locateFile?s.locateFile(C,b):b+C}var N,E,T,R,$,O;if(v){g?b=Kl().dirname(b)+"/":b=__dirname+"/",N=function(A,V){return $||($=Ch()),O||(O=Kl()),A=O.normalize(A),$.readFileSync(A,V?null:"utf8")},T=function(A){var V=N(A,!0);return V.buffer||(V=new Uint8Array(V)),pe(V.buffer),V},process.argv.length>1&&(d=process.argv[1].replace(/\\/g,"/")),f=process.argv.slice(2),process.on("uncaughtException",function(C){if(!(C instanceof wc))throw C}),process.on("unhandledRejection",ko),m=function(C){process.exit(C)},s.inspect=function(){return"[Emscripten Module object]"};var M;try{M=c3()}catch(C){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),C}global.Worker=M.Worker}else x?(typeof read!="undefined"&&(N=function(A){return read(A)}),T=function(A){var V;return typeof readbuffer=="function"?new Uint8Array(readbuffer(A)):(V=read(A,"binary"),pe(typeof V=="object"),V)},typeof scriptArgs!="undefined"?f=scriptArgs:typeof arguments!="undefined"&&(f=arguments),typeof quit=="function"&&(m=function(C){quit(C)}),typeof print!="undefined"&&(typeof console=="undefined"&&(console={}),console.log=print,console.warn=console.error=typeof printErr!="undefined"?printErr:print)):(h||g)&&(g?b=self.location.href:typeof document!="undefined"&&document.currentScript&&(b=document.currentScript.src),typeof r!="undefined"&&r&&(b=r),b.indexOf("blob:")!==0?b=b.substr(0,b.lastIndexOf("/")+1):b="",v?(N=function(A,V){return $||($=Ch()),O||(O=Kl()),A=O.normalize(A),$.readFileSync(A,V?null:"utf8")},T=function(A){var V=N(A,!0);return V.buffer||(V=new Uint8Array(V)),pe(V.buffer),V}):(N=function(C){var A=new XMLHttpRequest;return A.open("GET",C,!1),A.send(null),A.responseText},g&&(T=function(C){var A=new XMLHttpRequest;return A.open("GET",C,!1),A.responseType="arraybuffer",A.send(null),new Uint8Array(A.response)}),E=function(C,A,V){var Z=new XMLHttpRequest;Z.open("GET",C,!0),Z.responseType="arraybuffer",Z.onload=function(){if(Z.status==200||Z.status==0&&Z.response){A(Z.response);return}V()},Z.onerror=V,Z.send(null)}),R=function(C){document.title=C});v&&typeof performance=="undefined"&&(global.performance=p3().performance);var B=s.print||console.log.bind(console),L=s.printErr||console.warn.bind(console);for(p in c)c.hasOwnProperty(p)&&(s[p]=c[p]);c=null,s.arguments&&(f=s.arguments),s.thisProgram&&(d=s.thisProgram),s.quit&&(m=s.quit);function H(C){H.shown||(H.shown={}),H.shown[C]||(H.shown[C]=1,L(C))}var W=Atomics.load,K=Atomics.store,J=Atomics.compareExchange,Q;s.wasmBinary&&(Q=s.wasmBinary);var ee=s.noExitRuntime||!0;typeof WebAssembly!="object"&&ko("no native wasm support detected");var Y,ne,te=!1,ce;function pe(C,A){C||ko("Assertion failed: "+A)}function se(C){var A=s["_"+C];return pe(A,"Cannot call unknown function "+C+", make sure it is exported"),A}function fe(C,A,V,Z,he){var de={string:function(Rr){var Fu=0;if(Rr!=null&&Rr!==0){var Ek=(Rr.length<<2)+1;Fu=Eu(Ek),Ze(Rr,Fu,Ek)}return Fu},array:function(Rr){var Fu=Eu(Rr.length);return lt(Rr,Fu),Fu}};function me(Rr){return A==="string"?Ae(Rr):A==="boolean"?Boolean(Rr):Rr}var Ne=se(C),dt=[],gr=0;if(Z)for(var fr=0;fr<Z.length;fr++){var fa=de[V[fr]];fa?(gr===0&&(gr=bc()),dt[fr]=fa(Z[fr])):dt[fr]=Z[fr]}var Au=Ne.apply(null,dt);return Au=me(Au),gr!==0&&Nu(gr),Au}function ye(C,A,V,Z){V=V||[];var he=V.every(function(me){return me==="number"}),de=A!=="string";return de&&he&&!Z?se(C):function(){return fe(C,A,V,arguments,Z)}}function _e(C,A,V){for(var Z=A+V,he="";!(A>=Z);){var de=C[A++];if(!de)return he;if(!(de&128)){he+=String.fromCharCode(de);continue}var me=C[A++]&63;if((de&224)==192){he+=String.fromCharCode((de&31)<<6|me);continue}var Ne=C[A++]&63;if((de&240)==224?de=(de&15)<<12|me<<6|Ne:de=(de&7)<<18|me<<12|Ne<<6|C[A++]&63,de<65536)he+=String.fromCharCode(de);else{var dt=de-65536;he+=String.fromCharCode(55296|dt>>10,56320|dt&1023)}}return he}function Ae(C,A){return C?_e(n(),C,A):""}function We(C,A,V,Z){if(!(Z>0))return 0;for(var he=V,de=V+Z-1,me=0;me<C.length;++me){var Ne=C.charCodeAt(me);if(Ne>=55296&&Ne<=57343){var dt=C.charCodeAt(++me);Ne=65536+((Ne&1023)<<10)|dt&1023}if(Ne<=127){if(V>=de)break;A[V++]=Ne}else if(Ne<=2047){if(V+1>=de)break;A[V++]=192|Ne>>6,A[V++]=128|Ne&63}else if(Ne<=65535){if(V+2>=de)break;A[V++]=224|Ne>>12,A[V++]=128|Ne>>6&63,A[V++]=128|Ne&63}else{if(V+3>=de)break;A[V++]=240|Ne>>18,A[V++]=128|Ne>>12&63,A[V++]=128|Ne>>6&63,A[V++]=128|Ne&63}}return A[V]=0,V-he}function Ze(C,A,V){return We(C,n(),A,V)}function ut(C){for(var A=0,V=0;V<C.length;++V){var Z=C.charCodeAt(V);Z>=55296&&Z<=57343&&(Z=65536+((Z&1023)<<10)|C.charCodeAt(++V)&1023),Z<=127?++A:Z<=2047?A+=2:Z<=65535?A+=3:A+=4}return A}function lt(C,A){t().set(C,A)}function tt(C,A){return C%A>0&&(C+=A-C%A),C}var Ue,Ge,Ie,cr,ft,St,Qt,Xr,Xt;function ht(C){Ue=C,s.HEAP8=Ge=new Int8Array(C),s.HEAP16=cr=new Int16Array(C),s.HEAP32=St=new Int32Array(C),s.HEAPU8=Ie=new Uint8Array(C),s.HEAPU16=ft=new Uint16Array(C),s.HEAPU32=Qt=new Uint32Array(C),s.HEAPF32=Xr=new Float32Array(C),s.HEAPF64=Xt=new Float64Array(C)}var Nr=s.INITIAL_MEMORY||16777216;if(y)Y=s.wasmMemory,Ue=s.buffer;else if(s.wasmMemory)Y=s.wasmMemory;else if(Y=new WebAssembly.Memory({initial:Nr/65536,maximum:2147483648/65536,shared:!0}),!(Y.buffer instanceof SharedArrayBuffer))throw L("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");Y&&(Ue=Y.buffer),Nr=Ue.byteLength,ht(Ue);var Ft,pr=[],Dt=[],qa=[],Ka=[],Vn=[],wo=!1,cc=!1;y||Dt.push({func:function(){Ff()}});function _u(){if(!y){if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)ug(s.preRun.shift());Su(pr)}}function hf(){wo=!0,!y&&Su(Dt)}function gf(){y||Su(qa)}function Vr(){y||(cc=!0)}function vf(){if(!y){if(s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;)lg(s.postRun.shift());Su(Vn)}}function ug(C){pr.unshift(C)}function lg(C){Vn.unshift(C)}var yn=0,pc=null,Xa=null;function cg(C){pe(!y,"addRunDependency cannot be used in a pthread worker"),yn++,s.monitorRunDependencies&&s.monitorRunDependencies(yn)}function pg(C){if(yn--,s.monitorRunDependencies&&s.monitorRunDependencies(yn),yn==0&&(pc!==null&&(clearInterval(pc),pc=null),Xa)){var A=Xa;Xa=null,A()}}s.preloadedImages={},s.preloadedAudios={};function ko(C){s.onAbort&&s.onAbort(C),y&&console.error("Pthread aborting at "+new Error().stack),C+="",L(C),te=!0,ce=1,C="abort("+C+"). Build with -s ASSERTIONS=1 for more info.";var A=new WebAssembly.RuntimeError(C);throw l(A),A}function Ya(C,A){return String.prototype.startsWith?C.startsWith(A):C.indexOf(A)===0}var fg="data:application/octet-stream;base64,";function xf(C){return Ya(C,fg)}var dg="file://";function yf(C){return Ya(C,dg)}var Wr="tfjs-backend-wasm-threaded-simd.wasm";xf(Wr)||(Wr=k(Wr));function bf(C){try{if(C==Wr&&Q)return new Uint8Array(Q);if(T)return T(C);throw"both async and sync fetching of the wasm failed"}catch(A){ko(A)}}function mg(){if(!Q&&(h||g)){if(typeof fetch=="function"&&!yf(Wr))return fetch(Wr,{credentials:"same-origin"}).then(function(C){if(!C.ok)throw"failed to load wasm binary file at '"+Wr+"'";return C.arrayBuffer()}).catch(function(){return bf(Wr)});if(E)return new Promise(function(C,A){E(Wr,function(V){C(new Uint8Array(V))},A)})}return Promise.resolve().then(function(){return bf(Wr)})}function hg(){var C={a:iv};function A(me,Ne){var dt=me.exports;if(s.asm=dt,Ft=s.asm.I,ne=Ne,!y){var gr=Fe.unusedWorkers.length;Fe.unusedWorkers.forEach(function(fr){Fe.loadWasmModuleToWorker(fr,function(){--gr||pg("wasm-instantiate")})})}}y||cg("wasm-instantiate");function V(me){A(me.instance,me.module)}function Z(me){return mg().then(function(Ne){return WebAssembly.instantiate(Ne,C)}).then(me,function(Ne){L("failed to asynchronously prepare wasm: "+Ne),ko(Ne)})}function he(){return!Q&&typeof WebAssembly.instantiateStreaming=="function"&&!xf(Wr)&&!yf(Wr)&&typeof fetch=="function"?fetch(Wr,{credentials:"same-origin"}).then(function(me){var Ne=WebAssembly.instantiateStreaming(me,C);return Ne.then(V,function(dt){return L("wasm streaming compile failed: "+dt),L("falling back to ArrayBuffer instantiation"),Z(V)})}):Z(V)}if(s.instantiateWasm)try{var de=s.instantiateWasm(C,A);return de}catch(me){return L("Module.instantiateWasm callback failed with error: "+me),!1}return he().catch(l),{}}var gg={10520:function(){throw"Canceled!"},10538:function(C,A){setTimeout(function(){kk(C,A)},0)}};function wf(){Fe.initRuntime()}function Su(C){for(;C.length>0;){var A=C.shift();if(typeof A=="function"){A(s);continue}var V=A.func;typeof V=="number"?A.arg===void 0?Ft.get(V)():Ft.get(V)(A.arg):V(A.arg===void 0?null:A.arg)}}var ia={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};function fc(C,A){if(C<=0||C>t().length||C&!0||A<0)return-28;if(A==0)return 0;A>=2147483647&&(A=1/0);var V=Atomics.load(o(),Tu>>2),Z=0;if(V==C){var he=Atomics.compareExchange(o(),Tu>>2,V,0);if(he==V&&(--A,Z=1,A<=0))return 1}var de=Atomics.notify(o(),C>>2,A);if(de>=0)return de+Z;throw"Atomics.notify returned an unexpected value "+de}s._emscripten_futex_wake=fc;function vg(C){if(y)throw"Internal Error! killThread() can only ever be called from main application thread!";if(!C)throw"Internal Error! Null pthread_ptr in killThread!";o()[C+12>>2]=0;var A=Fe.pthreads[C];A.worker.terminate(),Fe.freeThreadData(A),Fe.runningWorkers.splice(Fe.runningWorkers.indexOf(A.worker),1),A.worker.pthread=void 0}function xg(C){if(y)throw"Internal Error! cancelThread() can only ever be called from main application thread!";if(!C)throw"Internal Error! Null pthread_ptr in cancelThread!";var A=Fe.pthreads[C];A.worker.postMessage({cmd:"cancel"})}function kf(C){if(y)throw"Internal Error! cleanupThread() can only ever be called from main application thread!";if(!C)throw"Internal Error! Null pthread_ptr in cleanupThread!";var A=Fe.pthreads[C];if(A){o()[C+12>>2]=0;var V=A.worker;Fe.returnWorkerToPool(V)}}var Fe={unusedWorkers:[],runningWorkers:[],initMainThreadBlock:function(){for(var C=8,A=0;A<C;++A)Fe.allocateUnusedWorker()},initRuntime:function(){for(var C=Ja(228),A=0;A<228/4;++A)a()[C/4+A]=0;o()[C+12>>2]=C;var V=C+152;o()[V>>2]=V;for(var Z=Ja(512),A=0;A<128;++A)a()[Z/4+A]=0;Atomics.store(a(),C+100>>2,Z),Atomics.store(a(),C+40>>2,C),Av(C,!g,1),bk(C)},initWorker:function(){},pthreads:{},threadExitHandlers:[],setThreadStatus:function(){},runExitHandlers:function(){for(;Fe.threadExitHandlers.length>0;)Fe.threadExitHandlers.pop()();y&&pa()&&yk()},runExitHandlersAndDeinitThread:function(C,A){Atomics.store(a(),C+56>>2,1),Atomics.store(a(),C+60>>2,0),Fe.runExitHandlers(),Atomics.store(a(),C+4>>2,A),Atomics.store(a(),C+0>>2,1),fc(C+0,2147483647),Av(0,0,0)},threadExit:function(C){var A=pa();A&&(Fe.runExitHandlersAndDeinitThread(A,C),y&&postMessage({cmd:"exit"}))},threadCancel:function(){Fe.runExitHandlersAndDeinitThread(pa(),-1),postMessage({cmd:"cancelDone"})},terminateAllThreads:function(){for(var C in Fe.pthreads){var A=Fe.pthreads[C];A&&A.worker&&Fe.returnWorkerToPool(A.worker)}Fe.pthreads={};for(var V=0;V<Fe.unusedWorkers.length;++V){var Z=Fe.unusedWorkers[V];Z.terminate()}Fe.unusedWorkers=[];for(var V=0;V<Fe.runningWorkers.length;++V){var Z=Fe.runningWorkers[V],A=Z.pthread;Fe.freeThreadData(A),Z.terminate()}Fe.runningWorkers=[]},freeThreadData:function(C){if(!!C){if(C.threadInfoStruct){var A=o()[C.threadInfoStruct+100>>2];o()[C.threadInfoStruct+100>>2]=0,yc(A),yc(C.threadInfoStruct)}C.threadInfoStruct=0,C.allocatedOwnStack&&C.stackBase&&yc(C.stackBase),C.stackBase=0,C.worker&&(C.worker.pthread=null)}},returnWorkerToPool:function(C){Fe.runWithoutMainThreadQueuedCalls(function(){delete Fe.pthreads[C.pthread.threadInfoStruct],Fe.unusedWorkers.push(C),Fe.runningWorkers.splice(Fe.runningWorkers.indexOf(C),1),Fe.freeThreadData(C.pthread),C.pthread=void 0})},runWithoutMainThreadQueuedCalls:function(C){o()[Nk>>2]=0;try{C()}finally{o()[Nk>>2]=1}},receiveObjectTransfer:function(C){},loadWasmModuleToWorker:function(C,A){C.onmessage=function(V){var Z=V.data,he=Z.cmd;if(C.pthread&&(Fe.currentProxiedOperationCallerThread=C.pthread.threadInfoStruct),Z.targetThread&&Z.targetThread!=pa()){var de=Fe.pthreads[Z.targetThread];de?de.worker.postMessage(V.data,Z.transferList):console.error('Internal error! Worker sent a message "'+he+'" to target pthread '+Z.targetThread+", but that thread no longer exists!"),Fe.currentProxiedOperationCallerThread=void 0;return}if(he==="processQueuedMainThreadWork")Mf();else if(he==="spawnThread")Tf(V.data);else if(he==="cleanupThread")kf(Z.thread);else if(he==="killThread")vg(Z.thread);else if(he==="cancelThread")xg(Z.thread);else if(he==="loaded")C.loaded=!0,A&&A(C),C.runPthread&&(C.runPthread(),delete C.runPthread);else if(he==="print")B("Thread "+Z.threadId+": "+Z.text);else if(he==="printErr")L("Thread "+Z.threadId+": "+Z.text);else if(he==="alert")alert("Thread "+Z.threadId+": "+Z.text);else if(he==="exit"){var me=C.pthread&&Atomics.load(a(),C.pthread.threadInfoStruct+64>>2);me&&Fe.returnWorkerToPool(C)}else if(he==="exitProcess")try{mW(Z.returnCode)}catch(Ne){if(Ne instanceof wc)return;throw Ne}else he==="cancelDone"?Fe.returnWorkerToPool(C):he==="objectTransfer"?Fe.receiveObjectTransfer(V.data):V.data.target==="setimmediate"?C.postMessage(V.data):L("worker sent an unknown command "+he);Fe.currentProxiedOperationCallerThread=void 0},C.onerror=function(V){L("pthread sent an error! "+V.filename+":"+V.lineno+": "+V.message)},v&&(C.on("message",function(V){C.onmessage({data:V})}),C.on("error",function(V){C.onerror(V)}),C.on("exit",function(V){})),C.postMessage({cmd:"load",urlOrBlob:s.mainScriptUrlOrBlob||r,wasmMemory:Y,wasmModule:ne})},allocateUnusedWorker:function(){var C=k("tfjs-backend-wasm-threaded-simd.worker.js");Fe.unusedWorkers.push(new Worker(C))},getNewWorker:function(){return Fe.unusedWorkers.length==0&&(Fe.allocateUnusedWorker(),Fe.loadWasmModuleToWorker(Fe.unusedWorkers[0])),Fe.unusedWorkers.length>0?Fe.unusedWorkers.pop():null},busySpinWait:function(C){for(var A=performance.now()+C;performance.now()<A;);}};function yg(C,A){Ik(C,A),Nu(C)}s.establishStackSpace=yg;function bg(){return ee}s.getNoExitRuntime=bg;function wg(C,A){return Ft.get(C)(A)}s.invokeEntryPoint=wg;function kg(C,A,V,Z){ko("Assertion failed: "+Ae(C)+", at: "+[A?Ae(A):"unknown filename",V,Z?Ae(Z):"unknown function"])}function _g(C,A){var V=_main(C,A)}var Za;v?Za=function(){var C=process.hrtime();return C[0]*1e3+C[1]/1e6}:y?Za=function(){return performance.now()-s.__performance_now_clock_drift}:typeof dateNow!="undefined"?Za=dateNow:Za=function(){return performance.now()};function Sg(C){return o()[vk()>>2]=C,C}function Ig(C,A){if(y)return ua(1,1,C,A)}function Cg(C,A){if(C==A)postMessage({cmd:"processQueuedMainThreadWork"});else if(y)postMessage({targetThread:C,cmd:"processThreadQueue"});else{var V=Fe.pthreads[C],Z=V&&V.worker;if(!Z)return;Z.postMessage({cmd:"processThreadQueue"})}return 1}function Ng(){ko()}function Eg(C,A,V){var Z=Dg(A,V);return gg[C].apply(null,Z)}function Tg(C,A){}function _f(C,A,V){if(C<=0||C>t().length||C&!0)return-28;if(h){if(Atomics.load(o(),C>>2)!=A)return-6;for(var he=performance.now(),de=he+V,me=Atomics.exchange(o(),Tu>>2,C);;){if(he=performance.now(),he>de)return me=Atomics.exchange(o(),Tu>>2,0),-73;if(me=Atomics.exchange(o(),Tu>>2,0),me==0)break;if(Mf(),Atomics.load(o(),C>>2)!=A)return-6;me=Atomics.exchange(o(),Tu>>2,C)}return 0}else{var Z=Atomics.wait(o(),C>>2,A,V);if(Z==="timed-out")return-73;if(Z==="not-equal")return-6;if(Z==="ok")return 0;throw"Atomics.wait returned an unexpected value "+Z}}function Ag(C,A,V){n().copyWithin(C,A,A+V)}function Fg(){return v?f3().cpus().length:navigator.hardwareConcurrency}function ua(C,A){for(var V=arguments.length-2,Z=bc(),he=V,de=Eu(he*8),me=de>>3,Ne=0;Ne<V;Ne++){var dt=arguments[2+Ne];i()[me+Ne]=dt}var gr=Sk(C,he,de,A);return Nu(Z),gr}var dc=[],mc=[];function Dg(C,A){mc.length=0;var V;for(A>>=2;V=n()[C++];){var Z=V<105;Z&&A&1&&A++,mc.push(Z?i()[A++>>1]:o()[A]),++A}return mc}function Rg(C,A,V){dc.length=A;for(var Z=V>>3,he=0;he<A;he++)dc[he]=i()[Z+he];var de=C<0,me=de?gg[-C-1]:sv[C];return me.apply(null,dc)}function $g(){return n().length}function Pg(C){try{return Y.grow(C-Ue.byteLength+65535>>>16),ht(Y.buffer),1}catch(A){}}function Og(C){var A=$g();if(C<=A)return!1;var V=2147483648;if(C>V)return!1;for(var Z=1;Z<=4;Z*=2){var he=A*(1+.2/Z);he=Math.min(he,C+100663296);var de=Math.min(V,tt(Math.max(C,he),65536)),me=Pg(de);if(me)return!0}return!1}var Ke={inEventHandler:0,removeAllEventListeners:function(){for(var C=Ke.eventHandlers.length-1;C>=0;--C)Ke._removeHandler(C);Ke.eventHandlers=[],Ke.deferredCalls=[]},registerRemoveEventListeners:function(){Ke.removeEventListenersRegistered||(Ka.push(Ke.removeAllEventListeners),Ke.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(C,A,V){function Z(me,Ne){if(me.length!=Ne.length)return!1;for(var dt in me)if(me[dt]!=Ne[dt])return!1;return!0}for(var he in Ke.deferredCalls){var de=Ke.deferredCalls[he];if(de.targetFunction==C&&Z(de.argsList,V))return}Ke.deferredCalls.push({targetFunction:C,precedence:A,argsList:V}),Ke.deferredCalls.sort(function(me,Ne){return me.precedence<Ne.precedence})},removeDeferredCalls:function(C){for(var A=0;A<Ke.deferredCalls.length;++A)Ke.deferredCalls[A].targetFunction==C&&(Ke.deferredCalls.splice(A,1),--A)},canPerformEventHandlerRequests:function(){return Ke.inEventHandler&&Ke.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(!!Ke.canPerformEventHandlerRequests())for(var C=0;C<Ke.deferredCalls.length;++C){var A=Ke.deferredCalls[C];Ke.deferredCalls.splice(C,1),--C,A.targetFunction.apply(null,A.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(C,A){for(var V=0;V<Ke.eventHandlers.length;++V)Ke.eventHandlers[V].target==C&&(!A||A==Ke.eventHandlers[V].eventTypeString)&&Ke._removeHandler(V--)},_removeHandler:function(C){var A=Ke.eventHandlers[C];A.target.removeEventListener(A.eventTypeString,A.eventListenerFunc,A.useCapture),Ke.eventHandlers.splice(C,1)},registerOrRemoveHandler:function(C){var A=function(he){++Ke.inEventHandler,Ke.currentEventHandler=C,Ke.runDeferredCalls(),C.handlerFunc(he),Ke.runDeferredCalls(),--Ke.inEventHandler};if(C.callbackfunc)C.eventListenerFunc=A,C.target.addEventListener(C.eventTypeString,A,C.useCapture),Ke.eventHandlers.push(C),Ke.registerRemoveEventListeners();else for(var V=0;V<Ke.eventHandlers.length;++V)Ke.eventHandlers[V].target==C.target&&Ke.eventHandlers[V].eventTypeString==C.eventTypeString&&Ke._removeHandler(V--)},queueEventHandlerOnThread_iiii:function(C,A,V,Z,he){var de=bc(),me=Eu(12);o()[me>>2]=V,o()[me+4>>2]=Z,o()[me+8>>2]=he,Tv(0,C,637534208,A,Z,me),Nu(de)},getTargetThreadForEventCallback:function(C){switch(C){case 1:return 0;case 2:return Fe.currentProxiedOperationCallerThread;default:return C}},getNodeNameForTarget:function(C){return C?C==window?"#window":C==screen?"#screen":C&&C.nodeName?C.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function Mg(C){var A=ut(C)+1,V=Ja(A);return Ze(C,V,A),V}function Bg(C,A,V,Z){var he=bc(),de=Eu(12),me=0;A&&(me=Mg(A)),o()[de>>2]=me,o()[de+4>>2]=V,o()[de+8>>2]=Z,Tv(0,C,657457152,0,me,de),Nu(he)}function Lg(C,A,V,Z){A=A?Ae(A):"",Bg(C,A,V,Z)}function Vg(C){return C>2?Ae(C):C}var Wg=[0,typeof document!="undefined"?document:0,typeof window!="undefined"?window:0];function zg(C){C=Vg(C);var A=Wg[C]||(typeof document!="undefined"?document.querySelector(C):void 0);return A}function hc(C){return zg(C)}function Sf(C,A,V){var Z=hc(C);if(!Z)return-4;if(Z.canvasSharedPtr&&(o()[Z.canvasSharedPtr>>2]=A,o()[Z.canvasSharedPtr+4>>2]=V),Z.offscreenCanvas||!Z.controlTransferredOffscreen){Z.offscreenCanvas&&(Z=Z.offscreenCanvas);var he=!1;if(Z.GLctxObject&&Z.GLctxObject.GLctx){var de=Z.GLctxObject.GLctx.getParameter(2978);he=de[0]===0&&de[1]===0&&de[2]===Z.width&&de[3]===Z.height}Z.width=A,Z.height=V,he&&Z.GLctxObject.GLctx.viewport(0,0,A,V)}else if(Z.canvasSharedPtr){var me=o()[Z.canvasSharedPtr+8>>2];return Lg(me,C,A,V),1}else return-4;return 0}function If(C,A,V){return y?ua(2,1,C,A,V):Sf(C,A,V)}function Ug(C,A,V){var Z=hc(C);return Z?Sf(C,A,V):If(C,A,V)}function Gg(C){}function jg(C,A){}function Hg(C){var A=C.getExtension("ANGLE_instanced_arrays");if(A)return C.vertexAttribDivisor=function(V,Z){A.vertexAttribDivisorANGLE(V,Z)},C.drawArraysInstanced=function(V,Z,he,de){A.drawArraysInstancedANGLE(V,Z,he,de)},C.drawElementsInstanced=function(V,Z,he,de,me){A.drawElementsInstancedANGLE(V,Z,he,de,me)},1}function qg(C){var A=C.getExtension("OES_vertex_array_object");if(A)return C.createVertexArray=function(){return A.createVertexArrayOES()},C.deleteVertexArray=function(V){A.deleteVertexArrayOES(V)},C.bindVertexArray=function(V){A.bindVertexArrayOES(V)},C.isVertexArray=function(V){return A.isVertexArrayOES(V)},1}function Kg(C){var A=C.getExtension("WEBGL_draw_buffers");if(A)return C.drawBuffers=function(V,Z){A.drawBuffersWEBGL(V,Z)},1}function Xg(C){return!!(C.multiDrawWebgl=C.getExtension("WEBGL_multi_draw"))}var ct={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],contexts:{},offscreenCanvases:{},timerQueriesEXT:[],programInfos:{},stringCache:{},unpackAlignment:4,recordError:function(A){ct.lastError||(ct.lastError=A)},getNewId:function(C){for(var A=ct.counter++,V=C.length;V<A;V++)C[V]=null;return A},getSource:function(C,A,V,Z){for(var he="",de=0;de<A;++de){var me=Z?o()[Z+de*4>>2]:-1;he+=Ae(o()[V+de*4>>2],me<0?void 0:me)}return he},createContext:function(C,A){var V=C.getContext("webgl",A);if(!V)return 0;var Z=ct.registerContext(V,A);return Z},registerContext:function(C,A){var V=Ja(8);o()[V+4>>2]=pa();var Z={handle:V,attributes:A,version:A.majorVersion,GLctx:C};return C.canvas&&(C.canvas.GLctxObject=Z),ct.contexts[V]=Z,(typeof A.enableExtensionsByDefault=="undefined"||A.enableExtensionsByDefault)&&ct.initExtensions(Z),V},makeContextCurrent:function(C){return ct.currentContext=ct.contexts[C],s.ctx=la=ct.currentContext&&ct.currentContext.GLctx,!(C&&!la)},getContext:function(C){return ct.contexts[C]},deleteContext:function(C){ct.currentContext===ct.contexts[C]&&(ct.currentContext=null),typeof Ke=="object"&&Ke.removeAllHandlersOnTarget(ct.contexts[C].GLctx.canvas),ct.contexts[C]&&ct.contexts[C].GLctx.canvas&&(ct.contexts[C].GLctx.canvas.GLctxObject=void 0),yc(ct.contexts[C].handle),ct.contexts[C]=null},initExtensions:function(C){if(C||(C=ct.currentContext),!C.initExtensionsDone){C.initExtensionsDone=!0;var A=C.GLctx;Hg(A),qg(A),Kg(A),A.disjointTimerQueryExt=A.getExtension("EXT_disjoint_timer_query"),Xg(A);var V=A.getSupportedExtensions()||[];V.forEach(function(Z){Z.indexOf("lose_context")<0&&Z.indexOf("debug")<0&&A.getExtension(Z)})}},populateUniformTable:function(C){for(var A=ct.programs[C],V=ct.programInfos[C]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1},Z=V.uniforms,he=la.getProgramParameter(A,35718),de=0;de<he;++de){var me=la.getActiveUniform(A,de),Ne=me.name;V.maxUniformLength=Math.max(V.maxUniformLength,Ne.length+1),Ne.slice(-1)=="]"&&(Ne=Ne.slice(0,Ne.lastIndexOf("[")));var dt=la.getUniformLocation(A,Ne);if(dt){var gr=ct.getNewId(ct.uniforms);Z[Ne]=[me.size,gr],ct.uniforms[gr]=dt;for(var fr=1;fr<me.size;++fr){var fa=Ne+"["+fr+"]";dt=la.getUniformLocation(A,fa),gr=ct.getNewId(ct.uniforms),ct.uniforms[gr]=dt}}}}},Yg=["default","low-power","high-performance"];function Zg(C,A){var V=A>>2,Z=o()[V+(24>>2)],he={alpha:!!o()[V+(0>>2)],depth:!!o()[V+(4>>2)],stencil:!!o()[V+(8>>2)],antialias:!!o()[V+(12>>2)],premultipliedAlpha:!!o()[V+(16>>2)],preserveDrawingBuffer:!!o()[V+(20>>2)],powerPreference:Yg[Z],failIfMajorPerformanceCaveat:!!o()[V+(28>>2)],majorVersion:o()[V+(32>>2)],minorVersion:o()[V+(36>>2)],enableExtensionsByDefault:o()[V+(40>>2)],explicitSwapControl:o()[V+(44>>2)],proxyContextToMainThread:o()[V+(48>>2)],renderViaOffscreenBackBuffer:o()[V+(52>>2)]},de=hc(C);if(!de||he.explicitSwapControl)return 0;var me=ct.createContext(de,he);return me}function Jg(C,A){return Zg(C,A)}var Iu={mappings:{},buffers:[null,[],[]],printChar:function(C,A){var V=Iu.buffers[C];A===0||A===10?((C===1?B:L)(_e(V,0)),V.length=0):V.push(A)},varargs:void 0,get:function(){Iu.varargs+=4;var C=o()[Iu.varargs-4>>2];return C},getStr:function(C){var A=Ae(C);return A},get64:function(C,A){return C}};function Cf(C){return y?ua(3,1,C):0}function Nf(C,A,V,Z,he){if(y)return ua(4,1,C,A,V,Z,he)}function Ef(C,A,V,Z){if(y)return ua(5,1,C,A,V,Z);for(var he=0,de=0;de<V;de++){for(var me=o()[A+de*8>>2],Ne=o()[A+(de*8+4)>>2],dt=0;dt<Ne;dt++)Iu.printChar(C,n()[me+dt]);he+=Ne}return o()[Z>>2]=he,0}function Qg(C){var A=Fe.threadExitHandlers.pop();C&&A()}function ev(C,A){Fe.threadExitHandlers.push(function(){Ft.get(C)(A)})}function Tf(C){if(y)throw"Internal Error! spawnThread() can only ever be called from main application thread!";var A=Fe.getNewWorker();if(A.pthread!==void 0)throw"Internal error!";if(!C.pthread_ptr)throw"Internal error, no pthread ptr!";Fe.runningWorkers.push(A);for(var V=Ja(128*4),Z=0;Z<128;++Z)o()[V+Z*4>>2]=0;var he=C.stackBase+C.stackSize,de=Fe.pthreads[C.pthread_ptr]={worker:A,stackBase:C.stackBase,stackSize:C.stackSize,allocatedOwnStack:C.allocatedOwnStack,threadInfoStruct:C.pthread_ptr},me=de.threadInfoStruct>>2;Atomics.store(a(),me+(64>>2),C.detached),Atomics.store(a(),me+(100>>2),V),Atomics.store(a(),me+(40>>2),de.threadInfoStruct),Atomics.store(a(),me+(80>>2),C.stackSize),Atomics.store(a(),me+(76>>2),he),Atomics.store(a(),me+(104>>2),C.stackSize),Atomics.store(a(),me+(104+8>>2),he),Atomics.store(a(),me+(104+12>>2),C.detached);var Ne=xk(),dt=Ne+40;Atomics.store(a(),me+(172>>2),dt),A.pthread=de;var gr={cmd:"run",start_routine:C.startRoutine,arg:C.arg,threadInfoStruct:C.pthread_ptr,stackBase:C.stackBase,stackSize:C.stackSize};A.runPthread=function(){gr.time=performance.now(),A.postMessage(gr,C.transferList)},A.loaded&&(A.runPthread(),delete A.runPthread)}function tv(C,A,V,Z){if(typeof SharedArrayBuffer=="undefined")return L("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;if(!C)return L("pthread_create called with a null thread pointer!"),28;var he=[],de=0;if(y&&(he.length===0||de))return _k(687865856,C,A,V,Z);if(de)return de;var me=0,Ne=0,dt=0;A&&A!=-1?(me=o()[A>>2],me+=81920,Ne=o()[A+8>>2],dt=o()[A+12>>2]!==0):me=2097152;var gr=Ne==0;gr?Ne=Ck(16,me):(Ne-=me,pe(Ne>0));for(var fr=Ja(228),fa=0;fa<228>>2;++fa)a()[(fr>>2)+fa]=0;o()[C>>2]=fr,o()[fr+12>>2]=fr;var Au=fr+152;o()[Au>>2]=Au;var Rr={stackBase:Ne,stackSize:me,allocatedOwnStack:gr,detached:dt,startRoutine:V,pthread_ptr:fr,arg:Z,transferList:he};return y?(Rr.cmd="spawnThread",postMessage(Rr,he)):Tf(Rr),0}function rv(){if(!!y){var C=pa();if(!!C){var A=Atomics.load(a(),C+56>>2);if(!A){var V=Atomics.load(a(),C+0>>2);if(V==2)throw"Canceled!"}}}}function nv(){v||g||H("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function ov(C,A,V){if(!C)return L("pthread_join attempted on a null thread pointer!"),ia.ESRCH;if(y&&pa()==C)return L("PThread "+C+" is attempting to join to itself!"),ia.EDEADLK;if(!y&&wk()==C)return L("Main thread "+C+" is attempting to join to itself!"),ia.EDEADLK;var Z=o()[C+12>>2];if(Z!==C)return L("pthread_join attempted on thread "+C+", which does not point to a valid thread, or does not exist anymore!"),ia.ESRCH;var he=Atomics.load(a(),C+64>>2);if(he)return L("Attempted to join thread "+C+", which was already detached!"),ia.EINVAL;for(V&&nv();;){var de=Atomics.load(a(),C+0>>2);if(de==1){var me=Atomics.load(a(),C+4>>2);return A&&(o()[A>>2]=me),Atomics.store(a(),C+64>>2,1),y?postMessage({cmd:"cleanupThread",thread:C}):kf(C),0}if(!V)return ia.EBUSY;rv(),y||Mf(),_f(C+0,de,y?100:1)}}function av(C,A){return ov(C,A,!0)}function Af(C){if(y)return ua(6,1,C);switch(C){case 30:return 16384;case 85:var A=2147483648;return A/16384;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:case 80:case 81:case 79:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return typeof navigator=="object"&&navigator.hardwareConcurrency||1}return Sg(28),-1}y||Fe.initMainThreadBlock();var la,sv=[null,Ig,If,Cf,Nf,Ef,Af],iv={e:kg,r:_g,x:Cg,b:Ng,y:Eg,j:Tg,d:_f,c:fc,f:Za,p:Ag,A:Fg,u:Rg,q:Og,v:Ug,i:Gg,s:jg,w:Jg,l:Cf,n:Nf,g:Ef,o:wf,a:Y||s.wasmMemory,z:Qg,k:ev,h:tv,m:av,t:Af},gk=hg(),Ff=s.___wasm_call_ctors=function(){return(Ff=s.___wasm_call_ctors=s.asm.B).apply(null,arguments)},uv=s._init=function(){return(uv=s._init=s.asm.C).apply(null,arguments)},lv=s._init_with_threads_count=function(){return(lv=s._init_with_threads_count=s.asm.D).apply(null,arguments)},cv=s._get_threads_count=function(){return(cv=s._get_threads_count=s.asm.E).apply(null,arguments)},pv=s._register_tensor=function(){return(pv=s._register_tensor=s.asm.F).apply(null,arguments)},fv=s._dispose_data=function(){return(fv=s._dispose_data=s.asm.G).apply(null,arguments)},dv=s._dispose=function(){return(dv=s._dispose=s.asm.H).apply(null,arguments)},mv=s._Abs=function(){return(mv=s._Abs=s.asm.J).apply(null,arguments)},hv=s._Add=function(){return(hv=s._Add=s.asm.K).apply(null,arguments)},gv=s._AddN=function(){return(gv=s._AddN=s.asm.L).apply(null,arguments)},vv=s._All=function(){return(vv=s._All=s.asm.M).apply(null,arguments)},xv=s._Any=function(){return(xv=s._Any=s.asm.N).apply(null,arguments)},yv=s._ArgMax=function(){return(yv=s._ArgMax=s.asm.O).apply(null,arguments)},bv=s._AvgPool=function(){return(bv=s._AvgPool=s.asm.P).apply(null,arguments)},wv=s._BatchMatMul=function(){return(wv=s._BatchMatMul=s.asm.Q).apply(null,arguments)},kv=s._Ceil=function(){return(kv=s._Ceil=s.asm.R).apply(null,arguments)},_v=s._ClipByValue=function(){return(_v=s._ClipByValue=s.asm.S).apply(null,arguments)},Sv=s._Conv2D=function(){return(Sv=s._Conv2D=s.asm.T).apply(null,arguments)},Iv=s._Conv2DBackpropInput=function(){return(Iv=s._Conv2DBackpropInput=s.asm.U).apply(null,arguments)},Cv=s._Cos=function(){return(Cv=s._Cos=s.asm.V).apply(null,arguments)},Nv=s._Cosh=function(){return(Nv=s._Cosh=s.asm.W).apply(null,arguments)},Df=s._CropAndResize=function(){return(Df=s._CropAndResize=s.asm.X).apply(null,arguments)},Rf=s._Cumsum=function(){return(Rf=s._Cumsum=s.asm.Y).apply(null,arguments)},$f=s._DepthToSpace=function(){return($f=s._DepthToSpace=s.asm.Z).apply(null,arguments)},gc=s._DepthwiseConv2dNative=function(){return(gc=s._DepthwiseConv2dNative=s.asm._).apply(null,arguments)},Cu=s._Elu=function(){return(Cu=s._Elu=s.asm.$).apply(null,arguments)},Ev=s._Equal=function(){return(Ev=s._Equal=s.asm.aa).apply(null,arguments)},vc=s._Exp=function(){return(vc=s._Exp=s.asm.ba).apply(null,arguments)},re=s._FlipLeftRight=function(){return(re=s._FlipLeftRight=s.asm.ca).apply(null,arguments)},ae=s._Floor=function(){return(ae=s._Floor=s.asm.da).apply(null,arguments)},Se=s._FloorDiv=function(){return(Se=s._FloorDiv=s.asm.ea).apply(null,arguments)},st=s._FusedBatchNorm=function(){return(st=s._FusedBatchNorm=s.asm.fa).apply(null,arguments)},er=s._FusedConv2D=function(){return(er=s._FusedConv2D=s.asm.ga).apply(null,arguments)},Gt=s._FusedDepthwiseConv2D=function(){return(Gt=s._FusedDepthwiseConv2D=s.asm.ha).apply(null,arguments)},et=s._Gather=function(){return(et=s._Gather=s.asm.ia).apply(null,arguments)},rt=s._GatherNd=function(){return(rt=s._GatherNd=s.asm.ja).apply(null,arguments)},wr=s._Greater=function(){return(wr=s._Greater=s.asm.ka).apply(null,arguments)},_o=s._GreaterEqual=function(){return(_o=s._GreaterEqual=s.asm.la).apply(null,arguments)},So=s._LeakyRelu=function(){return(So=s._LeakyRelu=s.asm.ma).apply(null,arguments)},Pf=s._Less=function(){return(Pf=s._Less=s.asm.na).apply(null,arguments)},xc=s._LessEqual=function(){return(xc=s._LessEqual=s.asm.oa).apply(null,arguments)},Yr=s._Log=function(){return(Yr=s._Log=s.asm.pa).apply(null,arguments)},ca=s._LogicalAnd=function(){return(ca=s._LogicalAnd=s.asm.qa).apply(null,arguments)},Of=s._Max=function(){return(Of=s._Max=s.asm.ra).apply(null,arguments)},kV=s._MaxPool=function(){return(kV=s._MaxPool=s.asm.sa).apply(null,arguments)},_V=s._Maximum=function(){return(_V=s._Maximum=s.asm.ta).apply(null,arguments)},SV=s._Mean=function(){return(SV=s._Mean=s.asm.ua).apply(null,arguments)},IV=s._Min=function(){return(IV=s._Min=s.asm.va).apply(null,arguments)},CV=s._Minimum=function(){return(CV=s._Minimum=s.asm.wa).apply(null,arguments)},NV=s._MirrorPad=function(){return(NV=s._MirrorPad=s.asm.xa).apply(null,arguments)},EV=s._Multiply=function(){return(EV=s._Multiply=s.asm.ya).apply(null,arguments)},TV=s._Neg=function(){return(TV=s._Neg=s.asm.za).apply(null,arguments)},AV=s._NonMaxSuppressionV3=function(){return(AV=s._NonMaxSuppressionV3=s.asm.Aa).apply(null,arguments)},FV=s._NonMaxSuppressionV4=function(){return(FV=s._NonMaxSuppressionV4=s.asm.Ba).apply(null,arguments)},DV=s._NonMaxSuppressionV5=function(){return(DV=s._NonMaxSuppressionV5=s.asm.Ca).apply(null,arguments)},RV=s._NotEqual=function(){return(RV=s._NotEqual=s.asm.Da).apply(null,arguments)},$V=s._OneHot=function(){return($V=s._OneHot=s.asm.Ea).apply(null,arguments)},PV=s._PadV2=function(){return(PV=s._PadV2=s.asm.Fa).apply(null,arguments)},OV=s._Pow=function(){return(OV=s._Pow=s.asm.Ga).apply(null,arguments)},MV=s._Prelu=function(){return(MV=s._Prelu=s.asm.Ha).apply(null,arguments)},BV=s._Prod=function(){return(BV=s._Prod=s.asm.Ia).apply(null,arguments)},LV=s._RealDiv=function(){return(LV=s._RealDiv=s.asm.Ja).apply(null,arguments)},VV=s._Relu=function(){return(VV=s._Relu=s.asm.Ka).apply(null,arguments)},WV=s._Relu6=function(){return(WV=s._Relu6=s.asm.La).apply(null,arguments)},zV=s._ResizeBilinear=function(){return(zV=s._ResizeBilinear=s.asm.Ma).apply(null,arguments)},UV=s._Reverse=function(){return(UV=s._Reverse=s.asm.Na).apply(null,arguments)},GV=s._RotateWithOffset=function(){return(GV=s._RotateWithOffset=s.asm.Oa).apply(null,arguments)},jV=s._Round=function(){return(jV=s._Round=s.asm.Pa).apply(null,arguments)},HV=s._Rsqrt=function(){return(HV=s._Rsqrt=s.asm.Qa).apply(null,arguments)},qV=s._ScatterNd=function(){return(qV=s._ScatterNd=s.asm.Ra).apply(null,arguments)},KV=s._SelectV2=function(){return(KV=s._SelectV2=s.asm.Sa).apply(null,arguments)},XV=s._Sigmoid=function(){return(XV=s._Sigmoid=s.asm.Ta).apply(null,arguments)},YV=s._Sin=function(){return(YV=s._Sin=s.asm.Ua).apply(null,arguments)},ZV=s._Softmax=function(){return(ZV=s._Softmax=s.asm.Va).apply(null,arguments)},JV=s._Sqrt=function(){return(JV=s._Sqrt=s.asm.Wa).apply(null,arguments)},QV=s._Square=function(){return(QV=s._Square=s.asm.Xa).apply(null,arguments)},eW=s._SquaredDifference=function(){return(eW=s._SquaredDifference=s.asm.Ya).apply(null,arguments)},tW=s._Step=function(){return(tW=s._Step=s.asm.Za).apply(null,arguments)},rW=s._StridedSlice=function(){return(rW=s._StridedSlice=s.asm._a).apply(null,arguments)},nW=s._Sub=function(){return(nW=s._Sub=s.asm.$a).apply(null,arguments)},oW=s._Sum=function(){return(oW=s._Sum=s.asm.ab).apply(null,arguments)},aW=s._Tan=function(){return(aW=s._Tan=s.asm.bb).apply(null,arguments)},sW=s._Tanh=function(){return(sW=s._Tanh=s.asm.cb).apply(null,arguments)},iW=s._Tile=function(){return(iW=s._Tile=s.asm.db).apply(null,arguments)},uW=s._TopK=function(){return(uW=s._TopK=s.asm.eb).apply(null,arguments)},lW=s._Transform=function(){return(lW=s._Transform=s.asm.fb).apply(null,arguments)},cW=s._Transpose=function(){return(cW=s._Transpose=s.asm.gb).apply(null,arguments)},pW=s.__FusedMatMul=function(){return(pW=s.__FusedMatMul=s.asm.hb).apply(null,arguments)},Ja=s._malloc=function(){return(Ja=s._malloc=s.asm.ib).apply(null,arguments)},yc=s._free=function(){return(yc=s._free=s.asm.jb).apply(null,arguments)},vk=s.___errno_location=function(){return(vk=s.___errno_location=s.asm.kb).apply(null,arguments)},xk=s._emscripten_get_global_libc=function(){return(xk=s._emscripten_get_global_libc=s.asm.lb).apply(null,arguments)},pa=s._pthread_self=function(){return(pa=s._pthread_self=s.asm.mb).apply(null,arguments)},yk=s.___pthread_tsd_run_dtors=function(){return(yk=s.___pthread_tsd_run_dtors=s.asm.nb).apply(null,arguments)},Mf=s._emscripten_main_thread_process_queued_calls=function(){return(Mf=s._emscripten_main_thread_process_queued_calls=s.asm.ob).apply(null,arguments)},fW=s._emscripten_current_thread_process_queued_calls=function(){return(fW=s._emscripten_current_thread_process_queued_calls=s.asm.pb).apply(null,arguments)},bk=s._emscripten_register_main_browser_thread_id=function(){return(bk=s._emscripten_register_main_browser_thread_id=s.asm.qb).apply(null,arguments)},wk=s._emscripten_main_browser_thread_id=function(){return(wk=s._emscripten_main_browser_thread_id=s.asm.rb).apply(null,arguments)},kk=s.__emscripten_do_dispatch_to_thread=function(){return(kk=s.__emscripten_do_dispatch_to_thread=s.asm.sb).apply(null,arguments)},_k=s._emscripten_sync_run_in_main_thread_4=function(){return(_k=s._emscripten_sync_run_in_main_thread_4=s.asm.tb).apply(null,arguments)},Sk=s._emscripten_run_in_main_runtime_thread_js=function(){return(Sk=s._emscripten_run_in_main_runtime_thread_js=s.asm.ub).apply(null,arguments)},Tv=s.__emscripten_call_on_thread=function(){return(Tv=s.__emscripten_call_on_thread=s.asm.vb).apply(null,arguments)},dW=s._emscripten_tls_init=function(){return(dW=s._emscripten_tls_init=s.asm.wb).apply(null,arguments)},Av=s.__emscripten_thread_init=function(){return(Av=s.__emscripten_thread_init=s.asm.xb).apply(null,arguments)},bc=s.stackSave=function(){return(bc=s.stackSave=s.asm.yb).apply(null,arguments)},Nu=s.stackRestore=function(){return(Nu=s.stackRestore=s.asm.zb).apply(null,arguments)},Eu=s.stackAlloc=function(){return(Eu=s.stackAlloc=s.asm.Ab).apply(null,arguments)},Ik=s._emscripten_stack_set_limits=function(){return(Ik=s._emscripten_stack_set_limits=s.asm.Bb).apply(null,arguments)},Ck=s._memalign=function(){return(Ck=s._memalign=s.asm.Cb).apply(null,arguments)},Nk=s.__emscripten_allow_main_runtime_queued_calls=10512,Tu=s.__emscripten_main_thread_futex=12148;s.cwrap=ye,s.PThread=Fe,s.PThread=Fe,s.wasmMemory=Y,s.ExitStatus=wc;var Bf;function wc(C){this.name="ExitStatus",this.message="Program terminated with exit("+C+")",this.status=C}Xa=function C(){Bf||Fv(),Bf||(Xa=C)};function Fv(C){if(C=C||f,yn>0)return;if(y){u(s),hf(),postMessage({cmd:"loaded"});return}if(_u(),yn>0)return;function A(){Bf||(Bf=!0,s.calledRun=!0,!te&&(hf(),gf(),u(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),vf()))}s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),A()},1)):A()}s.run=Fv;function mW(C,A){if(!(A&&ee&&C===0)){if(!A&&y)throw postMessage({cmd:"exitProcess",returnCode:C}),new wc(C);ee||(Fe.terminateAllThreads(),ce=C,Vr(),s.onExit&&s.onExit(C),te=!0),m(C,new wc(C))}}if(s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();return y&&(ee=!1,Fe.initWorker()),Fv(),e.ready}}();typeof Nh=="object"&&typeof q0=="object"?q0.exports=H0:typeof define=="function"&&define.amd?define([],function(){return H0}):typeof Nh=="object"&&(Nh.WasmBackendModuleThreadedSimd=H0)});var h3=jt((Eh,X0)=>{var K0=function(){var r=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename!="undefined"&&(r=r||__filename),function(e){e=e||{};var t=typeof e!="undefined"?e:{},n,o;t.ready=new Promise(function(re,ae){n=re,o=ae});var a={},i;for(i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);var s=[],u="./this.program",l=function(re,ae){throw ae},c=!1,p=!1,f=!1,d=!1;c=typeof window=="object",p=typeof importScripts=="function",f=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d=!c&&!f&&!p;var m="";function h(re){return t.locateFile?t.locateFile(re,m):m+re}var g,v,x,y,b,k;f?(p?m=Kl().dirname(m)+"/":m=__dirname+"/",g=function(ae,Se){return b||(b=Ch()),k||(k=Kl()),ae=k.normalize(ae),b.readFileSync(ae,Se?null:"utf8")},x=function(ae){var Se=g(ae,!0);return Se.buffer||(Se=new Uint8Array(Se)),B(Se.buffer),Se},process.argv.length>1&&(u=process.argv[1].replace(/\\/g,"/")),s=process.argv.slice(2),process.on("uncaughtException",function(re){if(!(re instanceof Ev))throw re}),process.on("unhandledRejection",Vn),l=function(re){process.exit(re)},t.inspect=function(){return"[Emscripten Module object]"}):d?(typeof read!="undefined"&&(g=function(ae){return read(ae)}),x=function(ae){var Se;return typeof readbuffer=="function"?new Uint8Array(readbuffer(ae)):(Se=read(ae,"binary"),B(typeof Se=="object"),Se)},typeof scriptArgs!="undefined"?s=scriptArgs:typeof arguments!="undefined"&&(s=arguments),typeof quit=="function"&&(l=function(re){quit(re)}),typeof print!="undefined"&&(typeof console=="undefined"&&(console={}),console.log=print,console.warn=console.error=typeof printErr!="undefined"?printErr:print)):(c||p)&&(p?m=self.location.href:typeof document!="undefined"&&document.currentScript&&(m=document.currentScript.src),r&&(m=r),m.indexOf("blob:")!==0?m=m.substr(0,m.lastIndexOf("/")+1):m="",g=function(re){var ae=new XMLHttpRequest;return ae.open("GET",re,!1),ae.send(null),ae.responseText},p&&(x=function(re){var ae=new XMLHttpRequest;return ae.open("GET",re,!1),ae.responseType="arraybuffer",ae.send(null),new Uint8Array(ae.response)}),v=function(re,ae,Se){var st=new XMLHttpRequest;st.open("GET",re,!0),st.responseType="arraybuffer",st.onload=function(){if(st.status==200||st.status==0&&st.response){ae(st.response);return}Se()},st.onerror=Se,st.send(null)},y=function(re){document.title=re});var N=t.print||console.log.bind(console),E=t.printErr||console.warn.bind(console);for(i in a)a.hasOwnProperty(i)&&(t[i]=a[i]);a=null,t.arguments&&(s=t.arguments),t.thisProgram&&(u=t.thisProgram),t.quit&&(l=t.quit);var T;t.wasmBinary&&(T=t.wasmBinary);var R=t.noExitRuntime||!0;typeof WebAssembly!="object"&&Vn("no native wasm support detected");var $,O=!1,M;function B(re,ae){re||Vn("Assertion failed: "+ae)}function L(re){var ae=t["_"+re];return B(ae,"Cannot call unknown function "+re+", make sure it is exported"),ae}function H(re,ae,Se,st,er){var Gt={string:function(Yr){var ca=0;if(Yr!=null&&Yr!==0){var Of=(Yr.length<<2)+1;ca=gc(Of),Y(Yr,ca,Of)}return ca},array:function(Yr){var ca=gc(Yr.length);return ne(Yr,ca),ca}};function et(Yr){return ae==="string"?Q(Yr):ae==="boolean"?Boolean(Yr):Yr}var rt=L(re),wr=[],_o=0;if(st)for(var So=0;So<st.length;So++){var Pf=Gt[Se[So]];Pf?(_o===0&&(_o=Rf()),wr[So]=Pf(st[So])):wr[So]=st[So]}var xc=rt.apply(null,wr);return xc=et(xc),_o!==0&&$f(_o),xc}function W(re,ae,Se,st){Se=Se||[];var er=Se.every(function(et){return et==="number"}),Gt=ae!=="string";return Gt&&er&&!st?L(re):function(){return H(re,ae,Se,arguments,st)}}var K=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function J(re,ae,Se){for(var st=ae+Se,er=ae;re[er]&&!(er>=st);)++er;if(er-ae>16&&re.subarray&&K)return K.decode(re.subarray(ae,er));for(var Gt="";ae<er;){var et=re[ae++];if(!(et&128)){Gt+=String.fromCharCode(et);continue}var rt=re[ae++]&63;if((et&224)==192){Gt+=String.fromCharCode((et&31)<<6|rt);continue}var wr=re[ae++]&63;if((et&240)==224?et=(et&15)<<12|rt<<6|wr:et=(et&7)<<18|rt<<12|wr<<6|re[ae++]&63,et<65536)Gt+=String.fromCharCode(et);else{var _o=et-65536;Gt+=String.fromCharCode(55296|_o>>10,56320|_o&1023)}}return Gt}function Q(re,ae){return re?J(se,re,ae):""}function ee(re,ae,Se,st){if(!(st>0))return 0;for(var er=Se,Gt=Se+st-1,et=0;et<re.length;++et){var rt=re.charCodeAt(et);if(rt>=55296&&rt<=57343){var wr=re.charCodeAt(++et);rt=65536+((rt&1023)<<10)|wr&1023}if(rt<=127){if(Se>=Gt)break;ae[Se++]=rt}else if(rt<=2047){if(Se+1>=Gt)break;ae[Se++]=192|rt>>6,ae[Se++]=128|rt&63}else if(rt<=65535){if(Se+2>=Gt)break;ae[Se++]=224|rt>>12,ae[Se++]=128|rt>>6&63,ae[Se++]=128|rt&63}else{if(Se+3>=Gt)break;ae[Se++]=240|rt>>18,ae[Se++]=128|rt>>12&63,ae[Se++]=128|rt>>6&63,ae[Se++]=128|rt&63}}return ae[Se]=0,Se-er}function Y(re,ae,Se){return ee(re,se,ae,Se)}function ne(re,ae){pe.set(re,ae)}function te(re,ae){return re%ae>0&&(re+=ae-re%ae),re}var ce,pe,se,fe,ye,_e,Ae,We,Ze;function ut(re){ce=re,t.HEAP8=pe=new Int8Array(re),t.HEAP16=fe=new Int16Array(re),t.HEAP32=_e=new Int32Array(re),t.HEAPU8=se=new Uint8Array(re),t.HEAPU16=ye=new Uint16Array(re),t.HEAPU32=Ae=new Uint32Array(re),t.HEAPF32=We=new Float32Array(re),t.HEAPF64=Ze=new Float64Array(re)}var lt=t.INITIAL_MEMORY||16777216,tt,Ue=[],Ge=[],Ie=[],cr=[],ft=!1;Ge.push({func:function(){wf()}});function St(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ht(t.preRun.shift());yn(Ue)}function Qt(){ft=!0,yn(Ge)}function Xr(){yn(Ie)}function Xt(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Nr(t.postRun.shift());yn(cr)}function ht(re){Ue.unshift(re)}function Nr(re){cr.unshift(re)}var Ft=0,pr=null,Dt=null;function qa(re){Ft++,t.monitorRunDependencies&&t.monitorRunDependencies(Ft)}function Ka(re){if(Ft--,t.monitorRunDependencies&&t.monitorRunDependencies(Ft),Ft==0&&(pr!==null&&(clearInterval(pr),pr=null),Dt)){var ae=Dt;Dt=null,ae()}}t.preloadedImages={},t.preloadedAudios={};function Vn(re){t.onAbort&&t.onAbort(re),re+="",E(re),O=!0,M=1,re="abort("+re+"). Build with -s ASSERTIONS=1 for more info.";var ae=new WebAssembly.RuntimeError(re);throw o(ae),ae}function wo(re,ae){return String.prototype.startsWith?re.startsWith(ae):re.indexOf(ae)===0}var cc="data:application/octet-stream;base64,";function _u(re){return wo(re,cc)}var hf="file://";function gf(re){return wo(re,hf)}var Vr="tfjs-backend-wasm.wasm";_u(Vr)||(Vr=h(Vr));function vf(re){try{if(re==Vr&&T)return new Uint8Array(T);if(x)return x(re);throw"both async and sync fetching of the wasm failed"}catch(ae){Vn(ae)}}function ug(){if(!T&&(c||p)){if(typeof fetch=="function"&&!gf(Vr))return fetch(Vr,{credentials:"same-origin"}).then(function(re){if(!re.ok)throw"failed to load wasm binary file at '"+Vr+"'";return re.arrayBuffer()}).catch(function(){return vf(Vr)});if(v)return new Promise(function(re,ae){v(Vr,function(Se){re(new Uint8Array(Se))},ae)})}return Promise.resolve().then(function(){return vf(Vr)})}function lg(){var re={a:hg};function ae(et,rt){var wr=et.exports;t.asm=wr,$=t.asm.j,ut($.buffer),tt=t.asm.r,Ka("wasm-instantiate")}qa("wasm-instantiate");function Se(et){ae(et.instance)}function st(et){return ug().then(function(rt){return WebAssembly.instantiate(rt,re)}).then(et,function(rt){E("failed to asynchronously prepare wasm: "+rt),Vn(rt)})}function er(){return!T&&typeof WebAssembly.instantiateStreaming=="function"&&!_u(Vr)&&!gf(Vr)&&typeof fetch=="function"?fetch(Vr,{credentials:"same-origin"}).then(function(et){var rt=WebAssembly.instantiateStreaming(et,re);return rt.then(Se,function(wr){return E("wasm streaming compile failed: "+wr),E("falling back to ArrayBuffer instantiation"),st(Se)})}):st(Se)}if(t.instantiateWasm)try{var Gt=t.instantiateWasm(re,ae);return Gt}catch(et){return E("Module.instantiateWasm callback failed with error: "+et),!1}return er().catch(o),{}}function yn(re){for(;re.length>0;){var ae=re.shift();if(typeof ae=="function"){ae(t);continue}var Se=ae.func;typeof Se=="number"?ae.arg===void 0?tt.get(Se)():tt.get(Se)(ae.arg):Se(ae.arg===void 0?null:ae.arg)}}function pc(){Vn()}function Xa(re,ae,Se){se.copyWithin(re,ae,ae+Se)}function cg(){return se.length}function pg(re){try{return $.grow(re-ce.byteLength+65535>>>16),ut($.buffer),1}catch(ae){}}function ko(re){var ae=cg(),Se=2147483648;if(re>Se)return!1;for(var st=1;st<=4;st*=2){var er=ae*(1+.2/st);er=Math.min(er,re+100663296);var Gt=Math.min(Se,te(Math.max(re,er),65536)),et=pg(Gt);if(et)return!0}return!1}var Ya={mappings:{},buffers:[null,[],[]],printChar:function(re,ae){var Se=Ya.buffers[re];ae===0||ae===10?((re===1?N:E)(J(Se,0)),Se.length=0):Se.push(ae)},varargs:void 0,get:function(){Ya.varargs+=4;var re=_e[Ya.varargs-4>>2];return re},getStr:function(re){var ae=Q(re);return ae},get64:function(re,ae){return re}};function fg(re){return 0}function xf(re,ae,Se,st,er){}function dg(re,ae,Se,st){for(var er=0,Gt=0;Gt<Se;Gt++){for(var et=_e[ae+Gt*8>>2],rt=_e[ae+(Gt*8+4)>>2],wr=0;wr<rt;wr++)Ya.printChar(re,se[et+wr]);er+=rt}return _e[st>>2]=er,0}function yf(){return 6}function Wr(){return 28}function bf(re){return _e[Df()>>2]=re,re}function mg(re){switch(re){case 30:return 16384;case 85:var ae=2147483648;return ae/16384;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:case 80:case 81:case 79:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return typeof navigator=="object"&&navigator.hardwareConcurrency||1}return bf(28),-1}var hg={a:pc,d:Xa,e:ko,f:fg,c:xf,b:dg,h:yf,g:Wr,i:mg},gg=lg(),wf=t.___wasm_call_ctors=function(){return(wf=t.___wasm_call_ctors=t.asm.k).apply(null,arguments)},Su=t._init=function(){return(Su=t._init=t.asm.l).apply(null,arguments)},ia=t._init_with_threads_count=function(){return(ia=t._init_with_threads_count=t.asm.m).apply(null,arguments)},fc=t._get_threads_count=function(){return(fc=t._get_threads_count=t.asm.n).apply(null,arguments)},vg=t._register_tensor=function(){return(vg=t._register_tensor=t.asm.o).apply(null,arguments)},xg=t._dispose_data=function(){return(xg=t._dispose_data=t.asm.p).apply(null,arguments)},kf=t._dispose=function(){return(kf=t._dispose=t.asm.q).apply(null,arguments)},Fe=t._Abs=function(){return(Fe=t._Abs=t.asm.s).apply(null,arguments)},yg=t._Add=function(){return(yg=t._Add=t.asm.t).apply(null,arguments)},bg=t._AddN=function(){return(bg=t._AddN=t.asm.u).apply(null,arguments)},wg=t._All=function(){return(wg=t._All=t.asm.v).apply(null,arguments)},kg=t._Any=function(){return(kg=t._Any=t.asm.w).apply(null,arguments)},_g=t._ArgMax=function(){return(_g=t._ArgMax=t.asm.x).apply(null,arguments)},Za=t._AvgPool=function(){return(Za=t._AvgPool=t.asm.y).apply(null,arguments)},Sg=t._BatchMatMul=function(){return(Sg=t._BatchMatMul=t.asm.z).apply(null,arguments)},Ig=t._Ceil=function(){return(Ig=t._Ceil=t.asm.A).apply(null,arguments)},Cg=t._ClipByValue=function(){return(Cg=t._ClipByValue=t.asm.B).apply(null,arguments)},Ng=t._Conv2D=function(){return(Ng=t._Conv2D=t.asm.C).apply(null,arguments)},Eg=t._Conv2DBackpropInput=function(){return(Eg=t._Conv2DBackpropInput=t.asm.D).apply(null,arguments)},Tg=t._Cos=function(){return(Tg=t._Cos=t.asm.E).apply(null,arguments)},_f=t._Cosh=function(){return(_f=t._Cosh=t.asm.F).apply(null,arguments)},Ag=t._CropAndResize=function(){return(Ag=t._CropAndResize=t.asm.G).apply(null,arguments)},Fg=t._Cumsum=function(){return(Fg=t._Cumsum=t.asm.H).apply(null,arguments)},ua=t._DepthToSpace=function(){return(ua=t._DepthToSpace=t.asm.I).apply(null,arguments)},dc=t._DepthwiseConv2dNative=function(){return(dc=t._DepthwiseConv2dNative=t.asm.J).apply(null,arguments)},mc=t._Elu=function(){return(mc=t._Elu=t.asm.K).apply(null,arguments)},Dg=t._Equal=function(){return(Dg=t._Equal=t.asm.L).apply(null,arguments)},Rg=t._Exp=function(){return(Rg=t._Exp=t.asm.M).apply(null,arguments)},$g=t._FlipLeftRight=function(){return($g=t._FlipLeftRight=t.asm.N).apply(null,arguments)},Pg=t._Floor=function(){return(Pg=t._Floor=t.asm.O).apply(null,arguments)},Og=t._FloorDiv=function(){return(Og=t._FloorDiv=t.asm.P).apply(null,arguments)},Ke=t._FusedBatchNorm=function(){return(Ke=t._FusedBatchNorm=t.asm.Q).apply(null,arguments)},Mg=t._FusedConv2D=function(){return(Mg=t._FusedConv2D=t.asm.R).apply(null,arguments)},Bg=t._FusedDepthwiseConv2D=function(){return(Bg=t._FusedDepthwiseConv2D=t.asm.S).apply(null,arguments)},Lg=t._Gather=function(){return(Lg=t._Gather=t.asm.T).apply(null,arguments)},Vg=t._GatherNd=function(){return(Vg=t._GatherNd=t.asm.U).apply(null,arguments)},Wg=t._Greater=function(){return(Wg=t._Greater=t.asm.V).apply(null,arguments)},zg=t._GreaterEqual=function(){return(zg=t._GreaterEqual=t.asm.W).apply(null,arguments)},hc=t._LeakyRelu=function(){return(hc=t._LeakyRelu=t.asm.X).apply(null,arguments)},Sf=t._Less=function(){return(Sf=t._Less=t.asm.Y).apply(null,arguments)},If=t._LessEqual=function(){return(If=t._LessEqual=t.asm.Z).apply(null,arguments)},Ug=t._Log=function(){return(Ug=t._Log=t.asm._).apply(null,arguments)},Gg=t._LogicalAnd=function(){return(Gg=t._LogicalAnd=t.asm.$).apply(null,arguments)},jg=t._Max=function(){return(jg=t._Max=t.asm.aa).apply(null,arguments)},Hg=t._MaxPool=function(){return(Hg=t._MaxPool=t.asm.ba).apply(null,arguments)},qg=t._Maximum=function(){return(qg=t._Maximum=t.asm.ca).apply(null,arguments)},Kg=t._Mean=function(){return(Kg=t._Mean=t.asm.da).apply(null,arguments)},Xg=t._Min=function(){return(Xg=t._Min=t.asm.ea).apply(null,arguments)},ct=t._Minimum=function(){return(ct=t._Minimum=t.asm.fa).apply(null,arguments)},Yg=t._MirrorPad=function(){return(Yg=t._MirrorPad=t.asm.ga).apply(null,arguments)},Zg=t._Multiply=function(){return(Zg=t._Multiply=t.asm.ha).apply(null,arguments)},Jg=t._Neg=function(){return(Jg=t._Neg=t.asm.ia).apply(null,arguments)},Iu=t._NonMaxSuppressionV3=function(){return(Iu=t._NonMaxSuppressionV3=t.asm.ja).apply(null,arguments)},Cf=t._NonMaxSuppressionV4=function(){return(Cf=t._NonMaxSuppressionV4=t.asm.ka).apply(null,arguments)},Nf=t._NonMaxSuppressionV5=function(){return(Nf=t._NonMaxSuppressionV5=t.asm.la).apply(null,arguments)},Ef=t._NotEqual=function(){return(Ef=t._NotEqual=t.asm.ma).apply(null,arguments)},Qg=t._OneHot=function(){return(Qg=t._OneHot=t.asm.na).apply(null,arguments)},ev=t._PadV2=function(){return(ev=t._PadV2=t.asm.oa).apply(null,arguments)},Tf=t._Pow=function(){return(Tf=t._Pow=t.asm.pa).apply(null,arguments)},tv=t._Prelu=function(){return(tv=t._Prelu=t.asm.qa).apply(null,arguments)},rv=t._Prod=function(){return(rv=t._Prod=t.asm.ra).apply(null,arguments)},nv=t._RealDiv=function(){return(nv=t._RealDiv=t.asm.sa).apply(null,arguments)},ov=t._Relu=function(){return(ov=t._Relu=t.asm.ta).apply(null,arguments)},av=t._Relu6=function(){return(av=t._Relu6=t.asm.ua).apply(null,arguments)},Af=t._ResizeBilinear=function(){return(Af=t._ResizeBilinear=t.asm.va).apply(null,arguments)},la=t._Reverse=function(){return(la=t._Reverse=t.asm.wa).apply(null,arguments)},sv=t._RotateWithOffset=function(){return(sv=t._RotateWithOffset=t.asm.xa).apply(null,arguments)},iv=t._Round=function(){return(iv=t._Round=t.asm.ya).apply(null,arguments)},gk=t._Rsqrt=function(){return(gk=t._Rsqrt=t.asm.za).apply(null,arguments)},Ff=t._ScatterNd=function(){return(Ff=t._ScatterNd=t.asm.Aa).apply(null,arguments)},uv=t._SelectV2=function(){return(uv=t._SelectV2=t.asm.Ba).apply(null,arguments)},lv=t._Sigmoid=function(){return(lv=t._Sigmoid=t.asm.Ca).apply(null,arguments)},cv=t._Sin=function(){return(cv=t._Sin=t.asm.Da).apply(null,arguments)},pv=t._Softmax=function(){return(pv=t._Softmax=t.asm.Ea).apply(null,arguments)},fv=t._Sqrt=function(){return(fv=t._Sqrt=t.asm.Fa).apply(null,arguments)},dv=t._Square=function(){return(dv=t._Square=t.asm.Ga).apply(null,arguments)},mv=t._SquaredDifference=function(){return(mv=t._SquaredDifference=t.asm.Ha).apply(null,arguments)},hv=t._Step=function(){return(hv=t._Step=t.asm.Ia).apply(null,arguments)},gv=t._StridedSlice=function(){return(gv=t._StridedSlice=t.asm.Ja).apply(null,arguments)},vv=t._Sub=function(){return(vv=t._Sub=t.asm.Ka).apply(null,arguments)},xv=t._Sum=function(){return(xv=t._Sum=t.asm.La).apply(null,arguments)},yv=t._Tan=function(){return(yv=t._Tan=t.asm.Ma).apply(null,arguments)},bv=t._Tanh=function(){return(bv=t._Tanh=t.asm.Na).apply(null,arguments)},wv=t._Tile=function(){return(wv=t._Tile=t.asm.Oa).apply(null,arguments)},kv=t._TopK=function(){return(kv=t._TopK=t.asm.Pa).apply(null,arguments)},_v=t._Transform=function(){return(_v=t._Transform=t.asm.Qa).apply(null,arguments)},Sv=t._Transpose=function(){return(Sv=t._Transpose=t.asm.Ra).apply(null,arguments)},Iv=t.__FusedMatMul=function(){return(Iv=t.__FusedMatMul=t.asm.Sa).apply(null,arguments)},Cv=t._malloc=function(){return(Cv=t._malloc=t.asm.Ta).apply(null,arguments)},Nv=t._free=function(){return(Nv=t._free=t.asm.Ua).apply(null,arguments)},Df=t.___errno_location=function(){return(Df=t.___errno_location=t.asm.Va).apply(null,arguments)},Rf=t.stackSave=function(){return(Rf=t.stackSave=t.asm.Wa).apply(null,arguments)},$f=t.stackRestore=function(){return($f=t.stackRestore=t.asm.Xa).apply(null,arguments)},gc=t.stackAlloc=function(){return(gc=t.stackAlloc=t.asm.Ya).apply(null,arguments)};t.cwrap=W;var Cu;function Ev(re){this.name="ExitStatus",this.message="Program terminated with exit("+re+")",this.status=re}Dt=function re(){Cu||vc(),Cu||(Dt=re)};function vc(re){if(re=re||s,Ft>0||(St(),Ft>0))return;function ae(){Cu||(Cu=!0,t.calledRun=!0,!O&&(Qt(),Xr(),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),Xt()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),ae()},1)):ae()}if(t.run=vc,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return vc(),e.ready}}();typeof Eh=="object"&&typeof X0=="object"?X0.exports=K0:typeof define=="function"&&define.amd?define([],function(){return K0}):typeof Eh=="object"&&(Eh.WasmBackendModule=K0)});var hV=kc(KE());var Mae=1e-7,Bae=1e-4,Da=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},so=class{refCount(e){return An("refCount")}incRef(e){return An("incRef")}timerAvailable(){return!0}time(e){return An("time")}read(e){return An("read")}readSync(e){return An("readSync")}numDataIds(){return An("numDataIds")}disposeData(e,t){return An("disposeData")}write(e,t,n){return An("write")}move(e,t,n,o,a){return An("move")}memory(){return An("memory")}floatPrecision(){return An("floatPrecision")}epsilon(){return this.floatPrecision()===32?Mae:Bae}dispose(){return An("dispose")}};function An(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function XE(r){let e=r.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,nm(r,e,t)}function Lae(r,e){if(r.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${r.length}Second array length was ${e.length}`);let t=r.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,nm(r,t,n),nm(e,t,n)}function il(r,e,t){return Math.max(r,Math.min(e,t))}function Vae(r){return r%2==0?r:r+1}function nm(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}function Wae(r){let e=0;for(let t=0;t<r.length;t++)e+=r[t];return e}function zae(r,e){let t=Math.random();return e*t+(1-t)*r}function Uae(r,e){let t=0;for(let n=0;n<r.length;n++){let o=Number(r[n])-Number(e[n]);t+=o*o}return t}function Pe(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function mb(r,e,t=""){Pe(ul(r,e),()=>t+` Shapes ${r} and ${e} must match`)}function Gae(r){Pe(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ra(r,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(r)||sn(r)&&!t)for(let n=0;n<r.length;++n)Ra(r[n],e,t);else e.push(r);return e}function xr(r){if(r.length===0)return 1;let e=r[0];for(let t=1;t<r.length;t++)e*=r[t];return e}function jae(r){return r.length===0}function ul(r,e){if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function YE(r){return r%1==0}function Hae(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;{let e=Math.exp(2*r);return(e-1)/(e+1)}}function qae(r){let e=Math.ceil(Math.sqrt(r));return[e,Math.ceil(r/e)]}function Kae(r){let e=new Uint32Array(r);for(let t=0;t<r;++t)e[t]=t;return XE(e),e}function $s(r,e){return e<=r.length?r:r+" ".repeat(e-r.length)}function Xae(r,e=n=>0,t){return new Promise((n,o)=>{let a=0,i=()=>{if(r()){n();return}a++;let s=e(a);if(t!=null&&a>=t){o();return}setTimeout(i,s)};i()})}function Yae(r,e){let t=1,n=-1;for(let a=0;a<r.length;++a)if(r[a]>=0)t*=r[a];else if(r[a]===-1){if(n!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${n} and dim ${a}`);n=a}else if(r[a]<0)throw Error(`Shapes can not be < 0. Found ${r[a]} at dim ${a}`);if(n===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${r}`);return r}if(t===0)throw Error(`Cannot infer the missing size in [${r}] when there are 0 elements`);if(e%t!=0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);let o=r.slice();return o[n]=e/t,o}function ZE(r,e){let t=e.length;return r=r==null?e.map((n,o)=>o):[].concat(r),Pe(r.every(n=>n>=-t&&n<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${r}`),Pe(r.every(n=>YE(n)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(n=>n<0?t+n:n)}function Zae(r,e){let t=[],n=[],o=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||o?null:ZE(e,r).sort(),i=0;for(let s=0;s<r.length;++s){if(a!=null){if(a[i]===s&&r[s]!==1)throw new Error(`Can't squeeze axis ${s} since its dim '${r[s]}' is not 1`);(a[i]==null||a[i]>s)&&r[s]===1&&(t.push(r[s]),n.push(s)),a[i]<=s&&i++}r[s]!==1&&(t.push(r[s]),n.push(s))}return{newShape:t,keptDims:n}}function Jae(r,e){let t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${r}`);return t}function hb(r,e){let t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else if(r==="string")t=new Array(e);else throw new Error(`Unknown data type ${r}`);return t}function gb(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(isNaN(n)||!isFinite(n))throw Error(`A tensor of type ${e} being uploaded contains ${n}.`)}}function vb(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function Qae(r,e){return!(e==="complex64"||e==="float32"&&r!=="complex64"||e==="int32"&&r!=="float32"&&r!=="complex64"||e==="bool"&&r==="bool")}function sn(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray}function om(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function xb(r){if(r==null)return 0;let e=0;return r.forEach(t=>e+=t.length),e}function ll(r){return typeof r=="string"||r instanceof String}function JE(r){return typeof r=="boolean"}function QE(r){return typeof r=="number"}function cl(r){return Array.isArray(r)?cl(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray?"int32":QE(r)?"float32":ll(r)?"string":JE(r)?"bool":"float32"}function am(r){return!!(r&&r.constructor&&r.call&&r.apply)}function pl(r,e){for(let t=e;t<r;++t)if(r%t==0)return t;return r}function io(r){let e=r.length;if(e<2)return[];let t=new Array(e-1);t[e-2]=r[e-1];for(let n=e-3;n>=0;--n)t[n]=t[n+1]*r[n+1];return t}function eT(r,e,t,n=!1){let o=new Array;if(e.length===1){let a=e[0]*(n?2:1);for(let i=0;i<a;i++)o[i]=t[r+i]}else{let a=e[0],i=e.slice(1),s=i.reduce((u,l)=>u*l)*(n?2:1);for(let u=0;u<a;u++)o[u]=eT(r+u*s,i,t,n)}return o}function Ps(r,e,t=!1){if(r.length===0)return e[0];let n=r.reduce((o,a)=>o*a)*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error(`[${r}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return eT(0,r,e,t)}function yb(r,e){let t=fl(r,e);for(let n=0;n<t.length;n++)t[n]=1;return t}function fl(r,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${e}`)}function ese(r,e){let t=r.reduce((n,o)=>n*o,1);if(e==null||e==="float32")return Ps(r,new Float32Array(t));if(e==="int32")return Ps(r,new Int32Array(t));if(e==="bool")return Ps(r,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function dp(r){r.forEach(e=>{Pe(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function tse(r,e,t){if(e===0)return 0;if(e===1)return r[0];let n=r[r.length-1];for(let o=0;o<r.length-1;++o)n+=t[o]*r[o];return n}function rse(r,e,t){if(e===0)return[];if(e===1)return[r];let n=new Array(e);for(let o=0;o<n.length-1;++o)n[o]=Math.floor(r/t[o]),r-=n[o]*t[o];return n[n.length-1]=r,n}function mp(r){return r&&r.then&&typeof r.then=="function"}function Fn(...r){X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(...r)}function nse(...r){X().getBool("IS_TEST")||X().getBool("PROD")||console.log(...r)}var tT="tfjsflags",sm=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ose,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&Fn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){let o=this.urlFlags[e];Fn(`Setting feature override from URL ${e}: ${o}.`),this.set(e,o)}}getAsync(e){return Be(this,null,function*(){return e in this.flags?this.flags[e]:(this.flags[e]=yield this.evaluateFlag(e),this.flags[e])})}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(mp(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")return;let e=this.getQueryParams(this.global.location.search);tT in e&&e[tT].split(",").forEach(n=>{let[o,a]=n.split(":");this.urlFlags[o]=sse(o,a)})}};function ose(r){let e={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(ase(e,n[0],n[1]),n.join("="))),e}function ase(r,e,t){r[decodeURIComponent(e)]=decodeURIComponent(t||"")}function sse(r,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${r}.`)}function X(){return bb}var bb=null;function rT(r){bb=r}var wb;function kb(){if(wb==null){let r;if(typeof window!="undefined")r=window;else if(typeof global!="undefined")r=global;else if(typeof process!="undefined")r=process;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");wb=r}return wb}function ise(){let r=kb();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function hp(r,e){let t=ise();if(t.has(r))return t.get(r);{let n=e();return t.set(r,n),t.get(r)}}var dl="Abs",gp="Acos",vp="Acosh",Lo="Add",Os="AddN",Ms="All",Bs="Any",Ls="ArgMax",im="ArgMin",xp="Asin",yp="Asinh",bp="Atan",wp="Atanh",kp="Atan2",Vs="AvgPool",um="AvgPoolGrad",lm="AvgPool3D",cm="AvgPool3DGrad",Ws="BatchMatMul",ml="BatchToSpaceND",pm="Bincount";var fm="BroadcastArgs",uo="Cast",zs="Ceil",$a="ClipByValue",hl="Complex",dm="ComplexAbs",gl="Concat",Us="Conv2D",mm="Conv2DBackpropFilter",Gs="Conv2DBackpropInput",hm="Conv3D",gm="Conv3DBackpropFilterV2",vm="Conv3DBackpropInputV2",js="Cos",Hs="Cosh",qs="Cumsum",Ks="CropAndResize",xm="DenseBincount",Xs="DepthToSpace",Ys="DepthwiseConv2dNative",ym="DepthwiseConv2dNativeBackpropFilter",bm="DepthwiseConv2dNativeBackpropInput",wm="Diag",km="Dilation2D",_b="Dilation2DBackpropInput",Sb="Dilation2DBackpropFilter",Zs="RealDiv",_m="Einsum",Vo="Elu",Sm="EluGrad",_p="Erf",Js="Equal",Qs="Exp",vl="ExpandDims",Sp="Expm1",Im="FFT",xl="Fill",ei="FlipLeftRight",ti="Floor",ri="FloorDiv",ni="FusedBatchNorm",yl="GatherV2",oi="GatherNd",ai="Greater",si="GreaterEqual",lo="Identity",Cm="IFFT",Nm="Imag",Ip="IsFinite",Cp="IsInf",Np="IsNan",Wo="LeakyRelu",ii="Less",ui="LessEqual",Em="LinSpace",li="Log",Ep="Log1p",ci="LogicalAnd",Tp="LogicalNot",Ap="LogicalOr";var Tm="LRN",Am="LRNGrad",pi="Max",fi="Maximum",di="MaxPool",Fm="MaxPoolGrad",Dm="MaxPool3D",Rm="MaxPool3DGrad",$m="MaxPoolWithArgmax",mi="Mean",hi="Min",gi="Minimum",vi="MirrorPad",Fp="Mod",Pm="Multinomial",zo="Multiply",bl="Neg",xi="NotEqual",yi="NonMaxSuppressionV3",bi="NonMaxSuppressionV4",wi="NonMaxSuppressionV5",wl="OnesLike",ki="OneHot",kl="Pack",_i="PadV2";var Si="Pow",Uo="Prelu",Ii="Prod",_l="Range",Om="Real",Dp="Reciprocal",Go="Relu",Pa="Reshape",Mm="ResizeNearestNeighbor",Bm="ResizeNearestNeighborGrad",Ci="ResizeBilinear",Lm="ResizeBilinearGrad",jo="Relu6",Ni="Reverse",Ei="Round",Ti="Rsqrt",Ai="ScatterNd",Sl="Select",Rp="Selu",Il="Slice",Fi="Sin",$p="Sinh",Pp="Sign",Ho="Sigmoid",Op="Softplus",Di="Sqrt",qo="Sum",Cl="SpaceToBatchND",Nl="SplitV",Ri="Softmax",Vm="SparseFillEmptyRows",Wm="SparseReshape",zm="SparseSegmentMean",Um="SparseSegmentSum",Gm="SparseToDense",$i="SquaredDifference",El="Square",Pi="StridedSlice",jm="StringNGrams",Hm="StringSplit",qm="StringToHashBucketFast",Oi="Sub",Mi="Tan",Bi="Tanh",Li="Tile",Vi="TopK",Wi="Transform",zi="Transpose",Km="Unique",Tl="Unpack",Xm="UnsortedSegmentSum",Al="ZerosLike",co="Step",nT="FromPixels",Ui="RotateWithOffset",Gi="_FusedMatMul",ji="FusedConv2D",Hi="FusedDepthwiseConv2D";var Ym=hp("kernelRegistry",()=>new Map),use=hp("gradRegistry",()=>new Map);function Ib(r,e){let t=oT(r,e);return Ym.get(t)}function Cb(r){return use.get(r)}function Nb(r){let e=Ym.entries(),t=[];for(;;){let{done:n,value:o}=e.next();if(n)break;let[a,i]=o,[s]=a.split("_");s===r&&t.push(i)}return t}function Fl(r){let{kernelName:e,backendName:t}=r,n=oT(e,t);Ym.has(n)&&Fn(`The kernel '${e}' for backend '${t}' is already registered`),Ym.set(n,r)}function oT(r,e){return`${e}_${r}`}var w={};Io(w,{arraysEqual:()=>ul,assert:()=>Pe,assertNonNegativeIntegerDimensions:()=>dp,assertNonNull:()=>Gae,assertShapesMatch:()=>mb,bytesFromStringArray:()=>xb,bytesPerElement:()=>om,checkConversionForErrors:()=>gb,clamp:()=>il,computeStrides:()=>io,createScalarValue:()=>hse,createShuffledIndices:()=>Kae,decodeString:()=>Ol,distSquared:()=>Uae,encodeString:()=>Pl,fetch:()=>vse,fingerPrint64:()=>mse,flatten:()=>Ra,getArrayFromDType:()=>hb,getTypedArrayFromDType:()=>Jae,hasEncodingLoss:()=>Qae,hexToLong:()=>Mp,indexToLoc:()=>rse,inferDtype:()=>cl,inferFromImplicitShape:()=>Yae,isBoolean:()=>JE,isFunction:()=>am,isInt:()=>YE,isNumber:()=>QE,isPromise:()=>mp,isScalarShape:()=>jae,isString:()=>ll,isTypedArray:()=>sn,isValidDtype:()=>vb,locToIndex:()=>tse,makeOnesTypedArray:()=>yb,makeZerosNestedTypedArray:()=>ese,makeZerosTypedArray:()=>fl,nearestDivisor:()=>pl,nearestLargerEven:()=>Vae,now:()=>Zi,parseAxisParam:()=>ZE,randUniform:()=>zae,repeatedTry:()=>Xae,rightPad:()=>$s,shuffle:()=>XE,shuffleCombo:()=>Lae,sizeFromShape:()=>xr,sizeToSquarishShape:()=>qae,squeezeShape:()=>Zae,sum:()=>Wae,swap:()=>nm,tanh:()=>Hae,toNestedArray:()=>Ps,toTypedArray:()=>$l});var gT=kc(hT());var Xi=gT.default||gT;function Mp(r){return Xi.fromString(r,!0,16)}var vT=Mp("c3a5c85c97cb3127"),Yi=Mp("b492b66fbe98f273"),Mr=Mp("9ae16a3b2f90404f");function Ab(r){return r.xor(r.shru(47))}function xT(r,e,t){let n=r.slice(e,e+t);return Xi.fromBytes(Array.from(n),!0,!0)}function Et(r,e){return xT(r,e,8)}function yT(r,e){return xT(r,e,4)}function yr(r,e){return e===0?r:r.shru(e).or(r.shl(64-e))}function Oa(r,e,t=Mp("9ddfea08eb382d69")){let n=r.xor(e).mul(t);n=n.xor(n.shru(47));let o=e.xor(n).mul(t);return o=o.xor(o.shru(47)),o=o.mul(t),o}function cse(r,e,t,n,o,a){o=o.add(r),a=yr(a.add(o).add(n),21);let i=o;return o=o.add(e),o=o.add(t),a=a.add(yr(o,44)),[o.add(n),a.add(i)]}function Jm(r,e,t,n){return cse(Et(r,e),Et(r,e+8),Et(r,e+16),Et(r,e+24),t,n)}function pse(r,e=r.length){if(e>=8){let t=Mr.add(e*2),n=Et(r,0).add(Mr),o=Et(r,e-8),a=yr(o,37).mul(t).add(n),i=yr(n,25).add(o).mul(t);return Oa(a,i,t)}if(e>=4){let t=Mr.add(e*2),n=yT(r,0);return Oa(n.shl(3).add(e),yT(r,e-4),t)}if(e>0){let t=r[0],n=r[e>>1],o=r[e-1],a=t+(n<<8),i=e+(o<<2);return Ab(Mr.mul(a).xor(vT.mul(i))).mul(Mr)}return Mr}function fse(r,e=r.length){let t=Mr.add(e*2),n=Et(r,0).mul(Yi),o=Et(r,8),a=Et(r,e-8).mul(t),i=Et(r,e-16).mul(Mr);return Oa(yr(n.add(o),43).add(yr(a,30)).add(i),n.add(yr(o.add(Mr),18)).add(a),t)}function dse(r,e=r.length){let t=Mr.add(e*2),n=Et(r,0).mul(Mr),o=Et(r,8),a=Et(r,e-8).mul(t),i=Et(r,e-16).mul(Mr),s=yr(n.add(o),43).add(yr(a,30)).add(i),u=Oa(s,n.add(yr(o.add(Mr),18)).add(a),t),l=Et(r,16).mul(t),c=Et(r,24),p=s.add(Et(r,e-32)).mul(t),f=u.add(Et(r,e-24)).mul(t);return Oa(yr(l.add(c),43).add(yr(p,30)).add(f),l.add(yr(c.add(n),18)).add(p),t)}function mse(r,e=r.length){let t=Xi.fromNumber(81,!0);if(e<=32)return e<=16?pse(r,e):fse(r,e);if(e<=64)return dse(r,e);let n=t,o=t.mul(Yi).add(113),a=Ab(o.mul(Mr).add(113)).mul(Mr),i=[Xi.UZERO,Xi.UZERO],s=[Xi.UZERO,Xi.UZERO];n=n.mul(Mr).add(Et(r,0));let u=0,l=(e-1>>6)*64,c=l+(e-1&63)-63;do n=yr(n.add(o).add(i[0]).add(Et(r,u+8)),37).mul(Yi),o=yr(o.add(i[1]).add(Et(r,u+48)),42).mul(Yi),n=n.xor(s[1]),o=o.add(i[0]).add(Et(r,u+40)),a=yr(a.add(s[0]),33).mul(Yi),i=Jm(r,u,i[1].mul(Yi),n.add(s[0])),s=Jm(r,u+32,a.add(s[1]),o.add(Et(r,u+16))),[a,n]=[n,a],u+=64;while(u!==l);let p=Yi.add(a.and(255).shl(1));return u=c,s[0]=s[0].add(e-1&63),i[0]=i[0].add(s[0]),s[0]=s[0].add(i[0]),n=yr(n.add(o).add(i[0]).add(Et(r,u+8)),37).mul(p),o=yr(o.add(i[1]).add(Et(r,u+48)),42).mul(p),n=n.xor(s[1].mul(9)),o=o.add(i[0].mul(9).add(Et(r,u+40))),a=yr(a.add(s[0]),33).mul(p),i=Jm(r,u,i[1].mul(p),n.add(s[0])),s=Jm(r,u+32,a.add(s[1]),o.add(Et(r,u+16))),[a,n]=[n,a],Oa(Oa(i[0],s[0],p).add(Ab(o).mul(vT)).add(a),Oa(i[1],s[1],p).add(n),p)}function hse(r,e){return e==="string"?Pl(r):$l([r],e)}function gse(r,e){return r instanceof Float32Array&&e==="float32"||r instanceof Int32Array&&e==="int32"||r instanceof Uint8Array&&e==="bool"}function $l(r,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Ra(r)),X().getBool("DEBUG")&&gb(r,e),gse(r,e))return r;if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool"){let t=new Uint8Array(r.length);for(let n=0;n<t.length;++n)Math.round(r[n])!==0&&(t[n]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Zi(){return X().platform.now()}function vse(r,e){return X().platform.fetch(r,e)}function Pl(r,e="utf-8"){return e=e||"utf-8",X().platform.encode(r,e)}function Ol(r,e="utf-8"){return e=e||"utf-8",X().platform.decode(r,e)}var Fb=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new bT)}profileKernel(e,t,n){let o,a=()=>{o=n()},i,s=Zi();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(let l of o)l.dataSync();i=Promise.resolve({kernelMs:Zi()-s})}if(X().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<o.length;l++){let c=o[l];c.data().then(p=>{xse(p,c.dtype,e)})}return{kernelName:e,outputs:o,inputs:t,timeMs:i.then(l=>l.kernelMs),extraInfo:i.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:o,inputs:a,extraInfo:i}=e;n.forEach(s=>{Promise.all([s.data(),o,i]).then(u=>{this.logger.logKernelProfile(t,s,u[0],u[1],a,u[2])})})}};function xse(r,e,t){if(e!=="float32")return!1;for(let n=0;n<r.length;n++){let o=r[n];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${t}'`),!0}return!1}var bT=class{logKernelProfile(e,t,n,o,a,i){let s=typeof o=="number"?$s(`${o}ms`,9):o.error,u=$s(e,25),l=t.rank,c=t.size,p=$s(t.shape.toString(),14),f="";for(let d in a){let m=a[d];if(m!=null){let h=m.shape||t.shape,g=h.length;f+=`${d}: ${g}D ${g>0?h:""} `}}console.log(`%c${u}	%c${s}	%c${l}D ${p}	%c${c}	%c${f}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function wT(r,e,t){let n={},o={};for(let u=0;u<e.length;u++)n[e[u].id]=!0;for(let u=0;u<r.length;u++){let l=r[u],c=l.inputs;for(let p in c){let f=c[p],d=!1;for(let m=0;m<e.length;m++)if(n[f.id]){l.outputs.forEach(h=>n[h.id]=!0),d=!0,o[l.id]=!0;break}if(d)break}}let a={};a[t.id]=!0;let i={};for(let u=r.length-1;u>=0;u--){let l=r[u],c=l.inputs;for(let p=0;p<l.outputs.length;p++)if(a[l.outputs[p].id]){for(let f in c)a[c[f].id]=!0,i[l.id]=!0;break}}let s=[];for(let u=0;u<r.length;u++){let l=r[u];if(o[l.id]&&i[l.id]){let c={};for(let f in l.inputs){let d=l.inputs[f];n[d.id]&&(c[f]=d)}let p=Object.assign({},l);p.inputs=c,p.outputs=l.outputs,s.push(p)}}return s}function kT(r,e,t,n){for(let o=e.length-1;o>=0;o--){let a=e[o],i=[];if(a.outputs.forEach(u=>{let l=r[u.id];l!=null?i.push(l):i.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);let s=a.gradient(i);for(let u in a.inputs){if(!(u in s))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(s)}.`);let l=t(()=>s[u]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${l.dtype}'`);let c=a.inputs[u];if(!ul(l.shape,c.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${u}' has shape '${l.shape}', which does not match the shape of the input '${c.shape}'`);if(r[c.id]==null)r[c.id]=l;else{let p=r[c.id];r[c.id]=n(p,l),p.dispose()}}}}var _T=20,Bp=3,Db=7;function ST(r,e,t,n){let o=io(e),a=yse(r,e,t,o),i=e.length,s=Qm(r,e,t,o,a),u=["Tensor"];return n&&(u.push(`  dtype: ${t}`),u.push(`  rank: ${i}`),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(s.map(l=>"    "+l).join(`
`)),u.join(`
`)}function yse(r,e,t,n){let o=xr(e),a=n[n.length-1],i=new Array(a).fill(0),s=e.length,u=t==="complex64"?Vp(r):r;if(s>1)for(let l=0;l<o/a;l++){let c=l*a;for(let p=0;p<a;p++)i[p]=Math.max(i[p],Lp(u[c+p],0,t).length)}return i}function Lp(r,e,t){let n;return Array.isArray(r)?n=`${parseFloat(r[0].toFixed(Db))} + ${parseFloat(r[1].toFixed(Db))}j`:ll(r)?n=`'${r}'`:t==="bool"?n=IT(r):n=parseFloat(r.toFixed(Db)).toString(),$s(n,e)}function IT(r){return r===0?"false":"true"}function Qm(r,e,t,n,o,a=!0){let i=t==="complex64"?2:1,s=e[0],u=e.length;if(u===0){if(t==="complex64"){let h=Vp(r);return[Lp(h[0],0,t)]}return t==="bool"?[IT(r[0])]:[r[0].toString()]}if(u===1){if(s>_T){let g=Bp*i,v=Array.from(r.slice(0,g)),x=Array.from(r.slice((s-Bp)*i,s*i));return t==="complex64"&&(v=Vp(v),x=Vp(x)),["["+v.map((y,b)=>Lp(y,o[b],t)).join(", ")+", ..., "+x.map((y,b)=>Lp(y,o[s-Bp+b],t)).join(", ")+"]"]}let h=t==="complex64"?Vp(r):Array.from(r);return["["+h.map((g,v)=>Lp(g,o[v],t)).join(", ")+"]"]}let l=e.slice(1),c=n.slice(1),p=n[0]*i,f=[];if(s>_T){for(let h=0;h<Bp;h++){let g=h*p,v=g+p;f.push(...Qm(r.slice(g,v),l,t,c,o,!1))}f.push("...");for(let h=s-Bp;h<s;h++){let g=h*p,v=g+p;f.push(...Qm(r.slice(g,v),l,t,c,o,h===s-1))}}else for(let h=0;h<s;h++){let g=h*p,v=g+p;f.push(...Qm(r.slice(g,v),l,t,c,o,h===s-1))}let d=u===2?",":"";f[0]="["+f[0]+d;for(let h=1;h<f.length-1;h++)f[h]=" "+f[h]+d;let m=`,
`;for(let h=2;h<u;h++)m+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(a?"":m),f}function Vp(r){let e=[];for(let t=0;t<r.length;t+=2)e.push([r[t],r[t+1]]);return e}var mt=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=xr(e),n!=null){let o=n.length;Pe(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||hb(t,this.size),this.strides=io(e)}set(e,...t){t.length===0&&(t=[0]),Pe(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let o of e){if(o<0||o>=this.shape[t]){let a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let n=e[e.length-1];for(let o=0;o<e.length-1;++o)n+=this.strides[o]*e[o];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return po().makeTensor(this.values,this.shape,this.dtype)}},po=null,Ml=null,bse=null;function CT(r){po=r}function NT(r){Ml=r}function ET(r){bse=r}var Dr=class{constructor(e,t,n,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=xr(e),this.strides=io(e),this.dataId=n,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return Be(this,null,function*(){let e=yield this.data();return Ml.buffer(this.shape,this.dtype,e)})}bufferSync(){return Ml.buffer(this.shape,this.dtype,this.dataSync())}array(){return Be(this,null,function*(){let e=yield this.data();return Ps(this.shape,e,this.dtype==="complex64")})}arraySync(){return Ps(this.shape,this.dataSync(),this.dtype==="complex64")}data(){return Be(this,null,function*(){this.throwIfDisposed();let e=po().read(this.dataId);if(this.dtype==="string"){let t=yield e;try{return t.map(n=>Ol(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e})}dataSync(){this.throwIfDisposed();let e=po().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Ol(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}bytes(){return Be(this,null,function*(){this.throwIfDisposed();let e=yield po().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)})}dispose(){this.isDisposed||(po().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Ml.print(this,e)}clone(){return this.throwIfDisposed(),Ml.clone(this)}toString(e=!1){let t=this.dataSync();return ST(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Ml.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),po().makeVariable(this,e,t,n)}};Object.defineProperty(Dr,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});function wse(){return hp("Tensor",()=>Dr)}wse();var Bl=class extends Dr{constructor(e,t,n,o){super(e.shape,e.dtype,e.dataId,o);this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ul(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);po().disposeTensor(this),this.dataId=e.dataId,po().incRef(this,null)}dispose(){po().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Bl,Symbol.hasInstance,{value:r=>r instanceof Dr&&r.assign!=null&&r.assign instanceof Function});var Rb;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(Rb||(Rb={}));var $b;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})($b||($b={}));var Pb;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(Pb||(Pb={}));var Ob;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(Ob||(Ob={}));var Mb;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(Mb||(Mb={}));var kse={float32:Ob,int32:$b,bool:Pb,complex64:Mb};function ur(r,e){if(r==="string"||e==="string"){if(r==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${r} with ${e}`)}return kse[r][e]}function Ji(r){return ur(r,"int32")}function TT(r,e){if(r.dtype===e.dtype)return[r,e];let t=ur(r.dtype,e.dtype);return[r.cast(t),e.cast(t)]}function AT(r){let e=[],t=new Set;return FT(r,e,t),e}function FT(r,e,t){if(r==null)return;if(r instanceof Dr){e.push(r);return}if(!_se(r))return;let n=r;for(let o in n){let a=n[o];t.has(a)||(t.add(a),FT(a,e,t))}}function _se(r){return Array.isArray(r)||typeof r=="object"}function Bb(r){return r.kernelName!=null}var Lb=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},Qi=class{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Lb}ready(){return Be(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(yield this.initializeBackend(n).success){yield this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(Fn(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}setBackend(e){return Be(this,null,function*(){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?yield t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Fb(this.backendInstance),!0})}setupRegisteredKernels(){Nb(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Nb(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{let n=t.factory();if(n&&!(n instanceof so)&&typeof n.then=="function"){let o=++this.pendingBackendInitId,a=n.then(i=>o<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(o<this.pendingBackendInitId||(this.pendingBackendInit=null,Fn(`Initialization of backend ${e} failed`),Fn(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return Fn(`Initialization of backend ${e} failed`),Fn(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:o,asyncInit:a}=this.initializeBackend(n);if(a||o)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),o=n.backend,a=this.readSync(t),i=o.refCount(t);o.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let o;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(o),()=>(o=t(),o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o))}scopedRun(e,t,n){e();try{let o=n();return t(),o}catch(o){throw t(),o}}nextTensorId(){return Qi.nextTensorId++}nextVariableId(){return Qi.nextVariableId++}clone(e){let t=je.runKernel(lo,{x:e}),n={x:e},o=i=>({x:()=>{let s="float32",u={x:i},l={dtype:s};return je.runKernel(uo,u,l)}}),a=[];return this.addTapeNode(this.state.activeScope.name,n,[t],o,a,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,!(Ib(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let o=this.backend.numDataIds(),a=0;n.forEach(u=>{a+=u.dtype==="complex64"?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-t-a-i;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[],o=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let s;this.backendName==null&&this.backend;let u,l=Bb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Bb(e)){let{kernelName:m,inputs:h,attrs:g}=e;this.backendName==null&&this.backend;let v=Ib(m,this.backendName);Pe(v!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),s=()=>{let x=this.backend.numDataIds();u=v.kernelFunc({inputs:h,attrs:g,backend:this.backend});let y=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,x,y);let b=y.map(k=>{if(k.rank!=null)return k;let{dataId:N,shape:E,dtype:T}=k;return this.makeTensorFromDataId(N,E,T)});if(o){let k=this.getTensorsForGradient(m,h,b);n=this.saveTensorsForBackwardMode(k)}return b}}else{let{forwardFunc:m}=e,h=g=>{!o||(n=g.map(v=>this.keep(this.clone(v))))};s=()=>{let g=this.backend.numDataIds();u=this.tidy(()=>m(this.backend,h));let v=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,g,v),v}}let{inputs:c,attrs:p}=e,f=Bb(e)?null:e.backwardsFunc,d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=s():(d=this.profiler.profileKernel(l,c,()=>s()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),t=d.outputs)}),o&&this.addTapeNode(l,c,t,f,n,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(m=>c[m]!=null?c[m].shape:null),outputShapes:t.map(m=>m.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(u)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,t,n){let o=Cb(e);if(o!=null){let a=o.inputsToSave||[],i=o.outputsToSave||[],s;o.saveAllInputs?(Pe(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(t).map(l=>t[l])):s=a.map(l=>t[l]);let u=n.filter((l,c)=>i[c]);return s.concat(u)}return[]}makeTensor(e,t,n,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",o=o||this.backend;let a=e;n==="string"&&ll(e[0])&&(a=e.map(u=>Pl(u)));let i=o.write(a,t,n),s=new Dr(t,n,i,this.nextTensorId());if(this.trackTensor(s,o),n==="string"){let u=this.state.tensorInfo.get(i),l=xb(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s}makeTensorFromDataId(e,t,n,o){n=n||"float32";let a=new Dr(t,n,e,this.nextTensorId());return this.trackTensor(a,o),a}makeVariable(e,t=!0,n,o){n=n||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));let a=new Bl(e,t,n,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*om(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Bl||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){let n=e.size*om(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){return Be(this,null,function*(){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let o of this.state.activeProfile.kernels)o.kernelTimeMs=yield o.kernelTimeMs,o.extraInfo=yield o.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,o,a,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=Cb(e);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=l=>(l=l.map((c,p)=>{if(c==null){let f=n[p],d=fl(f.size,f.dtype);return this.makeTensor(d,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],a,i))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=AT(e),n=new Set(t.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){let i=this.state.activeScope.track[a];!i.kept&&!n.has(i.id)&&i.dispose()}let o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(a=>{!a.kept&&a.scopeId===o.id&&this.track(a)})}gradients(e,t,n,o=!1){if(Pe(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Pe(a instanceof Dr,()=>"The result y returned by f() must be a tensor.");let i=wT(this.state.activeTape,t,a);if(!o&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let s={};s[a.id]=n==null?Sse(a.shape):n,kT(s,i,l=>this.tidy(l),Ise);let u=t.map(l=>s[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(let c of l.saved)c.dispose()}),this.state.activeTape=null),{value:a,grads:u}})}customGrad(e){return Pe(am(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{Pe(t.every(s=>s instanceof Dr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n,o={};t.forEach((s,u)=>{o[u]=s});let a=(s,u)=>(n=e(...t,u),Pe(n.value instanceof Dr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Pe(am(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(s,u)=>{let l=n.gradFunc(s,u),c=Array.isArray(l)?l:[l];Pe(c.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Pe(c.every(f=>f instanceof Dr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let p={};return c.forEach((f,d)=>{p[d]=()=>f}),p};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}time(e){return Be(this,null,function*(){let t=Zi(),n=yield this.backend.time(e);return n.wallMs=Zi()-t,n})}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Lb;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};Qi.nextTensorId=0;Qi.nextVariableId=0;function Sse(r){let e=yb(xr(r),"float32");return je.makeTensor(e,r,"float32")}function Vb(){let r=kb();if(r._tfengine==null){let e=new sm(r);r._tfengine=new Qi(e)}return rT(r._tfengine.ENV),CT(()=>r._tfengine),r._tfengine}var je=Vb();function Ise(r,e){let t={a:r,b:e};return je.runKernel(Lo,t)}var eu={};Io(eu,{isBrowser:()=>zb,isMobile:()=>Ese,mockIsMobile:()=>Nse});function Cse(){return typeof navigator!="undefined"&&navigator!=null}var Wb;function Nse(r){Wb=r}function Ese(r){if(Wb!==void 0)return Wb;if(r||Cse()){if(r||(r=navigator),r.product==="ReactNative")return!0;let e=r.userAgent||r.vendor||(typeof window!="undefined"?window.opera:"");if(!e){let t=r;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function zb(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var Kn=X();Kn.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Kn.registerFlag("IS_BROWSER",()=>zb());Kn.registerFlag("IS_NODE",()=>typeof process!="undefined"&&typeof process.versions!="undefined"&&typeof process.versions.node!="undefined");Kn.registerFlag("IS_CHROME",()=>typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Kn.registerFlag("PROD",()=>!1);Kn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Kn.getBool("DEBUG"));Kn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Kn.registerFlag("IS_TEST",()=>!1);Kn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Kn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);function Tse(r,e){let t=r;if(sn(r))return e==="string"?[]:[r.length];if(!Array.isArray(r))return[];let n=[];for(;Array.isArray(t)||sn(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(r)&&X().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&DT(r,n,[]),n}function DT(r,e,t){if(t=t||[],!Array.isArray(r)&&!sn(r)){Pe(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}Pe(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${r.length} elements`),Pe(r.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${r.length} elements`);let n=e.slice(1);for(let o=0;o<r.length;++o)DT(r[o],n,t.concat(o))}function RT(r,e,t,n){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==e||r==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${n}' must be ${r} tensor, but got ${e} tensor`)}}function kt(r,e,t,n="numeric"){if(r instanceof Dr)return RT(n,r.dtype,e,t),r;let o=cl(r);if(o!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(o=n),RT(n,o,e,t),r==null||!sn(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){let u=r==null?"null":r.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${u}'`)}let a=Tse(r,o);!sn(r)&&!Array.isArray(r)&&(r=[r]);let s=o!=="string"?$l(r,o):Ra(r,[],!0);return je.makeTensor(s,a,o)}var Ase="__op";function zt(r){let e=Object.keys(r);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0],n=r[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+Ase;let o=(...a)=>{je.startScope(t);try{let i=n(...a);return mp(i)&&console.error("Cannot return a Promise inside of tidy."),je.endScope(i),i}catch(i){throw je.endScope(null),i}};return Object.defineProperty(o,"name",{value:t,configurable:!0}),o}function Fse(r,e){let t=kt(r,"real","complex"),n=kt(e,"imag","complex");mb(t.shape,n.shape,`real and imag shapes, ${t.shape} and ${n.shape}, must match in call to tf.complex().`);let o={real:t,imag:n};return je.runKernel(hl,o)}var $T=zt({complex_:Fse});function PT(r,e,t,n){if(n==null&&(n=cl(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!sn(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){dp(e);let o=xr(e),a=xr(t);Pe(o===a,()=>`Based on the provided shape, [${e}], the tensor should have ${o} values but has ${a}`);for(let i=0;i<t.length;++i){let s=t[i],u=i===t.length-1?s!==xr(e.slice(i)):!0;Pe(t[i]===e[i]||!u,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!sn(r)&&!Array.isArray(r)&&(r=[r]),e=e||t,r=n!=="string"?$l(r,n):Ra(r,[],!0),je.makeTensor(r,e,n)}var Ub=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function OT(r){return Ub?Buffer.byteLength(r):new Blob([r]).size}function MT(r){if(Ub)return Buffer.from(r).toString("base64");let e=new Uint8Array(r),t="";for(let n=0,o=e.length;n<o;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function BT(r){if(Ub){let n=Buffer.from(r,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}let e=atob(r),t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t.set([e.charCodeAt(n)],n);return t.buffer}function eh(r){if(r.length===1)return r[0];let e=0;r.forEach(o=>{e+=o.byteLength});let t=new Uint8Array(e),n=0;return r.forEach(o=>{t.set(new Uint8Array(o),n),n+=o.byteLength}),t.buffer}function th(r,e){let t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy,weightsManifest:e};return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),t}function rh(r,e){return Be(this,null,function*(){let t={modelTopology:r.modelTopology,format:r.format,generatedBy:r.generatedBy,convertedBy:r.convertedBy};if(r.trainingConfig!=null&&(t.trainingConfig=r.trainingConfig),r.weightsManifest!=null){let[n,o]=yield e(r.weightsManifest);t.weightSpecs=n,t.weightData=o}return r.signature!=null&&(t.signature=r.signature),r.userDefinedMetadata!=null&&(t.userDefinedMetadata=r.userDefinedMetadata),r.modelInitializer!=null&&(t.modelInitializer=r.modelInitializer),t})}function Ko(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:OT(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:OT(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var Zt=class{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Zt.instance==null&&(Zt.instance=new Zt),Zt.instance}static registerSaveRouter(e){Zt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Zt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Zt.getHandlers(e,"save")}static getLoadHandlers(e,t){return Zt.getHandlers(e,"load",t)}static getHandlers(e,t,n){let o=[];return(t==="load"?Zt.getInstance().loadRouters:Zt.getInstance().saveRouters).forEach(i=>{let s=i(e,n);s!==null&&o.push(s)}),o}};var Gb="tensorflowjs",jb=1,tu="models_store",Ma="model_info_store";function LT(){if(!X().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let r=typeof window=="undefined"?self:window,e=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Hb(r){let e=r.result;e.createObjectStore(tu,{keyPath:"modelPath"}),e.createObjectStore(Ma,{keyPath:"modelPath"})}var Xo=class{constructor(e){if(this.indexedDB=LT(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){return Be(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)})}load(){return Be(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(e,t){return new Promise((n,o)=>{let a=this.indexedDB.open(Gb,jb);a.onupgradeneeded=()=>Hb(a),a.onsuccess=()=>{let i=a.result;if(t==null){let s=i.transaction(tu,"readonly"),l=s.objectStore(tu).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return i.close(),o(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(l.result.modelArtifacts)},l.onerror=c=>(i.close(),o(l.error)),s.oncomplete=()=>i.close()}else{let s=Ko(t),u=i.transaction(Ma,"readwrite"),l=u.objectStore(Ma),c=l.put({modelPath:this.modelPath,modelArtifactsInfo:s}),p;c.onsuccess=()=>{p=i.transaction(tu,"readwrite");let d=p.objectStore(tu).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:s});d.onsuccess=()=>n({modelArtifactsInfo:s}),d.onerror=m=>{l=u.objectStore(Ma);let h=l.delete(this.modelPath);h.onsuccess=()=>(i.close(),o(d.error)),h.onerror=g=>(i.close(),o(d.error))}},c.onerror=f=>(i.close(),o(c.error)),u.oncomplete=()=>{p==null?i.close():p.oncomplete=()=>i.close()}}},a.onerror=i=>o(a.error)})}};Xo.URL_SCHEME="indexeddb://";var VT=r=>X().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Xo.URL_SCHEME)?Rse(r.slice(Xo.URL_SCHEME.length)):null;Zt.registerSaveRouter(VT);Zt.registerLoadRouter(VT);function Rse(r){return new Xo(r)}function $se(r){return r.startsWith(Xo.URL_SCHEME)?r.slice(Xo.URL_SCHEME.length):r}var qb=class{constructor(){this.indexedDB=LT()}listModels(){return Be(this,null,function*(){return new Promise((e,t)=>{let n=this.indexedDB.open(Gb,jb);n.onupgradeneeded=()=>Hb(n),n.onsuccess=()=>{let o=n.result,a=o.transaction(Ma,"readonly"),s=a.objectStore(Ma).getAll();s.onsuccess=()=>{let u={};for(let l of s.result)u[l.modelPath]=l.modelArtifactsInfo;e(u)},s.onerror=u=>(o.close(),t(s.error)),a.oncomplete=()=>o.close()},n.onerror=o=>t(n.error)})})}removeModel(e){return Be(this,null,function*(){return e=$se(e),new Promise((t,n)=>{let o=this.indexedDB.open(Gb,jb);o.onupgradeneeded=()=>Hb(o),o.onsuccess=()=>{let a=o.result,i=a.transaction(Ma,"readwrite"),s=i.objectStore(Ma),u=s.get(e),l;u.onsuccess=()=>{if(u.result==null)return a.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{let c=s.delete(e),p=()=>{l=a.transaction(tu,"readwrite");let d=l.objectStore(tu).delete(e);d.onsuccess=()=>t(u.result.modelArtifactsInfo),d.onerror=m=>n(u.error)};c.onsuccess=p,c.onerror=f=>(p(),a.close(),n(u.error))}},u.onerror=c=>(a.close(),n(u.error)),i.oncomplete=()=>{l==null?a.close():l.oncomplete=()=>a.close()}},o.onerror=a=>n(o.error)})})}};var Yo="/",Ll="tensorflowjs_models",WT="info",Pse="model_topology",Ose="weight_specs",Mse="weight_data",Bse="model_metadata";function zT(r){return{info:[Ll,r,WT].join(Yo),topology:[Ll,r,Pse].join(Yo),weightSpecs:[Ll,r,Ose].join(Yo),weightData:[Ll,r,Mse].join(Yo),modelMetadata:[Ll,r,Bse].join(Yo)}}function UT(r){for(let e of Object.values(r))window.localStorage.removeItem(e)}function Lse(r){let e=r.split(Yo);if(e.length<3)throw new Error(`Invalid key format: ${r}`);return e.slice(1,e.length-1).join(Yo)}function Vse(r){return r.startsWith(Zo.URL_SCHEME)?r.slice(Zo.URL_SCHEME.length):r}var Zo=class{constructor(e){if(!X().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=zT(this.modelPath)}save(e){return Be(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),o=Ko(e);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,MT(e.weightData));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:o}}catch(a){throw UT(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}})}load(){return Be(this,null,function*(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let o=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(o==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=o;let a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){let s=JSON.parse(a);t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,s.signature!=null&&(t.signature=s.signature),s.userDefinedMetadata!=null&&(t.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(t.modelInitializer=s.modelInitializer),s.trainingConfig!=null&&(t.trainingConfig=s.trainingConfig)}let i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=BT(i),t})}};Zo.URL_SCHEME="localstorage://";var GT=r=>X().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Zo.URL_SCHEME)?Wse(r.slice(Zo.URL_SCHEME.length)):null;Zt.registerSaveRouter(GT);Zt.registerLoadRouter(GT);function Wse(r){return new Zo(r)}var Kb=class{constructor(){Pe(X().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Pe(typeof window=="undefined"||typeof window.localStorage!="undefined",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return Be(this,null,function*(){let e={},t=Ll+Yo,n=Yo+WT;for(let o=0;o<this.LS.length;++o){let a=this.LS.key(o);if(a.startsWith(t)&&a.endsWith(n)){let i=Lse(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e})}removeModel(e){return Be(this,null,function*(){e=Vse(e);let t=zT(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);let n=JSON.parse(this.LS.getItem(t.info));return UT(t),n})}};var jT="://",fo=class{constructor(){this.managers={}}static getInstance(){return fo.instance==null&&(fo.instance=new fo),fo.instance}static registerManager(e,t){Pe(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(jT)&&(e=e.slice(0,e.indexOf(jT))),Pe(e.length>0,()=>"scheme must not be an empty string.");let n=fo.getInstance();Pe(n.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),n.managers[e]=t}static getManager(e){let t=this.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(this.getInstance().managers)}};var HT=class{fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}};if(X().get("IS_BROWSER")){X().setPlatform("browser",new HT);try{fo.registerManager(Zo.URL_SCHEME,new Kb)}catch(r){}try{fo.registerManager(Xo.URL_SCHEME,new qb)}catch(r){}}var zse={importFetch:()=>qT()},Xb;var KT=class{constructor(){this.util=Rv(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return X().global.fetch!=null?X().global.fetch(e,t):(Xb==null&&(Xb=zse.importFetch()),Xb(e,t))}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}};X().get("IS_NODE")&&X().setPlatform("node",new KT);function Me(r,e="float32",t){return e=e||"float32",dp(r),new mt(r,e,t)}function Use(r,e){let t=kt(r,"x","cast");if(!vb(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");let n={x:t},o={dtype:e};return je.runKernel(uo,n,o)}var nh=zt({cast_:Use});function Gse(r){let t={x:kt(r,"x","clone","string_or_numeric")};return je.runKernel(lo,t)}var XT=zt({clone_:Gse});function YT(r,e=!1){console.log(r.toString(e))}Vb();var jse={buffer:Me,cast:nh,clone:XT,print:YT};NT(jse);var Hse="model",qse=".json",Kse=".weights.bin";function ZT(r){return new Promise(e=>setTimeout(e)).then(r)}var Ba=class{constructor(e){if(!X().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Ba.URL_SCHEME)&&(e=e.slice(Ba.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Hse),this.modelJsonFileName=e+qse,this.weightDataFileName=e+Kse}save(e){return Be(this,null,function*(){if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=th(e,n),a=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=a,yield ZT(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){let s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;s.download=this.weightDataFileName,s.href=t,yield ZT(()=>s.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ko(e)}}})}};Ba.URL_SCHEME="downloads://";var Xse=r=>X().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Ba.URL_SCHEME)?Yse(r.slice(Ba.URL_SCHEME.length)):null;Zt.registerSaveRouter(Xse);function Yse(r="model"){return new Ba(r)}function Yb(r,e,t,n){i(r),t=t==null?0:t,n=n==null?1:n,s(t,n);let o=0,a=u=>(u.then(l=>{let c=t+ ++o/r.length*(n-t);return e(c),l}),u);function i(u){Pe(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function s(u,l){Pe(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),Pe(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${l}`),Pe(l>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${l}`)}return Promise.all(r.map(a))}function JT(r,e){return Be(this,null,function*(){e==null&&(e={});let t=e.fetchFunc==null?X().platform.fetch:e.fetchFunc,n=r.map(p=>t(p,e.requestInit,{isBinary:!0})),o=0,a=.5,s=(e.onProgress==null?yield Promise.all(n):yield Yb(n,e.onProgress,o,a)).map(p=>p.arrayBuffer()),u=.5,l=1;return e.onProgress==null?yield Promise.all(s):yield Yb(s,e.onProgress,u,l)})}var Jse="application/octet-stream",Qse="application/json",oh=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(Pe(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=X().platform.fetch,Pe(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Pe(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}save(e){return Be(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o=th(e,n);t.body.append("model.json",new Blob([JSON.stringify(o)],{type:Qse}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:Jse}),"model.weights.bin");let a=yield this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:Ko(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)})}load(){return Be(this,null,function*(){let e=yield this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=yield e.json()}catch(a){let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}let n=t.modelTopology,o=t.weightsManifest;if(n==null&&o==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return rh(t,a=>this.loadWeights(a))})}loadWeights(e){return Be(this,null,function*(){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,o]=eie(t),a=this.weightPathPrefix||n,i=[];for(let c of e)i.push(...c.weights);let s=[],u=[];for(let c of e)for(let p of c.paths)this.weightUrlConverter!=null?u.push(this.weightUrlConverter(p)):s.push(a+p+o);this.weightUrlConverter&&s.push(...yield Promise.all(u));let l=yield JT(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,eh(l)]})}};oh.URL_SCHEME_REGEX=/^https?:\/\//;function eie(r){let e=r.lastIndexOf("/"),t=r.lastIndexOf("?"),n=r.substring(0,e),o=t>e?r.substring(t):"";return[n+"/",o]}function Zb(r){return r.match(oh.URL_SCHEME_REGEX)!=null}var QT=(r,e)=>{if(typeof fetch=="undefined"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(r)?t=r.every(n=>Zb(n)):t=Zb(r),t)return eA(r,e)}return null};Zt.registerSaveRouter(QT);Zt.registerLoadRouter(QT);function eA(r,e){return new oh(r,e)}var ah={};Io(ah,{prepareAndValidate:()=>tA});function tA(r,e){let t=r.shape.length,n=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(n<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${n}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[n-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[n-1]} vs. ${t}`);if(xr(r.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${r.shape}.`);let o=e.shape,a=o[o.length-1],i=1;for(let p=0;p<o.length-1;++p)i*=o[p];let s=r.shape,u=o.slice();u.pop();let l=1;for(let p=a;p<t;++p)l*=s[p],u.push(s[p]);let c=[...io(r.shape).map(p=>p/l),1].slice(0,a);return[u,i,l,c]}var sh={};Io(sh,{calculateShapes:()=>nA,validateInput:()=>rA,validateUpdateShape:()=>Jb});function Jb(r,e,t){let n=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${r}, sliceDim: ${n}, and batchDim: ${o}.`;if(t.rank<o)throw new Error(a+` update.rank < ${o}. `);if(r.length<n+(t.rank-o))throw new Error(a+` Output shape length < ${n+(t.rank-o)}`);if(t.rank!==o+r.length-n)throw new Error(a+` update.rank != ${o+r.length-n}`);for(let i=0;i<o;++i)if(t.shape[i]!==e.shape[i])throw new Error(a+` updates.shape[${i}] (${t.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<t.rank-o;++i)if(t.shape[i+o]!==r[i+n])throw new Error(a+` updates.shape[${i+o}] (${t.shape[i+o]}) != shape[${i+o}] (${r[i+o]})`)}function rA(r,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}Jb(t,e,r)}function nA(r,e,t){let n=e.shape.length,o=n>1?e.shape[n-1]:1,a=t.length,i=1;for(let p=o;p<a;++p)i*=t[p];let s=o<1?1:o,u=xr(e.shape)/s,l=[...io(t.slice(0,o)),1],c=xr(t);return{sliceRank:o,numUpdates:u,sliceSize:i,strides:l,outputSize:c}}var Tt={};Io(Tt,{assertParamsValid:()=>nie,computeFlatOffset:()=>uie,computeOutShape:()=>aie,getNormalizedAxes:()=>sie,isSliceContinous:()=>iie,maskToAxes:()=>oie,parseSliceParams:()=>lie,sliceInfo:()=>cie,startForAxis:()=>cA,startIndicesWithElidedDims:()=>iA,stopForAxis:()=>pA,stopIndicesWithElidedDims:()=>uA,stridesForAxis:()=>lA,stridesWithElidedDims:()=>oA});var Qb=-2,rie=-1;function nie(r,e,t){let n=r.shape.length;Pe(n===e.length,()=>`Error in slice${n}D: Length of begin ${e} must match the rank of the array (${n}).`),Pe(n===t.length,()=>`Error in slice${n}D: Length of size ${t} must match the rank of the array (${n}).`);for(let o=0;o<n;++o)Pe(e[o]+t[o]<=r.shape[o],()=>`Error in slice${n}D: begin[${o}] + size[${o}] (${e[o]+t[o]}) would overflow input.shape[${o}] (${r.shape[o]})`)}function oie(r){let e=[],t=0;for(;r>0;)r&1&&e.push(t),r/=2,t++;return e}function aie(r,e,t){let n=[];for(let o=0;o<r.length;o++)n[o]=Math.ceil((e[o]-r[o])/t[o]);return n}function oA(r,e,t,n){let o=[...r];for(let a=o.length;a<n.length;a++)o.push(1);for(let a=0;a<t;a++)a===0?o[e]=1:(o.splice(e,0,1),o.pop());return o}function aA(r,e,t){return t<=r?t:t-(e-1)}function sA(r,e){let t=[];for(let n=0;n<r;n++)t.push(e+n);return t}function sie(r,e,t,n,o,a,i,s,u){let l=r.length,c=new Array(l),p=new Array(l),f=new Array(l);if(e.length&&t>0){let d=e[0],m=t+1;c=iA(i,d,m,n,r),p=uA(s,d,m,o,r),f=oA(a,d,m,r)}else for(let d=0;d<l;d++)c[d]=cA(i,n,a,r,d,u),p[d]=pA(s,o,a,r,d,u),f[d]=lA(a,d,u);return{begin:c,end:p,strides:f}}function iA(r,e,t,n,o){let a=[...o],i=sA(t,e);for(let s=0;s<a.length;s++)if(i.indexOf(s)>-1)a[s]=0;else{let u=aA(e,t,s),l=n[u];r&1<<u&&(l=0),a[s]=l}return a}function uA(r,e,t,n,o){let a=[...o],i=sA(t,e);for(let s=0;s<a.length;s++)if(i.indexOf(s)>-1)a[s]=Number.MAX_SAFE_INTEGER;else{let u=aA(e,t,s),l=n[u];r&1<<u&&(l=Number.MAX_SAFE_INTEGER),a[s]=l}for(let s=0;s<a.length;s++){let u=o[s];a[s]<0&&(a[s]+=u),a[s]=il(0,a[s],o[s])}return a}function lA(r,e,t){let n=r[e];return(t&1<<e||n==null)&&(n=1),n}function cA(r,e,t,n,o,a){let i=e[o],s=t[o]||1;(r&1<<o||a&1<<o||i==null)&&(s>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);let u=n[o];return i<0&&(i+=u),i=il(0,i,u-1),i}function pA(r,e,t,n,o,a){let i=e[o],s=t[o]||1;(r&1<<o||a&1<<o||i==null)&&(s>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);let u=n[o];return i<0&&(i+=u),s>0?i=il(0,i,u):i=il(-1,i,u-1),i}function iie(r,e,t){let n=t.length;for(let o=0;o<t.length;o++)if(t[o]>1){n=o;break}for(let o=n+1;o<t.length;o++)if(e[o]>0||t[o]!==r[o])return!1;return!0}function uie(r,e){let t=r.length>0?r[r.length-1]:1;for(let n=0;n<r.length-1;n++)t+=r[n]*e[n];return t}function lie(r,e,t){let n,o=r.shape.length;typeof e=="number"?n=[e,...new Array(o-1).fill(0)]:e.length<o?n=e.concat(new Array(o-e.length).fill(0)):n=e.slice(),n.forEach(i=>{Pe(i!==-1,()=>"slice() does not support negative begin indexing.")});let a;return t==null?a=new Array(o).fill(-1):typeof t=="number"?a=[t,...new Array(o-1).fill(-1)]:t.length<o?a=t.concat(new Array(o-t.length).fill(-1)):a=t,a=a.map((i,s)=>i>=0?i:(Pe(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${s}.`),r.shape[s]-n[s])),[n,a]}function cie(r,e,t,n,o,a,i,s,u){let l;if(n==null?(l=new Array(e.length),l.fill(1)):l=n,i!=null&&(i&i-1)!=0)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1,p={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:l.slice(),beginMask:o,endMask:a,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:u};for(let y=0;y<p.dims;y++)c&&(1<<y&s)!=0&&p.numAddAxisAfterEllipsis++,1<<y&i&&(c=!0);c||(p.ellipsisMask|=1<<p.dims,p.dims++);let f={dims:r.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};pie(p,f);let d=!0,m=!0,h=!0,g=[],v=[];for(let y=0;y<r.length;++y){if(f.strides[y]===0)throw Error(`strides[${y}] must be non-zero`);let b=!!(f.shrinkAxisMask&1<<y),k=r[y];if(k===-1){g.push(b?1:-1);continue}let N=[f.beginMask&1<<y,f.endMask&1<<y],E=[f.strides[y]>0?0:-1,f.strides[y]>0?k:k-1];if(b&&f.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");h=h&&f.strides[y]===1;let T=!!(f.beginMask&1<<y&&f.endMask&1<<y);if(f.beginValid&&f.endValid){if(b){let M=f.begin[y]<0?k+f.begin[y]:f.begin[y];if(f.begin[y]=M,f.end[y]=f.begin[y]+1,M<0||M>=k)throw Error(`slice index ${f.begin[y]} of dimension ${y} out of bounds.`)}else f.begin[y]=fA(f.begin[y],0,f.strides[y],k,N,E),f.end[y]=fA(f.end[y],1,f.strides[y],k,N,E);let O=f.strides[y]===1&&f.begin[y]===0&&f.end[y]===k;d=d&&O,m=m&&(y===0&&f.strides[y]===1||O)}else d=d&&f.strides[y]===1&&T,m=m&&(y===0&&f.strides[y]===1||T);let R,$=!1;if(f.beginValid&&f.endValid?(R=f.end[y]-f.begin[y],$=!0):b?(R=1,$=!0):T&&k>=0&&(f.strides[y]<0?R=-k:R=k,$=!0),$){let O;R===0||R<0!=f.strides[y]<0?O=0:O=Math.trunc(R/f.strides[y])+(R%f.strides[y]!=0?1:0),g.push(O)}else g.push(-1)}for(let y=0;y<f.finalShapeGatherIndices.length;++y){let b=f.finalShapeGatherIndices[y];b>=0?v.push(g[b]):b===Qb&&v.push(1)}return{finalShapeSparse:v.filter((y,b)=>f.finalShapeGatherIndices[b]!==Qb),finalShape:v,isIdentity:d,sliceDim0:m,isSimpleSlice:h,begin:f.begin,end:f.end,strides:f.strides}}function pie(r,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=r.begin!=null,e.endValid=r.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let n=0;n<r.dims;n++)if(1<<n&r.ellipsisMask){let o=Math.min(e.dims-(r.dims-n)+1+r.numAddAxisAfterEllipsis,e.dims);for(;t<o;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=n}else if(1<<n&r.newAxisMask)e.finalShapeGatherIndices.push(Qb),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);r.begin!=null&&(e.begin[t]=r.begin[n]),r.end!=null&&(e.end[t]=r.end[n]),e.strides[t]=r.strides[n],r.beginMask&1<<n&&(e.beginMask|=1<<t),r.endMask&1<<n&&(e.endMask|=1<<t),r.shrinkAxisMask&1<<n?(e.finalShapeGatherIndices.push(rie),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(n)),e.inputShapeGatherIndicesSparse[t]=n,t++}}function fA(r,e,t,n,o,a){if(o[e])return t>0?a[e]:a[e+1&1];{let i=r<0?n+r:r;return i<a[0]?a[0]:i>a[1]?a[1]:i}}function dA(r){X().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}ET(dA);function Xn(){return je}function mA(r,e){return je.tidy(r,e)}function e0(r){return je.setBackend(r)}function Vl(r,e,t=1){return je.registerBackend(r,e,t)}function fie(r,e){let t=kt(r,"a","mul"),n=kt(e,"b","mul");[t,n]=TT(t,n);let o={a:t,b:n};return je.runKernel(zo,o)}var hA=zt({mul_:fie});function die(r,e,t,n,o="NHWC",a){let i=r[3],s=[...e,i],u=vA(o);return t0(r,s,t,a,n,null,null,u)}function mie(r,e,t,n,o,a,i="channelsLast"){let[s,u]=ih(e),l;if(i==="channelsLast")l=[s,u,r[3],r[3]];else if(i==="channelsFirst")l=[s,u,r[1],r[1]];else throw new Error(`Unknown dataFormat ${i}`);return t0(r,l,t,n,o,a,!1,i)}function hie(r,e,t,n,o,a,i="NDHWC"){let[s,u,l]=n0(e),c,p;if(i==="NDHWC")p="channelsLast",c=[s,u,l,r[4],r[4]];else if(i==="NCDHW")p="channelsFirst",c=[s,u,l,r[1],r[1]];else throw new Error(`Unknown dataFormat ${i}`);return gA(r,c,t,n,o,!1,p,a)}function t0(r,e,t,n,o,a,i=!1,s="channelsLast"){let[u,l,c,p]=[-1,-1,-1,-1];if(s==="channelsLast")[u,l,c,p]=r;else if(s==="channelsFirst")[u,p,l,c]=r;else throw new Error(`Unknown dataFormat ${s}`);let[f,d,,m]=e,[h,g]=ih(t),[v,x]=ih(n),y=Wl(f,v),b=Wl(d,x),{padInfo:k,outHeight:N,outWidth:E}=xie(o,l,c,h,g,y,b,a,s),T=i?m*p:m,R;return s==="channelsFirst"?R=[u,T,N,E]:s==="channelsLast"&&(R=[u,N,E,T]),{batchSize:u,dataFormat:s,inHeight:l,inWidth:c,inChannels:p,outHeight:N,outWidth:E,outChannels:T,padInfo:k,strideHeight:h,strideWidth:g,filterHeight:f,filterWidth:d,effectiveFilterHeight:y,effectiveFilterWidth:b,dilationHeight:v,dilationWidth:x,inShape:r,outShape:R,filterShape:e}}function gA(r,e,t,n,o,a=!1,i="channelsLast",s){let[u,l,c,p,f]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,l,c,p,f]=r;else if(i==="channelsFirst")[u,f,l,c,p]=r;else throw new Error(`Unknown dataFormat ${i}`);let[d,m,h,,g]=e,[v,x,y]=n0(t),[b,k,N]=n0(n),E=Wl(d,b),T=Wl(m,k),R=Wl(h,N),{padInfo:$,outDepth:O,outHeight:M,outWidth:B}=yie(o,l,c,p,v,x,y,E,T,R,s),L=a?g*f:g,H;return i==="channelsFirst"?H=[u,L,O,M,B]:i==="channelsLast"&&(H=[u,O,M,B,L]),{batchSize:u,dataFormat:i,inDepth:l,inHeight:c,inWidth:p,inChannels:f,outDepth:O,outHeight:M,outWidth:B,outChannels:L,padInfo:$,strideDepth:v,strideHeight:x,strideWidth:y,filterDepth:d,filterHeight:m,filterWidth:h,effectiveFilterDepth:E,effectiveFilterHeight:T,effectiveFilterWidth:R,dilationDepth:b,dilationHeight:k,dilationWidth:N,inShape:r,outShape:H,filterShape:e}}function gie(r,e,t,n,o){n==null&&(n=r0(r,e,t));let a=r[0],i=r[1],s=ru((a-e+2*n)/t+1,o),u=ru((i-e+2*n)/t+1,o);return[s,u]}function vie(r,e,t,n,o,a){o==null&&(o=r0(r,e,n));let i=r[0],s=r[1],u=r[2],l=ru((i-e+2*o)/n+1,a),c=ru((s-e+2*o)/n+1,a),p=ru((u-e+2*o)/n+1,a);return[l,c,p,t]}function r0(r,e,t,n=1){let o=Wl(e,n);return Math.floor((r[0]*(t-1)-t+o)/2)}function ih(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function n0(r){return typeof r=="number"?[r,r,r]:r}function Wl(r,e){return e<=1?r:r+(r-1)*(e-1)}function xie(r,e,t,n,o,a,i,s,u){let l,c,p;if(typeof r=="number"){l={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};let d=gie([e,t],a,n,r,s);c=d[0],p=d[1]}else if(r==="same"){c=Math.ceil(e/n),p=Math.ceil(t/o);let f=Math.max(0,(c-1)*n+a-e),d=Math.max(0,(p-1)*o+i-t),m=Math.floor(f/2),h=f-m,g=Math.floor(d/2),v=d-g;l={top:m,bottom:h,left:g,right:v,type:"SAME"}}else if(r==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-a+1)/n),p=Math.ceil((t-i+1)/o);else if(typeof r=="object"){let f=u==="channelsLast"?r[1][0]:r[2][0],d=u==="channelsLast"?r[1][1]:r[2][1],m=u==="channelsLast"?r[2][0]:r[3][0],h=u==="channelsLast"?r[2][1]:r[3][1];l={top:f,bottom:d,left:m,right:h,type:f===0&&d===0&&m===0&&h===0?"VALID":"EXPLICIT"},c=ru((e-a+f+d)/n+1,s),p=ru((t-i+m+h)/o+1,s)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:l,outHeight:c,outWidth:p}}function yie(r,e,t,n,o,a,i,s,u,l,c){let p,f,d,m;if(typeof r=="number"){p={top:r,bottom:r,left:r,right:r,front:r,back:r,type:r===0?"VALID":"NUMBER"};let g=vie([e,t,n,1],s,1,o,r,c);f=g[0],d=g[1],m=g[2]}else if(r==="same"){f=Math.ceil(e/o),d=Math.ceil(t/a),m=Math.ceil(n/i);let h=(f-1)*o+s-e,g=(d-1)*a+u-t,v=(m-1)*i+l-n,x=Math.floor(h/2),y=h-x,b=Math.floor(g/2),k=g-b,N=Math.floor(v/2),E=v-N;p={top:b,bottom:k,left:N,right:E,front:x,back:y,type:"SAME"}}else if(r==="valid")p={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((e-s+1)/o),d=Math.ceil((t-u+1)/a),m=Math.ceil((n-l+1)/i);else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:p,outDepth:f,outHeight:d,outWidth:m}}function ru(r,e){if(!e)return Math.trunc(r);switch(e){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${e}`)}}function o0(r){let[e,t,n]=ih(r);return e===1&&t===1&&n===1}function bie(r,e){return o0(r)||o0(e)}function vA(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${r}`)}function wie(r,e){let n={x:kt(r,"x","reshape","string_or_numeric")},o={shape:e};return je.runKernel(Pa,n,o)}var xA=zt({reshape_:wie});function kie(r){let t={x:kt(r,"x","sigmoid","float32")};return je.runKernel(Ho,t)}var yA=zt({sigmoid_:kie});function _ie(r,e){let t=r.length,n=[];for(let o=0;o<t;o++){let a=t-1-o,i=r[a]||1;(e[e.length-1-o]||1)>1&&i===1&&n.unshift(a)}return n}function a0(r,e){let t=[];for(let n=0;n<e.length;n++){let o=r[r.length-n-1],a=e.length-n-1,i=e[a];(o==null||o===1&&i>1)&&t.unshift(a)}return t}function Sie(r,e){let t=[],n=Math.max(r.length,e.length);for(let o=0;o<n;o++){let a=r[r.length-o-1];a==null&&(a=1);let i=e[e.length-o-1];if(i==null&&(i=1),a===1)t.unshift(i);else if(i===1)t.unshift(a);else if(a!==i){let s=`Operands could not be broadcast together with shapes ${r} and ${e}.`;throw Error(s)}else t.unshift(a)}return t}function Iie(r){let t={x:kt(r,"x","elu","float32")};return je.runKernel(Vo,t)}var bA=zt({elu_:Iie});function Cie(r,e=.2){let n={x:kt(r,"x","leakyRelu")},o={alpha:e};return je.runKernel(Wo,n,o)}var wA=zt({leakyRelu_:Cie});function Nie(r,e=null,t=!1){let n=kt(r,"x","sum");n.dtype==="bool"&&(n=nh(n,"int32"));let o={x:n},a={axis:e,keepDims:t};return je.runKernel(qo,o,a)}var kA=zt({sum_:Nie});function s0(r,e){for(let t=0;t<r.length;++t)if(r[r.length-t-1]!==e-1-t)return!1;return!0}function _A(r,e,t){let n=r.length+e.length,o=[],a=0,i=0;for(let s=0;s<n;s++)t.indexOf(s)===-1?o.push(r[a++]):o.push(e[i++]);return o}function Eie(r,e){let t=[],n=r.length;for(let a=0;a<n;a++)e.indexOf(a)===-1&&t.push(r[a]);let o=e.map(a=>r[a]);return[t,o]}function Tie(r,e){let t=e.map(n=>1);return _A(r,t,e)}function Aie(r,e,t){Pe(s0(e,t),()=>`${r} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Fie(r,e){if(s0(r,e))return null;let t=[];for(let n=0;n<e;++n)r.indexOf(n)===-1&&t.push(n);return r.forEach(n=>t.push(n)),t}function Die(r){return r.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Rie(r,e){let t=[];for(let n=e-r;n<e;++n)t.push(n);return t}function Wp(r,e="float32"){if(e==="complex64"){let n=Wp(r,"float32"),o=Wp(r,"float32");return $T(n,o)}let t=fl(xr(r),e);return je.makeTensor(t,r,e)}function $ie(r,e){let t=kt(r,"x","prelu"),n=kt(e,"alpha","prelu"),o={x:t,alpha:n};return je.runKernel(Uo,o)}var SA=zt({prelu_:$ie});function Wie(r){let t={x:kt(r,"x","relu")};return je.runKernel(Go,t)}var VA=zt({relu_:Wie});function zie(r){let t={x:kt(r,"x","relu6")};return je.runKernel(jo,t)}var WA=zt({relu6_:zie});function d0(r,e){if((sn(r)&&e!=="string"||Array.isArray(r))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&sn(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return PT(r,[],[],e)}function Uie(r,e=0){let n={x:kt(r,"x","step")},o={alpha:e};return je.runKernel(co,n,o)}var zA=zt({step_:Uie});function UA(r,e){let t=[];for(let a=0;a<e.length;a++)e[a]&&t.push(a);let n=Me(r,"int32"),o=Me([t.length,r.length],"int32");for(let a=0;a<t.length;a++){let i=n.indexToLoc(t[a]),s=a*r.length;o.values.set(i,s)}return o.toTensor()}function Gie(r,e,t){if(t==null||t==="linear")return r;if(t==="relu")return hA(r,zA(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function jie(r,e){let t=e,n=a0(r.shape,e.shape);return n.length>0&&(t=kA(t,n)),xA(t,r.shape)}function Hie(r,e,t,n){if(e==="linear")return r;if(e==="relu")return VA(r);if(e==="elu")return bA(r);if(e==="relu6")return WA(r);if(e==="prelu")return SA(r,t);if(e==="leakyrelu")return wA(r,n);if(e==="sigmoid")return yA(r);throw new Error(`Unknown fused activation ${e}.`)}var qie=(r,e)=>!(r>0)||e==="linear";function GA(r,e,t){let n=Kie(r,e,t),o=n<0?-(n+1):n;r.splice(o,0,e)}function Kie(r,e,t){return Yie(r,e,t||Xie)}function Xie(r,e){return r>e?1:r<e?-1:0}function Yie(r,e,t){let n=0,o=r.length,a=0,i=!1;for(;n<o;){a=n+(o-n>>>1);let s=t(e,r[a]);s>0?n=a+1:(o=a,i=!s)}return i?n:-n-1}function jA(r,e,t,n,o){return m0(r,e,t,n,o,0)}function HA(r,e,t,n,o,a){return m0(r,e,t,n,o,0,!1,a,!0)}function qA(r,e,t,n,o,a){return m0(r,e,t,n,o,a,!0)}function m0(r,e,t,n,o,a,i=!1,s=!1,u=!1){let l=[];for(let g=0;g<e.length;g++)e[g]>o&&l.push({score:e[g],boxIndex:g,suppressBeginIndex:0});l.sort(KA);let c=a>0?-.5/a:0,p=[],f=[];for(;p.length<t&&l.length>0;){let g=l.pop(),{score:v,boxIndex:x,suppressBeginIndex:y}=g;if(v<o)break;let b=!1;for(let k=p.length-1;k>=y;--k){let N=Zie(r,x,p[k]);if(N>=n){b=!0;break}if(g.score=g.score*Jie(n,c,N),g.score<=o)break}g.suppressBeginIndex=p.length,b||(g.score===v?(p.push(x),f.push(g.score)):g.score>o&&GA(l,g,KA))}let d=p.length,m=t-d;s&&m>0&&(p.push(...new Array(m).fill(0)),f.push(...new Array(m).fill(0)));let h={selectedIndices:p};return i&&(h.selectedScores=f),u&&(h.validOutputs=d),h}function Zie(r,e,t){let n=r.subarray(e*4,e*4+4),o=r.subarray(t*4,t*4+4),a=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),p=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),d=(s-a)*(u-i),m=(p-l)*(f-c);if(d<=0||m<=0)return 0;let h=Math.max(a,l),g=Math.max(i,c),v=Math.min(s,p),x=Math.min(u,f),y=Math.max(v-h,0)*Math.max(x-g,0);return y/(d+m-y)}function Jie(r,e,t){let n=Math.exp(e*t*t);return t<=r?n:0}function KA(r,e){return r.score-e.score||r.score===e.score&&e.boxIndex-r.boxIndex}var S={};Io(S,{ERF_A1:()=>pue,ERF_A2:()=>fue,ERF_A3:()=>due,ERF_A4:()=>mue,ERF_A5:()=>hue,ERF_P:()=>cue,PARALLELIZE_THRESHOLD:()=>lh,SELU_SCALE:()=>lue,SELU_SCALEALPHA:()=>uue,applyActivation:()=>Hie,assertAndGetBroadcastShape:()=>Sie,assertAxesAreInnerMostDims:()=>Aie,assertParamsConsistent:()=>Qie,assignToTypedArray:()=>wue,axesAreInnerMostDims:()=>s0,calculateShapes:()=>nA,checkEinsumDimSizes:()=>Nue,combineLocations:()=>_A,complexWithEvenIndex:()=>xue,complexWithOddIndex:()=>yue,computeConv2DInfo:()=>t0,computeConv3DInfo:()=>gA,computeDefaultPad:()=>r0,computeDilation2DInfo:()=>die,computeOptimalWindowSize:()=>tue,computeOutAndReduceShapes:()=>Eie,computeOutShape:()=>eue,computePool2DInfo:()=>mie,computePool3DInfo:()=>hie,convertConv2DDataFormat:()=>vA,decodeEinsumEquation:()=>Iue,eitherStridesOrDilationsAreOne:()=>bie,expandShapeToKeepDim:()=>Tie,exponent:()=>_ue,exponents:()=>kue,fromStringArrayToUint8:()=>Oue,fromUint8ToStringArray:()=>Pue,getAxesPermutation:()=>Fie,getBroadcastDims:()=>_ie,getComplexWithIndex:()=>bue,getEinsumComputePath:()=>Eue,getEinsumPermutation:()=>Cue,getFusedBiasGradient:()=>jie,getFusedDyActivation:()=>Gie,getImageCenter:()=>rue,getInnerMostAxes:()=>Rie,getPermuted:()=>oue,getReductionAxes:()=>a0,getReshaped:()=>nue,getReshapedPermuted:()=>aue,getSliceBeginCoords:()=>sue,getSliceSize:()=>iue,getUndoAxesPermutation:()=>Die,isIdentityPermutation:()=>Tue,log:()=>nse,mergeRealAndImagArrays:()=>gue,prepareAndValidate:()=>tA,prepareSplitSize:()=>Fue,segment_util:()=>g0,shouldFuse:()=>qie,slice_util:()=>Tt,splitRealAndImagArrays:()=>vue,tupleValuesAreOne:()=>o0,upcastType:()=>ur,validateInput:()=>rA,validateUpdateShape:()=>Jb,warn:()=>Fn});function Qie(r,e){let t=r[0].length;r.forEach((o,a)=>{Pe(o.length===t,()=>`Error in concat${t}D: rank of tensors[${a}] must be the same as the rank of the rest (${t})`)}),Pe(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);let n=r[0];r.forEach((o,a)=>{for(let i=0;i<t;i++)Pe(i===e||o[i]===n[i],()=>`Error in concat${t}D: Shape of tensors[${a}] (${o}) does not match the shape of the rest (${n}) along the non-concatenated axis ${a}.`)})}function eue(r,e){let t=r[0].slice();for(let n=1;n<r.length;n++)t[e]+=r[n][e];return t}var lh=30;function tue(r){return r<=lh?r:pl(r,Math.floor(Math.sqrt(r)))}function rue(r,e,t){let n=t*(typeof r=="number"?r:r[0]),o=e*(typeof r=="number"?r:r[1]);return[n,o]}function nue(r,e,t,n=!0){let o=[];if(n)o=o.concat(e.slice(0)),o.push(r[0]/t),o=o.concat(r.slice(1));else{o=o.concat(r[0]);let a=e.length;for(let i=0;i<a;++i)o=o.concat([r[i+1]/e[i],e[i]]);o=o.concat(r.slice(a+1))}return o}function oue(r,e,t=!0){let n=[];if(t){n.push(e);for(let o=e+1;o<r;++o)o<=2*e?(n.push(o),n.push(o-(e+1))):n.push(o)}else{let o=[],a=[];for(let i=1;i<r;++i)i>=e*2+1||i%2==1?a.push(i):o.push(i);n.push(...o),n.push(0),n.push(...a)}return n}function aue(r,e,t,n=!0){let o=[];n?o.push(r[0]/t):o.push(r[0]*t);for(let a=1;a<r.length;++a)a<=e.length?n?o.push(e[a-1]*r[a]):o.push(r[a]/e[a-1]):o.push(r[a]);return o}function sue(r,e){let t=[0];for(let n=0;n<e;++n)t.push(r[n][0]);return t}function iue(r,e,t){let n=r.slice(0,1);for(let o=0;o<t;++o)n.push(r[o+1]-e[o][0]-e[o][1]);return n}var uue=1.7580993408473768,lue=1.0507009873554805;var cue=.3275911,pue=.254829592,fue=-.284496736,due=1.421413741,mue=-1.453152027,hue=1.061405429;function gue(r,e){if(r.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${r.length}, imag: ${e.length}.`);let t=new Float32Array(r.length*2);for(let n=0;n<t.length;n+=2)t[n]=r[n/2],t[n+1]=e[n/2];return t}function vue(r){let e=new Float32Array(r.length/2),t=new Float32Array(r.length/2);for(let n=0;n<r.length;n+=2)e[n/2]=r[n],t[n/2]=r[n+1];return{real:e,imag:t}}function xue(r){let e=Math.ceil(r.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let o=0;o<r.length;o+=4)t[Math.floor(o/4)]=r[o],n[Math.floor(o/4)]=r[o+1];return{real:t,imag:n}}function yue(r){let e=Math.floor(r.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let o=2;o<r.length;o+=4)t[Math.floor(o/4)]=r[o],n[Math.floor(o/4)]=r[o+1];return{real:t,imag:n}}function bue(r,e){let t=r[e*2],n=r[e*2+1];return{real:t,imag:n}}function wue(r,e,t,n){r[n*2]=e,r[n*2+1]=t}function kue(r,e){let t=new Float32Array(r/2),n=new Float32Array(r/2);for(let o=0;o<Math.ceil(r/2);o++){let a=(e?2:-2)*Math.PI*(o/r);t[o]=Math.cos(a),n[o]=Math.sin(a)}return{real:t,imag:n}}function _ue(r,e,t){let n=(t?2:-2)*Math.PI*(r/e),o=Math.cos(n),a=Math.sin(n);return{real:o,imag:a}}var h0="->",Sue=/->/g,XA=",",YA="...";function Iue(r,e){r=r.replace(/\s/g,"");let t=(r.length-r.replace(Sue,"").length)/h0.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${h0}").`);let[n,o]=r.split(h0);Pe(n.indexOf(YA)===-1,()=>`The ellipsis notation ("${YA}") is not supported yet.`);let a=n.split(XA),i=a.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let s=[];for(let f=0;f<o.length;++f){let d=o[f];if(!a.some(m=>m.indexOf(d)!==-1))throw new Error(`Output subscripts contain the label ${d} not present in the input subscripts.`);s.indexOf(d)===-1&&s.push(d)}for(let f=0;f<n.length;++f){let d=n[f];s.indexOf(d)===-1&&d!==XA&&s.push(d)}let u=new Array(a.length);for(let f=0;f<i;++f){if(new Set(a[f].split("")).size!==a[f].length)throw new Error(`Found duplicate axes in input component ${a[f]}. Support for duplicate axes in input is not implemented yet.`);u[f]=[];for(let d=0;d<a[f].length;++d)u[f].push(s.indexOf(a[f][d]))}let l=s.length,c=o.length,p=[];for(let f=c;f<l;++f)p.push(f);return{allDims:s,summedDims:p,idDims:u}}function Cue(r,e){let t=new Array(r);t.fill(-1);for(let o=0;o<e.length;++o)t[e[o]]=o;let n=[];for(let o=0;o<r;++o)t[o]===-1&&n.push(o);return t=t.filter(o=>o!==-1),{permutationIndices:t,expandDims:n}}function Nue(r,e,t){let n=new Array(r);for(let o=0;o<t.length;++o){let a=t[o].shape;for(let i=0;i<e[o].length;++i)n[e[o][i]]===void 0?n[e[o][i]]=a[i]:Pe(n[e[o][i]]===a[i],()=>`Expected dimension ${n[e[o][i]]} at axis ${i} of input shaped ${JSON.stringify(a)}, but got dimension ${a[i]}`)}}function Eue(r,e){let t=r,n=[],o=0;r.length===0&&t.push(-1),o=r.length+1;for(let i=0;i<o;++i)n.push([]);let a=[];for(let i=0;i<t.length;++i){let s=t[i],u=Aue(e,s);for(let l of u)a.indexOf(l)===-1&&(n[i].push(l),a.push(l))}return{path:t,steps:n}}function Tue(r){return r.every((e,t)=>e===t)}function Aue(r,e){let t=[];for(let n=0;n<r.length;++n)(r[n].length===0||r[n].indexOf(e)!==-1||e===-1)&&t.push(n);return t}function Fue(r,e,t=0){let n=[];if(typeof e=="number")Pe(r.shape[t]%e==0,()=>"Number of splits must evenly divide the axis."),n=new Array(e).fill(r.shape[t]/e);else{let o=e.reduce((i,s)=>(s===-1&&(i+=1),i),0);Pe(o<=1,()=>"There should be only one negative value in split array.");let a=e.indexOf(-1);if(a!==-1){let i=e.reduce((s,u)=>u>0?s+u:s);e[a]=r.shape[t]-i}Pe(r.shape[t]===e.reduce((i,s)=>i+s),()=>"The sum of sizes must match the size of the axis dimension."),n=e}return n}var g0={};Io(g0,{collectGatherOpShapeInfo:()=>$ue,computeOutShape:()=>Rue,segOpComputeOptimalWindowSize:()=>Due});function Due(r,e){let t=!1,n;for(r<=lh?(n=r,t=!0):n=pl(r,Math.floor(Math.sqrt(r)));!t;)n>e||n===r?t=!0:n=pl(r,n+1);return n}function Rue(r,e,t){let n=[],o=r.length;for(let a=0;a<o;a++)a!==e?n.push(r[a]):n.push(t);return n}function $ue(r,e,t,n){let o=e.shape.length,a=r.shape.length;if(n!==0&&(n<-o||n>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${n}`);if(n<0&&(n+=o),n>a)throw new Error(`batchDims (${n}) must be less than rank(x) (
    ${a}).`);if(t<n)throw new Error(`batchDims (${n}) must be less than or equal to axis (${t}).`);for(let p=0;p<n;++p)if(r.shape[p]!==e.shape[p])throw new Error(`x.shape[${p}]: ${r.shape[p]} should be equal to indices.shape[${p}]: ${e.shape[p]}.`);let i=r.shape[t],s=[],u=1,l=1,c=1;for(let p=0;p<n;++p)s.push(r.shape[p]),u*=r.shape[p];for(let p=n;p<t;p++)s.push(r.shape[p]),l*=r.shape[p];for(let p=n;p<o;p++)s.push(e.shape[p]);for(let p=t+1;p<a;p++)s.push(r.shape[p]),c*=r.shape[p];return{batchSize:u,sliceSize:c,outerSize:l,dimSize:i,outputShape:s}}function Pue(r){try{return r.map(e=>Ol(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Oue(r){return r.map(e=>Pl(e))}var Sr={};Io(Sr,{nonMaxSuppressionV3Impl:()=>jA,nonMaxSuppressionV4Impl:()=>HA,nonMaxSuppressionV5Impl:()=>qA,whereImpl:()=>UA});var Ye;(function(r){r[r.float32=0]="float32",r[r.int32=1]="int32",r[r.bool=2]="bool",r[r.string=3]="string",r[r.complex64=4]="complex64"})(Ye||(Ye={}));var La;(function(r){r[r.linear=0]="linear",r[r.relu=1]="relu",r[r.relu6=2]="relu6",r[r.prelu=3]="prelu",r[r.leakyrelu=4]="leakyrelu",r[r.sigmoid=5]="sigmoid",r[r.elu=6]="elu"})(La||(La={}));var ZA;function Mue(r){ZA=r.wasm.cwrap(Gi,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function Bue(r){let{inputs:e,backend:t,attrs:n}=r,{a:o,b:a,bias:i,preluActivationWeights:s}=e;if(o.dtype!=="float32"||a.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:p}=n,f=t.dataIdMap.get(o.dataId).id,d=t.dataIdMap.get(a.dataId).id,m=0;if(i!=null){let T=t.dataIdMap.get(i.dataId);if(T.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${T.shape.length}.`);m=T.id}let h=s==null?0:t.dataIdMap.get(s.dataId).id,g=La[c];if(g==null)throw new Error(`${c} activation not yet supported for FusedConv2D in the wasm backend.`);let v=u?o.shape[2]:o.shape[1],x=l?a.shape[1]:a.shape[2],y=o.shape[0],b=t.makeOutput([y,v,x],o.dtype),k=t.dataIdMap.get(b.dataId).id,N=new Uint8Array(new Int32Array(o.shape).buffer),E=new Uint8Array(new Int32Array(a.shape).buffer);return ZA(f,N,o.shape.length,d,E,a.shape.length,u,l,g,m,h,p||0,k),b}var JA={kernelName:Gi,backendName:"wasm",setupFunc:Mue,kernelFunc:Bue};function nt(r,e){let t;function n(a){t=a.wasm.cwrap(r,null,["number","number","number"])}function o(a){let{backend:i,inputs:{x:s}}=a,u=i.dataIdMap.get(s.dataId).id,l=i.makeOutput(s.shape,e||s.dtype),c=i.dataIdMap.get(l.dataId).id;return w.sizeFromShape(l.shape)===0||t(u,Ye[s.dtype],c),l}return{kernelName:r,backendName:"wasm",setupFunc:n,kernelFunc:o}}var QA=nt(dl);function pt(r,e,t){let n;function o(i){n=i.wasm.cwrap(r,null,["number","array","number","number","array","number","number","number"])}function a(i){let{backend:s,inputs:u}=i,{a:l,b:c}=u,p=s.dataIdMap.get(l.dataId).id,f=s.dataIdMap.get(c.dataId).id,d=t!=null?t:l.dtype,m=S.assertAndGetBroadcastShape(l.shape,c.shape),h=s.makeOutput(m,d);if(w.sizeFromShape(m)===0)return h;let g=new Uint8Array(new Int32Array(l.shape).buffer),v=new Uint8Array(new Int32Array(c.shape).buffer),x=s.dataIdMap.get(h.dataId).id,y=()=>n(p,g,l.shape.length,f,v,c.shape.length,Ye[l.dtype],x);if(e&&l.dtype==="float32")return y(),h;let b=S.getBroadcastDims(l.shape,m),k=S.getBroadcastDims(c.shape,m),N=b.every((T,R)=>T===R),E=k.every((T,R)=>T===R);if(N&&E)return y(),h;throw new Error(`Broadcasting along outer dims is not yet supported for ${l.dtype} ${r}.`)}return{kernelName:r,backendName:"wasm",setupFunc:o,kernelFunc:a}}var Lue=!0,eF=pt(Lo,Lue);var tF;function Vue(r){tF=r.wasm.cwrap(Os,null,["array","number","number","number"])}function Wue(r){let{inputs:e,backend:t}=r,n=t.makeOutput(e[0].shape,e[0].dtype);if(w.sizeFromShape(n.shape)===0)return n;let o=e.map(s=>t.dataIdMap.get(s.dataId).id),a=new Uint8Array(new Int32Array(o).buffer),i=t.dataIdMap.get(n.dataId).id;return tF(a,o.length,Ye[n.dtype],i),n}var rF={kernelName:Os,backendName:"wasm",setupFunc:Vue,kernelFunc:Wue};function ou(r){let{inputs:{x:e},backend:t}=r,n=t.makeOutput(e.shape,e.dtype),o=t.typedArrayFromHeap(e);return t.typedArrayFromHeap(n).set(o),n}var nF={kernelName:lo,backendName:"wasm",kernelFunc:ou};var oF;function zue(r){oF=r.wasm.cwrap(zi,null,["number","array","number","number","number","array","number"])}function mo(r){let{inputs:e,backend:t,attrs:n}=r,[o,a]=Gue(e.x.shape,n.perm),i=!0;for(let m=0;m<a.length;m++)a[m]!==m&&(i=!1);let s=Uue(e.x.shape,n.perm),u={dataId:e.x.dataId,shape:o,dtype:e.x.dtype};if(i){let m=ou({inputs:e,backend:t});return m.shape=s,m}let l=t.makeOutput(s,u.dtype),c=t.dataIdMap.get(u.dataId).id,p=t.dataIdMap.get(l.dataId).id,f=new Uint8Array(new Int32Array(a).buffer),d=new Uint8Array(new Int32Array(u.shape).buffer);return oF(c,d,u.shape.length,Ye[u.dtype],p,f,a.length),l}function Uue(r,e){let t=new Array(r.length);for(let n=0;n<t.length;n++)t[n]=r[e[n]];return t}function Gue(r,e){let t=[],n=[];for(let o=0;o<r.length;++o)r[o]!==1&&t.push(r[o]),r[e[o]]!==1&&n.push(e[o]);for(let o=0;o<n.length;++o){let a=-1;for(let i=0;i<n.length;++i)n[i]>=o&&(a===-1||n[a]>n[i])&&(a=i);n[a]=o}return[t,n]}var aF={kernelName:zi,backendName:"wasm",kernelFunc:mo,setupFunc:zue};function Br(r,e,t){let n=r.shape,o=r.shape.length,a=w.parseAxisParam(e,n),i=a,s=S.getAxesPermutation(i,o),u=null,l=!1;if(s!=null){let c=new Array(o);for(let d=0;d<c.length;d++)c[d]=n[s[d]];i=S.getInnerMostAxes(i.length,o),u=mo({inputs:{x:r},attrs:{perm:s},backend:t});let p=t.dataIdMap.get(r.dataId).id;t.dataIdMap.get(u.dataId).id!==p&&(l=!0)}return{transposed:u,originalAxes:a,axes:i,inputWasTransposed:l}}var sF;function jue(r){sF=r.wasm.cwrap(Ms,null,["number, number, number"])}function Hue(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o,keepDims:a}=n,{x:i}=t,u=e.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e);if(d){let y=e.dataIdMap.get(c.dataId).id;l=c,u=y}let m=l.shape.length;S.assertAxesAreInnerMostDims("all",p,m);let[h,g]=S.computeOutAndReduceShapes(l.shape,p),v=w.sizeFromShape(g),x=e.makeOutput(h,i.dtype);if(w.sizeFromShape(l.shape)!==0){let y=e.dataIdMap.get(x.dataId).id;sF(u,v,y)}if(d&&e.disposeData(c.dataId),a){let y=S.expandShapeToKeepDim(x.shape,f);x.shape=y}return x}var iF={kernelName:Ms,backendName:"wasm",setupFunc:jue,kernelFunc:Hue};var uF;function que(r){uF=r.wasm.cwrap(Bs,null,["number, number, number"])}function Kue(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o,keepDims:a}=n,{x:i}=t,u=e.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e);if(d){let y=e.dataIdMap.get(c.dataId).id;l=c,u=y}let m=l.shape.length;S.assertAxesAreInnerMostDims("any",p,m);let[h,g]=S.computeOutAndReduceShapes(l.shape,p),v=w.sizeFromShape(g),x=e.makeOutput(h,i.dtype);if(w.sizeFromShape(l.shape)!==0){let y=e.dataIdMap.get(x.dataId).id;uF(u,v,y)}if(d&&e.disposeData(c.dataId),a){let y=S.expandShapeToKeepDim(x.shape,f);x.shape=y}return x}var lF={kernelName:Bs,backendName:"wasm",setupFunc:que,kernelFunc:Kue};var cF;function Xue(r){cF=r.wasm.cwrap(Ls,null,["number","number","number","number","number"])}function Yue(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o}=n,{x:a}=t,i=e.dataIdMap.get(a.dataId).id,s=i,u=a,{transposed:l,axes:c,inputWasTransposed:p}=Br(a,o,e);if(p){let v=e.dataIdMap.get(l.dataId).id;v!==i&&(u=l,s=v)}let f=u.shape.slice(0,-1),d=e.makeOutput(f,"int32"),m=e.dataIdMap.get(d.dataId).id,h=w.sizeFromShape(d.shape),g=u.shape[c[0]];return cF(s,Ye[u.dtype],h,g,m),p&&e.disposeData(l.dataId),d}var pF={kernelName:Ls,backendName:"wasm",kernelFunc:Yue,setupFunc:Xue};var fF;function Zue(r){fF=r.wasm.cwrap(Vs,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Jue(r){let{inputs:e,attrs:t,backend:n}=r,o=e.x,a=n.dataIdMap.get(o.dataId).id,{filterSize:i,strides:s,pad:u,dimRoundingMode:l}=t,c=S.computePool2DInfo(o.shape,i,s,1,u,l),p=c.filterHeight,f=c.filterWidth,d=c.padInfo.top,m=c.padInfo.right,h=c.padInfo.bottom,g=c.padInfo.left,v=c.strideHeight,x=c.strideWidth,y=c.inChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);if(c.dilationWidth!==1||c.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${c.dilationHeight}, ${c.dilationWidth}].`);let b=n.makeOutput(c.outShape,"float32"),k=n.dataIdMap.get(b.dataId).id;return fF(a,o.shape[0],o.shape[1],o.shape[2],p,f,d,m,h,g,v,x,y,k),b}var dF={kernelName:Vs,backendName:"wasm",setupFunc:Zue,kernelFunc:Jue};function or(r){let{inputs:e,attrs:t}=r,{x:n}=e,{shape:o}=t,a=w.sizeFromShape(n.shape),i=w.inferFromImplicitShape(o,a);return w.assert(a===w.sizeFromShape(i),()=>`new shape: ${i}, old shape: ${n.shape}. New shape and old shape must have the same number of elements.`),r.backend.incRef(n.dataId),{dataId:n.dataId,shape:i,dtype:n.dtype}}var mF={kernelName:Pa,backendName:"wasm",kernelFunc:or};var hF;function Que(r){hF=r.wasm.cwrap(Ws,null,["number","array","number","number","array","number","number","number","number"])}function ele(r){let{inputs:e,backend:t,attrs:n}=r,{a:o,b:a}=e,{transposeA:i,transposeB:s}=n;if(o.dtype!=="float32"||a.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let u=o.shape.length,l=a.shape.length,c=i?o.shape[u-2]:o.shape[u-1],p=s?a.shape[l-1]:a.shape[l-2],f=i?o.shape[u-1]:o.shape[u-2],d=s?a.shape[l-2]:a.shape[l-1],m=o.shape.slice(0,-2),h=a.shape.slice(0,-2),g=w.sizeFromShape(m),v=w.sizeFromShape(h),x=g===v||g===1||v===1;w.assert(u>=2&&l>=2&&x,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${m}) and (${h}).`);let b=(g>v?o.shape.slice(0,-2):a.shape.slice(0,-2)).concat([f,d]);w.assert(c===p,()=>`Error in matMul: inner shapes (${c}) and (${p}) of Tensors with shapes ${o.shape} and ${a.shape} and transposeA=${i} and transposeB=${s} must match.`);let k=i?[g,c,f]:[g,f,c],N=s?[v,d,p]:[v,p,d],E=or({inputs:{x:o},backend:t,attrs:{shape:k}}),T=or({inputs:{x:a},backend:t,attrs:{shape:N}}),R=t.dataIdMap.get(E.dataId).id,$=t.dataIdMap.get(T.dataId).id,O=i?E.shape[2]:E.shape[1],M=s?T.shape[1]:T.shape[2],B=Math.max(g,v),L=t.makeOutput([B,O,M],E.dtype),H=t.dataIdMap.get(L.dataId).id,W=new Uint8Array(new Int32Array(E.shape).buffer),K=new Uint8Array(new Int32Array(T.shape).buffer);return hF(R,W,E.shape.length,$,K,T.shape.length,i,s,H),t.disposeData(E.dataId),t.disposeData(T.dataId),L.shape=b,L}var gF={kernelName:Ws,backendName:"wasm",setupFunc:Que,kernelFunc:ele};var V0={};Io(V0,{addImpl:()=>x0,bincountImpl:()=>Gl,bincountReduceImpl:()=>ch,ceilImpl:()=>y0,concatImpl:()=>au,equalImpl:()=>b0,expImpl:()=>k0,expm1Impl:()=>S0,floorImpl:()=>I0,gatherNdImpl:()=>ph,gatherV2Impl:()=>fh,greaterEqualImpl:()=>N0,greaterImpl:()=>C0,lessEqualImpl:()=>T0,lessImpl:()=>E0,linSpaceImpl:()=>dh,logImpl:()=>A0,maxImpl:()=>mh,maximumImpl:()=>F0,minimumImpl:()=>D0,multiplyImpl:()=>zp,negImpl:()=>R0,notEqualImpl:()=>$0,prodImpl:()=>P0,rangeImpl:()=>iu,rsqrtImpl:()=>O0,sigmoidImpl:()=>WF,simpleAbsImpl:()=>v0,sliceImpl:()=>uu,sparseFillEmptyRowsImpl:()=>hh,sparseReshapeImpl:()=>gh,sparseSegmentReductionImpl:()=>Hl,sqrtImpl:()=>GF,squaredDifferenceImpl:()=>B0,stridedSliceImpl:()=>vh,stringNGramsImpl:()=>xh,stringSplitImpl:()=>yh,stringToHashBucketFastImpl:()=>bh,subImpl:()=>L0,tileImpl:()=>wh,topKImpl:()=>kh,transposeImpl:()=>jl,uniqueImpl:()=>_h});function oe(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>{t!=null&&w.assert(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}function v0(r){let e=new Float32Array(r.length);for(let t=0;t<r.length;++t)e[t]=Math.abs(r[t]);return e}var tle=r=>{let{x:e}=r.inputs,t=r.backend;oe(e,"abs");let n=new Float32Array(w.sizeFromShape(e.shape)),o=t.data.get(e.dataId).values;return n=v0(o),t.makeOutput(n,e.shape,e.dtype)},vF={kernelName:dl,backendName:"cpu",kernelFunc:tle};function qe(r){return(e,t,n,o,a)=>{let i=S.assertAndGetBroadcastShape(e,t),s=i.length,u=w.computeStrides(i),l=w.sizeFromShape(i),c=w.getTypedArrayFromDType(a,l),p=e.length,f=t.length,d=w.computeStrides(e),m=w.computeStrides(t),h=S.getBroadcastDims(e,i),g=S.getBroadcastDims(t,i);if(h.length+g.length===0)for(let v=0;v<c.length;++v)c[v]=r(n[v%n.length],o[v%o.length]);else for(let v=0;v<c.length;++v){let x=w.indexToLoc(v,s,u),y=x.slice(-p);h.forEach(E=>y[E]=0);let b=w.locToIndex(y,p,d),k=x.slice(-f);g.forEach(E=>k[E]=0);let N=w.locToIndex(k,f,m);c[v]=r(n[b],o[N])}return[c,i]}}function lr(r){let{inputs:e,backend:t}=r,{real:n,imag:o}=e,a=t.data.get(n.dataId).values,i=t.data.get(o.dataId).values,s=t.makeTensorInfo(n.shape,"complex64"),u=t.data.get(s.dataId);return u.complexTensorInfos={real:t.makeTensorInfo(n.shape,"float32",a),imag:t.makeTensorInfo(o.shape,"float32",i)},s}var xF={kernelName:hl,backendName:"cpu",kernelFunc:lr};function zl(r,e,t="float32"){if(t==="complex64"){let o=zl(r,e,"float32"),a=zl(r,e,"float32");return lr({inputs:{real:o,imag:a},backend:r})}let n=w.makeZerosTypedArray(w.sizeFromShape(e),t);return r.makeTensorInfo(e,t,n)}function Ir(r){let{inputs:e,backend:t}=r,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}var yF={kernelName:lo,backendName:"cpu",kernelFunc:Ir};function Pn(r){let{inputs:e,backend:t}=r,{input:n}=e,o=t.data.get(n.dataId).complexTensorInfos.real,a=t.data.get(o.dataId).values;return t.makeTensorInfo(o.shape,o.dtype,a)}var bF={kernelName:Om,backendName:"cpu",kernelFunc:Pn};function On(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{dtype:a}=n;if(a==="complex64"){if(o.dtype==="complex64")return Ir({inputs:{x:o},backend:t});let i=zl(t,o.shape,o.dtype),s=On({inputs:{x:o},backend:t,attrs:{dtype:"float32"}}),u=lr({inputs:{real:s,imag:i},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(s),u}if(o.dtype==="complex64"){let i=Pn({inputs:{input:o},backend:t}),s=On({inputs:{x:i},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(i),s}if(!w.hasEncodingLoss(o.dtype,a)){let i=Ir({inputs:{x:o},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(a==="int32"){let i=t.data.get(o.dataId).values,s=Int32Array.from(i);return t.makeTensorInfo(o.shape,"int32",s)}if(a==="bool"){let i=t.data.get(o.dataId).values,s=w.toTypedArray([0],o.dtype),[u,l]=qe((c,p)=>c!==p?1:0)(o.shape,[],i,s,"bool");return t.makeTensorInfo(l,"bool",u)}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${a}`)}var wF={kernelName:uo,backendName:"cpu",kernelFunc:On};function Qe(r,e,t,n){return t==null?({inputs:o,backend:a})=>{let{a:i,b:s}=o,u=a;oe([i,s],r);let l=u.data.get(i.dataId).values,c=u.data.get(s.dataId).values,p=i.dtype==="string"?S.fromUint8ToStringArray(l):l,f=i.dtype==="string"?S.fromUint8ToStringArray(c):c,d=n||i.dtype,[m,h]=e(i.shape,s.shape,p,f,d);return u.makeTensorInfo(h,d,m)}:({inputs:o,backend:a})=>{let{a:i,b:s}=o,u=a;if(i.dtype==="complex64"||s.dtype==="complex64"){let l=On({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),c=u.data.get(l.dataId),p=c.complexTensorInfos.real,f=c.complexTensorInfos.imag,d=u.data.get(p.dataId).values,m=u.data.get(f.dataId).values,h=On({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),g=u.data.get(h.dataId),v=g.complexTensorInfos.real,x=g.complexTensorInfos.imag,y=u.data.get(v.dataId).values,b=u.data.get(x.dataId).values,[k,N,E]=t(i.shape,s.shape,d,m,y,b),T=u.makeTensorInfo(E,"float32",k),R=u.makeTensorInfo(E,"float32",N),$=lr({inputs:{real:T,imag:R},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(h),u.disposeIntermediateTensorInfo(T),u.disposeIntermediateTensorInfo(R),$}else{let l=u.data.get(i.dataId).values,c=u.data.get(s.dataId).values,p=n||i.dtype,[f,d]=e(i.shape,s.shape,l,c,p);return u.makeTensorInfo(d,p,f)}}}function Ul(r){return(e,t,n,o,a,i)=>{let s=S.assertAndGetBroadcastShape(e,t),u=w.sizeFromShape(s),l=s.length,c=w.computeStrides(s),p=w.getTypedArrayFromDType("float32",u),f=w.getTypedArrayFromDType("float32",u),d=S.getBroadcastDims(e,s),m=S.getBroadcastDims(t,s),h=S.mergeRealAndImagArrays(n,o),g=S.mergeRealAndImagArrays(a,i),v=e.length,x=w.computeStrides(e),y=t.length,b=w.computeStrides(t);if(d.length+m.length===0)for(let k=0;k<p.length;k++){let N=k%h.length,E=k%g.length,T=r(h[N*2],h[N*2+1],g[E*2],g[E*2+1]);p[k]=T.real,f[k]=T.imag}else for(let k=0;k<p.length;k++){let N=w.indexToLoc(k,l,c),E=N.slice(-v);d.forEach(M=>E[M]=0);let T=w.locToIndex(E,v,x),R=N.slice(-y);m.forEach(M=>R[M]=0);let $=w.locToIndex(R,y,b),O=r(h[T*2],h[T*2+1],g[$*2],g[$*2+1]);p[k]=O.real,f[k]=O.imag}return[p,f,s]}}var x0=qe((r,e)=>r+e),rle=Ul((r,e,t,n)=>({real:r+t,imag:e+n})),Jo=Qe(Lo,x0,rle),kF={kernelName:Lo,backendName:"cpu",kernelFunc:Jo};function Gl(r,e,t,n,o){let a=w.sizeFromShape(n),i=w.makeZerosTypedArray(o,t);for(let s=0;s<r.length;s++){let u=r[s];if(u<0)throw new Error("Input x must be non-negative!");u>=o||(a>0?i[u]+=e[s]:i[u]+=1)}return i}function ch(r,e,t,n=!1){let o=r.shape[0],a=r.shape[1],i=Me([o,t],e.dtype);for(let s=0;s<o;s++)for(let u=0;u<a;u++){let l=r.get(s,u);if(l<0)throw new Error("Input x must be non-negative!");l>=t||(n?i.set(1,s,l):e.size>0?i.set(i.get(s,l)+e.get(s,u),s,l):i.set(i.get(s,l)+1,s,l))}return i}function Lr(r){return(e,t,n)=>{let o=w.getTypedArrayFromDType(t,e.length);for(let a=0;a<e.length;++a)o[a]=r(e[a],n);return o}}function Oe(r,e,t){return({inputs:n,attrs:o,backend:a})=>{let{x:i}=n;if(oe(i,r),i.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");let s=a,u=s.data.get(i.dataId).values,l=w.sizeFromShape(i.shape),c=t||i.dtype,p=w.getArrayFromDType(c,l);for(let f=0;f<l;++f)p[f]=e(u[f],o);return s.makeTensorInfo(i.shape,c,p)}}function Mn(r,e,t){return({inputs:n,attrs:o,backend:a})=>{let{x:i}=n;if(oe(i,r),i.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");let s=a,u=s.data.get(i.dataId).values,l=t||i.dtype,c=e(u,l,o);return s.makeTensorInfo(i.shape,l,c)}}var y0=Lr(r=>Math.ceil(r)),nle=Mn(zs,y0),_F={kernelName:zs,backendName:"cpu",kernelFunc:nle};function au(r,e,t,n){let o=w.getArrayFromDType(t,w.sizeFromShape(e));if(n&&t!=="string"){let a=0;r.forEach(i=>{let s=w.sizeFromShape(i.shape);o.set(i.vals,a),a+=s})}else{let a=0;r.forEach(i=>{let s=t==="string"?S.fromUint8ToStringArray(i.vals):i.vals,u=0;for(let l=0;l<i.shape[0];++l){let c=l*e[1]+a;for(let p=0;p<i.shape[1];++p)o[c+p]=s[u++]}a+=i.shape[1]})}return o}var b0=qe((r,e)=>r===e?1:0),w0=Qe(Js,b0,null,"bool"),SF={kernelName:Js,backendName:"cpu",kernelFunc:w0};var k0=Lr(r=>Math.exp(r)),_0=Mn(Qs,k0,"float32"),IF={kernelName:Qs,backendName:"cpu",kernelFunc:_0};var S0=Lr(r=>Math.expm1(r)),ole=Mn(Sp,S0),CF={kernelName:Sp,backendName:"cpu",kernelFunc:ole};var I0=Lr(r=>Math.floor(r)),ale=Mn(ti,I0),NF={kernelName:ti,backendName:"cpu",kernelFunc:ale};function ph(r,e,t,n,o,a,i,s,u){let l=Me([n,a],t);for(let c=0;c<n;c++){let p=[],f=0;for(let d=0;d<o;d++){let m=r[c*o+d];f+=m*i[d],p.push(m)}if(f<0||f>=u/a)throw new Error(`Invalid indices: ${p} does not index into ${s}`);for(let d=0;d<a;d++)l.values[c*a+d]=e.get(...e.indexToLoc(f*a+d))}return l}function fh(r,e,t){let n=Me(t,r.dtype);for(let o=0;o<n.size;++o){let i=n.indexToLoc(o).slice(),s=i[0],u=i[2],l=e.locToIndex([s,u]);i[2]=e.values[l];let c=r.locToIndex(i);n.values[o]=r.values[c]}return n}var C0=qe((r,e)=>r>e?1:0),sle=Qe(ai,C0,null,"bool"),EF={kernelName:ai,backendName:"cpu",kernelFunc:sle};var N0=qe((r,e)=>r>=e?1:0),ile=Qe(si,N0,null,"bool"),TF={kernelName:si,backendName:"cpu",kernelFunc:ile};var E0=qe((r,e)=>r<e?1:0),ule=Qe(ii,E0,null,"bool"),AF={kernelName:ii,backendName:"cpu",kernelFunc:ule};var T0=qe((r,e)=>r<=e?1:0),lle=Qe(ui,T0,null,"bool"),FF={kernelName:ui,backendName:"cpu",kernelFunc:lle};function dh(r,e,t){let n=(e-r)/(t-1),o=w.makeZerosTypedArray(t,"float32");o[0]=r;for(let a=1;a<o.length;a++)o[a]=o[a-1]+n;return o}var A0=Lr(r=>Math.log(r)),cle=Mn(li,A0),DF={kernelName:li,backendName:"cpu",kernelFunc:cle};function mh(r,e,t,n){let o=w.getTypedArrayFromDType(n,w.sizeFromShape(t));for(let a=0;a<o.length;++a){let i=a*e,s=r[i];for(let u=0;u<e;++u){let l=r[i+u];(Number.isNaN(l)||l>s)&&(s=l)}o[a]=s}return o}var F0=qe((r,e)=>Math.max(r,e)),ple=Qe(fi,F0),RF={kernelName:fi,backendName:"cpu",kernelFunc:ple};var D0=qe((r,e)=>Math.min(r,e)),fle=Qe(gi,D0),$F={kernelName:gi,backendName:"cpu",kernelFunc:fle};var zp=qe((r,e)=>r*e),dle=Ul((r,e,t,n)=>({real:r*t-e*n,imag:r*n+e*t})),su=Qe(zo,zp,dle),PF={kernelName:zo,backendName:"cpu",kernelFunc:su};function R0(r,e,t){let n=w.createScalarValue(-1,t);return zp([],e,n,r,t)}function mle(r){let{inputs:e,backend:t}=r,{x:n}=e;oe(n,"neg");let o=t.data.get(n.dataId).values,[a,i]=R0(o,n.shape,n.dtype);return t.makeTensorInfo(i,n.dtype,a)}var OF={kernelName:bl,backendName:"cpu",kernelFunc:mle};var $0=qe((r,e)=>r!==e?1:0),hle=Qe(xi,$0,null,"bool"),MF={kernelName:xi,backendName:"cpu",kernelFunc:hle};function jl(r,e,t,n,o){let a=e.length,i=w.sizeFromShape(e),s=w.computeStrides(e),u=w.computeStrides(o),l=w.getTypedArrayFromDType(t,w.sizeFromShape(o));for(let c=0;c<i;++c){let p=w.indexToLoc(c,a,s),f=new Array(p.length);for(let m=0;m<f.length;m++)f[m]=p[n[m]];let d=w.locToIndex(f,a,u);l[d]=r[c]}return l}function Jt(r){let{inputs:e,attrs:t,backend:n}=r,{x:o}=e,{perm:a}=t;oe(o,"transpose");let i=o.shape.length,s=new Array(i);for(let p=0;p<s.length;p++)s[p]=o.shape[a[p]];let u=n.data.get(o.dataId).values,l=jl(u,o.shape,o.dtype,a,s);return{dataId:n.write(l,s,o.dtype),shape:s,dtype:o.dtype}}var BF={kernelName:zi,backendName:"cpu",kernelFunc:Jt};function P0(r,e,t,n){let[o,a]=S.computeOutAndReduceShapes(r,n),i=ur(e,"int32"),s=w.makeZerosTypedArray(w.sizeFromShape(o),i),u=w.sizeFromShape(a);for(let l=0;l<s.length;++l){let c=l*u,p=1;for(let f=0;f<u;++f)p*=t[c+f];s[l]=p}return{outVals:s,outShape:o,outDtype:i}}function gle(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n;oe(o,"prod");let s=o.shape.length,u=w.parseAxisParam(a,o.shape),l=S.getAxesPermutation(u,s),c=u,p=o,f=[];l!=null&&(p=Jt({inputs:{x:o},backend:t,attrs:{perm:l}}),f.push(p),c=S.getInnerMostAxes(c.length,s));let d=t.data.get(p.dataId).values,{outVals:m,outShape:h,outDtype:g}=P0(p.shape,p.dtype,d,c),v=h;return i&&(v=S.expandShapeToKeepDim(h,u)),f.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.makeTensorInfo(v,g,m)}var LF={kernelName:Ii,backendName:"cpu",kernelFunc:gle};function iu(r,e,t,n){let o=r===e,a=r<e&&t<0,i=e<r&&t>1;if(o||a||i)return w.makeZerosTypedArray(0,n);let s=Math.abs(Math.ceil((e-r)/t)),u=w.makeZerosTypedArray(s,n);e<r&&t===1&&(t=-1),u[0]=r;for(let l=1;l<u.length;l++)u[l]=u[l-1]+t;return u}var O0=Lr(r=>1/Math.sqrt(r)),vle=Mn(Ti,O0),VF={kernelName:Ti,backendName:"cpu",kernelFunc:vle};var WF=Lr(r=>1/(1+Math.exp(-r))),M0=Oe(Ho,r=>1/(1+Math.exp(-r))),zF={kernelName:Ho,backendName:"cpu",kernelFunc:M0};function uu(r,e,t,n,o){let a=Tt.isSliceContinous(n,e,t),i=w.sizeFromShape(t),s=w.computeStrides(n);if(a){let p=Tt.computeFlatOffset(e,s);return o==="string"?r.slice(p,p+i):r.subarray(p,p+i)}let u=o==="string"?S.fromUint8ToStringArray(r):r,l=Me(n,o,u),c=Me(t,o);for(let p=0;p<c.size;++p){let f=c.indexToLoc(p),d=f.map((m,h)=>m+e[h]);c.set(l.get(...d),...f)}return o==="string"?S.fromStringArrayToUint8(c.values):c.values}function Bn(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{begin:a,size:i}=n;oe(o,"slice");let[s,u]=Tt.parseSliceParams(o,a,i);Tt.assertParamsValid(o,s,u);let l=t.data.get(o.dataId).values,c=uu(l,s,u,o.shape,o.dtype);return t.makeTensorInfo(u,o.dtype,c)}var UF={kernelName:Il,backendName:"cpu",kernelFunc:Bn};function hh(r,e,t,n,o,a,i){let s=e[0],u=a[0],l=new Array(u),c=new Array(s),p=e[1];if(u===0){if(s!==0)throw new Error(`Received SparseTensor with denseShape[0] = 0 but
         indices.shape[0] = ${s}`);let g=w.getArrayFromDType(t,0),v=w.getArrayFromDType(o,0);return[g,[0,p],v,l,c]}let f=!0,d=0,m=new Array(u).fill(0);for(let g=0;g<s;++g){let v=r[g*p];if(v<0)throw new Error(`indices(${g}, 0) is invalid: ${v} < 0`);if(v>=u)throw new Error(`indices(${g}, 0) is invalid: ${v} >= ${u}`);++m[v],f=f&&v>=d,d=v}let h=!0;for(let g=0;g<u;++g){let v=m[g]===0;l[g]=v,h=h&&!v,m[g]=Math.max(m[g],1),g>0&&(m[g]+=m[g-1])}if(h&&f){let g=r,v=n;for(let x=0;x<s;++x)c[x]=x;return[g,[s,p],v,l,c]}else{let g=m[u-1],v=w.getArrayFromDType(t,g*p),x=w.getArrayFromDType(o,g),y=new Array(u).fill(0);for(let b=0;b<s;++b){let k=r[b*p],N=y[k],E=(k===0?0:m[k-1])+N;y[k]++;for(let T=0;T<p;++T)v[E*p+T]=r[b*p+T];x[E]=n[b],c[b]=E}for(let b=0;b<u;++b)if(y[b]===0){let N=b===0?0:m[b-1];v[N*p+0]=b;for(let E=1;E<p;++E)v[N*p+E]=0;x[N]=i}return[v,[g,p],x,l,c]}}function gh(r,e,t,n,o){let a=w.sizeFromShape(n),i=e[0],s=o.length,u=[],l=1,c=-1;for(let g=0;g<s;++g){let v=o[g];if(v===-1){if(c!==-1)throw new Error(`only one output dimension may be -1, not both ${c} and ${g}`);c=g,u.push(1)}else{if(v<0)throw new Error(`size ${g} must be non-negative, not ${v}`);l*=v,u.push(v)}}if(c!==-1){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");let g=Math.trunc(a/l);if(l*g!==a)throw new Error(`Input to reshape is a SparseTensor with ${a}
          dense values, but the requested shape requires a multiple of ${l}. inputShape=${n} outputShape= ${u}`);u[c]=g}let p=w.sizeFromShape(u);if(p!==a)throw new Error(`Input to reshape is a tensor with ${a} dense values, but the requested shape has ${p}. inputShape=${n} outputShape=${u}`);let f=n.length,d=[];if(f>0){d[f-1]=1;for(let g=f-2;g>=0;--g)d[g]=d[g+1]*n[g+1]}let m=[];if(s>0){m[s-1]=1;for(let g=s-2;g>=0;--g)m[g]=m[g+1]*u[g+1]}let h=w.getArrayFromDType(t,i*s);for(let g=0;g<i;++g){let v=0;for(let x=0;x<f;++x)v+=r[g*f+x]*d[x];for(let x=0;x<s;++x)h[g*s+x]=Math.trunc(v/m[x]),v%=m[x]}return[h,[i,s],u]}function Hl(r,e,t,n,o,a=!1,i=0){let s=n.length;if(s!==o.length)throw new Error("segmentIds and indices should have same size.");let u=[e[0],r.length/e[0]],l=u[1],p=s>0?o[s-1]+1:0;if(p<0)throw new Error("segment ids must be >= 0");let f=e.slice();f[0]=p;let d=f.reduce((y,b)=>y*b,1),m=w.getArrayFromDType(t,d);if(s===0)return p>0&&m.fill(i),[m,f];if(p<=0)throw new Error("segment ids must be >= 0");let h=0,g=1,v=0,x=o[h];for(;;){let y=0;if(g<s){if(y=o[g],x===y){++g;continue}if(x>=y)throw new Error("segment ids are not increasing")}if(x<0||x>=p)throw new Error(`Segment id ${x} out of range [0, ${p}), possibly because segmentIds input is not sorted.`);x>v&&m.fill(i,v*l,x*l);for(let b=h;b<g;++b){let k=n[b];if(k<0||k>=u[0])throw new Error(`Bad: indices[${b}] == ${n[b]} out of range [0, ${u[0]})`);for(let N=0;N<l;N++)m[x*l+N]+=r[k*l+N]}if(a)for(let b=0;b<l;b++)m[x*l+b]/=g-h;if(h=g,++g,v=x+1,x=y,g>s)break}return v<p&&m.fill(i,v*l,p*l),[m,f]}var GF=Lr(r=>Math.sqrt(r)),xle=Oe(Di,r=>Math.sqrt(r)),jF={kernelName:Di,backendName:"cpu",kernelFunc:xle};var B0=qe((r,e)=>{let t=r-e;return t*t}),yle=Qe($i,B0),HF={kernelName:$i,backendName:"cpu",kernelFunc:yle};function vh(r,e,t,n){let o=Me(r,e.dtype);for(let a=0;a<o.size;a++){let i=o.indexToLoc(a),s=new Array(i.length);for(let u=0;u<s.length;u++)s[u]=i[u]*t[u]+n[u];o.set(e.get(...s),...i)}return o}var qF=class{constructor(e,t,n,o,a,i){this.separator=w.encodeString(e),this.nGramWidths=t,this.leftPad=w.encodeString(n),this.rightPad=w.encodeString(o),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,o,a,i){for(let s=0;s<a;++s){let u=this.getPadWidth(i),l=Math.max(0,u-s),c=Math.max(0,u-(a-(s+1))),p=i-(l+c),f=t+(l>0?0:s-u),d=0;d+=l*this.leftPad.length;for(let x=0;x<p;++x)d+=e[f+x].length;d+=c*this.rightPad.length,d+=(l+c+p-1)*this.separator.length,n[o+s]=new Uint8Array(d);let h=n[o+s],g=0,v=x=>x.forEach(y=>h[g++]=y);for(let x=0;x<l;++x)v(this.leftPad),v(this.separator);for(let x=0;x<p-1;++x)v(e[f+x]),v(this.separator);if(p>0){v(e[f+p-1]);for(let x=0;x<c;++x)v(this.separator),v(this.rightPad)}else{for(let x=0;x<c-1;++x)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(e,t){let n=e.length,o=t.length;if(o>0){let u=t[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let l=1;l<o;++l){let c=t[l]>=u;if(c=c&&t[l]<=n,!c)throw new Error(`Invalid split value ${t[l]}, must be in [${u}, ${n}]`);u=t[l]}if(u!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${u}`)}let a=o-1,i=w.getArrayFromDType("int32",o);if(n===0||o===0){let u=new Array(n);for(let l=0;l<=a;++l)i[l]=0;return[u,i]}i[0]=0;for(let u=1;u<=a;++u){let l=t[u]-t[u-1],c=0;this.nGramWidths.forEach(p=>{c+=this.getNumNGrams(l,p)}),this.preserveShort&&l>0&&c===0&&(c=1),i[u]=i[u-1]+c}let s=new Array(i[a]);for(let u=0;u<a;++u){let l=t[u],c=i[u];if(this.nGramWidths.forEach(p=>{let f=t[u+1]-t[u],d=this.getNumNGrams(f,p);this.createNGrams(e,l,s,c,d,p),c+=d}),this.preserveShort&&c===i[u]){let p=t[u+1]-t[u];if(p===0)continue;let f=p+2*this.padWidth,d=1;this.createNGrams(e,l,s,c,d,f)}}return[s,i]}};function xh(r,e,t,n,o,a,i,s){return new qF(t,n,o,a,i,s).compute(r,e)}function ble(r,e,t,n){if(!r.length)return;if(e.length===0){for(let a=0;a<r.length;++a)n.push(r.subarray(a,a+1));return}if(e.length===1){let a=e[0],i=r.indexOf(a);for(;i!==-1;){let s=r.subarray(0,i);(!t||s.length!==0)&&n.push(s),r=r.subarray(i+1),i=r.indexOf(a)}(!t||r.length!==0)&&n.push(r);return}let o=0;for(let a=0;a<r.length+1;a++)if(a===r.length||e.indexOf(r[a])!==-1){let i=r.subarray(o,a);(!t||i.length!==0)&&n.push(i),o=a+1}}function yh(r,e,t){let n=r.length,o=[],a=0,i=0,s=new Array(n);for(let f=0;f<n;++f){let d=o.length;ble(r[f],e,t,o);let m=o.length-d;s[f]=m,a+=m,i=Math.max(i,m)}let u=w.getArrayFromDType("int32",a*2),l=new Array(a),c=[n,i],p=0;for(let f=0;f<n;++f)for(let d=0;d<s[f];++d)u[p*2]=f,u[p*2+1]=d,l[p]=o[p],++p;return[u,l,c]}function bh(r,e){let t=w.getArrayFromDType("int32",r.length);for(let n=0;n<r.length;++n)t[n]=w.fingerPrint64(r[n]).modulo(e).getLowBitsUnsigned();return t}var L0=qe((r,e)=>r-e),wle=Ul((r,e,t,n)=>({real:r-t,imag:e-n})),Up=Qe(Oi,L0,wle),KF={kernelName:Oi,backendName:"cpu",kernelFunc:Up};function wh(r,e){let t=new Array(r.rank);for(let o=0;o<t.length;o++)t[o]=r.shape[o]*e[o];let n=Me(t,r.dtype);for(let o=0;o<n.values.length;++o){let a=n.indexToLoc(o),i=new Array(r.rank);for(let u=0;u<i.length;u++)i[u]=a[u]%r.shape[u];let s=r.locToIndex(i);n.values[o]=r.values[s]}return n}var Gp=(r,e)=>{let t=e.value-r.value;return t===0?r.index-e.index:t};function XF(r,e,t=0,n=r.length-1){for(;n>t;){if(n-t>600){let s=n-t+1,u=e-t+1,l=Math.log(s),c=.5*Math.exp(2*l/3),p=.5*Math.sqrt(l*c*(s-c)/s)*Math.sign(u-s/2),f=Math.max(t,Math.floor(e-u*c/s+p)),d=Math.min(n,Math.floor(e+(s-u)*c/s+p));XF(r,e,f,d)}let o=r[e],a=t,i=n;for(w.swap(r,t,e),Gp(r[n],o)>0&&w.swap(r,t,n);a<i;){for(w.swap(r,a,i),a++,i--;Gp(r[a],o)<0;)a=a+1;for(;Gp(r[i],o)>0;)i=i-1}Gp(r[t],o)===0?w.swap(r,t,i):(i=i+1,w.swap(r,i,n)),i<=e&&(t=i+1),e<=i&&(n=i-1)}}function kh(r,e,t,n,o){let a=e[e.length-1],[i,s]=[r.length/a,a],u=w.getTypedArrayFromDType(t,i*n),l=w.getTypedArrayFromDType("int32",i*n);for(let p=0;p<i;p++){let f=p*s,d=r.subarray(f,f+s),m=new Array(d.length);d.forEach((x,y)=>m[y]={value:x,index:y}),n<m.length&&(XF(m,n),m=m.slice(0,n)),o&&m.sort(Gp);let h=p*n,g=u.subarray(h,h+n),v=l.subarray(h,h+n);for(let x=0;x<n;x++)g[x]=m[x].value,v[x]=m[x].index}let c=e.slice();return c[c.length-1]=n,[Me(c,t,u),Me(c,"int32",l)]}function _h(r,e,t,n){let o=w.parseAxisParam(e,t)[0],a=[1,t[0],1];for(let m=0;m<o;m++)a[0]*=t[m];a[1]=t[o];for(let m=o+1;m<t.length;m++)a[2]*=t[m];let i={},s=new Int32Array(t[o]),u=new mt(a,n,r),l=[],c=a[0]===1&&a[2]===1;for(let m=0;m<t[o];m++){let h;if(c)h=r[m].toString();else{let g=[];for(let v=0;v<a[0];v++)for(let x=0;x<a[2];x++)g.push(u.get(v,m,x));h=g.join(",")}if(i[h]!==void 0)s[m]=i[h];else{let g=Object.keys(i).length;i[h]=g,s[m]=g,l.push(m)}}let p=a.slice();p[1]=Object.keys(i).length;let f=new mt(p,n);l.forEach((m,h)=>{for(let g=0;g<a[0];g++)for(let v=0;v<a[2];v++)f.set(u.get(g,m,v),g,h,v)});let d=t.slice();return d[o]=p[1],{outputValues:f.values,outputShape:d,indices:s}}function Qo(r){let{inputs:{x:e},attrs:{begin:t,size:n},backend:o}=r,[a,i]=Tt.parseSliceParams(e,t,n),s=Tt.isSliceContinous(e.shape,a,i),u=o.readSync(e.dataId),l=o.makeOutput(i,e.dtype),c=w.computeStrides(e.shape),p=o.dataIdMap.get(l.dataId);if(s){let m=Tt.computeFlatOffset(a,c);return e.dtype==="string"?p.stringBytes=u.slice(m,m+w.sizeFromShape(i)):o.typedArrayFromHeap(l).set(u.subarray(m,m+w.sizeFromShape(i))),l}if(e.dtype==="string"){let m=uu(u,a,i,e.shape,e.dtype);return p.stringBytes=m,l}let f=o.typedArrayFromHeap(l),d=e.shape.length;if(d===2)kle(u,c[0],f,a,i);else if(d===3)_le(u,c[0],c[1],f,a,i);else if(d===4)Sle(u,c[0],c[1],c[2],f,a,i);else{let m=uu(u,a,i,e.shape,e.dtype);f.set(m)}return l}function kle(r,e,t,n,o){let a=0,i=n[0],s=n[1],u=i+o[0];for(let l=i;l<u;l++){let c=l*e+s;t.set(r.subarray(c,c+o[1]),a),a+=o[1]}}function _le(r,e,t,n,o,a){let i=0,s=o[0],u=o[1],l=o[2],c=s+a[0],p=u+a[1];for(let f=s;f<c;f++)for(let d=u;d<p;d++){let m=f*e+d*t+l;n.set(r.subarray(m,m+a[2]),i),i+=a[2]}}function Sle(r,e,t,n,o,a,i){let s=0,u=a[0],l=a[1],c=a[2],p=u+i[0],f=l+i[1],d=c+i[2],m=a[3];for(let h=u;h<p;h++)for(let g=l;g<f;g++)for(let v=c;v<d;v++){let x=h*e+g*t+v*n+m;o.set(r.subarray(x,x+i[3]),s),s+=i[3]}}var YF={kernelName:Il,backendName:"wasm",kernelFunc:Qo};function Ile(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockShape:a,crops:i}=n,s=a.reduce((v,x)=>v*x),u=S.getReshaped(o.shape,a,s),l=S.getPermuted(u.length,a.length),c=S.getReshapedPermuted(o.shape,a,s),p=S.getSliceBeginCoords(i,a.length),f=S.getSliceSize(c,i,a.length),d=or({inputs:{x:o},backend:t,attrs:{shape:u}}),m=mo({inputs:{x:d},backend:t,attrs:{perm:l}}),h=or({inputs:{x:m},backend:t,attrs:{shape:c}}),g=Qo({inputs:{x:h},backend:t,attrs:{begin:p,size:f}});return t.disposeData(d.dataId),t.disposeData(m.dataId),t.disposeData(d.dataId),g}var ZF={kernelName:ml,backendName:"wasm",kernelFunc:Ile};function ea(r){let{inputs:{x:e},attrs:{dtype:t},backend:n}=r,o=n.makeOutput(e.shape,t),a=n.typedArrayFromHeap(e);return n.typedArrayFromHeap(o).set(a),o}var JF={kernelName:uo,backendName:"wasm",kernelFunc:ea};var QF=nt(zs);var eD;function Cle(r){eD=r.wasm.cwrap($a,null,["number","number","number","number"])}function Nle(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{clipValueMin:a,clipValueMax:i}=n,s=t.dataIdMap.get(o.dataId).id,u=t.makeOutput(o.shape,o.dtype),l=t.dataIdMap.get(u.dataId).id;return eD(s,a,i,l),u}var tD={kernelName:$a,backendName:"wasm",setupFunc:Cle,kernelFunc:Nle};function W0(r){let{inputs:e,backend:t}=r,n=w.parseAxisParam(r.attrs.axis,e[0].shape)[0],o=S.computeOutShape(e.map(d=>d.shape),n),a=e.filter(d=>w.sizeFromShape(d.shape)>0);if(a.length===1)return ou({inputs:{x:a[0]},backend:t});let i=t.makeOutput(o,e[0].dtype);if(w.sizeFromShape(o)===0)return i;let s=a.map(d=>d.shape);if(S.assertParamsConsistent(s,n),a[0].dtype==="string"){let d=a.map(y=>{let b=w.sizeFromShape(y.shape.slice(n));return or({inputs:{x:y},backend:t,attrs:{shape:[-1,b]}})}),m=d.map(y=>({vals:t.readSync(y.dataId),shape:y.shape}));o=S.computeOutShape(d.map(y=>y.shape),1);let h=d[0].shape[0]===1,g=au(m,o,e[0].dtype,h),v=S.computeOutShape(a.map(y=>y.shape),n);i.shape=v;let x=t.dataIdMap.get(i.dataId);return x.stringBytes=S.fromStringArrayToUint8(g),d.forEach(y=>t.disposeData(y.dataId)),i}let u=w.sizeFromShape(a[0].shape.slice(0,n)),l=0,c=a.map(d=>{let m=w.sizeFromShape(d.shape.slice(n));return l+=m,m}),p=a.map(d=>t.typedArrayFromHeap(d)),f=t.typedArrayFromHeap(i);for(let d=0;d<u;d++){let m=d*l;for(let h=0;h<p.length;h++){let g=c[h],v=d*g,x=p[h].subarray(v,v+g);f.set(x,m),m+=g}}return i}var rD={kernelName:gl,backendName:"wasm",kernelFunc:W0};var nD;function Ele(r){nD=r.wasm.cwrap(Us,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Tle(r){let{inputs:e,attrs:t,backend:n}=r,{x:o,filter:a}=e,i=n.dataIdMap.get(o.dataId).id,s=n.dataIdMap.get(a.dataId).id,{strides:u,dilations:l,pad:c,dimRoundingMode:p,dataFormat:f}=t,d=S.convertConv2DDataFormat(f),m=S.computeConv2DInfo(o.shape,a.shape,u,l,c,p,!1,d),h=m.filterHeight,g=m.filterWidth,v=m.padInfo.top,x=m.padInfo.right,y=m.padInfo.bottom,b=m.padInfo.left,k=m.dilationHeight,N=m.dilationWidth,E=m.strideHeight,T=m.strideWidth,R=m.inChannels,$=m.outChannels,O=m.padInfo.type==="SAME"?1:0;if(m.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${m.dataFormat}'. Please use 'channelsLast'.`);let M=n.makeOutput(m.outShape,"float32"),B=n.dataIdMap.get(M.dataId).id;return nD(i,o.shape[0],o.shape[1],o.shape[2],s,h,g,v,x,y,b,O,k,N,E,T,R,$,B),M}var oD={kernelName:Us,backendName:"wasm",setupFunc:Ele,kernelFunc:Tle};var aD;function Ale(r){aD=r.wasm.cwrap(Gs,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Fle(r){let{backend:e,inputs:t,attrs:n}=r,{dy:o,filter:a}=t,{strides:i,pad:s,dataFormat:u,dimRoundingMode:l,inputShape:c}=n,p=1,f=S.convertConv2DDataFormat(u),d=S.computeConv2DInfo(c,a.shape,i,p,s,l,!1,f),{batchSize:m,filterHeight:h,filterWidth:g,inChannels:v,inHeight:x,inWidth:y,outChannels:b,outHeight:k,outWidth:N,strideHeight:E,strideWidth:T}=d,R=h-1-d.padInfo.top,$=g-1-d.padInfo.left,O=d.dataFormat==="channelsLast",M=w.computeStrides(d.inShape),B=w.computeStrides(o.shape),[L,H,W]=w.computeStrides(a.shape),K=M[0],J=O?M[1]:M[2],Q=O?M[2]:1,ee=O?1:M[1],Y=B[0],ne=O?B[1]:B[2],te=O?B[2]:1,ce=O?1:B[1],pe=e.makeOutput(d.inShape,"float32"),se=e.dataIdMap.get(pe.dataId).id,fe=e.dataIdMap.get(o.dataId).id,ye=e.dataIdMap.get(a.dataId).id;return aD(fe,ye,m,h,g,x,y,v,k,N,b,E,T,R,$,L,H,W,K,J,Q,ee,Y,ne,te,ce,se),pe}var sD={kernelName:Gs,backendName:"wasm",setupFunc:Ale,kernelFunc:Fle};var iD=nt(js);var uD=nt(Hs);var z0;(function(r){r[r.bilinear=0]="bilinear",r[r.nearest=1]="nearest"})(z0||(z0={}));var lD;function Dle(r){lD=r.wasm.cwrap(Ks,null,["number","number","number","number","array","number","number","number","number","number"])}function Rle(r){let{backend:e,inputs:t,attrs:n}=r,{method:o,extrapolationValue:a,cropSize:i}=n,{image:s,boxes:u,boxInd:l}=t,c=u.shape[0],[p,f]=i,d=[c,p,f,s.shape[3]],m=e.dataIdMap.get(s.dataId),h;s.dtype!=="float32"&&(h=ea({backend:e,inputs:{x:s},attrs:{dtype:"float32"}}),m=e.dataIdMap.get(h.dataId));let g=m.id,v=e.dataIdMap.get(u.dataId).id,x=e.dataIdMap.get(l.dataId).id,y=e.makeOutput(d,"float32"),b=e.dataIdMap.get(y.dataId).id,k=new Uint8Array(new Int32Array(s.shape).buffer);return lD(g,v,x,c,k,p,f,z0[o],a,b),h!=null&&e.disposeData(h.dataId),y}var cD={kernelName:Ks,backendName:"wasm",setupFunc:Dle,kernelFunc:Rle};var pD;function $le(r){pD=r.wasm.cwrap(qs,null,["number","number","number","number","number","number"])}function Ple(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,exclusive:i,reverse:s}=n,u=o.shape.length;w.assert(o.dtype==="float32"||o.dtype==="int32",()=>`cumsum does not support ${o.dtype} tensors in the WASM backend`);let l=S.getAxesPermutation([a],u),c=o;l!==null&&(c=mo({inputs:{x:o},attrs:{perm:l},backend:t}));let p=S.getInnerMostAxes(1,u)[0];S.assertAxesAreInnerMostDims("cumsum",[p],u);let f=t.makeOutput(c.shape,c.dtype),d=c.shape[p],m=t.dataIdMap.get(c.dataId).id,h=t.dataIdMap.get(f.dataId).id;pD(m,i?1:0,s?1:0,d,h,Ye[o.dtype]);let g=f;if(l!==null){let v=S.getUndoAxesPermutation(l);g=mo({inputs:{x:f},attrs:{perm:v},backend:t}),t.disposeData(c.dataId),t.disposeData(f.dataId)}return g}var fD={kernelName:qs,backendName:"wasm",setupFunc:$le,kernelFunc:Ple};var dD;function Ole(r){dD=r.wasm.cwrap(Xs,null,["number","number","number","array","number","array","array","number","number"])}function Mle(r){let{backend:e,inputs:t,attrs:n}=r,{x:o}=t,{blockSize:a,dataFormat:i}=n,s=o.shape[0],u=i==="NHWC"?o.shape[1]:o.shape[2],l=i==="NHWC"?o.shape[2]:o.shape[3],c=i==="NHWC"?o.shape[3]:o.shape[1],p=u*a,f=l*a,d=c/(a*a),m=i==="NHWC"?[s,p,f,d]:[s,d,p,f],h=e.makeOutput(m,"float32"),v=e.dataIdMap.get(o.dataId).id,x=new Uint8Array(new Int32Array(w.computeStrides(o.shape)).buffer),y=new Uint8Array(new Int32Array(m).buffer),b=new Uint8Array(new Int32Array(w.computeStrides(m)).buffer),k=e.dataIdMap.get(h.dataId).id;return dD(v,a,i==="NHWC"?1:0,x,o.shape.length-1,y,b,m.length,k),h}var mD={kernelName:Xs,backendName:"wasm",setupFunc:Ole,kernelFunc:Mle};var hD;function Ble(r){hD=r.wasm.cwrap(Ys,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Lle(r){let{inputs:e,attrs:t,backend:n}=r,{x:o,filter:a}=e,i=n.dataIdMap.get(o.dataId).id,s=n.dataIdMap.get(a.dataId).id,{strides:u,dilations:l,pad:c,dimRoundingMode:p}=t,f=l==null?[1,1]:l,d=S.computeConv2DInfo(o.shape,a.shape,u,f,c,p,!0),m=d.filterHeight,h=d.filterWidth,g=d.padInfo.top,v=d.padInfo.right,x=d.padInfo.bottom,y=d.padInfo.left,b=d.dilationHeight,k=d.dilationWidth,N=d.strideHeight,E=d.strideWidth,T=d.inChannels,R=d.outChannels,$=d.padInfo.type==="SAME"?1:0;if(d.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${d.dataFormat}'. Please use 'channelsLast'.`);let O=n.makeOutput(d.outShape,"float32"),M=n.dataIdMap.get(O.dataId).id;return hD(i,o.shape[0],o.shape[1],o.shape[2],s,m,h,g,v,x,y,$,b,k,N,E,T,R,M),O}var gD={kernelName:Ys,backendName:"wasm",setupFunc:Ble,kernelFunc:Lle};var vD=nt(Vo);var Vle=!1,xD=pt(Js,Vle,"bool");var yD=nt(Qs,"float32");function Sh(r){let{inputs:e,attrs:t,backend:n}=r,{input:o}=e,{dim:a}=t,i=o.shape.length,s=o.shape.slice(),u=a;return a<0&&(w.assert(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+a+1),s.splice(u,0,1),or({inputs:{x:o},backend:n,attrs:{shape:s}})}var bD={kernelName:vl,backendName:"wasm",kernelFunc:Sh};function U0(r){let{attrs:{shape:e,value:t,dtype:n},backend:o}=r,a=o.makeOutput(e,n);return o.typedArrayFromHeap(a).fill(t),a}var wD={kernelName:xl,backendName:"wasm",kernelFunc:U0};var kD;function Wle(r){kD=r.wasm.cwrap(ei,null,["number","number","number","number","number","number"])}function zle(r){let{inputs:e,backend:t}=r,{image:n}=e,o=t.makeOutput(n.shape,n.dtype),a=t.dataIdMap.get(n.dataId).id,i=t.dataIdMap.get(o.dataId).id,[s,u,l,c]=n.shape;return kD(a,s,u,l,c,i),o}var _D={kernelName:ei,backendName:"wasm",kernelFunc:zle,setupFunc:Wle};var SD=nt(ti);var Ule=!1,ID=pt(ri,Ule);var CD;function Gle(r){CD=r.wasm.cwrap(ni,null,["number","number","number","number","number","number","number"])}function jle(r){let{backend:e,inputs:t,attrs:n}=r,{varianceEpsilon:o}=n,{x:a,mean:i,variance:s,offset:u,scale:l}=t,c=e.dataIdMap.get(a.dataId).id,p=e.dataIdMap.get(i.dataId).id,f=e.dataIdMap.get(s.dataId).id,d=u!=null?e.dataIdMap.get(u.dataId).id:0,m=l!=null?e.dataIdMap.get(l.dataId).id:0,h=e.makeOutput(a.shape,a.dtype);if(w.sizeFromShape(a.shape)===0)return h;let g=e.dataIdMap.get(h.dataId).id;return CD(c,p,f,d,m,o,g),h}var ND={kernelName:ni,backendName:"wasm",setupFunc:Gle,kernelFunc:jle};var ED;function Hle(r){ED=r.wasm.cwrap(ji,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function qle(r){let{inputs:e,attrs:t,backend:n}=r,{x:o,filter:a,bias:i,preluActivationWeights:s}=e,{strides:u,pad:l,dilations:c,dataFormat:p,dimRoundingMode:f,activation:d,leakyreluAlpha:m}=t,h=S.computeConv2DInfo(o.shape,a.shape,u,c,l,f),g=La[d];if(g==null)throw new Error(`${d} activation not yet supported for FusedConv2D in the wasm backend.`);let v=n.dataIdMap.get(o.dataId).id,x=n.dataIdMap.get(a.dataId).id,y=h.outChannels,b=0;if(i!=null){let te=n.dataIdMap.get(i.dataId);if(te.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${te.shape.length}.`);if(te.shape[0]!==y)throw new Error(`FusedConv2D bias shape (${te.shape}) does not match the number of output channels (${y})`);b=te.id}let k=h.filterHeight,N=h.filterWidth,E=h.padInfo.top,T=h.padInfo.right,R=h.padInfo.bottom,$=h.padInfo.left,O=h.dilationHeight,M=h.dilationWidth,B=h.strideHeight,L=h.strideWidth,H=h.inChannels,W=h.padInfo.type==="SAME"?1:0,K=h.batchSize,J=h.inHeight,Q=h.inWidth;if(p!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${p}'. Please use 'NHWC'.`);let ee=n.makeOutput(h.outShape,"float32"),Y=n.dataIdMap.get(ee.dataId).id,ne=s==null?0:n.dataIdMap.get(s.dataId).id;return ED(v,K,J,Q,x,k,N,b,E,T,R,$,W,O,M,B,L,H,y,g,ne,m||0,Y),ee}var TD={kernelName:ji,backendName:"wasm",setupFunc:Hle,kernelFunc:qle};var AD;function Kle(r){AD=r.wasm.cwrap(Hi,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Xle(r){let{inputs:e,attrs:t,backend:n}=r,{x:o,filter:a,bias:i,preluActivationWeights:s}=e,{strides:u,pad:l,dilations:c,dataFormat:p,dimRoundingMode:f,activation:d,leakyreluAlpha:m}=t,h=S.computeConv2DInfo(o.shape,a.shape,u,c,l,f,!0),g=La[d];if(g==null)throw new Error(`${d} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);let v=n.dataIdMap.get(o.dataId).id,x=n.dataIdMap.get(a.dataId).id,y=h.outChannels,b=0;if(i!=null){let te=n.dataIdMap.get(i.dataId);if(te.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${te.shape.length}.`);if(te.shape[0]!==y)throw new Error(`FusedDepthwiseConv2D bias shape (${te.shape}) does not match the number of output channels (${y})`);b=te.id}let k=h.filterHeight,N=h.filterWidth,E=h.padInfo.top,T=h.padInfo.right,R=h.padInfo.bottom,$=h.padInfo.left,O=h.dilationHeight,M=h.dilationWidth,B=h.strideHeight,L=h.strideWidth,H=h.inChannels,W=h.padInfo.type==="SAME"?1:0,K=h.batchSize,J=h.inHeight,Q=h.inWidth;if(p!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${p}'. Please use 'NHWC'.`);let ee=n.makeOutput(h.outShape,"float32"),Y=n.dataIdMap.get(ee.dataId).id,ne=s==null?0:n.dataIdMap.get(s.dataId).id;return AD(v,K,J,Q,x,k,N,b,E,T,R,$,W,O,M,B,L,H,y,g,ne,m||0,Y),ee}var FD={kernelName:Hi,backendName:"wasm",setupFunc:Kle,kernelFunc:Xle};var DD;function Yle(r){DD=r.wasm.cwrap(oi,null,["number","number","number","number","number","number","array","number"])}function Zle(r){let{backend:e,inputs:t}=r,{params:n,indices:o}=t,[a,i,s,u]=ah.prepareAndValidate(n,o),l=e.makeOutput(a,n.dtype);if(i===0)return l;let c=o.shape,p=c[c.length-1],d=e.dataIdMap.get(n.dataId).id,h=e.dataIdMap.get(o.dataId).id,g=new Uint8Array(new Int32Array(u).buffer),v=e.dataIdMap.get(l.dataId).id;return DD(d,Ye[n.dtype],h,i,p,s,g,v),l}var RD={kernelName:oi,backendName:"wasm",setupFunc:Yle,kernelFunc:Zle};var $D;function Jle(r){$D=r.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function Qle(r){let{backend:e,inputs:t,attrs:n}=r,{x:o,indices:a}=t,{axis:i,batchDims:s}=n,u=w.parseAxisParam(i,o.shape)[0],l=e.readSync(a.dataId),c=o.shape[u];for(let R=0;R<l.length;++R){let $=l[R];w.assert($<=c-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${c-1}]`)}let p=S.segment_util.collectGatherOpShapeInfo(o,a,u,s),f=or({inputs:{x:o},attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]},backend:e}),d=w.sizeFromShape(a.shape),m=or({inputs:{x:a},attrs:{shape:[p.batchSize,d/p.batchSize]},backend:e}),h=[p.batchSize,p.outerSize,d/p.batchSize,p.sliceSize],g=e.makeOutput(h,o.dtype);if(w.sizeFromShape(o.shape)===0)return g;let v=f.shape.length-1,y=e.dataIdMap.get(f.dataId).id,k=e.dataIdMap.get(m.dataId).id,N=e.dataIdMap.get(g.dataId).id,E=new Uint8Array(new Int32Array(w.computeStrides(f.shape)).buffer),T=new Uint8Array(new Int32Array(w.computeStrides(h)).buffer);return $D(y,Ye[o.dtype],E,v,k,p.batchSize,T,N),e.disposeData(f.dataId),e.disposeData(m.dataId),g.shape=p.outputShape,g}var PD={kernelName:yl,backendName:"wasm",setupFunc:Jle,kernelFunc:Qle};var ece=!1,OD=pt(ai,ece,"bool");var tce=!1,MD=pt(si,tce,"bool");var BD;function rce(r){BD=r.wasm.cwrap(Wo,null,["number","number","number","number"])}function nce(r){let{inputs:{x:e},attrs:{alpha:t},backend:n}=r,o=n.dataIdMap.get(e.dataId).id,a=n.makeOutput(e.shape,"float32");if(w.sizeFromShape(e.shape)!==0){let i=n.dataIdMap.get(a.dataId).id;BD(o,Ye[e.dtype],t,i)}return a}var LD={kernelName:Wo,backendName:"wasm",setupFunc:rce,kernelFunc:nce};var oce=!1,VD=pt(ii,oce,"bool");var ace=!1,WD=pt(ui,ace,"bool");var zD=nt(li);var sce=!1,UD=pt(ci,sce,"bool");var GD;function ice(r){GD=r.wasm.cwrap(pi,null,["number","number","number","number"])}function uce(r){let{backend:e,inputs:t,attrs:n}=r,{reductionIndices:o,keepDims:a}=n,{x:i}=t,u=e.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e);if(d){let y=e.dataIdMap.get(c.dataId).id;l=c,u=y}let m=l.shape.length;S.assertAxesAreInnerMostDims("max",p,m);let[h,g]=S.computeOutAndReduceShapes(l.shape,p),v=w.sizeFromShape(g),x=e.makeOutput(h,i.dtype);if(w.sizeFromShape(l.shape)!==0){let y=e.dataIdMap.get(x.dataId).id;GD(u,Ye[i.dtype],v,y)}if(d&&e.disposeData(c.dataId),a){let y=S.expandShapeToKeepDim(x.shape,f);x.shape=y}return x}var jD={kernelName:pi,backendName:"wasm",setupFunc:ice,kernelFunc:uce};var lce=!1,HD=pt(fi,lce);var qD;function cce(r){qD=r.wasm.cwrap(di,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function pce(r){let{inputs:e,attrs:t,backend:n}=r,o=e.x,a=n.dataIdMap.get(o.dataId).id;w.assert(o.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${o.dtype}.`);let{filterSize:i,strides:s,pad:u,dimRoundingMode:l}=t,c=S.computePool2DInfo(o.shape,i,s,1,u,l),p=c.filterHeight,f=c.filterWidth,d=c.padInfo.top,m=c.padInfo.right,h=c.padInfo.bottom,g=c.padInfo.left,v=c.dilationHeight,x=c.dilationWidth,y=c.strideHeight,b=c.strideWidth,k=c.inChannels,N=c.outChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);let E=n.makeOutput(c.outShape,"float32"),T=n.dataIdMap.get(E.dataId).id;return qD(a,o.shape[0],o.shape[1],o.shape[2],p,f,d,m,h,g,v,x,y,b,k,N,T),E}var KD={kernelName:di,backendName:"wasm",setupFunc:cce,kernelFunc:pce};var XD;function fce(r){XD=r.wasm.cwrap(mi,null,["number, number, number"])}function dce(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o,keepDims:a}=n,{x:i}=t,s=e.dataIdMap.get(i.dataId).id,u=s,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e),m=p;if(d){let b=e.dataIdMap.get(c.dataId).id;b!==s&&(l=c,u=b,m=S.getInnerMostAxes(m.length,l.shape.length))}S.assertAxesAreInnerMostDims("mean",m,l.shape.length);let[h,g]=S.computeOutAndReduceShapes(l.shape,m),v=w.sizeFromShape(g),x=l;l.dtype!=="float32"&&(x=ea({backend:e,inputs:{x:l},attrs:{dtype:"float32"}}),u=e.dataIdMap.get(x.dataId).id);let y=e.makeOutput(h,"float32");if(w.sizeFromShape(l.shape)!==0){let b=e.dataIdMap.get(y.dataId).id;XD(u,v,b)}if(d&&e.disposeData(c.dataId),a){let b=S.expandShapeToKeepDim(y.shape,f);y.shape=b}return l.dtype!=="float32"&&e.disposeData(x.dataId),y}var YD={kernelName:mi,backendName:"wasm",setupFunc:fce,kernelFunc:dce};var ZD;function mce(r){ZD=r.wasm.cwrap(hi,null,["number","number","number","number"])}function hce(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o,keepDims:a}=n,{x:i}=t,s=e.dataIdMap.get(i.dataId).id,u=s,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e);if(d){let y=e.dataIdMap.get(c.dataId).id;y!==s&&(l=c,u=y)}let m=l.shape.length;S.assertAxesAreInnerMostDims("min",p,m);let[h,g]=S.computeOutAndReduceShapes(l.shape,p),v=w.sizeFromShape(g),x=e.makeOutput(h,l.dtype);if(w.sizeFromShape(l.shape)!==0){let y=e.dataIdMap.get(x.dataId).id;ZD(u,Ye[i.dtype],v,y)}if(d&&e.disposeData(c.dataId),a){let y=S.expandShapeToKeepDim(x.shape,f);x.shape=y}return x}var JD={kernelName:hi,backendName:"wasm",setupFunc:mce,kernelFunc:hce};var gce=!1,QD=pt(gi,gce);var G0;(function(r){r[r.reflect=0]="reflect",r[r.symmetric=1]="symmetric"})(G0||(G0={}));var eR;function vce(r){eR=r.wasm.cwrap(vi,null,["number","array","number","number","array","array","number","number"])}function xce(r){let{inputs:{x:e},backend:t,attrs:{paddings:n,mode:o}}=r,a=n.map((m,h)=>m[0]+e.shape[h]+m[1]),i=t.dataIdMap.get(e.dataId).id,s=t.makeOutput(a,e.dtype),u=t.dataIdMap.get(s.dataId).id,l=new Uint8Array(new Int32Array(e.shape).buffer),c=n.map(m=>m[0]),p=n.map(m=>m[1]),f=new Uint8Array(new Int32Array(c).buffer),d=new Uint8Array(new Int32Array(p).buffer);return eR(i,l,e.shape.length,Ye[e.dtype],f,d,G0[o],u),s}var tR={kernelName:vi,backendName:"wasm",kernelFunc:xce,setupFunc:vce};var yce=!0,rR=pt(zo,yce);var nR=nt(bl);function ql(r,e){let t=new Int32Array(r.wasm.HEAPU8.buffer,e,4),n=t[0],o=t[1],a=t[2],i=t[3];return r.wasm._free(e),{pSelectedIndices:n,selectedSize:o,pSelectedScores:a,pValidOutputs:i}}var oR;function bce(r){oR=r.wasm.cwrap(yi,"number",["number","number","number","number","number"])}function wce(r){let{backend:e,inputs:t,attrs:n}=r,{iouThreshold:o,maxOutputSize:a,scoreThreshold:i}=n,{boxes:s,scores:u}=t,l=e.dataIdMap.get(s.dataId).id,c=e.dataIdMap.get(u.dataId).id,p=oR(l,c,a,o,i),{pSelectedIndices:f,selectedSize:d,pSelectedScores:m,pValidOutputs:h}=ql(e,p);return e.wasm._free(m),e.wasm._free(h),e.makeOutput([d],"int32",f)}var aR={kernelName:yi,backendName:"wasm",setupFunc:bce,kernelFunc:wce};var sR;function kce(r){sR=r.wasm.cwrap(bi,"number",["number","number","number","number","number","bool"])}function _ce(r){let{backend:e,inputs:t,attrs:n}=r,{iouThreshold:o,maxOutputSize:a,scoreThreshold:i,padToMaxOutputSize:s}=n,{boxes:u,scores:l}=t,c=e.dataIdMap.get(u.dataId).id,p=e.dataIdMap.get(l.dataId).id,f=sR(c,p,a,o,i,s),{pSelectedIndices:d,selectedSize:m,pSelectedScores:h,pValidOutputs:g}=ql(e,f);e.wasm._free(h);let v=e.makeOutput([m],"int32",d),x=e.makeOutput([],"int32",g);return[v,x]}var iR={kernelName:bi,backendName:"wasm",setupFunc:kce,kernelFunc:_ce};var uR;function Sce(r){uR=r.wasm.cwrap(wi,"number",["number","number","number","number","number","number"])}function Ice(r){let{backend:e,inputs:t,attrs:n}=r,{iouThreshold:o,maxOutputSize:a,scoreThreshold:i,softNmsSigma:s}=n,{boxes:u,scores:l}=t,c=e.dataIdMap.get(u.dataId).id,p=e.dataIdMap.get(l.dataId).id,f=uR(c,p,a,o,i,s),{pSelectedIndices:d,selectedSize:m,pSelectedScores:h,pValidOutputs:g}=ql(e,f);e.wasm._free(g);let v=e.makeOutput([m],"int32",d),x=e.makeOutput([m],"float32",h);return[v,x]}var lR={kernelName:wi,backendName:"wasm",setupFunc:Sce,kernelFunc:Ice};var Cce=!1,cR=pt(xi,Cce,"bool");var pR;function Nce(r){pR=r.wasm.cwrap(ki,null,["number","number","number","number","number"])}function Ece(r){let{inputs:e,backend:t,attrs:n}=r,{indices:o}=e,{depth:a,onValue:i,offValue:s}=n,u=t.makeOutput([...o.shape,a],"int32"),l=t.dataIdMap.get(u.dataId).id,p=t.dataIdMap.get(o.dataId).id;return pR(p,a,i,s,l),u}var fR={kernelName:ki,backendName:"wasm",setupFunc:Nce,kernelFunc:Ece};function Tce(r){let{inputs:{x:e},backend:t}=r,n=t.makeOutput(e.shape,e.dtype);return t.typedArrayFromHeap(n).fill(1),n}var dR={kernelName:wl,backendName:"wasm",kernelFunc:Tce};function Ace(r){let{inputs:e,backend:t,attrs:n}=r,{axis:o}=n;if(e.length===1)return Sh({inputs:{input:e[0]},backend:t,attrs:{dim:o}});let a=e[0].shape,i=e[0].dtype;e.forEach(c=>{w.assertShapesMatch(a,c.shape,"All tensors passed to stack must have matching shapes"),w.assert(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let s=[],u=e.map(c=>{let p=Sh({inputs:{input:c},backend:t,attrs:{dim:o}});return s.push(p),p}),l=W0({inputs:u,backend:t,attrs:{axis:o}});return s.forEach(c=>t.disposeData(c.dataId)),l}var mR={kernelName:kl,backendName:"wasm",kernelFunc:Ace};var hR;function Fce(r){hR=r.wasm.cwrap(_i,null,["number","array","number","number","array","array","number","number"])}function Dce(r){let{inputs:{x:e},backend:t,attrs:{paddings:n,constantValue:o}}=r,a=n.map((h,g)=>h[0]+e.shape[g]+h[1]);if(w.sizeFromShape(e.shape)===0)return U0({backend:t,attrs:{shape:a,value:o,dtype:e.dtype}});let i=t.dataIdMap.get(e.dataId).id,s=t.makeOutput(a,e.dtype),l=t.dataIdMap.get(s.dataId).id,c=new Uint8Array(new Int32Array(e.shape).buffer),p=n.map(h=>h[0]),f=n.map(h=>h[1]),d=new Uint8Array(new Int32Array(p).buffer),m=new Uint8Array(new Int32Array(f).buffer);return hR(i,c,e.shape.length,Ye[e.dtype],d,m,o,l),s}var Ih={kernelName:_i,backendName:"wasm",kernelFunc:Dce,setupFunc:Fce};var Rce=!1,gR=pt(Si,Rce);var vR;function $ce(r){vR=r.wasm.cwrap(Uo,null,["number","number","number"])}function Pce(r){let{inputs:e,backend:t}=r,{x:n,alpha:o}=e,a=t.dataIdMap.get(n.dataId).id,i=t.dataIdMap.get(o.dataId).id,s=a,u=n,l=u;u.dtype!=="float32"&&(l=ea({backend:t,inputs:{x:n},attrs:{dtype:"float32"}}),s=t.dataIdMap.get(l.dataId).id);let c=t.makeOutput(n.shape,"float32"),p=t.dataIdMap.get(c.dataId).id;return vR(s,i,p),u.dtype!=="float32"&&t.disposeData(l.dataId),c}var xR={kernelName:Uo,backendName:"wasm",setupFunc:$ce,kernelFunc:Pce};var yR;function Oce(r){yR=r.wasm.cwrap(Ii,null,["number","number","number","number"])}function Mce(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o,keepDims:a}=n,{x:i}=t,s=e.dataIdMap.get(i.dataId).id,u=s,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e),m=p;if(d){let y=e.dataIdMap.get(c.dataId).id;y!==s&&(l=c,u=y,m=S.getInnerMostAxes(m.length,l.shape.length))}S.assertAxesAreInnerMostDims("prod",m,l.shape.length);let[h,g]=S.computeOutAndReduceShapes(l.shape,m),v=w.sizeFromShape(g),x=e.makeOutput(h,l.dtype);if(w.sizeFromShape(l.shape)!==0){let y=e.dataIdMap.get(x.dataId).id;yR(u,v,Ye[x.dtype],y)}if(d&&e.disposeData(c.dataId),a){let y=S.expandShapeToKeepDim(x.shape,f);x.shape=y}return x}var bR={kernelName:Ii,backendName:"wasm",setupFunc:Oce,kernelFunc:Mce};var Bce=r=>{let{backend:e,attrs:t}=r,{start:n,stop:o,step:a,dtype:i}=t,s=iu(n,o,a,i),u=e.makeOutput([s.length],i);return e.typedArrayFromHeap(u).set(s),u},wR={kernelName:_l,backendName:"wasm",kernelFunc:Bce};var Lce=!0,kR=pt(Zs,Lce);var _R=nt(Go);var SR=nt(jo);var IR;function Vce(r){IR=r.wasm.cwrap(Ci,null,["number","number","number","number","number","number","number","number","number","number"])}function Wce(r){let{backend:e,inputs:t,attrs:n}=r,{images:o}=t,{alignCorners:a,halfPixelCenters:i,size:s}=n,[u,l]=s,[c,p,f,d]=o.shape,m=[c,u,l,d],h=e.dataIdMap.get(o.dataId),g;h.dtype!=="float32"&&(g=ea({backend:e,inputs:{x:o},attrs:{dtype:"float32"}}),h=e.dataIdMap.get(g.dataId));let v=h.id,x=e.makeOutput(m,"float32");if(w.sizeFromShape(o.shape)===0)return x;let y=e.dataIdMap.get(x.dataId).id;return IR(v,c,p,f,d,u,l,a?1:0,i?1:0,y),g!=null&&e.disposeData(g.dataId),x}var CR={kernelName:Ci,backendName:"wasm",setupFunc:Vce,kernelFunc:Wce};var NR;function zce(r){NR=r.wasm.cwrap(Ni,null,["number","array","number","array","number","number"])}function Uce(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{dims:a}=n,i=w.parseAxisParam(a,o.shape);if(o.shape.length===0)return ou({inputs:{x:o},backend:t});let s=t.makeOutput(o.shape,o.dtype),u=t.dataIdMap.get(o.dataId).id,l=t.dataIdMap.get(s.dataId).id,c=new Uint8Array(new Int32Array(i).buffer),p=new Uint8Array(new Int32Array(o.shape).buffer);NR(u,c,i.length,p,o.shape.length,l);let f=or({inputs:{x:s},attrs:{shape:o.shape},backend:t});return t.disposeData(s.dataId),f}var ER={kernelName:Ni,backendName:"wasm",kernelFunc:Uce,setupFunc:zce};var TR;function Gce(r){TR=r.wasm.cwrap(Ui,null,["number","number","number","number","number","number","number","number","array","number","number"])}function jce(r){let{inputs:e,backend:t,attrs:n}=r,{image:o}=e,{radians:a,fillValue:i,center:s}=n,u=t.makeOutput(o.shape,o.dtype),l=t.dataIdMap.get(o.dataId).id,c=t.dataIdMap.get(u.dataId).id,[p,f,d,m]=o.shape,[h,g]=S.getImageCenter(s,f,d),v=i===0,x=255,y=typeof i=="number"?[i,i,i,v?0:x]:[...i,x],b=new Uint8Array(new Int32Array(y).buffer);return TR(l,p,f,d,m,a,h,g,b,y.length,c),u}var AR={kernelName:Ui,backendName:"wasm",kernelFunc:jce,setupFunc:Gce};var FR=nt(Ei);var DR=nt(Ti);var RR;function Hce(r){RR=r.wasm.cwrap(Ai,null,["number","number","number","number","number","number","array","number","number"])}function qce(r){let{backend:e,inputs:t,attrs:n}=r,{indices:o,updates:a}=t,{shape:i}=n,s=e.makeOutput(i,a.dtype);if(w.sizeFromShape(i)===0)return s;let{sliceRank:u,numUpdates:l,sliceSize:c,strides:p,outputSize:f}=sh.calculateShapes(a,o,i),m=e.dataIdMap.get(o.dataId).id,g=e.dataIdMap.get(a.dataId).id,v=new Uint8Array(new Int32Array(p).buffer),x=e.dataIdMap.get(s.dataId).id;return RR(m,g,Ye[a.dtype],u,l,c,v,f,x),s}var $R={kernelName:Ai,backendName:"wasm",setupFunc:Hce,kernelFunc:qce};var PR;function Kce(r){PR=r.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function Xce(r){let{inputs:e,backend:t}=r,{condition:n,t:o,e:a}=e,i=t.dataIdMap.get(n.dataId).id,s=t.dataIdMap.get(o.dataId).id,u=t.dataIdMap.get(a.dataId).id,l=t.makeOutput(o.shape,o.dtype),c=t.dataIdMap.get(l.dataId).id,p=n.shape.length,f=o.shape.length,d=p===0||p>1||f===1?1:w.sizeFromShape(o.shape.slice(1));return PR(i,s,u,d,c),l}var OR={kernelName:Sl,backendName:"wasm",kernelFunc:Xce,setupFunc:Kce};var MR;function Yce(r){MR=r.wasm.cwrap(Ho,null,["number","number"])}function Zce(r){let{backend:e,inputs:{x:t}}=r,n=e.dataIdMap.get(t.dataId).id,o=e.makeOutput(t.shape,t.dtype),a=e.dataIdMap.get(o.dataId).id;return w.sizeFromShape(o.shape)===0||MR(n,a),o}var BR={kernelName:"Sigmoid",backendName:"wasm",setupFunc:Yce,kernelFunc:Zce};var LR=nt(Fi);var VR;function Jce(r){VR=r.wasm.cwrap(Ri,null,["number","number","number","number"])}function Qce(r){let{backend:e,inputs:{logits:t},attrs:{dim:n}}=r,o=e.dataIdMap.get(t.dataId).id,a=e.makeOutput(t.shape,t.dtype),i=e.dataIdMap.get(a.dataId).id,s=t.shape[n],u=w.sizeFromShape(t.shape)/s;return w.sizeFromShape(a.shape)===0||VR(o,i,s,u),a}var WR={kernelName:Ri,backendName:"wasm",setupFunc:Jce,kernelFunc:Qce};function epe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockShape:a,paddings:i}=n,s=w.sizeFromShape(a),u=[[0,0]];u.push(...i);for(let N=1+a.length;N<o.shape.length;++N)u.push([0,0]);let l=Ih.kernelFunc({inputs:{x:o},backend:t,attrs:{paddings:u,constantValue:0}}),c=S.getReshaped(l.shape,a,s,!1),p=S.getPermuted(c.length,a.length,!1),f=S.getReshapedPermuted(l.shape,a,s,!1),h=or({inputs:{x:l},backend:t,attrs:{shape:c}}),x=mo({inputs:{x:h},backend:t,attrs:{perm:p}}),k=or({inputs:{x},backend:t,attrs:{shape:f}});return t.disposeData(l.dataId),t.disposeData(h.dataId),t.disposeData(x.dataId),k}var zR={kernelName:Cl,backendName:"wasm",kernelFunc:epe};function tpe(r){let{inputs:e,attrs:t,backend:n}=r,{x:o}=e,{numOrSizeSplits:a,axis:i}=t,s=w.parseAxisParam(i,o.shape)[0],u=S.prepareSplitSize(o,a,s),l=new Array(o.shape.length).fill(0),c=o.shape.slice();return u.map(p=>{let f=[...c];f[s]=p;let d=Qo({inputs:{x:o},attrs:{begin:l,size:f},backend:n});return l[s]+=p,d})}var UR={kernelName:Nl,backendName:"wasm",kernelFunc:tpe};var GR=nt(Di);var jR=nt(El);var rpe=!0,HR=pt($i,rpe);var qR;function npe(r){qR=r.wasm.cwrap(co,null,["number","number","number","number"])}function ope(r){let{backend:e,inputs:t,attrs:n}=r,{alpha:o}=n,{x:a}=t,i=e.dataIdMap.get(a.dataId).id,s=e.makeOutput(a.shape,a.dtype),u=e.dataIdMap.get(s.dataId).id;return qR(i,o,Ye[a.dtype],u),s}var KR={kernelName:co,backendName:"wasm",setupFunc:npe,kernelFunc:ope};var XR;function ape(r){XR=r.wasm.cwrap(Pi,null,["number","array","number","array","array","array","array","array","number","number"])}function spe(r){let{backend:e,inputs:t,attrs:n}=r,{x:o}=t,{begin:a,end:i,strides:s,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:f}=n,{finalShapeSparse:d,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:v,begin:x,end:y,strides:b}=Tt.sliceInfo(o.shape,a,i,s,u,l,c,p,f),k;if(h)k=or({inputs:{x:o},backend:e,attrs:{shape:m}});else if(g||v){w.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let N=Tt.computeOutShape(x,y,b),E=Qo({inputs:{x:o},backend:e,attrs:{begin:x,size:N}});k=or({inputs:{x:E},backend:e,attrs:{shape:m}}),e.disposeData(E.dataId)}else{let N=e.makeOutput(d,"float32"),E=e.dataIdMap.get(o.dataId).id,T=new Uint8Array(new Int32Array(w.computeStrides(o.shape)).buffer),R=new Uint8Array(new Int32Array(x).buffer),$=new Uint8Array(new Int32Array(y).buffer),O=new Uint8Array(new Int32Array(b).buffer),M=new Uint8Array(new Int32Array(d).buffer),B=new Uint8Array(new Int32Array(w.computeStrides(d)).buffer),L=e.dataIdMap.get(N.dataId).id;XR(E,T,o.shape.length,R,$,O,M,B,d.length,L),k=or({inputs:{x:N},backend:e,attrs:{shape:m}}),e.disposeData(N.dataId)}return k}var YR={kernelName:Pi,backendName:"wasm",setupFunc:ape,kernelFunc:spe};var ipe=!0,ZR=pt(Oi,ipe);var JR;function upe(r){JR=r.wasm.cwrap(qo,null,["number","number","number","number"])}function lpe(r){let{backend:e,inputs:t,attrs:n}=r,{axis:o,keepDims:a}=n,{x:i}=t,s=e.dataIdMap.get(i.dataId).id,u=s,l=i,{transposed:c,axes:p,originalAxes:f,inputWasTransposed:d}=Br(i,o,e),m=p;if(d){let y=e.dataIdMap.get(c.dataId).id;y!==s&&(l=c,u=y,m=S.getInnerMostAxes(m.length,l.shape.length))}S.assertAxesAreInnerMostDims("sum",m,l.shape.length);let[h,g]=S.computeOutAndReduceShapes(l.shape,m),v=w.sizeFromShape(g),x=e.makeOutput(h,l.dtype);if(w.sizeFromShape(l.shape)!==0){let y=e.dataIdMap.get(x.dataId).id;JR(u,v,Ye[x.dtype],y)}if(d&&e.disposeData(c.dataId),a){let y=S.expandShapeToKeepDim(x.shape,f);x.shape=y}return x}var QR={kernelName:qo,backendName:"wasm",setupFunc:upe,kernelFunc:lpe};var e3=nt(Mi);var t3=nt(Bi);var r3;function cpe(r){r3=r.wasm.cwrap(Li,null,["number","array","number","array","number","number"])}function ppe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,a=t.dataIdMap.get(o.dataId).id,{reps:i}=n,s=new Array(o.shape.length);for(let f=0;f<s.length;f++)s[f]=o.shape[f]*i[f];let u=new Uint8Array(new Int32Array(o.shape).buffer),l=new Uint8Array(new Int32Array(s).buffer),c=t.makeOutput(s,o.dtype),p=t.dataIdMap.get(c.dataId).id;return r3(a,u,o.shape.length,l,s.length,Ye[c.dtype],p),c}var n3={kernelName:Li,backendName:"wasm",setupFunc:cpe,kernelFunc:ppe};var o3;function fpe(r){o3=r.wasm.cwrap(Vi,null,["number","array","number","number","number","bool","number","number"])}var dpe=({inputs:r,backend:e,attrs:t})=>{let{x:n}=r,{k:o,sorted:a}=t,i=e.dataIdMap.get(n.dataId).id,s=new Uint8Array(new Int32Array(n.shape).buffer),u=n.shape.slice();u[u.length-1]=o;let l=e.makeOutput(u,n.dtype),c=e.dataIdMap.get(l.dataId).id,p=e.makeOutput(u,"int32"),f=e.dataIdMap.get(p.dataId).id;return o3(i,s,n.shape.length,Ye[n.dtype],o,a,c,f),[l,p]},a3={kernelName:Vi,backendName:"wasm",setupFunc:fpe,kernelFunc:dpe};var s3;function mpe(r){s3=r.wasm.cwrap(Wi,null,["number","number","bool","number","number","number","number","number","number","array","number","number","number","number","number"])}function hpe(r){let{backend:e,inputs:t,attrs:n}=r,{image:o,transforms:a}=t,{interpolation:i,fillMode:s,fillValue:u,outputShape:l}=n,[c,p,f,d]=o.shape,[m,h]=l!=null?l:[p,f],g=[c,m,h,d],v=new Uint8Array(new Int32Array(w.computeStrides(o.shape)).buffer),x=e.makeOutput(g,o.dtype),y=e.dataIdMap.get(x.dataId).id,k=e.dataIdMap.get(o.dataId).id,E=e.dataIdMap.get(a.dataId).id,T=i==="nearest"?1:2,R;switch(s){case"constant":R=1;break;case"reflect":R=2;break;case"wrap":R=3;break;case"nearest":R=4;break;default:R=1;break}return s3(k,E,a.shape[0]>1,c,m,h,d,f,p,v,o.shape.length-1,T,R,u,y),x}var i3={kernelName:Wi,backendName:"wasm",setupFunc:mpe,kernelFunc:hpe};function gpe(r){let{inputs:e,backend:t,attrs:n}=r,{value:o}=e,{axis:a}=n;a<0&&(a+=o.shape.length);let i=o.shape[a],s=o.shape.length,u=new Array(s-1),l=0;for(let d=0;d<s;d++)d!==a&&(u[l++]=o.shape[d]);let c=new Array(i),p=new Array(s).fill(0),f=o.shape.slice();f[a]=1;for(let d=0;d<c.length;d++)p[a]=d,c[d]=Qo({inputs:{x:o},attrs:{begin:p,size:f},backend:t});return c.map(({dataId:d,dtype:m})=>({dataId:d,dtype:m,shape:u}))}var u3={kernelName:Tl,backendName:"wasm",kernelFunc:gpe};function vpe(r){let{inputs:{x:e},backend:t}=r,n=t.makeOutput(e.shape,e.dtype);return t.typedArrayFromHeap(n).fill(0),n}var l3={kernelName:Al,backendName:"wasm",kernelFunc:vpe};var xpe=[QA,eF,rF,iF,lF,pF,dF,gF,ZF,JF,QF,tD,rD,oD,sD,iD,uD,cD,fD,mD,gD,vD,xD,yD,bD,wD,_D,SD,ID,JA,ND,TD,FD,RD,PD,OD,MD,nF,LD,VD,WD,zD,UD,jD,HD,KD,YD,JD,QD,tR,rR,nR,aR,iR,lR,cR,fR,dR,mR,Ih,gR,xR,bR,wR,kR,_R,SR,mF,CR,ER,AR,DR,FR,$R,OR,BR,LR,YF,WR,zR,UR,GR,jR,HR,KR,YR,ZR,QR,e3,t3,n3,a3,i3,aF,u3,l3];for(let r of xpe)Fl(r);var j0=X();j0.registerFlag("WASM_HAS_SIMD_SUPPORT",()=>Be(void 0,null,function*(){return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}));j0.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",()=>Be(void 0,null,function*(){if(j0.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(r){return!1}}));var Y0=kc(d3());var m3='var Module={};function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;this.alert=threadAlert;Module["instantiateWasm"]=function(info,receiveInstance){var instance=new WebAssembly.Instance(Module["wasmModule"],info);Module["wasmModule"]=null;receiveInstance(instance);return instance.exports};function moduleLoaded(){}this.onmessage=function(e){try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module).then(function(instance){Module=instance;moduleLoaded()})}else if(e.data.cmd==="objectTransfer"){Module["PThread"].receiveObjectTransfer(e.data)}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,0,0);var max=e.data.stackBase;var top=e.data.stackBase+e.data.stackSize;Module["establishStackSpace"](top,max);Module["_emscripten_tls_init"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].setThreadStatus(Module["_pthread_self"](),1);try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(!Module["getNoExitRuntime"]())Module["PThread"].threadExit(result)}catch(ex){if(ex==="Canceled!"){Module["PThread"].threadCancel()}else if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["getNoExitRuntime"]()){}else{Module["PThread"].threadExit(ex.status)}}else{Module["PThread"].threadExit(-2);throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["PThread"].threadCancel()}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);throw ex}};if(typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string"){self={location:{href:__filename}};var onmessage=this.onmessage;var nodeWorkerThreads=require("worker_threads");global.Worker=nodeWorkerThreads.Worker;var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",function(data){onmessage({data:data})});var nodeFS=require("fs");var nodeRead=function(filename){return nodeFS.readFileSync(filename,"utf8")};function globalEval(x){global.require=require;global.Module=Module;eval.call(null,x)}importScripts=function(f){globalEval(nodeRead(f))};postMessage=function(msg){parentPort.postMessage(msg)};if(typeof performance==="undefined"){performance={now:function(){return Date.now()}}}}';var g3=kc(h3());var Th=class extends so{constructor(e){super();this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(kpe),_pe=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new Da(this,Xn())}write(e,t,n){let o={id:this.dataIdNextNumber++};return this.move(o,e,t,n,1),o}numDataIds(){return this.dataIdMap.numDataIds()}time(e){return Be(this,null,function*(){let t=w.now();return e(),{kernelMs:w.now()-t}})}move(e,t,n,o,a){let i=this.dataIdNextNumber++;if(o==="string"){let c=t;this.dataIdMap.set(e,{id:i,stringBytes:c,shape:n,dtype:o,memoryOffset:null,refCount:a});return}let s=w.sizeFromShape(n),u=s*w.bytesPerElement(o),l=this.wasm._malloc(u);this.dataIdMap.set(e,{id:i,memoryOffset:l,shape:n,dtype:o,refCount:a}),this.wasm.tfjs.registerTensor(i,s,l),t!=null&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,u),l)}read(e){return Be(this,null,function*(){return this.readSync(e)})}readSync(e){let{memoryOffset:t,dtype:n,shape:o,stringBytes:a}=this.dataIdMap.get(e);if(n==="string")return a;let i=this.wasm.HEAPU8.slice(t,t+w.sizeFromShape(o)*w.bytesPerElement(n));return bpe(i.buffer,n)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);t!=null&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n){let o;if(n==null)o=this.write(null,e,t);else{let a=this.dataIdNextNumber++;o={id:a},this.dataIdMap.set(o,{id:a,memoryOffset:n,shape:e,dtype:t,refCount:1});let i=w.sizeFromShape(e);this.wasm.tfjs.registerTensor(a,i,n)}return{dataId:o,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){let o=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(n),i=w.sizeFromShape(e);switch(t){case"float32":return new Float32Array(o,a,i);case"int32":return new Int32Array(o,a,i);case"bool":return new Uint8Array(o,a,i);default:throw new Error(`Unknown dtype ${t}`)}}};function ype(r){return(e,t)=>(w.fetch(r,{credentials:"same-origin"}).then(n=>{n.ok||e.env.a(`failed to load wasm binary file at '${r}'`),n.arrayBuffer().then(o=>{WebAssembly.instantiate(o,e).then(a=>{t(a.instance,a.module)})})}),{})}function v3(r,e,t){if(Z0!=null)return Z0;let n="tfjs-backend-wasm.wasm";return r&&e?n="tfjs-backend-wasm-threaded-simd.wasm":r&&(n="tfjs-backend-wasm-simd.wasm"),Hp!=null&&Hp[n]!=null?Hp[n]:t+n}function x3(){return Be(this,null,function*(){let[r,e]=yield Promise.all([X().getAsync("WASM_HAS_SIMD_SUPPORT"),X().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((t,n)=>{let o={};o.locateFile=(s,u)=>{if(s.endsWith(".worker.js")){let l=m3,c=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(c)}return s.endsWith(".wasm")?v3(r,e,jp!=null?jp:u):u+s},y3&&(o.instantiateWasm=ype(v3(r,e,jp!=null?jp:"")));let a=!1;o.onAbort=()=>{if(a||Ah)return;Ah=!0,n({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"})};let i;e&&r&&Z0==null?(o.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+Y0.default.toString()],{type:"text/javascript"}),i=(0,Y0.default)(o)):i=(0,g3.default)(o),i.then(s=>{a=!0,Ah=!1;let u=null;s.tfjs={init:s.cwrap("init",null,[]),initWithThreadsCount:s.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:s.cwrap("get_threads_count","number",[]),registerTensor:s.cwrap("register_tensor",null,["number","number","number"]),disposeData:s.cwrap("dispose_data",u,["number"]),dispose:s.cwrap("dispose",u,[])},t({wasm:s})})})})}function bpe(r,e){switch(e){case"float32":return new Float32Array(r);case"int32":return new Int32Array(r);case"bool":return new Uint8Array(r);default:throw new Error(`Unknown dtype ${e}`)}}var wpe=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],Z0=null,jp=null,Hp={},Ah=!1,y3=!1;function J0(r,e=!1){if(Ah)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof r=="string")jp=r;else{Hp=r;let t=wpe.filter(n=>Hp[n]==null);if(t.length>0)throw new Error(`There were no entries found for the following binaries: ${t.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}y3=e}var kpe=-1,_pe=-1;var Q0="3.11.0";var Spe=2;Vl("wasm",()=>Be(void 0,null,function*(){let{wasm:r}=yield x3();return new Th(r)}),Spe);var lu={},ew={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function b3(r,e){lu[r]=e}function vn(r){if(!(r in lu)){let t=Cpe(r);if(t!==null)lu[r]=t;else return console.log("Could not get context for WebGL version",r),null}let e=lu[r];return e.isContextLost()?(delete lu[r],vn(r)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),lu[r])}function Ipe(r){if(typeof OffscreenCanvas!="undefined"&&r===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Cpe(r){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let e=Ipe(r);return e.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete lu[r]},!1),r===1?e.getContext("webgl",ew)||e.getContext("experimental-webgl",ew):e.getContext("webgl2",ew)}var Va;(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(Va||(Va={}));var Cr;(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(Cr||(Cr={}));var br;(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(br||(br={}));function cu(r,e){return[e,r]}function w3(r,e){return r*e}function qp(r){let e=w.sizeFromShape(r),t=Math.ceil(e/4);return w.sizeToSquarishShape(t)}function ho(r,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(r/2))]}function k3(r,e){let[t,n]=ho(r,e);return t*n*4}function Kp(r,e){let t=r,n,o,a,i,s,u,l,c,p,f;return X().getNumber("WEBGL_VERSION")===2?(n=t.R32F,o=t.R16F,a=t.RGBA16F,i=t.RGBA32F,s=t.RED,l=4,c=1,p=t.HALF_FLOAT,f=t.FLOAT):(n=r.RGBA,o=r.RGBA,a=r.RGBA,i=t.RGBA,s=r.RGBA,l=4,c=4,p=e!=null?e.HALF_FLOAT_OES:null,f=r.FLOAT),u=r.RGBA,{internalFormatFloat:n,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:p,textureTypeFloat:f}}function Te(r,e){let t=e();return X().getBool("DEBUG")&&Npe(r),t}function Npe(r){let e=r.getError();if(e!==r.NO_ERROR)throw new Error("WebGL Error: "+Ape(r,e))}var Epe=596e-10,Tpe=65504;function _3(r){return!!(X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||Epe<Math.abs(r)&&Math.abs(r)<Tpe)}function Ape(r,e){switch(e){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Xp(r,e){return ta(r,()=>r.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function S3(r,e){let t=ta(r,()=>r.createShader(r.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Te(r,()=>r.shaderSource(t,e)),Te(r,()=>r.compileShader(t)),r.getShaderParameter(t,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function I3(r,e){let t=ta(r,()=>r.createShader(r.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Te(r,()=>r.shaderSource(t,e)),Te(r,()=>r.compileShader(t)),r.getShaderParameter(t,r.COMPILE_STATUS)===!1)throw Dpe(e,r.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}var Fpe=/ERROR: [0-9]+:([0-9]+):/g;function Dpe(r,e){let t=Fpe.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(r);return}let n=+t[1],o=r.split(`
`),a=o.length.toString().length+2,i=o.map((p,f)=>w.rightPad((f+1).toString(),a)+p),s=0;for(let p=0;p<i.length;p++)s=Math.max(i[p].length,s);let u=i.slice(0,n-1),l=i.slice(n-1,n),c=i.slice(n);console.log(u.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${w.rightPad(l[0],s)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function C3(r){return ta(r,()=>r.createProgram(),"Unable to create WebGLProgram.")}function N3(r,e){if(Te(r,()=>r.linkProgram(e)),r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Fh(r,e){if(Te(r,()=>r.validateProgram(e)),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function E3(r,e){let t=ta(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Te(r,()=>r.bindBuffer(r.ARRAY_BUFFER,t)),Te(r,()=>r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)),t}function T3(r,e){let t=ta(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Te(r,()=>r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t)),Te(r,()=>r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)),t}function A3(r){return ta(r,()=>r.createTexture(),"Unable to create WebGLTexture.")}function F3(r,e){let t=X().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||e<=0){let n=`[${r}x${e}]`;throw new Error("Requested texture size "+n+" is invalid.")}if(r>t||e>t){let n=`[${r}x${e}]`,o=`[${t}x${t}]`;throw new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+o+".")}}function D3(r){return ta(r,()=>r.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function tw(r,e,t,n,o,a,i){let s=r.getAttribLocation(e,t);return s===-1?!1:(Te(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),Te(r,()=>r.vertexAttribPointer(s,o,r.FLOAT,!1,a,i)),Te(r,()=>r.enableVertexAttribArray(s)),!0)}function Rpe(r,e,t){Ppe(r,t),Te(r,()=>r.activeTexture(r.TEXTURE0+t)),Te(r,()=>r.bindTexture(r.TEXTURE_2D,e))}function R3(r,e,t){return ta(r,()=>r.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function $3(r,e,t){return r.getUniformLocation(e,t)}function P3(r,e,t,n){Te(r,()=>Rpe(r,e,n)),Te(r,()=>r.uniform1i(t,n))}function Dh(r,e,t){Te(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,t)),Te(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0))}function rw(r,e){Te(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,e)),Te(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0))}function Yp(r){let e=r.checkFramebufferStatus(r.FRAMEBUFFER);if(e!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+$pe(r,e))}function $pe(r,e){switch(e){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function ta(r,e,t){let n=Te(r,()=>e());if(n==null)throw new Error(t);return n}function Ppe(r,e){let t=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+r.TEXTURE0;if(n<r.TEXTURE0||n>t){let o=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${o}.`)}}function Wa(r,e=2){return w.sizeFromShape(r.slice(0,r.length-e))}function za(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function Rh(r){let e=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(e=[Wa(r),...za(r)]),e}function O3(r,e=!1){let t=X().getNumber("WEBGL_MAX_TEXTURE_SIZE");e&&(t=t*2,r=r.map((o,a)=>a>=r.length-2?w.nearestLargerEven(r[a]):r[a]),r.length===1&&(r=[2,r[0]])),r.length!==2&&(r=w.squeezeShape(r).newShape);let n=w.sizeFromShape(r);if(r.length<=1&&n<=t)return[1,n];if(r.length===2&&r[0]<=t&&r[1]<=t)return r;if(r.length===3&&r[0]*r[1]<=t&&r[2]<=t)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=t&&r[1]*r[2]<=t)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=t&&r[3]<=t)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=t&&r[1]*r[2]*r[3]<=t)return[r[0],r[1]*r[2]*r[3]];if(e){let o=Wa(r),a=2,i=2;return r.length&&([a,i]=za(r)),n=o*(a/2)*(i/2),w.sizeToSquarishShape(n).map(s=>s*2)}return w.sizeToSquarishShape(n)}function $h(r){return r%2==0}function pu(r,e){if(r=r.slice(-2),e=e.slice(-2),w.arraysEqual(r,e)||!r.length||!e.length||r[0]===0||r[1]===0||e[0]===0||e[1]===0)return!0;if(r.length!==e.length){let t=r.slice(-1)[0],n=e.slice(-1)[0];if(t===n||$h(t)&&$h(n)&&(r[0]===1||e[0]===1))return!0}return r[1]===e[1]&&$h(r[0])&&$h(e[0])}var nw,ow;function M3(r){if(nw==null){let e=vn(r);nw=e.getParameter(e.MAX_TEXTURE_SIZE)}return nw}function B3(r){if(ow==null){let e=vn(r);ow=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ow)}function L3(r){if(r===0)return 0;let e,t=vn(r);return xn(t,"EXT_disjoint_timer_query_webgl2")&&r===2?e=2:xn(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function xn(r,e){return r.getExtension(e)!=null}function aw(r){try{if(vn(r)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function V3(r){if(r===0)return!1;let e=vn(r);if(r===1){if(!xn(e,"OES_texture_float"))return!1}else if(!xn(e,"EXT_color_buffer_float"))return!1;return sw(e)}function W3(r){if(r===0)return!1;let e=vn(r);if(r===1){if(!xn(e,"OES_texture_float")||!xn(e,"WEBGL_color_buffer_float"))return!1}else{if(xn(e,"EXT_color_buffer_float"))return sw(e);let n="EXT_color_buffer_half_float";if(xn(e,n)){let o=e.getExtension(n);return Ope(e,o)}return!1}return sw(e)}function sw(r){let e=Kp(r),t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);let n=1,o=1;r.texImage2D(r.TEXTURE_2D,0,e.internalFormatFloat,n,o,0,e.textureFormatFloat,e.textureTypeFloat,null);let a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0);let i=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(t),r.deleteFramebuffer(a),i}function Ope(r,e){let t=Kp(r,e),n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);let o=1,a=1;r.texImage2D(r.TEXTURE_2D,0,t.internalFormatHalfFloat,o,a,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);let i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);let s=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(n),r.deleteFramebuffer(i),s}function z3(r){return r!==2?!1:vn(r).fenceSync!=null}function go(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>{t!=null&&w.assert(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}var Le=X();Le.registerFlag("HAS_WEBGL",()=>Le.getNumber("WEBGL_VERSION")>0);Le.registerFlag("WEBGL_VERSION",()=>aw(2)?2:aw(1)?1:0);Le.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Le.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Le.get("WEBGL_VERSION")===2);Le.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Le.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Le.registerFlag("WEBGL_PACK",()=>Le.getBool("HAS_WEBGL"));Le.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_CLIP",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_REDUCE",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_LAZILY_UNPACK",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_CONV_IM2COL",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>M3(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>B3(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let r=Le.getNumber("WEBGL_VERSION");return r===0?0:L3(r)});Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Le.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!eu.isMobile());Le.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>V3(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Le.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Le.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Le.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>W3(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_FENCE_API_ENABLED",()=>z3(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Le.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Le.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${r}.`)});Le.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>eu.isMobile()?1:-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${r}.`)});Le.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Le.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Le.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Le.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);function At(){let r,e,t,n,o,a,i,s,u,l;return X().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",e="in",t="out",n="in",o="texture",a="outputColor",i="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",e="attribute",t="varying",n="varying",o="texture2D",a="gl_FragColor",i="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:e,varyingVs:t,varyingFs:n,texture2D:o,output:a,defineOutput:i,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Yn(r,e,t="index"){let n=w.computeStrides(e);return n.map((o,a)=>{let i=`int ${r[a]} = ${t} / ${o}`,s=a===n.length-1?`int ${r[a+1]} = ${t} - ${r[a]} * ${o}`:`index -= ${r[a]} * ${o}`;return`${i}; ${s};`}).join("")}function fu(r,e,t="index"){let n=w.computeStrides(e);return n.map((o,a)=>{let i=`int ${r[a]} = ${t} / outShapeStrides[${a}]`,s=a===n.length-1?`int ${r[a+1]} = ${t} - ${r[a]} * outShapeStrides[${a}]`:`index -= ${r[a]} * outShapeStrides[${a}]`;return`${i}; ${s};`}).join("")}function Mpe(r,e){let t=r.length,n=r.map(a=>`${e}[${a}]`),o=new Array(t-1);o[t-2]=n[t-1];for(let a=t-3;a>=0;--a)o[a]=`(${o[a+1]} * ${n[a+1]})`;return o}function U3(r,e,t="index"){let n=r.map((a,i)=>i),o=Mpe(n,e);return o.map((a,i)=>{let s=`int ${r[i]} = ${t} / ${o[i]}`,u=i===o.length-1?`int ${r[i+1]} = ${t} - ${r[i]} * ${o[i]}`:`index -= ${r[i]} * ${o[i]}`;return`${s}; ${u};`}).join("")}function Xl(r){let e=w.computeStrides(r).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function Yl(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var Ph=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;var{getBroadcastDims:G3}=S;function j3(r,e,t){let n=[];if(r.forEach(d=>{let m=w.sizeFromShape(d.shapeInfo.logicalShape);if(d.shapeInfo.isUniform?n.push(`uniform float ${d.name}${m>1?`[${m}]`:""};`):(n.push(`uniform sampler2D ${d.name};`),n.push(`uniform int offset${d.name};`)),t.enableShapeUniforms){let{uniformShape:h}=Oh(t.packedInputs,d.shapeInfo.logicalShape,d.shapeInfo.texShape);switch(h.length){case 1:n.push(`uniform int ${d.name}Shape;`);break;case 2:n.push(`uniform ivec2 ${d.name}Shape;`);break;case 3:n.push(`uniform ivec3 ${d.name}Shape;`);break;case 4:n.push(`uniform ivec4 ${d.name}Shape;`);break;default:break}n.push(`uniform ivec2 ${d.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:n.push("uniform int outShape;");break;case 2:n.push("uniform ivec2 outShape;"),n.push("uniform int outShapeStrides;");break;case 3:n.push("uniform ivec3 outShape;"),n.push("uniform ivec2 outShapeStrides;");break;case 4:n.push("uniform ivec4 outShape;"),n.push("uniform ivec3 outShapeStrides;");break;default:break}n.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(d=>{n.push(`uniform ${d.type} ${d.name}${d.arrayIndex?`[${d.arrayIndex}]`:""};`)});let o=n.join(`
`),a=r.map(d=>Bpe(d,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),i=e.texShape,s=At(),u=Wpe(s),l,c,p=Gpe(s);return e.isPacked?(l=Lpe(e.logicalShape,i,t.enableShapeUniforms),c=Upe(s)):(l=Vpe(e.logicalShape,i,t.enableShapeUniforms),c=zpe(s)),t.packedInputs&&(p+=Kpe),[p,u,c,o,l,a,t.userCode].join(`
`)}function Zl(r,e=!1){let t=r.shapeInfo.logicalShape;switch(t.length){case 0:return sfe(r,e);case 1:return ufe(r,e);case 2:return cfe(r,e);case 3:return ffe(r,e);case 4:return mfe(r,e);case 5:return hfe(r);case 6:return gfe(r);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function H3(r,e){switch(r.shapeInfo.logicalShape.length){case 0:return afe(r);case 1:return ife(r,e);case 2:return lfe(r,e);case 3:return pfe(r,e);default:return dfe(r,e)}}function Bpe(r,e,t=!1,n){let o="";t?o+=H3(r,n):o+=Zl(r,n);let a=r.shapeInfo.logicalShape,i=e.logicalShape;return a.length<=i.length&&(t?o+=vfe(r,e):o+=xfe(r,e)),o}function Lpe(r,e,t){switch(r.length){case 0:return q3();case 1:return Xpe(r,e,t);case 2:return nfe(r,e,t);case 3:return Zpe(r,e,t);default:return Qpe(r,e,t)}}function Vpe(r,e,t){switch(r.length){case 0:return q3();case 1:return Ype(r,e,t);case 2:return ofe(r,e,t);case 3:return Jpe(r,e,t);case 4:return efe(r,e,t);case 5:return tfe(r,e);case 6:return rfe(r,e);default:throw new Error(`${r.length}-D output sampling is not yet supported`)}}function Wpe(r){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${r.texture2D}(textureSampler, uv).r;
    }
  `}function zpe(r){return`
    void setOutput(float val) {
      ${r.output} = vec4(val, 0, 0, 0);
    }
  `}function Upe(r){return`
    void setOutput(vec4 val) {
      ${r.output} = val;
    }
  `}function Gpe(r){return`${r.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${r.varyingFs} vec2 resultUV;
    ${r.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${r.defineSpecialNaN}
    ${r.defineSpecialInf}
    ${r.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${jpe}
    ${Hpe}
    ${qpe}
  `}var jpe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Hpe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qpe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Kpe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function q3(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Xpe(r,e,t){let n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return n[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${n[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);
    }
  `}function Ype(r,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Zpe(r,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(r[2]/2),a=o*Math.ceil(r[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function Jpe(r,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${fu(["r","c","d"],r)}
    return ivec3(r, c, d);
  }
`;let n=Yn(["r","c","d"],r);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${n}
      return ivec3(r, c, d);
    }
  `}function Qpe(r,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(r[r.length-1]/2),a=o*Math.ceil(r[r.length-2]/2),i=a,s="",u="b, r, c";for(let l=2;l<r.length-1;l++)i*=r[r.length-l-1],s=`
      int b${l} = index / ${i};
      index -= b${l} * ${i};
    `+s,u=`b${l}, `+u;return`
    ivec${r.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${s}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${r.length}(${u});
    }
  `}function efe(r,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${fu(["r","c","d","d2"],r)}
      return ivec4(r, c, d, d2);
    }
  `;let n=Yn(["r","c","d","d2"],r);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${n}
      return ivec4(r, c, d, d2);
    }
  `}function tfe(r,e){let t=Yn(["r","c","d","d2","d3"],r);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function rfe(r,e){let t=Yn(["r","c","d","d2","d3","d4"],r);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function nfe(r,e,t){let n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(w.arraysEqual(r,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `;let o=Math.ceil(r[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function ofe(r,e,t){return w.arraysEqual(r,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:r[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:r[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${r[1]};
      int c = index - r * ${r[1]};
      return ivec2(r, c);
    }
  `}function du(r){return`offset${r}`}function afe(r){let e=r.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),n=At();return`
    vec4 ${t}() {
      return ${n.texture2D}(${e}, halfCR);
    }
  `}function sfe(r,e){let t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`float ${n}() {return ${t};}`;let[o,a]=r.shapeInfo.texShape;if(o===1&&a===1)return`
      float ${n}() {
        return sampleTexture(${t}, halfCR);
      }
    `;let i=du(t);if(e)return`
    float ${n}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${i});
      return sampleTexture(${t}, uv);
    }
  `;let[s,u]=r.shapeInfo.texShape;return`
    float ${n}() {
      vec2 uv = uvFromFlat(${s}, ${u}, ${i});
      return sampleTexture(${t}, uv);
    }
  `}function ife(r,e){let t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=r.shapeInfo.texShape,a=At();if(e)return`
    vec4 ${n}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${t}, uv);
    }
  `;let i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${n}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${a.texture2D}(${t}, uv);
    }
  `}function ufe(r,e){let t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`
      float ${n}(int index) {
        ${Jl(r)}
      }
    `;let o=r.shapeInfo.texShape,a=o[0],i=o[1];if(i===1&&a===1)return`
      float ${n}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;let s=du(t);return i===1?e?`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${a}.0);
        return sampleTexture(${t}, uv);
      }
    `:a===1?e?`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${s});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${a}, ${i}, index + ${s});
      return sampleTexture(${t}, uv);
    }
  `}function lfe(r,e){let t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),a=r.shapeInfo.texShape,i=a[0],s=a[1],u=At();if(a!=null&&w.arraysEqual(t,a))return e?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);

        return ${u.texture2D}(${n}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${i}.0);

        return ${u.texture2D}(${n}, uv);
      }
    `;if(e)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${n}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${n}, uv);
    }
  `;let l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(t[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${l[0]}, ${l[1]}, row, col);
      return ${u.texture2D}(${n}, uv);
    }
  `}function cfe(r,e){let t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),a=r.shapeInfo.texShape;if(a!=null&&w.arraysEqual(t,a)){if(e)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `;let f=a[0],d=a[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${d}.0, ${f}.0);
      return sampleTexture(${n}, uv);
    }
  `}let{newShape:i,keptDims:s}=w.squeezeShape(t),u=i;if(u.length<t.length){let f=Ql(r,u),d=["row","col"];return`
      ${Zl(f,e)}
      float ${o}(int row, int col) {
        return ${o}(${ec(d,s)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${Jl(r)}
      }
    `;let l=a[0],c=a[1],p=du(n);return c===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${n}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${n}, uv);
    }
  `:l===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${n}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${n}, uv);
    }
  `:e?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${n}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);
        return sampleTexture(${n}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${p};
    vec2 uv = uvFromFlat(${l}, ${c}, index);
    return sampleTexture(${n}, uv);
  }
`}function pfe(r,e){let t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),a=r.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(t[0]===1){let f=t.slice(1),d=[1,2],m=Ql(r,f),h=["b","row","col"];return`
        ${H3(m,e)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${ec(h,d)});
        }
      `}let s=At();if(e)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${n}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${s.texture2D}(${n}, uv);
    }
  `;let u=i[0],l=i[1],c=Math.ceil(t[2]/2),p=c*Math.ceil(t[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${l}, ${p}, ${c}, b, row, col);
      return ${s.texture2D}(${n}, uv);
    }
  `}function ffe(r,e){let t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],{newShape:s,keptDims:u}=w.squeezeShape(t),l=s;if(l.length<t.length){let h=Ql(r,l),g=["row","col","depth"];return`
        ${Zl(h,e)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${ec(g,u)});
        }
      `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${i}, 1)));
        ${Jl(r)}
      }
    `;let c=r.shapeInfo.texShape,p=c[0],f=c[1],d=r.shapeInfo.flatOffset;if(f===a&&d==null)return e?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${n}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${p}.0);
          return sampleTexture(${n}, uv);
        }
      `;if(f===i&&d==null)return e?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${n}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${n}, uv);
    }
  `;let m=du(n);return e?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${n}Shape[1] * ${n}Shape[2];
      int stride1 = ${n}Shape[2];
      int index = row * ${a} + col * ${i} + depth + ${m};
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);
      return sampleTexture(${n}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${i} + depth + ${m};
        vec2 uv = uvFromFlat(${p}, ${f}, index);
        return sampleTexture(${n}, uv);
      }
  `}function dfe(r,e){let t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=At();if(e)return`
    vec4 ${n}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${t}, uv);
    }
  `;let a=r.shapeInfo.logicalShape,i=a.length,s=r.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=u[0],c=u[1],p=Math.ceil(a[i-1]/2),f=p*Math.ceil(a[i-2]/2),d="int b, int row, int col",m=`b * ${f} + (row / 2) * ${p} + (col / 2)`;for(let h=2;h<i-1;h++)d=`int b${h}, `+d,f*=a[i-h-1],m=`b${h} * ${f} + `+m;return`
    vec4 ${n}(${d}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${l});
      return ${o.texture2D}(${t}, uv);
    }
  `}function mfe(r,e){let t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,s=t[1]*i,{newShape:u,keptDims:l}=w.squeezeShape(t);if(u.length<t.length){let x=Ql(r,u),y=["row","col","depth","depth2"];return`
      ${Zl(x,e)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${ec(y,l)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${s}, ${i}, ${a}, 1)));
        ${Jl(r)}
      }
    `;let c=r.shapeInfo.flatOffset,p=r.shapeInfo.texShape,f=p[0],d=p[1],m=`int stride2 = ${n}Shape[3];`,h=`int stride1 = ${n}Shape[2] * stride2;`,g=`int stride0 = ${n}Shape[1] * stride1;`;if(d===s&&c==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${m}
        ${h}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(d===a&&c==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n}Shape[1] * ${n}Shape[2], ${n}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;let v=du(n);return e?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${h}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${v});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${i} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${f}, ${d}, index + ${v});
      return sampleTexture(${n}, uv);
    }
  `}function hfe(r){let e=r.shapeInfo.logicalShape,t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=e[4],a=e[3]*o,i=e[2]*a,s=e[1]*i,{newShape:u,keptDims:l}=w.squeezeShape(e);if(u.length<e.length){let h=Ql(r,u),g=["row","col","depth","depth2","depth3"];return`
      ${Zl(h)}
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        return ${n}(${ec(g,l)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${s}, ${i}, ${a}, ${o})) +
          depth3;
        ${Jl(r)}
      }
    `;let c=r.shapeInfo.flatOffset,p=r.shapeInfo.texShape,f=p[0],d=p[1];if(d===s&&c==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${a}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(d===o&&c==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;let m=du(t);return`
    float ${n}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${i} + depth * ${a} +
          depth2 * ${o} + depth3 + ${m};
      vec2 uv = uvFromFlat(${f}, ${d}, index);
      return sampleTexture(${t}, uv);
    }
  `}function gfe(r){let e=r.shapeInfo.logicalShape,t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:o,keptDims:a}=w.squeezeShape(e);if(o.length<e.length){let g=Ql(r,o),v=["row","col","depth","depth2","depth3","depth4"];return`
      ${Zl(g)}
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${n}(${ec(v,a)});
      }
    `}let i=e[5],s=e[4]*i,u=e[3]*s,l=e[2]*u,c=e[1]*l;if(r.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${l}, ${u}, ${s})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Jl(r)}
      }
    `;let p=r.shapeInfo.flatOffset,f=r.shapeInfo.texShape,d=f[0],m=f[1];if(m===c&&p==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${u}, ${s}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(m===i&&p==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;let h=du(t);return`
    float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${l} + depth * ${u} +
          depth2 * ${s} + depth3 * ${i} + depth4 + ${h};
      vec2 uv = uvFromFlat(${d}, ${m}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Jl(r){let e=r.name,t=w.sizeFromShape(r.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function vfe(r,e){let t=r.name,n=t.charAt(0).toUpperCase()+t.slice(1),o="get"+n+"AtOutCoords",a=r.shapeInfo.logicalShape.length,i=e.logicalShape.length,s=G3(r.shapeInfo.logicalShape,e.logicalShape),u=Ve(i),l=i-a,c,p=["x","y","z","w","u","v"];a===0?c="":i<2&&s.length>=1?c="coords = 0;":c=s.map(x=>`coords.${p[x+l]} = 0;`).join(`
`);let f="";i<2&&a>0?f="coords":f=r.shapeInfo.logicalShape.map((x,y)=>`coords.${p[y+l]}`).join(", ");let d="return outputValue;",h=w.sizeFromShape(r.shapeInfo.logicalShape)===1,v=w.sizeFromShape(e.logicalShape)===1;if(a===1&&!h&&!v)d=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(h&&!v)i===1?d=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:d=`
        return vec4(outputValue.x);
      `;else if(s.length){let x=a-2,y=a-1;s.indexOf(x)>-1&&s.indexOf(y)>-1?d="return vec4(outputValue.x);":s.indexOf(x)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(y)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${u} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${n}(${f});
      ${d}
    }
  `}function xfe(r,e){let t=r.name,n=t.charAt(0).toUpperCase()+t.slice(1),o="get"+n+"AtOutCoords",a=e.texShape,i=r.shapeInfo.texShape,s=r.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!r.shapeInfo.isUniform&&s===u&&r.shapeInfo.flatOffset==null&&w.arraysEqual(i,a))return`
      float ${o}() {
        return sampleTexture(${t}, resultUV);
      }
    `;let l=Ve(u),c=G3(r.shapeInfo.logicalShape,e.logicalShape),p=u-s,f,d=["x","y","z","w","u","v"];s===0?f="":u<2&&c.length>=1?f="coords = 0;":f=c.map(h=>`coords.${d[h+p]} = 0;`).join(`
`);let m="";return u<2&&s>0?m="coords":m=r.shapeInfo.logicalShape.map((h,g)=>`coords.${d[g+p]}`).join(", "),`
    float ${o}() {
      ${l} coords = getOutputCoords();
      ${f}
      return get${n}(${m});
    }
  `}function Ve(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error(`GPU for rank ${r} is not yet supported`)}function Oh(r,e,t){let{newShape:n,keptDims:o}=w.squeezeShape(e),a=e.length,i=r&&a===3&&e[0]===1,s=i?e.slice(1):n,u=!r&&a>1&&!w.arraysEqual(e,t)&&n.length<a||i;return{useSqueezeShape:u,uniformShape:u?s:e,keptDims:o}}function Ql(r,e){let t=JSON.parse(JSON.stringify(r));return t.shapeInfo.logicalShape=e,t}function ec(r,e){return e.map(t=>r[t]).join(", ")}function K3(r,e,t,n){let o=t.map((y,b)=>{let k={logicalShape:y.shape,texShape:y.isUniform?null:y.texData.texShape,isUniform:y.isUniform,isPacked:y.isUniform?!1:y.texData.isPacked,flatOffset:null};return y.texData!=null&&y.texData.slice!=null&&y.texData.slice.flatOffset>0&&(k.flatOffset=y.texData.slice.flatOffset),{name:e.variableNames[b],shapeInfo:k}}),a=o.map(y=>y.shapeInfo),i={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},s=j3(o,i,e),u=r.createProgram(s),l=null,c=r.getUniformLocation(u,"NAN",!1);X().getNumber("WEBGL_VERSION")===1&&(l=r.getUniformLocation(u,"INFINITY",!1));let p=!1,f={},d={},m={};for(let y=0;y<e.variableNames.length;y++){let b=e.variableNames[y];f[b]=r.getUniformLocation(u,b,p),f[`offset${b}`]=r.getUniformLocation(u,`offset${b}`,p),e.enableShapeUniforms&&(d[`${b}Shape`]=r.getUniformLocation(u,`${b}Shape`,p),m[`${b}TexShape`]=r.getUniformLocation(u,`${b}TexShape`,p))}let h,g,v;e.enableShapeUniforms&&(h=r.getUniformLocation(u,"outShape",p),v=r.getUniformLocation(u,"outShapeStrides",p),g=r.getUniformLocation(u,"outTexShape",p));let x=[];return e.customUniforms&&e.customUniforms.forEach((y,b)=>{x[b]=r.getUniformLocation(u,y.name,p)}),{program:e,source:s,webGLProgram:u,uniformLocations:f,customUniformLocations:x,inShapeInfos:a,outShapeInfo:i,infLoc:l,nanLoc:c,inShapesLocations:d,inTexShapesLocations:m,outShapeLocation:h,outShapeStridesLocation:v,outTexShapeLocation:g}}function X3(r,e){if(r.length!==e.length)throw Error(`Binary was compiled with ${r.length} inputs, but was executed with ${e.length} inputs`);r.forEach((t,n)=>{let o=t.logicalShape,a=e[n],i=a.shape;if(!w.arraysEqual(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(t.isUniform&&a.isUniform)return;let s=t.texShape,u=a.isUniform?null:a.texData.texShape;if(!w.arraysEqual(s,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${u} must match`)})}function Y3(r,e,t,n,o){e.program.enableShapeUniforms||(X3(e.inShapeInfos,t),X3([e.outShapeInfo],[n]));let a=n.texData.texture,i=n.texData.texShape;n.texData.isPacked?r.setOutputPackedMatrixTexture(a,i[0],i[1]):r.setOutputMatrixTexture(a,i[0],i[1]),r.setProgram(e.webGLProgram),X().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&r.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&r.gl.uniform1f(e.nanLoc,NaN),t.forEach((u,l)=>{let c=e.program.variableNames[l],p=e.uniformLocations[c],f=e.uniformLocations[`offset${c}`],d=e.inShapesLocations[`${c}Shape`],m=e.inTexShapesLocations[`${c}TexShape`];if(d){let{uniformShape:h}=Oh(e.program.packedInputs,u.shape,u.texData.texShape);switch(h.length){case 1:r.gl.uniform1iv(d,new Int32Array(h));break;case 2:r.gl.uniform2iv(d,new Int32Array(h));break;case 3:r.gl.uniform3iv(d,new Int32Array(h));break;case 4:r.gl.uniform4iv(d,new Int32Array(h));break;default:break}}if(m&&r.gl.uniform2i(m,u.texData.texShape[0],u.texData.texShape[1]),p!=null){if(u.isUniform){if(w.sizeFromShape(u.shape)<2)r.gl.uniform1f(p,u.uniformValues[0]);else{let h=u.uniformValues;h instanceof Float32Array||(h=new Float32Array(h)),r.gl.uniform1fv(p,h)}return}u.texData.slice!=null&&f!=null&&r.gl.uniform1i(f,u.texData.slice.flatOffset),r.setInputMatrixTexture(u.texData.texture,p,l)}});let s=e.outShapeLocation;if(s)switch(n.shape.length){case 1:r.gl.uniform1iv(s,new Int32Array(n.shape));break;case 2:r.gl.uniform2iv(s,new Int32Array(n.shape));break;case 3:r.gl.uniform3iv(s,new Int32Array(n.shape));break;case 4:r.gl.uniform4iv(s,new Int32Array(n.shape));break;default:break}if(e.outShapeStridesLocation){let u=w.computeStrides(n.shape);switch(n.shape.length){case 2:r.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:r.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:r.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break;default:break}}e.outTexShapeLocation&&r.gl.uniform2i(e.outTexShapeLocation,n.texData.texShape[0],n.texData.texShape[1]),e.program.customUniforms&&o&&e.program.customUniforms.forEach((u,l)=>{let c=e.customUniformLocations[l],p=o[l];if(u.type==="float")r.gl.uniform1fv(c,p);else if(u.type==="vec2")r.gl.uniform2fv(c,p);else if(u.type==="vec3")r.gl.uniform3fv(c,p);else if(u.type==="vec4")r.gl.uniform4fv(c,p);else if(u.type==="int")r.gl.uniform1iv(c,p);else if(u.type==="ivec2")r.gl.uniform2iv(c,p);else if(u.type==="ivec3")r.gl.uniform3iv(c,p);else if(u.type==="ivec4")r.gl.uniform4iv(c,p);else throw Error(`uniform type ${u.type} is not supported yet.`)}),r.executeProgram()}function Z3(r,e,t){let n="";e.concat(t).forEach(i=>{let s=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(r.enableShapeUniforms&&!i.isUniform){let u=i.texData.texShape,{useSqueezeShape:l,uniformShape:c,keptDims:p}=Oh(r.packedInputs,i.shape,u),f="",d="",m="";if(c.length===1&&r.packedInputs){let k=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];f=`${k[0]>1}_${k[1]>1}`}else if(c.length===2&&!r.packedInputs)d=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!r.packedInputs){let k=w.computeStrides(c);m=`${k[0]===u[1]}_${k[k.length-1]===u[1]}`}let h=i.shape.length,g=c.length===2&&w.arraysEqual(i.shape,u),v=w.sizeFromShape(i.shape)===1,x=S.getBroadcastDims(i.shape,t.shape),y=!r.packedInputs&&h===t.shape.length&&w.arraysEqual(u,t.texData.texShape),b=r.packedInputs||c.length>2?"":`${u[0]>1}_${u[1]>1}`;n+=`${h}_${y}_${l?p:""}_${c.length}_${v}_${x}_${g}_${f}_${d}_${m}_${b}_${s}`}else{let u=i.isUniform?"uniform":i.texData.texShape;n+=`${i.shape}_${u}_${s}`}});let o=r.userCode,a=r.constructor.name;return a+="_"+n+"_"+o+`${X().getNumber("WEBGL_VERSION")}`,a}function Ut(r){return X().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&r<=4}var iw=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Va.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=At();this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?fu(["r","c","d"],e):Yn(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}};var uw=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Va.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=At();this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?fu(["r","c","d"],e):Yn(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}};var lw=class{constructor(e){this.variableNames=["A"],this.outTexUsage=Cr.DOWNLOAD;let t=At();this.outputShape=e,this.userCode=`
      ${Ph}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}};var cw=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Cr.DOWNLOAD;let t=At();this.outputShape=e,this.userCode=`
      ${Ph}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}};var pw=class{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=At();this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length);let o="result";t&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?Yl():Xl(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${n.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${n.output} = vec4(${o}, 0., 0., 0.);
      }
    `}};var fw=class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=At();this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length);let o="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let u=i*2+s;o+=`
          localCoords = coords;
          if(localCoords[2] + ${s} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${s};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?Yl():Xl(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${n.output} = ${a};
        }
    `}};function J3(r){let e=At(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return S3(r,t)}function Q3(r){let e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return E3(r,e)}function e$(r){let e=new Uint16Array([0,1,2,2,1,3]);return T3(r,e)}function Zp(r,e,t,n,o,a){F3(e,t);let i=A3(r),s=r.TEXTURE_2D;return Te(r,()=>r.bindTexture(s,i)),Te(r,()=>r.texParameteri(s,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)),Te(r,()=>r.texParameteri(s,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),Te(r,()=>r.texParameteri(s,r.TEXTURE_MIN_FILTER,r.NEAREST)),Te(r,()=>r.texParameteri(s,r.TEXTURE_MAG_FILTER,r.NEAREST)),Te(r,()=>r.texImage2D(s,0,n,e,t,0,o,a,null)),Te(r,()=>r.bindTexture(r.TEXTURE_2D,null)),i}function dw(r){return r.internalFormatFloat}function t$(r,e,t,n){let[o,a]=cu(e,t);return Zp(r,o,a,dw(n),n.textureFormatFloat,r.FLOAT)}function mw(r){return r.internalFormatHalfFloat}function r$(r,e,t,n){let[o,a]=cu(e,t);return Zp(r,o,a,mw(n),n.textureFormatFloat,n.textureTypeHalfFloat)}function hw(r){return r.downloadTextureFormat}function n$(r,e,t,n){let[o,a]=cu(e,t);return Zp(r,o,a,hw(n),r.RGBA,r.UNSIGNED_BYTE)}function gw(r){return r.internalFormatPackedFloat}function o$(r,e,t,n){let[o,a]=ho(e,t);return Zp(r,o,a,gw(n),r.RGBA,r.FLOAT)}function vw(r){return r.internalFormatPackedHalfFloat}function a$(r,e,t,n){let[o,a]=ho(e,t);return Zp(r,o,a,vw(n),r.RGBA,n.textureTypeHalfFloat)}function s$(r,e,t){let n=0,o=3*4,a=3*4+2*4;return Te(r,()=>r.bindBuffer(r.ARRAY_BUFFER,t)),tw(r,e,"clipSpacePos",t,3,a,n)&&tw(r,e,"uv",t,2,a,o)}function i$(r,e,t,n,o,a){Te(r,()=>r.bindTexture(r.TEXTURE_2D,e));let i,s,u;o instanceof Uint8Array?(i=new Uint8Array(t*n*4),s=r.UNSIGNED_BYTE,u=r.RGBA):(i=new Float32Array(t*n*4),s=r.FLOAT,u=a.internalFormatPackedFloat),i.set(o),Te(r,()=>r.texImage2D(r.TEXTURE_2D,0,u,t,n,0,r.RGBA,s,i)),Te(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function u$(r,e,t){Te(r,()=>r.bindTexture(r.TEXTURE_2D,e)),t.data instanceof Uint8Array?Te(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t.width,t.height,0,r.RGBA,r.UNSIGNED_BYTE,t.data)):Te(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)),Te(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function l$(r,e,t,n){let o=r.createBuffer();Te(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,o));let s=4*4*e*t;return Te(r,()=>r.bufferData(r.PIXEL_PACK_BUFFER,s,r.STREAM_READ)),Te(r,()=>r.readPixels(0,0,t,e,r.RGBA,r.FLOAT,0)),Te(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,null)),o}function c$(r,e,t){let n=r,o=new Float32Array(t);return n.bindBuffer(n.PIXEL_PACK_BUFFER,e),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,o),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),o}function p$(r,e,t,n){let[o,a]=cu(e,t),i=4,s=new Uint8Array(w3(e*t,i));return Te(r,()=>r.readPixels(0,0,o,a,n.downloadTextureFormat,r.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)}function f$(r,e,t,n,o,a,i,s){let u=r,l=new Float32Array(k3(a,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function d$(r,e,t){let n=new Float32Array(e*t*4);return Te(r,()=>r.readPixels(0,0,t,e,r.RGBA,r.FLOAT,n)),n}var xw=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];let t=X().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,b3(t,e)):this.gl=vn(t);let n="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(X().getNumber("WEBGL_VERSION")===1){let a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Xp(this.gl,a),xn(this.gl,i))this.textureHalfFloatExtension=Xp(this.gl,i);else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),xn(this.gl,o))this.colorBufferHalfFloatExtension=Xp(this.gl,o);else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",xn(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(xn(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Q3(this.gl),this.indexBuffer=e$(this.gl),this.framebuffer=D3(this.gl),this.textureConfig=Kp(this.gl,this.textureHalfFloatExtension)}get debug(){return X().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;Te(e,()=>e.finish()),Te(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Te(e,()=>e.deleteFramebuffer(this.framebuffer)),Te(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Te(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Te(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),t$(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),r$(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),n$(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),u$(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,o){this.throwIfDisposed(),i$(this.gl,e,t,n,o,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),a$(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),o$(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(rw(this.gl,this.framebuffer),this.outputTexture=null),Te(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>p$(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,o,a,i){return f$(this.gl,e,t,n,o,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return c$(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let o=l$(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(X().getBool("WEBGL_FENCE_API_ENABLED")){let o=e,a=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let i=o.clientWaitSync(a,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},t=a}else X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>d$(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl,n=I3(t,e);this.vertexShader==null&&(this.vertexShader=J3(t));let o=C3(t);return Te(t,()=>t.attachShader(o,this.vertexShader)),Te(t,()=>t.attachShader(o,n)),N3(t,o),this.debug&&Fh(t,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=s$(t,this.program,this.vertexBuffer)),o}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Te(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Fh(this.gl,this.program),Te(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?R3(this.gl,e,t):$3(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Te(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),P3(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[o,a]=ho(t,n);this.setOutputMatrixTextureDriver(e,o,a)}setOutputMatrixWriteRegion(e,t,n,o){this.setOutputMatrixWriteRegionDriver(n,e,o,t)}setOutputPackedMatrixWriteRegion(e,t,n,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Fh(this.gl,this.program),Yp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;this.debug&&this.debugValidate(),Te(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Te(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Xp(this.gl,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,o=this.getQueryTimerExtensionWebGL2(),a=n.createQuery();return n.beginQuery(o.TIME_ELAPSED_EXT,a),a}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(e){return Be(this,null,function*(){return yield w.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(e,t){if(t===0)return null;if(t===2){let n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{let n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let n=this.gl,o=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{let n=this.getQueryTimerExtensionWebGL1(),o=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=yfe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)&&w.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0))}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Dh(this.gl,e,this.framebuffer),this.debug&&Yp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Dh(this.gl,this.outputTexture,this.framebuffer),this.debug&&Yp(this.gl)):rw(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let o=this.gl;Dh(o,e,this.framebuffer),this.debug&&Yp(o),this.outputTexture=e,Te(o,()=>o.viewport(0,0,t,n)),Te(o,()=>o.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,o){this.throwIfDisposed(),Te(this.gl,()=>this.gl.scissor(e,t,n,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function yfe(r){let e=0;for(;e<r.length&&r[e]();++e);return e-1}var{addImpl:m$,bincountImpl:Mh,bincountReduceImpl:h$,ceilImpl:g$,concatImpl:v$,equalImpl:x$,expImpl:y$,expm1Impl:b$,floorImpl:w$,gatherNdImpl:k$,gatherV2Impl:_$,greaterImpl:S$,greaterEqualImpl:I$,lessImpl:C$,lessEqualImpl:N$,linSpaceImpl:E$,logImpl:T$,maxImpl:A$,maximumImpl:F$,minimumImpl:D$,multiplyImpl:R$,negImpl:$$,notEqualImpl:P$,prodImpl:O$,rangeImpl:M$,rsqrtImpl:B$,sigmoidImpl:L$,simpleAbsImpl:Bh,sliceImpl:V$,sparseFillEmptyRowsImpl:W$,sparseReshapeImpl:z$,sparseSegmentReductionImpl:Lh,sqrtImpl:U$,stridedSliceImpl:G$,stringNGramsImpl:j$,stringSplitImpl:H$,stringToHashBucketFastImpl:q$,subImpl:K$,tileImpl:X$,topKImpl:Y$,transposeImpl:mu,uniqueImpl:Z$}=V0;function yw(r,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${r}.${t}`)}function qt(r,e){return e===1?[r]:yw(r,e)}function J$(r,e){if(r===1)return"rc";let t="";for(let n=0;n<r;n++)t+=e[n],n<r-1&&(t+=",");return t}var bw=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;let t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let n=qt("rc",t),o=Ve(t),a=wfe(t,e,n),i=kfe(t,e[e.length-1],e[e.length-2],n),s=_fe(e,n);this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${s}));
          }
        }
      `}}};function bfe(r,e){let t=[];for(let n=0;n<=1;n++)for(let o=0;o<=1;o++){let a=`${n===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<r;i++)a=`${e[e.length-1-i]},`+a;t.push(a)}return t}function wfe(r,e,t){if(r===1)return`rc > ${e[0]}`;let n="";for(let o=r-2;o<r;o++)n+=`${t[o]} >= ${e[o]}`,o<r-1&&(n+="||");return n}function kfe(r,e,t,n){if(r===1)return"";let o=n.slice(-2);return`
    int r = ${o[0]};
    int c = ${o[1]};
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= ${e};
    bool rEdge = rp1 >= ${t};
  `}function _fe(r,e){let t=r.length,n=bfe(t,e);return t===1?`getA(rc),
            rc + 1 >= ${r[0]} ? 0. : getA(rc + 1),
            0, 0`:`getA(${n[0]}),
          cEdge ? 0. : getA(${n[1]}),
          rEdge ? 0. : getA(${n[2]}),
          rEdge || cEdge ? 0. : getA(${n[3]})`}var Jp=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length);let n="";for(let o=0;o<4;o++){let a="thisRC = rc;";o%2==1&&(a+="thisRC.z += 1;"),o>1&&(a+="thisRC.y += 1;"),n+=`
        ${a}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${Sfe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?Yl():Xl(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}};function Sfe(r,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?U3(["r","c","d"],"inputShape"):Yn(["r","c","d"],r)}
      return ivec3(r, c, d);
    }
  `}var ww=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,n){let o=eP(t,n),a=tP(e,o,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);let i=Q$(e,o,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let u=this.freeTextures[a].shift();return this.usedTextures[a].push(u),u}let s;return o===br.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===br.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===br.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===br.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===br.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(s),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),s}releaseTexture(e,t,n,o){if(this.freeTextures==null)return;let a=eP(n,o),i=tP(t,a,o);i in this.freeTextures||(this.freeTextures[i]=[]);let s=Q$(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,o),u=X().get("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],c=l.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l.splice(c,1),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});for(let e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function Ife(r,e){let t=r;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===r.RGBA)return 16;if(e===t.RGBA16F)return 8;throw new Error(`Unknown internal format ${e}`)}function Q$(r,e,t,n,o){let a=Cfe(e,n),i;if(o){let[u,l]=ho(r[0],r[1]);i=u*l}else{let[u,l]=cu(r[0],r[1]);i=u*l}let s=Ife(t,a);return i*s}function Cfe(r,e){switch(r){case br.PACKED_2X2_FLOAT32:return gw(e);case br.PACKED_2X2_FLOAT16:return vw(e);case br.UNPACKED_FLOAT32:return dw(e);case br.UNPACKED_FLOAT16:return mw(e);case br.PACKED_4X1_UNSIGNED_BYTE:return hw(e);default:throw new Error(`Unknown physical texture type ${r}`)}}function Nfe(r){return X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?br.PACKED_2X2_FLOAT32:br.UNPACKED_FLOAT32:r?br.PACKED_2X2_FLOAT16:br.UNPACKED_FLOAT16}function eP(r,e){if(r===Cr.UPLOAD)return br.PACKED_2X2_FLOAT32;if(r===Cr.RENDER||r==null)return Nfe(e);if(r===Cr.DOWNLOAD||r===Cr.PIXELS)return br.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${r}`)}function tP(r,e,t){return`${r[0]}_${r[1]}_${e}_${t}`}var qr=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},hr="if (isnan(x)) return x;",rP="return x;",kw="return abs(x);";var nP="return (x >= 0.0) ? x : (exp(x) - 1.0);",oP=hr+`
  return (x < 0.0) ? 0.0 : x;
`,aP=hr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Qp="return x;",sP="return 1.0 / (1.0 + exp(-1.0 * x));";var iP="return x;",uP=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,lP=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cP=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pP="return 1.0 / (1.0 + exp(-1.0 * x));",Zn=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}};var _w=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;let t=e.length,n=qt("rc",t),o=Ve(t),a=J$(t,n),i=n.slice(-2),s=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${s}));
      }
    `}};var Efe=Sr.whereImpl,Tfe=1e-7,Afe=1e-4,Vh={};function Ffe(r){return r in Vh||(Vh[r]={}),Vh[r]}var Dfe=X().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Rfe=600;function $fe(){return X().global.screen==null?1024:X().global.screen.height*X().global.screen.width*window.devicePixelRatio*Rfe/1024/1024}var tc=class extends so{constructor(e){super();if(this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!X().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){let t=vn(X().getNumber("WEBGL_VERSION"));this.binaryCache=Ffe(X().getNumber("WEBGL_VERSION")),this.gpgpu=new xw(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=e,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=e.gl.canvas;this.textureManager=new ww(this.gpgpu),this.numMBBeforeWarning=$fe(),this.texData=new Da(this,Xn())}nextDataId(){return tc.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,n){if((X().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||X().getBool("DEBUG"))&&this.checkNumericalProblems(e),n==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let o={id:this.nextDataId()};return this.texData.set(o,{shape:t,dtype:n,values:e,usage:Cr.UPLOAD,refCount:1}),o}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){let t=this.texData.get(e);t.refCount--}}move(e,t,n,o,a){if(X().getBool("DEBUG")&&this.checkNumericalProblems(t),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:o,values:t,usage:Cr.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t=this.texData.get(e),{values:n,dtype:o,complexTensorInfos:a,slice:i,shape:s,isPacked:u}=t;if(i!=null){let f;u?f=new Zn(s,Qp):f=new qr(s,Qp);let d=this.runWebGLProgram(f,[{dataId:e,shape:s,dtype:o}],o),m=this.readSync(d.dataId);return this.disposeIntermediateTensorInfo(d),m}if(n!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return n;let l=this.activeTimers!=null,c;l&&(c=w.now());let p;if(o==="complex64"){let f=this.readSync(a.real.dataId),d=this.readSync(a.imag.dataId);p=S.mergeRealAndImagArrays(f,d)}else p=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=w.now()-c),this.convertAndCacheOnCPU(e,p)}read(e){return Be(this,null,function*(){if(this.pendingRead.has(e)){let m=this.pendingRead.get(e);return new Promise(h=>m.push(h))}let t=this.texData.get(e),{values:n,shape:o,slice:a,dtype:i,complexTensorInfos:s,isPacked:u}=t;if(a!=null){let m;u?m=new Zn(o,Qp):m=new qr(o,Qp);let h=this.runWebGLProgram(m,[{dataId:e,shape:o,dtype:i}],i),g=this.read(h.dataId);return this.disposeIntermediateTensorInfo(h),g}if(n!=null)return this.convertAndCacheOnCPU(e);if(!X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&X().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,c;if(i!=="complex64"&&X().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);let m=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(m.texture,...qp(o))}this.pendingRead.set(e,[]),i!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let p;if(i==="complex64"){let m=yield Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),h=m[0],g=m[1];p=S.mergeRealAndImagArrays(h,g)}else if(l==null)p=this.getValuesFromTexture(e);else{let m=w.sizeFromShape(o);p=this.gpgpu.downloadFloat32MatrixFromBuffer(l,m)}if(c!=null&&this.disposeIntermediateTensorInfo(c),l!=null){let m=this.gpgpu.gl;Te(m,()=>m.deleteBuffer(l))}let f=this.convertAndCacheOnCPU(e,p),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach(m=>m(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Xn().removeDataId(e,this),this.pendingDeletes--),f})}bufferSync(e){let t=this.readSync(e.dataId),n=t;if(e.dtype==="string")try{n=t.map(o=>w.decodeString(o))}catch(o){throw new Error("Failed to decode encoded string bytes into utf-8")}return Me(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){let n=e[t];if(!_3(n))throw X().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:o}=this.texData.get(e),a=w.sizeFromShape(t);if(X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let f=this.decode(e),d=this.texData.get(f.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(d.texture,...qp(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(f),m}let i=X().getBool("WEBGL_PACK")&&o===!0,s=i?Rh(t):t,u=i?new cw(s):new lw(s),l=this.runWebGLProgram(u,[{shape:s,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(l),p}timerAvailable(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){return Be(this,null,function*(){let t=this.activeTimers,n=[],o=!1;this.programTimersStack==null?(this.programTimersStack=n,o=!0):this.activeTimers.push(n),this.activeTimers=n,e();let a=w.flatten(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=w.flatten(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=t,o&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let u=yield Promise.all(a);s.kernelMs=w.sum(u),s.getExtraProfileInfo=()=>u.map((l,c)=>({name:i[c],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:w.now(),endMs:null}}endTimer(e){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=w.now(),e)}getQueryTime(e){return Be(this,null,function*(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs})}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:o,usage:a,isPacked:i,slice:s}=this.texData.get(e),u=s&&s.origDataId||e,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),t!=null&&(this.numBytesInGPU-=this.computeBytes(o,n),this.textureManager.releaseTexture(t,o,a,i)));let c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Dfe){return X().getBool("WEBGL_CPU_FORWARD")&&e.every(n=>this.texData.get(n.dataId).texture==null&&w.sizeFromShape(n.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){S.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return Efe(e.shape,t)}packedUnaryOp(e,t,n){let o=new Zn(e.shape,t),a=this.compileAndRun(o,[e],n);return Xn().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){let o=Bh(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,o)}if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,kw,e.dtype);let t=new qr(e.shape,kw),n=this.compileAndRun(t,[e]);return Xn().makeTensorFromDataId(n.dataId,n.shape,n.dtype)}makeTensorInfo(e,t,n){let o;if(t==="string"&&n!=null&&n.length>0&&w.isString(n[0])){let a=n.map(i=>w.encodeString(i));o=this.write(a,e,t)}else o=this.write(n,e,t);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:t}}makeOutput(e,t,n){let{dataId:o}=this.makeTensorInfo(e,t,n);return Xn().makeTensorFromDataId(o,e,t,this)}unpackTensor(e){let t=new _w(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new bw(e.shape),n=!0;return this.runWebGLProgram(t,[e],e.dtype,null,n)}packedReshape(e,t){let n=[Wa(e.shape),...za(e.shape)],o={dtype:e.dtype,shape:n,dataId:e.dataId},a=[Wa(t),...za(t)],i=new Jp(a,n),s=!0,u=[n],l=this.runWebGLProgram(i,[o],e.dtype,u,s);return{dataId:l.dataId,shape:t,dtype:l.dtype}}decode(e){let t=this.texData.get(e),{isPacked:n,shape:o,dtype:a}=t,i=Rh(o),s,u=qp(i);n?s=new uw(i):s=new iw(i);let l=!0,c=[u],p=this.runWebGLProgram(s,[{shape:i,dtype:a,dataId:e}],a,c,l);return{dtype:a,shape:o,dataId:p.dataId}}runWebGLProgram(e,t,n,o,a=!1){let i=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(i.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===Va.DENSE){let g=qp(e.outputShape);s.texShape=g.map(v=>v*2)}if(e.outTexUsage!=null&&(s.usage=e.outTexUsage),w.sizeFromShape(i.shape)===0)return s.values=w.getTypedArrayFromDType(i.dtype,0),i;let u=[],l=t.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(g.dataId);if(v.texture==null){if(!e.packedInputs&&w.sizeFromShape(g.shape)<=X().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=g.shape)}else if(!!v.isPacked!=!!e.packedInputs)g=v.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),v=this.texData.get(g.dataId);else if(v.isPacked&&!pu(v.shape,g.shape)){let x=g,y=g.shape;g.shape=v.shape,g=this.packedReshape(g,y),u.push(g),v=this.texData.get(g.dataId),x.shape=y}return this.uploadToGPU(g.dataId),{shape:g.shape,texData:v,isUniform:!1}});this.uploadToGPU(i.dataId);let c={shape:i.shape,texData:s,isUniform:!1},p=Z3(e,l,c),f=this.getAndSaveBinary(p,()=>K3(this.gpgpu,e,l,c)),d=this.activeTimers!=null,m;d&&(m=this.startTimer()),Y3(this.gpgpu,f,l,c,o),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),d&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));let h=X().get("WEBGL_FLUSH_THRESHOLD");if(h>0){let g=w.now();g-this.lastGlFlushTime>h&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!X().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&a===!1){let g=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),g}return i}compileAndRun(e,t,n,o,a=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,o,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(X().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=mA(()=>{if(!X().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=X().getBool("DEBUG");X().set("DEBUG",!1);let t=this.abs(d0(1e-8)).dataSync()[0];if(X().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Tfe:Afe}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:o,values:a,texture:i,usage:s,isPacked:u}=t;if(i!=null)return;let l=this.activeTimers!=null,c;l&&(c=w.now());let p=t.texShape;if(p==null&&(p=O3(n,u),t.texShape=p),a!=null){let f=Rh(n),d,m=p[1],h=p[0],g=a instanceof Uint8Array||a instanceof Uint8ClampedArray;u?([m,h]=ho(p[0],p[1]),d=new fw(f,g)):d=new pw(f,g);let v=this.makeTensorInfo([h,m],o);g?this.texData.get(v.dataId).usage=Cr.PIXELS:this.texData.get(v.dataId).usage=Cr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),m,h,a);let x=[[h,m]],y=!0,b=this.runWebGLProgram(d,[v],o,x,y),k=this.texData.get(b.dataId);t.texture=k.texture,t.texShape=k.texShape,t.isPacked=k.isPacked,t.usage=k.usage,this.disposeIntermediateTensorInfo(v),this.texData.delete(b.dataId),t.values=null,l&&(this.uploadWaitMs+=w.now()-c)}else{let f=this.acquireTexture(p,s,o,u);t.texture=f}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:o}=n;return this.releaseGPUData(e),t!=null&&(n.values=Pfe(t,o)),n.values}acquireTexture(e,t,n,o){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,o)}computeBytes(e,t){return e[0]*e[1]*w.bytesPerElement(t)}};tc.nextDataId=0;function Pfe(r,e){if(e==="float32"||e==="complex64")return r;if(e==="int32"||e==="bool"){let t=e==="int32"?new Int32Array(r.length):new Uint8Array(r.length);for(let n=0;n<t.length;++n)t[n]=Math.round(r[n]);return t}else throw new Error(`Unknown dtype ${e}`)}eu.isBrowser()&&Vl("webgl",()=>new tc,2);var Wh=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;var Ln=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=S.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=Ut(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}};var Ua=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;var Jn=class{constructor(e,t,n,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=S.assertAndGetBroadcastShape(t,n);let a=this.outputShape.length;this.enableShapeUniforms=Ut(a);let i="";if(o)if(a===0||w.sizeFromShape(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Ve(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let u=qt("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${u[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${u[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${u[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${u[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}};function Kt(r){let{inputs:e,backend:t}=r,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}var fP={kernelName:lo,backendName:"webgl",kernelFunc:Kt};function Kr(r){let{inputs:e,backend:t}=r,{real:n,imag:o}=e,a=t.makeTensorInfo(n.shape,"complex64"),i=t.texData.get(a.dataId),s=Kt({inputs:{x:n},backend:t}),u=Kt({inputs:{x:o},backend:t});return i.complexTensorInfos={real:s,imag:u},a}var dP={kernelName:hl,backendName:"webgl",kernelFunc:Kr};var Sw="return (a < 0.) ? b * a : a;",Iw=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Ofe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{alpha:a}=n,i=t.makeTensorInfo([],"float32",w.createScalarValue(a,"float32")),s=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jn(Iw,o.shape,i.shape):new Ln(Sw,o.shape,i.shape),u=t.runWebGLProgram(s,[o,i],"float32");return t.disposeIntermediateTensorInfo(i),u}var mP={kernelName:Wo,backendName:"webgl",kernelFunc:Ofe};var Cw="return (a < 0.) ? b * a : a;",Nw=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Mfe(r){let{inputs:e,backend:t}=r,{x:n,alpha:o}=e,a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jn(Nw,n.shape,o.shape):new Ln(Cw,n.shape,o.shape);return t.runWebGLProgram(a,[n,o],"float32")}var hP={kernelName:Uo,backendName:"webgl",kernelFunc:Mfe};var zh="if (isnan(x)) return x;",gP=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,vP=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;function ke({opSnippet:r,packedOpSnippet:e,cpuKernelImpl:t,dtype:n}){return({inputs:o,backend:a})=>{let{x:i}=o,s=a,u=n||i.dtype;if(s.shouldExecuteOnCPU([i])&&t!=null){let p=s.texData.get(i.dataId),f=t(p.values,u);return s.makeTensorInfo(i.shape,u,f)}let l=X().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null,c;return l?c=new Zn(i.shape,e):c=new qr(i.shape,r),s.runWebGLProgram(c,[i],u)}}function ot({opSnippet:r,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:n=!1,cpuKernelImpl:o,dtype:a}){return({inputs:i,backend:s})=>{let{a:u,b:l}=i,c=s;if(n&&u.dtype==="complex64"){let m=c.texData.get(u.dataId),h=c.texData.get(l.dataId),[g,v]=[[m.complexTensorInfos.real,h.complexTensorInfos.real],[m.complexTensorInfos.imag,h.complexTensorInfos.imag]].map(y=>{let[b,k]=y,N={dataId:b.dataId,dtype:b.dtype,shape:u.shape},E={dataId:k.dataId,dtype:k.dtype,shape:l.shape},T=new Ln(r,u.shape,l.shape);return c.runWebGLProgram(T,[N,E],ur(b.dtype,k.dtype))}),x=Kr({inputs:{real:g,imag:v},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(v),x}let p=a||ur(u.dtype,l.dtype);if((u.dtype==="string"||l.dtype==="string"||c.shouldExecuteOnCPU([u,l]))&&o!=null){let m=c.texData.get(u.dataId).values,h=c.texData.get(l.dataId).values,g=u.dtype==="string"?S.fromUint8ToStringArray(m):m,v=u.dtype==="string"?S.fromUint8ToStringArray(h):h,[x,y]=o(u.shape,l.shape,g,v,p),b=c.makeTensorInfo(y,p),k=c.texData.get(b.dataId);return k.values=x,b}let f=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null,d;return f?d=new Jn(e,u.shape,l.shape,t):d=new Ln(r,u.shape,l.shape),c.runWebGLProgram(d,[u,l],p)}}function Ga(r,e=!1){if(r==="linear")return e?iP:rP;if(r==="relu")return e?lP:oP;if(r==="elu")return e?uP:nP;if(r==="relu6")return e?cP:aP;if(r==="prelu")return e?Nw:Cw;if(r==="leakyrelu")return e?Iw:Sw;if(r==="sigmoid")return e?pP:sP;throw new Error(`Activation ${r} has not been implemented for the WebGL backend.`)}var ef=class{constructor(e,t,n,o=!1,a=!1,i=!1,s=null,u=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Ut(this.outputShape.length);let c=o?e[1]:e[2],p=Math.ceil(c/2),f=o?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",m=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",v="";s&&(u?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:l?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:g=`vec4 activation(vec4 x) {
          ${s}
        }`,v="result = activation(result);");let x=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let y="rc.x",b="rc.x";e[0]<t[0]?y=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(b=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${p}; i++) {
          int batchA = ${y};
          int batchB = ${b};
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${d});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${h[0]});
          result += (${m[1]} * ${h[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${v}

        setOutput(result);
      }
    `}};var Ew={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},Uh=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=S.assertAndGetBroadcastShape(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}};var xP="return a * b;";function tf(r){let{inputs:e,backend:t}=r,{a:n,b:o}=e,a=S.upcastType(n.dtype,o.dtype);if(n.dtype==="complex64"){let s=t.texData.get(n.dataId),u=t.texData.get(o.dataId),l=new Uh(Ew.REAL,n.shape,o.shape),c=new Uh(Ew.IMAG,n.shape,o.shape),p=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:n.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:o.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:o.shape}],f=t.runWebGLProgram(l,p,"float32"),d=t.runWebGLProgram(c,p,"float32"),m=Kr({inputs:{real:f,imag:d},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),m}if(t.shouldExecuteOnCPU([n,o])){let s=t.texData.get(n.dataId),u=t.texData.get(o.dataId),[l,c]=R$(n.shape,o.shape,s.values,u.values,a),p=t.makeTensorInfo(c,a),f=t.texData.get(p.dataId);return f.values=l,p}let i;return X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Jn(xP,n.shape,o.shape):i=new Ln(xP,n.shape,o.shape),t.runWebGLProgram(i,[n,o],a)}var yP={kernelName:zo,backendName:"webgl",kernelFunc:tf};function bP(r,e,t){let n=[Wa(r.shape),...za(r.shape)],o={dtype:r.dtype,shape:n,dataId:r.dataId},a=[Wa(e),...za(e)],i=new Jp(a,n),s=!0,u=[n],l=t.runWebGLProgram(i,[o],r.dtype,u,s);return{dataId:l.dataId,shape:e,dtype:l.dtype}}function le(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{shape:a}=n,i=t,s=w.sizeFromShape(o.shape),u=w.inferFromImplicitShape(a,s),l=w.sizeFromShape(u);w.assert(s===l,()=>`The new shape (${u}) has ${l} elements and the old shape (${o.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);let c=i.texData.get(o.dataId);return c.isPacked&&!pu(o.shape,u)&&!(c.texture!==null&&pu(c.shape,u))?bP(o,u,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:u,dtype:o.dtype})}var wP={kernelName:Pa,backendName:"webgl",kernelFunc:le};var Gh=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:o,inSize:a,outSize:i}=e;this.outputShape=[o,i];let s=Math.floor(n/4)*4,u=n%4,l="sumValue += dot(values, ones);";if(t!=null){let p=1/t;l=`sumValue += dot(values * ${w.isInt(p)?p.toPrecision(2):p}, ones);`}let c="";a%n>0&&(c=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}};var Tw=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:o,inSize:a,outSize:i}=e;this.outputShape=[o,i];let s="0.0",u="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",u="min"):t==="max"&&(s="-1.0 / 1e-20",u="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");let c=Math.floor(n/4)*4,p=n%4,f=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,d="vec4";t==="all"?(s="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(s="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let m="";a%n>0&&(m=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${s};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${s});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${p===1}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${p===2}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${p===3}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${l});
      }
    `}};function Bfe(r){let e=[];for(;e.length===0||e[e.length-1].outSize!==1;){let t=e.length?e[e.length-1].outSize:r[1],n=S.computeOptimalWindowSize(t);e.push({inSize:t,windowSize:n,outSize:Math.ceil(t/n)})}return e}function cn(r,e,t,n){let o=Bfe(r.shape),a=r;for(let i=0;i<o.length;i++){let{inSize:s,windowSize:u,outSize:l}=o[i],c,p;t==="mean"?c=i===0?new Gh({windowSize:u,inSize:s,batchSize:r.shape[0],outSize:l},s):new Gh({windowSize:u,inSize:s,batchSize:r.shape[0],outSize:l}):c=new Tw({windowSize:u,inSize:s,batchSize:r.shape[0],outSize:l},t),p=a,a=n.runWebGLProgram(c,[a],e),p.dataId!==r.dataId&&n.disposeIntermediateTensorInfo(p)}return a}var Aw=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;let o=Ve(this.rank),a=Lfe(t);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}};function Lfe(r){let e=r.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);let t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(e);for(let o=0;o<r.length;o++)n[r[o]]=t[o];return n.join()}var Fw=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let o=Ve(this.rank),a=yw("rc",this.rank),i=new Array(this.rank);for(let c=0;c<t.length;c++)i[t[c]]=a[c];let s=`vec2(${i.slice(-2).join()})`,u=`++${a[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${i.join()}), ${s})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${u}) {
        result[1] = ${l};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${l};
        if(${u}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}};function ja(r,e,t){let n=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fw(r.shape,e):new Aw(r.shape,e);return t.runWebGLProgram(n,[r],r.dtype)}function kP(r,e,t,n){let o=e,a=r.shape.length,i=w.parseAxisParam(o,r.shape),s=i,u=S.getAxesPermutation(s,a),l=u!=null,c=r;l&&(c=ja(r,u,n),s=S.getInnerMostAxes(s.length,a)),S.assertAxesAreInnerMostDims("sum",s,a);let[p,f]=S.computeOutAndReduceShapes(c.shape,s),d=p;t&&(d=S.expandShapeToKeepDim(p,i));let m=w.sizeFromShape(f),g=w.sizeFromShape(r.shape)/m,v=le({inputs:{x:c},attrs:{shape:[g,m]},backend:n}),x=Ji(r.dtype),y=cn(v,x,"sum",n),b=le({inputs:{x:y},attrs:{shape:d},backend:n});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),l&&n.disposeIntermediateTensorInfo(c),b}function hu(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n;return kP(o,a,i,t)}var _P={kernelName:qo,backendName:"webgl",kernelFunc:hu};function _t(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{perm:a}=n,i=t,s=o.shape.length,u=new Array(s);for(let c=0;c<u.length;c++)u[c]=o.shape[a[c]];let l;if(i.shouldExecuteOnCPU([o])){let p=i.texData.get(o.dataId).values,f=mu(p,o.shape,o.dtype,a,u);l=i.makeTensorInfo(u,o.dtype);let d=i.texData.get(l.dataId);d.values=f}else l=ja(o,a,i);return l}var SP={kernelName:zi,backendName:"webgl",kernelFunc:_t};var Dw=1e3;function gu({a:r,b:e,transposeA:t,transposeB:n,backend:o,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:u=null}){let l=r.shape.length,c=e.shape.length,p=t?r.shape[l-2]:r.shape[l-1],f=n?e.shape[c-1]:e.shape[c-2],d=t?r.shape[l-1]:r.shape[l-2],m=n?e.shape[c-2]:e.shape[c-1],h=r.shape.slice(0,-2),g=e.shape.slice(0,-2),v=w.sizeFromShape(h),x=w.sizeFromShape(g),y=v===x||v===1||x===1;w.assert(l>=2&&c>=2&&y,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${h}) and (${g}).`);let k=(v>x?r.shape.slice(0,-2):e.shape.slice(0,-2)).concat([d,m]);w.assert(p===f,()=>`Error in matMul: inner shapes (${p}) and (${f}) of Tensors with shapes ${r.shape} and ${e.shape} and transposeA=${t} and transposeB=${n} must match.`);let N=t?[v,p,d]:[v,d,p],E=n?[x,m,f]:[x,f,m],T=le({inputs:{x:r},backend:o,attrs:{shape:N}}),R=le({inputs:{x:e},backend:o,attrs:{shape:E}}),$=[T,R],O=Math.max(v,x),M=t?T.shape[1]:T.shape[2],B=a!=null,L=i!=null,H=u==="leakyrelu",W=u!=null?Ga(u,!0):null,K=B||L||H||W!=null,J;if((d===1||m===1)&&M>Dw&&K===!1){let ee=T,Y=R;t&&(ee=_t({inputs:{x:T},backend:o,attrs:{perm:[0,2,1]}}),$.push(ee)),n&&(Y=_t({inputs:{x:R},backend:o,attrs:{perm:[0,2,1]}}),$.push(Y));let ne=m!==1,te=m===1,ce=ee;ne&&(ce=le({inputs:{x:ee},backend:o,attrs:{shape:[O,M,1]}}),$.push(ce));let pe=m===1?2:1,se=Y;te&&(se=le({inputs:{x:Y},backend:o,attrs:{shape:[O,1,M]}}),$.push(se));let fe=tf({inputs:{a:ce,b:se},backend:o});J=hu({inputs:{x:fe},backend:o,attrs:{axis:pe,keepDims:!0}}),$.push(fe)}else{let ee=ur(r.dtype,e.dtype),Y=new ef(N,E,[O,d,m],t,n,B,W,L,H),ne=[T,R];if(a!=null&&ne.push(a),L&&ne.push(i),H){let te=o.makeTensorInfo([],"float32",w.createScalarValue(s,"float32"));ne.push(te),$.push(te)}J=o.runWebGLProgram(Y,ne,ee)}let Q=le({inputs:{x:J},backend:o,attrs:{shape:k}});$.push(J);for(let ee of $)o.disposeIntermediateTensorInfo(ee);return Q}function Vfe(r){let{inputs:e,backend:t,attrs:n}=r,{a:o,b:a,bias:i,preluActivationWeights:s}=e,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:p}=n;return gu({a:o,b:a,transposeA:u,transposeB:l,backend:t,bias:i,preluActivationWeights:s,leakyreluAlpha:p,activation:c})}var IP={kernelName:Gi,backendName:"webgl",kernelFunc:Vfe};var CP="return abs(x);";function Wfe(r){let{inputs:e,backend:t}=r,{x:n}=e;if(t.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){let a=t.texData.get(n.dataId),i=Bh(a.values);return t.makeTensorInfo(n.shape,n.dtype,i)}let o;return X().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new Zn(n.shape,CP):o=new qr(n.shape,CP),t.runWebGLProgram(o,[n],n.dtype)}var NP={kernelName:dl,backendName:"webgl",kernelFunc:Wfe};var zfe=hr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Ufe=ke({opSnippet:zfe}),EP={kernelName:gp,backendName:"webgl",kernelFunc:Ufe};var Gfe=hr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,jfe=ke({opSnippet:Gfe}),TP={kernelName:vp,backendName:"webgl",kernelFunc:jfe};var AP="return a + b;",Hfe=ot({opSnippet:AP,packedOpSnippet:AP,supportsComplex:!0,cpuKernelImpl:m$}),FP={kernelName:Lo,backendName:"webgl",kernelFunc:Hfe};var Rw=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,i)=>`T${i}`);let n=[];this.variableNames.forEach(a=>{n.push(`float v${a} = get${a}AtOutCoords();`)});let o=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}};var $w=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,i)=>`T${i}`);let n=[];this.variableNames.forEach(a=>{n.push(`vec4 v${a} = get${a}AtOutCoords();`)});let o=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}};function jh(r){let{inputs:e,backend:t}=r,n=e;if(n.length===1)return Kt({inputs:{x:n[0]},backend:t});if(n.length>X().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let u=Math.floor(n.length/2),l=jh({inputs:n.slice(0,u),backend:t}),c=jh({inputs:n.slice(u),backend:t});return jh({inputs:[l,c],backend:t})}let o=n.map(u=>u.dtype).reduce((u,l)=>ur(u,l)),a=n.map(u=>u.shape),s=X().getBool("WEBGL_PACK")?new $w(n[0].shape,a):new Rw(n[0].shape,a);return t.runWebGLProgram(s,n,o)}var DP={kernelName:Os,backendName:"webgl",kernelFunc:jh};function qfe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n,s=o.shape.length,u=w.parseAxisParam(a,o.shape),l=u,c=S.getAxesPermutation(l,s),p=o;c!=null&&(p=_t({inputs:{x:o},backend:t,attrs:{perm:c}}),l=S.getInnerMostAxes(l.length,s)),S.assertAxesAreInnerMostDims("all",l,s);let[f,d]=S.computeOutAndReduceShapes(p.shape,l),m=w.sizeFromShape(d),h=le({inputs:{x:p},backend:t,attrs:{shape:[-1,m]}}),g=cn(h,h.dtype,"all",t),v;if(i){let x=S.expandShapeToKeepDim(f,u);v=le({inputs:{x:g},backend:t,attrs:{shape:x}})}else v=le({inputs:{x:g},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(p),v}var RP={kernelName:Ms,backendName:"webgl",kernelFunc:qfe};function Kfe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n,s=o.shape.length,u=w.parseAxisParam(a,o.shape),l=u,c=S.getAxesPermutation(l,s),p=o;c!=null&&(p=_t({inputs:{x:o},backend:t,attrs:{perm:c}}),l=S.getInnerMostAxes(l.length,s)),S.assertAxesAreInnerMostDims("any",l,s);let[f,d]=S.computeOutAndReduceShapes(p.shape,l),m=w.sizeFromShape(d),h=le({inputs:{x:p},backend:t,attrs:{shape:[-1,m]}}),g=cn(h,h.dtype,"any",t),v;if(i){let x=S.expandShapeToKeepDim(f,u);v=le({inputs:{x:g},backend:t,attrs:{shape:x}})}else v=le({inputs:{x:g},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(p),v}var $P={kernelName:Bs,backendName:"webgl",kernelFunc:Kfe};var Pw=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:o,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];let s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${s} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}};var Ow=class{constructor(e,t,n,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,w.assert(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");let s=this.outputShape,u=s.length,l=Ve(u),c=qt("coords",u),p,f;if(i===1){f=u+1;let T=Ve(f);p=`
        ${T} sourceLocR = ${T}(${c.join()}, 0);
        ++${c[u-1]};
        ${T} sourceLocG = ${T}(${c.join()}, 0);
        ++${c[u-2]};
        ${T} sourceLocA = ${T}(${c.join()}, 0);
        --${c[u-1]};
        ${T} sourceLocB = ${T}(${c.join()}, 0);
        --${c[u-2]};`}else f=u,p=`
        ${l} sourceLocR = coords;
        ++${c[u-1]};
        ${l} sourceLocG = coords;
        ++${c[u-2]};
        ${l} sourceLocA = coords;
        --${c[u-1]};
        ${l} sourceLocB = coords;
        --${c[u-2]};`;let d=["x","y","z","w","u","v"].slice(0,f),m="."+d[f-1],h=d.map(T=>"int "+T),g=qt("sourceLocR",f-1).concat("inIdx.r"),v=qt("sourceLocG",f-1).concat("inIdx.g"),x=qt("sourceLocB",f-1).concat("inIdx.b"),y=qt("sourceLocA",f-1).concat("inIdx.a"),b=n==="max"?"greaterThan":"lessThan",k=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${y.join()})));`,N=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${v.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${y.join()}) : 0.)`,E=o?"":`
      float getBestIndicesAChannel(${h.join()}) {
        return getChannel(getBestIndicesA(${d.join()}),
                                          vec2(${d.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${h.join()}) {
        return getChannel(getA(${d.join()}),
                               vec2(${d.slice(-2).join()}));
      }
      ${E}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${c[u-1]} < ${s[u-1]-1};
        bool hasNextRow = ${c[u-2]} < ${s[u-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${N};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${N};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function PP(r,e,t,n=null){let o=e.shape[0],a=e.shape[1];n!=null&&(o=n.shape[0],a=n.shape[1]);let i=S.computeOptimalWindowSize(a),s={windowSize:i,inSize:a,batchSize:o,outSize:Math.ceil(a/i)},u=new Pw(s,t,n==null),l=[e];n!=null&&l.push(n);let c=r.runWebGLProgram(u,l,"int32");if(c.shape[1]===1)return c;let p=PP(r,e,t,c);return r.disposeIntermediateTensorInfo(c),p}function OP(r,e,t,n=null){let o=n!=null?n.shape:e.shape,a=o[o.length-1],i=S.computeOptimalWindowSize(a),s=new Ow(o,i,t,n==null),u=n==null?[e]:[e,n],l=r.runWebGLProgram(s,u,"int32");if(l.shape.length===e.shape.length){let c=OP(r,e,t,l);return r.disposeIntermediateTensorInfo(l),c}return l}function Hh(r,e,t,n){let o=[t];if(S.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),o,e.shape.length),!X().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){let a=[],i=r.texData.get(e.dataId),s=i!==null&&i.isPacked,u=e;s&&(u=r.unpackTensor(e),a.push(u));let[l,c]=S.computeOutAndReduceShapes(u.shape,o),p=w.sizeFromShape(c),f=le({inputs:{x:u},backend:r,attrs:{shape:[-1,p]}});a.push(f);let d=PP(r,f,n);a.push(d);let m=le({inputs:{x:d},backend:r,attrs:{shape:l}});return a.forEach(h=>r.disposeIntermediateTensorInfo(h)),m}return OP(r,e,n)}function Xfe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a}=n,i=w.parseAxisParam(a,o.shape),s=S.getAxesPermutation(i,o.shape.length),u=o,l=[];s!=null&&(u=_t({inputs:{x:o},backend:t,attrs:{perm:s}}),l.push(u),i=S.getInnerMostAxes(i.length,u.shape.length)),S.assertAxesAreInnerMostDims("argMax",[i[0]],u.shape.length);let c=Hh(t,u,i[0],"max");return l.forEach(p=>t.disposeIntermediateTensorInfo(p)),c}var MP={kernelName:Ls,backendName:"webgl",kernelFunc:Xfe};function Yfe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a}=n,i=w.parseAxisParam(a,o.shape),s=S.getAxesPermutation(i,o.shape.length),u=o,l=[];s!=null&&(u=_t({inputs:{x:o},backend:t,attrs:{perm:s}}),l.push(u),i=S.getInnerMostAxes(i.length,u.shape.length)),S.assertAxesAreInnerMostDims("argMin",[i[0]],u.shape.length);let c=Hh(t,u,i[0],"min");return l.forEach(p=>t.disposeIntermediateTensorInfo(p)),c}var BP={kernelName:im,backendName:"webgl",kernelFunc:Yfe};var Zfe=hr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Jfe=ke({opSnippet:Zfe}),LP={kernelName:xp,backendName:"webgl",kernelFunc:Jfe};var Qfe=hr+"return log(x + sqrt(x * x + 1.0));",ede=ke({opSnippet:Qfe}),VP={kernelName:yp,backendName:"webgl",kernelFunc:ede};var tde=hr+`
  return atan(x);
`,rde=ke({opSnippet:tde}),WP={kernelName:bp,backendName:"webgl",kernelFunc:rde};var nde=gP+`
  return atan(a, b);
`,ode=`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+vP+`
  return result;
`,ade=ot({opSnippet:nde,packedOpSnippet:ode}),zP={kernelName:kp,backendName:"webgl",kernelFunc:ade};var sde=hr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,ide=ke({opSnippet:sde}),UP={kernelName:wp,backendName:"webgl",kernelFunc:ide};var vo=class{constructor(e,t,n,o=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,u=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;let h=t==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,v=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,x="0.0";if(h||(x="-1.0 / 1e-20"),n){let T=">=";this.userCode=`
        const ivec2 strides = ivec2(${s}, ${u});
        const ivec2 pads = ivec2(${d}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${T} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?a?g:v:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let y="max",b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(b="avgValue / count");let k=Math.floor(i/4)*4,N=i%4,E=`
      if (${h}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${y}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${u});
      const ivec2 pads = ivec2(${d}, ${m});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${E}
          }

          int xC = xCCorner + ${k};
          if (${N===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${N===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${N===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${E}
          }
        }
        setOutput(${b});
      }
    `}},vu=class{constructor(e,t,n,o=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,u=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,p=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,m=e.effectiveFilterHeight,h=e.effectiveFilterWidth,g=e.padInfo.front,v=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;let y=t==="avg",b="0.0";if(y||(b="-1.0 / 1e-20"),n){let $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${s}, ${u}, ${l});
        const ivec3 pads = ivec3(${g}, ${v}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${h};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${h} +
                      wR * ${h} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let k="max",N=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(N="avgValue / count");let E=Math.floor(i/4)*4,T=i%4,R=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${s}, ${u}, ${l});
      const ivec3 pads = ivec3(${g}, ${v}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${E}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${R}
            }

            int xC = xCCorner + ${E};
            if (${T===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${R}
            } else if (${T===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${R}
            } else if (${T===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${R}
            }
          }
          setOutput(${N});
        }
      }
    `}};function ude(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e;go(o,"avgPool");let{filterSize:a,strides:i,pad:s,dimRoundingMode:u}=n,l=1;w.assert(S.eitherStridesOrDilationsAreOne(i,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let c=S.computePool2DInfo(o.shape,a,i,l,s,u);if(c.filterWidth===1&&c.filterHeight===1&&w.arraysEqual(c.inShape,c.outShape))return Kt({inputs:{x:o},backend:t});let p=new vo(c,"avg",!1);return t.runWebGLProgram(p,[o],"float32")}var GP={kernelName:Vs,backendName:"webgl",kernelFunc:ude};function lde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{filterSize:a,strides:i,pad:s,dimRoundingMode:u,dataFormat:l}=n,c=[1,1,1],p=S.computePool3DInfo(o.shape,a,i,c,s,u,l),f=new vu(p,"avg",!1);return t.runWebGLProgram(f,[o],"float32")}var jP={kernelName:lm,backendName:"webgl",kernelFunc:lde};var Mw=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,o=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=u-1-e.padInfo.top,p=l-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${p});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${s}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},Bw=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,o=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,u=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,m=p-1-e.padInfo.front,h=f-1-e.padInfo.top,g=d-1-e.padInfo.left,v=1/(t*n*o);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${h}, ${g});
      const float avgMultiplier = float(${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function cde(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a}=e,i=a,{filterSize:s,strides:u,pad:l,dimRoundingMode:c}=n,p=[1,1,1],f=S.computePool3DInfo(i.shape,s,u,p,l,c),d=new Bw(f);return t.runWebGLProgram(d,[o],i.dtype)}var HP={kernelName:cm,backendName:"webgl",kernelFunc:cde};function pde(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a}=e,i=a;go([o,a],"avgPoolGrad");let{filterSize:s,strides:u,pad:l}=n,c=S.computePool2DInfo(i.shape,s,u,1,l),p=new Mw(c);return t.runWebGLProgram(p,[o],i.dtype)}var qP={kernelName:um,backendName:"webgl",kernelFunc:pde};function fde(r){let{inputs:e,backend:t,attrs:n}=r,{a:o,b:a}=e,{transposeA:i,transposeB:s}=n;return gu({a:o,b:a,transposeA:i,transposeB:s,backend:t})}var KP={kernelName:Ws,backendName:"webgl",kernelFunc:fde};var Lw=class{constructor(e,t,n,o,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],S.assertAndGetBroadcastShape(e,t),S.assertAndGetBroadcastShape(e,n);let s="0.0";o!=null&&(S.assertAndGetBroadcastShape(e,o),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let u="1.0";a!=null&&(S.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}};var Vw=class{constructor(e,t,n,o,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],S.assertAndGetBroadcastShape(e,t),S.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";o!=null&&(S.assertAndGetBroadcastShape(e,o),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let u="vec4(1.0)";a!=null&&(S.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}};var dde=({inputs:r,backend:e,attrs:t})=>{let{x:n,mean:o,variance:a,offset:i,scale:s}=r;w.assert(o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),w.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),w.assert(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=t;u==null&&(u=.001);let l=[n,o,a],c=null;i!=null&&(c=i.shape,l.push(i));let p=null;s!=null&&(p=s.shape,l.push(s));let f=X().getBool("WEBGL_PACK_NORMALIZATION")?new Vw(n.shape,o.shape,a.shape,c,p,u):new Lw(n.shape,o.shape,a.shape,c,p,u);return e.runWebGLProgram(f,l,l[0].dtype)},XP={kernelName:ni,backendName:"webgl",kernelFunc:dde};var Ww=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=Ve(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n=mde(this.rank),o,a=e.map((i,s)=>`sourceLoc.${zw[s]} = start[${s}] + coords.${zw[s]};`);o=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${n}));
      }
    `}},zw=["x","y","z","w","u","v"];function mde(r){if(r===1)return"sourceLoc";if(r<=6)return zw.slice(0,r).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${r} is not yet supported`)}var Uw=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=Ve(this.rank),n=qt("coords",this.rank),o=qt("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${a})`,s=`
      result.x = ${i};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((c,p)=>`start[${p}]`).join()});`:e.map((c,p)=>`${o[p]} = ${n[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${s}
        ${u}
        setOutput(result);
      }
    `}};function hde(r,e,t,n){let o=n.texData.get(r.dataId),a=n.makeTensorInfo(t,r.dtype),i=n.texData.get(a.dataId);Object.assign(i,o),i.refCount=1,i.shape=t,i.dtype=r.dtype;let s=Tt.computeFlatOffset(e,w.computeStrides(r.shape));o.slice&&(s+=o.slice.flatOffset),i.slice={flatOffset:s,origDataId:o.slice&&o.slice.origDataId||r.dataId};let u=n.dataRefCount.get(i.slice.origDataId)||1;return n.dataRefCount.set(i.slice.origDataId,u+1),a}function Qn(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{begin:a,size:i}=n,[s,u]=Tt.parseSliceParams(o,a,i);if(Tt.assertParamsValid(o,s,u),w.sizeFromShape(u)===0)return t.makeTensorInfo(u,o.dtype,[]);if(t.shouldExecuteOnCPU([o])||o.dtype==="string"){let p=t.texData.get(o.dataId),f=V$(p.values,s,u,o.shape,o.dtype);return t.makeTensorInfo(u,o.dtype,f)}let{isPacked:l}=t.texData.get(o.dataId),c=Tt.isSliceContinous(o.shape,s,u);if(l||!c){let p=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Uw(u):new Ww(u),f=[s];return t.runWebGLProgram(p,[o],o.dtype,f)}return t.uploadToGPU(o.dataId),hde(o,s,u,t)}var YP={kernelName:Il,backendName:"webgl",kernelFunc:Qn};var gde=r=>{let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockShape:a,crops:i}=n;w.assert(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let s=a.reduce((x,y)=>x*y),u=S.getReshaped(o.shape,a,s),l=S.getPermuted(u.length,a.length),c=S.getReshapedPermuted(o.shape,a,s),p=S.getSliceBeginCoords(i,a.length),f=S.getSliceSize(c,i,a.length),d=[],m=le({inputs:{x:o},backend:t,attrs:{shape:u}}),h=_t({inputs:{x:m},backend:t,attrs:{perm:l}}),g=le({inputs:{x:h},backend:t,attrs:{shape:c}}),v=Qn({inputs:{x:g},backend:t,attrs:{begin:p,size:f}});return d.push(m),d.push(h),d.push(g),d.forEach(x=>t.disposeIntermediateTensorInfo(x)),v},ZP={kernelName:ml,backendName:"webgl",kernelFunc:gde};function vde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,weights:a}=e,{size:i}=n,s=t.readSync(o.dataId),u=t.readSync(a.dataId),l=Mh(s,u,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,l)}var JP={kernelName:pm,backendName:"webgl",kernelFunc:vde};function xde(r){let{inputs:e,backend:t}=r,{s0:n,s1:o}=e,a=t.readSync(n.dataId),i=t.readSync(o.dataId),s=S.assertAndGetBroadcastShape(Array.from(a),Array.from(i));return t.makeTensorInfo([s.length],"int32",Int32Array.from(s))}var QP={kernelName:fm,backendName:"webgl",kernelFunc:xde};var yde="return float(a != b);",Gw=ot({opSnippet:yde,cpuKernelImpl:P$,dtype:"bool"}),eO={kernelName:xi,backendName:"webgl",kernelFunc:Gw};function ra(r){let{inputs:e,backend:t}=r,{input:n}=e,o=t.texData.get(n.dataId);return Kt({inputs:{x:o.complexTensorInfos.real},backend:t})}var tO={kernelName:Om,backendName:"webgl",kernelFunc:ra};var bde="return float(int(x));";function rO(r,e){let t=new qr(r.shape,bde),n=e.runWebGLProgram(t,[r],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}function jw(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{dtype:a}=n;if(a==="complex64"){if(o.dtype==="complex64")return Kt({inputs:{x:o},backend:t});let i=Wp(o.shape),s=jw({inputs:{x:o},backend:t,attrs:{dtype:"float32"}}),u=Kr({inputs:{real:s,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(s),u}if(o.dtype==="complex64"){let i=ra({inputs:{input:o},backend:t}),s=jw({inputs:{x:i},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(i),s}if(!w.hasEncodingLoss(o.dtype,a)){let i=Kt({inputs:{x:o},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(a==="int32")return rO(o,t);if(a==="bool"){let i=t.makeTensorInfo([],"bool",w.getTypedArrayFromDType("bool",1)),u=Gw({inputs:{a:o,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),u}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${a}`)}var nO={kernelName:uo,backendName:"webgl",kernelFunc:jw};var oO="return ceil(x);",wde=ke({opSnippet:oO,packedOpSnippet:oO,cpuKernelImpl:g$}),aO={kernelName:zs,backendName:"webgl",kernelFunc:wde};var Hw=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}};var qw=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function kde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{clipValueMin:a,clipValueMax:i}=n,s;X().getBool("WEBGL_PACK_CLIP")?s=new qw(o.shape):s=new Hw(o.shape);let u=[[a],[i]];return t.runWebGLProgram(s,[o],o.dtype,u)}var sO={kernelName:$a,backendName:"webgl",kernelFunc:kde};var Kw=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function iO(r,e){return{dataId:e.dataId,dtype:e.dtype,shape:r.shape}}function _de(r){let{inputs:e,backend:t}=r,{x:n}=e,o=t.texData.get(n.dataId),a=new Kw(n.shape),i=[iO(n,o.complexTensorInfos.real),iO(n,o.complexTensorInfos.imag)];return t.runWebGLProgram(a,i,i[0].dtype)}var uO={kernelName:dm,backendName:"webgl",kernelFunc:_de};var Xw=class{constructor(e){this.outputShape=[],this.outputShape=S.computeOutShape(e,1),this.variableNames=e.map((i,s)=>`T${s}`);let t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){let s=t[i-1];n.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${s}));`)}let o=t.length,a=t[t.length-1];n.push(`else setOutput(getT${o}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}};var Yw=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=S.computeOutShape(e,t);let n=this.outputShape,o=n.length,a=Ve(o),i=qt("coords",o),s=["x","y","z","w","u","v"].slice(0,o);this.variableNames=e.map((h,g)=>`T${g}`);let u=new Array(e.length-1);u[0]=e[0][t];for(let h=1;h<u.length;h++)u[h]=u[h-1]+e[h][t];let l=s[t],c=s.slice(-2),p=s.join(),f=`if (${l} < ${u[0]}) {
        return getChannel(
            getT0(${p}), vec2(${c.join()}));
        }`;for(let h=1;h<u.length;h++){let g=u[h-1];f+=`
        if (${l} < ${u[h]}  && ${l} >= ${u[h-1]}) {
          return getChannel(
            getT${h}(${qh(s,l,g)}),
            vec2(${qh(c,l,g)}));
        }`}let d=u.length,m=u[u.length-1];f+=`
        return getChannel(
          getT${d}(${qh(s,l,m)}),
          vec2(${qh(c,l,m)}));`,this.userCode=`
      float getValue(${s.map(h=>"int "+h)}) {
        ${f}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${n[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${n[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${n[o-2]} &&
            ${i[o-1]} < ${n[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}};function qh(r,e,t){let n=r.indexOf(e);return r.map((a,i)=>i===n?`${a} - ${t}`:a).join()}function xu(r){let{inputs:e,backend:t}=r,{input:n}=e,o=t.texData.get(n.dataId);return Kt({inputs:{x:o.complexTensorInfos.imag},backend:t})}var lO={kernelName:Nm,backendName:"webgl",kernelFunc:xu};function yu(r,e,t){let n=r[0].dtype;if(n==="complex64"){let c=r.map(h=>ra({inputs:{input:h},backend:t})),p=r.map(h=>xu({inputs:{input:h},backend:t})),f=yu(c,e,t),d=yu(p,e,t),m=Kr({inputs:{real:f,imag:d},backend:t});return c.forEach(h=>t.disposeIntermediateTensorInfo(h)),p.forEach(h=>t.disposeIntermediateTensorInfo(h)),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),m}let o=t.shouldExecuteOnCPU(r);if(n==="string"&&(o=!0),o){let c=r.map(v=>{let x=w.sizeFromShape(v.shape.slice(e));return le({inputs:{x:v},backend:t,attrs:{shape:[-1,x]}})}),p=c.map(v=>({vals:t.readSync(v.dataId),shape:v.shape})),f=S.computeOutShape(c.map(v=>v.shape),1),d=c[0].shape[0]===1,m=v$(p,f,n,d),h=S.computeOutShape(r.map(v=>v.shape),e),g=t.makeTensorInfo(h,n,m);return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),g}if(r.length>X().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let c=Math.floor(r.length/2),p=yu(r.slice(0,c),e,t),f=yu(r.slice(c),e,t),d=yu([p,f],e,t);return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),d}if(X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1){let c=new Yw(r.map(p=>p.shape),e);return t.runWebGLProgram(c,r,n)}let{tensors2D:a,outShape:i}=Sde(r,e,t),s=new Xw(a.map(c=>c.shape)),u=t.runWebGLProgram(s,a,n);a.forEach(c=>t.disposeIntermediateTensorInfo(c));let l=le({inputs:{x:u},attrs:{shape:i},backend:t});return t.disposeIntermediateTensorInfo(u),l}function Sde(r,e,t){let n=S.computeOutShape(r.map(a=>a.shape),e);return{tensors2D:r.map(a=>le({inputs:{x:a},attrs:{shape:[-1,w.sizeFromShape(a.shape.slice(e))]},backend:t})),outShape:n}}function Zw(r){let{inputs:e,backend:t,attrs:n}=r,{axis:o}=n,a=w.parseAxisParam(o,e[0].shape)[0],i=S.computeOutShape(e.map(l=>l.shape),a);if(w.sizeFromShape(i)===0)return t.makeTensorInfo(i,e[0].dtype,[]);let s=e.filter(l=>w.sizeFromShape(l.shape)>0);if(s.length===1)return Kt({inputs:{x:s[0]},backend:t});let u=s.map(l=>l.shape);return S.assertParamsConsistent(u,a),yu(s,a,t)}var cO={kernelName:gl,backendName:"webgl",kernelFunc:Zw};var rf=class{constructor(e,t=!1,n=null,o=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,p=e.dilationWidth,f=e.filterHeight,d=e.filterWidth,m=Math.floor(e.inChannels/4)*4,h=e.inChannels%4,g=e.dataFormat==="channelsLast",v=g?1:2,x=g?2:3,y=g?3:1,b="",k="";n&&(o?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:b=`
          float activation(float x) {
            ${n}
          }
        `,k="result = activation(result);");let N=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${u}, ${l});
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${y}];

        ivec2 xRCCorner =
            ivec2(coords[${v}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${h===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${h===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${h===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${N}
        ${k}
        setOutput(result);
      }
    `}},Jw=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,o=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,u=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,p=e.filterDepth,f=e.filterHeight,d=e.filterWidth,m=Math.floor(e.inChannels/4)*4,h=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${s});
      const ivec3 pads = ivec3(${t}, ${n}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${h===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${h===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${h===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};var Qw=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Ut(this.outputShape.length);let{dataFormat:n}=t,o=At(),a=n==="channelsLast",i=a?0:1,s=a?1:2,u=this.enableShapeUniforms?"if(blockIndex < outShape[1] && pos < outShape[0]) {":`if(blockIndex < ${e[1]} && pos < ${e[0]}) {`,l="";for(let c=0;c<=1;c++)for(let p=0;p<=1;p++)l+=`
          blockIndex = rc.y + ${p};
          pos = rc.x + ${c};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${s}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+p}] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+p}] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${o.output} = result;
      }
    `}};function Kh({x:r,filter:e,convInfo:t,backend:n,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:s=null}){let u=r.shape,l=n.texData.get(r.dataId),c=t.inChannels,p=u[0]*u[1]*u[2],f=t.outChannels,d=t.dataFormat==="channelsLast",m=!1,h=!1,g,v=[];if(!((p===1||f===1)&&c>Dw)&&l.isPacked&&d&&l.texture!=null&&u[2]%2!=0&&w.arraysEqual(l.shape.slice(-3),u.slice(-3))){let b=u[0]*u[1]*(u[2]+1),k={dataId:r.dataId,shape:[1,b,t.inChannels],dtype:r.dtype},N=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,w.assert(pu(l.shape,k.shape),()=>`packed reshape ${l.shape} to ${k.shape} isn't free`);let E=le({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}});v.push(E);let T=gu({a:k,b:E,backend:n,transposeA:m,transposeB:h,bias:o,activation:s,preluActivationWeights:a,leakyreluAlpha:i}),R=n.texData.get(T.dataId);w.assert(R.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=N,R.shape=t.outShape,g=Kt({inputs:{x:T},backend:n}),g.shape=t.outShape,v.push(T)}else{let b=d?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],k=le({inputs:{x:r},backend:n,attrs:{shape:[1,b,t.inChannels]}}),N=le({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}}),E=gu({a:k,b:N,transposeA:m,transposeB:h,backend:n,bias:o,activation:s,preluActivationWeights:a,leakyreluAlpha:i});g=le({inputs:{x:E},backend:n,attrs:{shape:t.outShape}}),v.push(k),v.push(N),v.push(E)}for(let b of v)n.disposeIntermediateTensorInfo(b);return g}function Xh({x:r,filter:e,convInfo:t,backend:n,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:s=null}){let{filterWidth:u,filterHeight:l,inChannels:c,outWidth:p,outHeight:f,dataFormat:d}=t,m=d==="channelsLast",h=u*l*c,g=f*p,v=[h,g],x=!0,y=!1,b=[],k=le({inputs:{x:r},backend:n,attrs:{shape:r.shape.slice(1)}}),N=le({inputs:{x:e},backend:n,attrs:{shape:[1,h,w.sizeFromShape(e.shape)/h]}});b.push(k),b.push(N);let E=new Qw(v,t),T=[k.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],R=n.runWebGLProgram(E,[k],"float32",T),$=le({inputs:{x:R},backend:n,attrs:{shape:[1,v[0],v[1]]}});b.push(R),b.push($);let O=o!=null,M=a!=null,B=s==="leakyrelu",L=s?Ga(s,!0):null,H=new ef($.shape,N.shape,[1,g,t.outChannels],x,y,O,L,M,B),W=[$,N];if(o&&W.push(o),M&&W.push(a),B){let ee=n.makeTensorInfo([],"float32",w.createScalarValue(i,"float32"));W.push(ee),b.push(ee)}let K=n.runWebGLProgram(H,W,"float32"),J=m?[1,f,p,t.outChannels]:[1,t.outChannels,f,p],Q=le({inputs:{x:K},backend:n,attrs:{shape:J}});b.push(K);for(let ee of b)n.disposeIntermediateTensorInfo(ee);return Q}function Ide(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dataFormat:u,dilations:l,dimRoundingMode:c}=n,p=S.convertConv2DDataFormat(u),f=S.computeConv2DInfo(o.shape,a.shape,i,l,s,c,!1,p),d;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))d=Kh({x:o,filter:a,convInfo:f,backend:t});else if(X().getBool("WEBGL_CONV_IM2COL")&&o.shape[0]===1)d=Xh({x:o,filter:a,convInfo:f,backend:t});else{let h=new rf(f);d=t.runWebGLProgram(h,[o,a],"float32")}let m=le({inputs:{x:d},backend:t,attrs:{shape:f.outShape}});return t.disposeIntermediateTensorInfo(d),m}var pO={kernelName:Us,backendName:"webgl",kernelFunc:Ide};var e1=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,o=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},t1=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,o=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",s=t-1-e.padInfo.top,u=n-1-e.padInfo.left,l=i?1:2,c=i?2:3,p=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},r1=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,o=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${s};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},n1=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,o=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,u=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=o-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${l}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Cde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,dy:a}=e,{strides:i,pad:s,dataFormat:u,dimRoundingMode:l,filterShape:c}=n,p=S.convertConv2DDataFormat(u),f=S.computeConv2DInfo(o.shape,c,i,1,s,l,!1,p),d=new e1(f);return t.runWebGLProgram(d,[o,a],"float32")}var fO={kernelName:mm,backendName:"webgl",kernelFunc:Cde};function Nde(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,filter:a}=e,{inputShape:i,strides:s,pad:u,dataFormat:l,dimRoundingMode:c}=n,p=S.convertConv2DDataFormat(l),f=S.computeConv2DInfo(i,a.shape,s,1,u,c,!1,p),d=new t1(f);return t.runWebGLProgram(d,[o,a],"float32")}var dO={kernelName:Gs,backendName:"webgl",kernelFunc:Nde};function Ede(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dilations:u}=n,l=S.computeConv3DInfo(o.shape,a.shape,i,u,s),c=new Jw(l);return t.runWebGLProgram(c,[o,a],"float32")}var mO={kernelName:hm,backendName:"webgl",kernelFunc:Ede};function Tde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,dy:a}=e,{strides:i,pad:s,filterShape:u}=n,l=S.computeConv3DInfo(o.shape,u,i,1,s),c=new r1(l);return t.runWebGLProgram(c,[o,a],"float32")}var hO={kernelName:gm,backendName:"webgl",kernelFunc:Tde};function Ade(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,filter:a}=e,{pad:i,strides:s,inputShape:u}=n,l=S.computeConv3DInfo(u,a.shape,s,1,i),c=new n1(l);return t.runWebGLProgram(c,[o,a],"float32")}var gO={kernelName:vm,backendName:"webgl",kernelFunc:Ade};var Fde=zh+`
  return cos(x);
`,Dde=ke({opSnippet:Fde}),vO={kernelName:js,backendName:"webgl",kernelFunc:Dde};var Rde=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,$de=ke({opSnippet:Rde}),xO={kernelName:Hs,backendName:"webgl",kernelFunc:$de};var o1=class{constructor(e,t,n,o,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,u,l]=e,[c]=t,[p,f]=n;this.outputShape=[c,p,f,l];let d=o==="bilinear"?1:0,[m,h]=[`${s-1}.0`,`${u-1}.0`],[g,v,x]=p>1?[`${(s-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[y,b,k]=f>1?[`${(u-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${h} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${h}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${y});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${v};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${h} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${d} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}};var Pde=r=>{let{inputs:e,backend:t,attrs:n}=r,{image:o,boxes:a,boxInd:i}=e,{cropSize:s,method:u,extrapolationValue:l}=n,c=new o1(o.shape,a.shape,s,u,l);return t.runWebGLProgram(c,[o,a,i],"float32")},yO={kernelName:Ks,backendName:"webgl",kernelFunc:Pde};var Yh=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}],this.outputShape=e;let o=e.length,a=t?"0.0":`getX(${bO(o,"coords")})`,i=e[e.length-1],s="",u="";t?(s=n?`end != ${i-1}`:"end != 0",u=n?"end + 1":"end - 1"):(s=n?`end + pow2 < ${i}`:"end >= pow2",u=n?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Ve(o)} coords = getOutputCoords();
        int end = ${wO(o,"coords")};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${s}) {
          int idx = ${u};
          ${wO(o,"coords")} = idx;
          val += getX(${bO(o,"coords")});
        }
        setOutput(val);
      }
    `}};function bO(r,e){if(r===1)return`${e}`;if(r===2)return`${e}.x, ${e}.y`;if(r===3)return`${e}.x, ${e}.y, ${e}.z`;if(r===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative sum for rank ${r} is not yet supported`)}function wO(r,e){if(r===1)return`${e}`;if(r===2)return`${e}.y`;if(r===3)return`${e}.z`;if(r===4)return`${e}.w`;throw Error(`Cumulative sum for rank ${r} is not yet supported`)}function Ode(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,exclusive:i,reverse:s}=n,u=o.shape.length,l=S.getAxesPermutation([a],u),c=o;l!=null&&(c=_t({inputs:{x:o},backend:t,attrs:{perm:l}}));let p=S.getInnerMostAxes(1,u)[0];if(p!==u-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${o.shape.length-1} but got axis=${a}`);let f=c.shape[p],d=Kt({inputs:{x:c},backend:t});for(let m=0;m<=Math.ceil(Math.log2(f))-1;m++){let h=new Yh(c.shape,!1,s),g=[[m]],v=d;d=t.runWebGLProgram(h,[d],d.dtype,g),t.disposeIntermediateTensorInfo(v)}if(i){let m=new Yh(c.shape,i,s),h=d;d=t.runWebGLProgram(m,[d],d.dtype),t.disposeIntermediateTensorInfo(h)}if(l!=null){let m=S.getUndoAxesPermutation(l),h=_t({inputs:{x:d},backend:t,attrs:{perm:m}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(c),h}return d}var kO={kernelName:qs,backendName:"webgl",kernelFunc:Ode};function Mde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,weights:a}=e,{size:i,binaryOutput:s}=n;if(o.shape.length===1){let u=t.readSync(o.dataId),l=t.readSync(a.dataId),c=Mh(u,l,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,c)}else if(o.shape.length===2){let u=t.bufferSync(o),l=t.bufferSync(a),c=h$(u,l,i,s);return t.makeTensorInfo(c.shape,a.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var _O={kernelName:xm,backendName:"webgl",kernelFunc:Mde};var a1=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function Bde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockSize:a,dataFormat:i}=n,s=o.shape[0],u=i==="NHWC"?o.shape[1]:o.shape[2],l=i==="NHWC"?o.shape[2]:o.shape[3],c=i==="NHWC"?o.shape[3]:o.shape[1],p=u*a,f=l*a,d=c/(a*a),m=i==="NHWC"?[s,p,f,d]:[s,d,p,f],h=new a1(m,a,i);return t.runWebGLProgram(h,[o],o.dtype)}var SO={kernelName:Xs,backendName:"webgl",kernelFunc:Bde};var nf=class{constructor(e,t=!1,n=null,o=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ut(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,u=e.outChannels/e.inChannels,l="",c="";n&&(o?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:l=`
          float activation(float x) {
            ${n}
          }
        `,c="result = activation(result);");let p=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${s}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${c}
        setOutput(result);
      }
    `}};var of=class{constructor(e,t=!1,n=null,o=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ut(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,u=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,p=e.filterWidth,f=p,d=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<p;v++)d+=`
          vec4 xTexelC${v*2};
          int xTexelC${v*2}Ready;
          vec4 xTexelC${v*2+1};
          int xTexelC${v*2+1}Ready;
          vec4 xC${v};`;d+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let v=0;v<p;v++)d+=`
          xTexelC${v*2} = vec4(0.0);
          xTexelC${v*2}Ready = 0;
          xTexelC${v*2+1} = vec4(0.0);
          xTexelC${v*2+1}Ready = 0;
          xC${v} = vec4(0.0);`;d+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let v=0;v<(f+1)/2;v++){let x=v*2;if(d+=`
          xC = xCCorner + ${x*l};
          `,u===1){if(x<p&&(s%2==1?(d+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,l===1&&x>0?d+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:d+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):d+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<p)){let y=s%2==0?w.nearestLargerEven(l):l;l%2==0&&s%2==1||l%2!=0&&s%2!=1?(d+=`
                  xCOffset = xC + imod(pads[1], 2) + ${y};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,l>1&&(d+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                      xTexelC${x} = getX(batch, xR, xCOffset, d1);
                      xTexelC${x}Ready = 1;
                    }
                    `),d+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                  `):y===1?d+=`
                    xC${x+1} = xTexelC${x};
                    `:d+=`
                    xCOffset = xC + ${y};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<p&&(s%2==1?(d+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<p&&(d+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(d+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<p&&(d+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<p&&(d+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<p&&(d+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}d+=`
    }
  `,d+=`
      }
    `;let m="",h="";n&&(o?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:m=`vec4 activation(vec4 x) {
          ${n}
        }`,h="result = activation(result);");let g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${d}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${h}
        setOutput(result);
      }
    `}};function Lde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dilations:u,dimRoundingMode:l}=n,c=u;c==null&&(c=[1,1]),w.assert(S.eitherStridesOrDilationsAreOne(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let p=S.computeConv2DInfo(o.shape,a.shape,i,c,s,l,!0),f;X().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels==1?f=new of(p):f=new nf(p);let d=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return t.runWebGLProgram(f,[o,a],"float32",d)}var IO={kernelName:Ys,backendName:"webgl",kernelFunc:Lde};var s1=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,o=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},i1=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,o=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Vde(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,dy:a}=e,{strides:i,dilations:s,pad:u,dimRoundingMode:l,filterShape:c}=n,p=S.computeConv2DInfo(o.shape,c,i,s,u,l,!0),f=new s1(p);return t.runWebGLProgram(f,[o,a],"float32")}var CO={kernelName:ym,backendName:"webgl",kernelFunc:Vde};function Wde(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,filter:a}=e,{strides:i,dilations:s,pad:u,dimRoundingMode:l,inputShape:c}=n,p=S.computeConv2DInfo(c,a.shape,i,s,u,l,!0),f=new i1(p);return t.runWebGLProgram(f,[o,a],"float32")}var NO={kernelName:bm,backendName:"webgl",kernelFunc:Wde};var u1=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function zde(r){let{inputs:e,backend:t}=r,{x:n}=e,o=[...n.shape,...n.shape],a=w.sizeFromShape(n.shape),i=le({inputs:{x:n},backend:t,attrs:{shape:[a]}}),s=new u1(a),u=t.runWebGLProgram(s,[i],i.dtype),l=le({inputs:{x:u},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(u),l}var EO={kernelName:wm,backendName:"webgl",kernelFunc:zde};var l1=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:o,strideHeight:a,strideWidth:i,filterHeight:s,filterWidth:u,dilationHeight:l,dilationWidth:c}=e,{top:p,left:f}=o;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${p}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${s}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function Ude(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dilations:u}=n,l=S.computeDilation2DInfo(o.shape,a.shape,i,s,"NHWC",u),c,p=new l1(l);c=t.runWebGLProgram(p,[o,a],"float32");let f=le({inputs:{x:c},backend:t,attrs:{shape:l.outShape}});return t.disposeIntermediateTensorInfo(c),f}var TO={kernelName:km,backendName:"webgl",kernelFunc:Ude};function Gde(r){let{inputs:e,backend:t,attrs:n}=r,{equation:o}=n,a=e,{allDims:i,summedDims:s,idDims:u}=S.decodeEinsumEquation(o,a.length);S.checkEinsumDimSizes(i.length,u,a);let{path:l,steps:c}=S.getEinsumComputePath(s,u),p=c.length,f=null,d=i.length,m=[];for(let h=0;h<p;++h){for(let g of c[h]){let{permutationIndices:v,expandDims:x}=S.getEinsumPermutation(d,u[g]),y;S.isIdentityPermutation(v)?y=a[g]:(y=_t({inputs:{x:a[g]},backend:t,attrs:{perm:v}}),m.push(y));let b=y.shape.slice();for(let k=0;k<x.length;++k)b.splice(x[k],0,1);w.arraysEqual(y.shape,b)||(y=le({inputs:{x:y},backend:t,attrs:{shape:b}}),m.push(y)),f===null?f=y:(f=tf({inputs:{a:y,b:f},backend:t}),m.push(f))}h<p-1&&(l[h]>=0&&(f=hu({inputs:{x:f},backend:t,attrs:{axis:l[h]-(i.length-d),keepDims:!1}}),m.push(f)),d--)}for(let h of m)h!==f&&t.disposeIntermediateTensorInfo(h);return f}var AO={kernelName:_m,backendName:"webgl",kernelFunc:Gde};var jde="return (x >= 0.0) ? x : (exp(x) - 1.0);",Hde=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,qde=ke({opSnippet:jde,packedOpSnippet:Hde}),FO={kernelName:Vo,backendName:"webgl",kernelFunc:qde};var Kde="return (b >= 1.0) ? a : a * (b + 1.0);",Xde=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Yde=r=>{let{inputs:e,backend:t}=r,{dy:n,y:o}=e,a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jn(Xde,n.shape,o.shape):new Ln(Kde,n.shape,o.shape);return t.runWebGLProgram(a,[n,o],n.dtype)},DO={kernelName:Sm,backendName:"webgl",kernelFunc:Yde};var Zde=`
  return vec4(equal(a, b));
`,Jde="return float(a == b);",Qde=ot({opSnippet:Jde,packedOpSnippet:Zde,dtype:"bool",cpuKernelImpl:x$}),RO={kernelName:Js,backendName:"webgl",kernelFunc:Qde};var eme=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${S.ERF_P};
  float a1 = ${S.ERF_A1};
  float a2 = ${S.ERF_A2};
  float a3 = ${S.ERF_A3};
  float a4 = ${S.ERF_A4};
  float a5 = ${S.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,tme=ke({opSnippet:eme}),$O={kernelName:_p,backendName:"webgl",kernelFunc:tme};var PO="return exp(x);",c1=ke({opSnippet:PO,packedOpSnippet:PO,cpuKernelImpl:y$,dtype:"float32"}),OO={kernelName:Qs,backendName:"webgl",kernelFunc:c1};function Zh(r){let{inputs:e,attrs:t,backend:n}=r,{dim:o}=t,{input:a}=e,i=a.shape.length,s=a.shape.slice(),u=o;return o<0&&(w.assert(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+o+1),s.splice(u,0,1),le({inputs:{x:a},backend:n,attrs:{shape:s}})}var MO={kernelName:vl,backendName:"webgl",kernelFunc:Zh};var BO="return exp(x) - 1.0;",rme=ke({opSnippet:BO,packedOpSnippet:BO,cpuKernelImpl:b$}),LO={kernelName:Sp,backendName:"webgl",kernelFunc:rme};var Jh=class{constructor(e,t,n){this.variableNames=["real","imag"];let o=t[1];this.outputShape=t;let a=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=n?`${o}.0`:"1.0",s;if(e==="real")s="return real * expR - imag * expI;";else if(e==="imag")s="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${s}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function Qh(r,e,t){let n=t.texData.get(r.dataId),o=w.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],i=o/a,s=le({inputs:{x:r},backend:t,attrs:{shape:[i,a]}}),u=s.shape,l=new Jh("real",u,e),c=new Jh("imag",u,e),p=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:u},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:u}],f=t.runWebGLProgram(l,p,"float32"),d=t.runWebGLProgram(c,p,"float32"),m=Kr({inputs:{real:f,imag:d},backend:t});t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d);let h=le({inputs:{x:m},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(m),h}function nme(r){let{inputs:e,backend:t}=r,{input:n}=e;return Qh(n,!1,t)}var VO={kernelName:Im,backendName:"webgl",kernelFunc:nme};var p1=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function na(r){let{backend:e,attrs:t}=r,{shape:n,value:o}=t,{dtype:a}=t;if(a=a||w.inferDtype(o),a==="string"){let i=w.getArrayFromDType(a,w.sizeFromShape(n));return i.fill(o),e.makeTensorInfo(n,a,i)}else{let i=new p1(n,o),s=[[o]];return e.runWebGLProgram(i,[],a,s)}}var WO={kernelName:xl,backendName:"webgl",kernelFunc:na};var f1=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var zO={kernelName:ei,backendName:"webgl",kernelFunc:({inputs:r,backend:e})=>{let{image:t}=r,n=e,o=new f1(t.shape);return n.runWebGLProgram(o,[t],t.dtype)}};var UO="return floor(x);",ome=ke({opSnippet:UO,packedOpSnippet:UO,cpuKernelImpl:w$}),GO={kernelName:ti,backendName:"webgl",kernelFunc:ome};var ame=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,sme=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,ime=ot({opSnippet:ame,packedOpSnippet:sme,dtype:"int32"}),jO={kernelName:ri,backendName:"webgl",kernelFunc:ime};var d1=class{constructor(e){this.variableNames=["A"];let t=At(),[n,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}};var m1=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=At(),[n,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}};var HO={kernelName:nT,backendName:"webgl",kernelFunc:ume},rc;function ume(r){let{inputs:e,backend:t,attrs:n}=r,{pixels:o}=e,{numChannels:a}=n,i=typeof HTMLVideoElement!="undefined"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement!="undefined"&&o instanceof HTMLImageElement,[u,l]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=[l,u],p=[l,u,a];(s||i)&&(rc==null&&(rc=document.createElement("canvas").getContext("2d")),rc.canvas.width=u,rc.canvas.height=l,rc.drawImage(o,0,0,u,l),o=rc.canvas);let f=t.makeTensorInfo(c,"int32");t.texData.get(f.dataId).usage=Cr.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(f.dataId),o);let d=X().getBool("WEBGL_PACK")?new m1(p):new d1(p),m=t.runWebGLProgram(d,[f],"int32");return t.disposeData(f.dataId),m}function lme(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a,bias:i,preluActivationWeights:s}=e,{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:f,activation:d,leakyreluAlpha:m}=n,h=S.convertConv2DDataFormat(c),g=S.computeConv2DInfo(o.shape,a.shape,u,p,l,f,!1,h),v,x=[];if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))v=Kh({x:o,filter:a,convInfo:g,backend:t,bias:i,activation:d,preluActivationWeights:s,leakyreluAlpha:m});else if(X().getBool("WEBGL_CONV_IM2COL")&&o.shape[0]===1)v=Xh({x:o,filter:a,convInfo:g,backend:t,bias:i,activation:d,preluActivationWeights:s,leakyreluAlpha:m});else{let b=i!=null,k=s!=null,N=d==="leakyrelu",E=d?Ga(d,!1):null,T=new rf(g,b,E,k,N),R=[o,a];if(i&&R.push(i),s&&R.push(s),N){let $=t.makeTensorInfo([],"float32",w.createScalarValue(m,"float32"));R.push($),x.push($)}v=t.runWebGLProgram(T,R,"float32")}let y=le({inputs:{x:v},backend:t,attrs:{shape:g.outShape}});return x.push(v),x.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}var qO={kernelName:ji,backendName:"webgl",kernelFunc:lme};function cme(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a,bias:i,preluActivationWeights:s}=e,{strides:u,pad:l,dilations:c,dimRoundingMode:p,activation:f,leakyreluAlpha:d}=n,m=[],h=c;h==null&&(h=[1,1]),w.assert(S.eitherStridesOrDilationsAreOne(u,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${h}'`);let g=S.computeConv2DInfo(o.shape,a.shape,u,h,l,p,!0),v=X().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels==1,x=f?Ga(f,v):null,y=[o,a],b=i!=null,k=s!=null,N=f==="leakyrelu";if(b&&y.push(i),k&&y.push(s),N){let $=t.makeTensorInfo([],"float32",w.createScalarValue(d,"float32"));y.push($),m.push($)}let E;v?E=new of(g,b,x,k,N):E=new nf(g,b,x,k,N);let T=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],R=t.runWebGLProgram(E,y,"float32",T);return m.forEach($=>t.disposeIntermediateTensorInfo($)),R}var KO={kernelName:Hi,backendName:"webgl",kernelFunc:cme};var h1=class{constructor(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;let o=Ve(t.length),a=Ve(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        ${o} strides = ${o}(${this.strides});
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < ${this.sliceDim}; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * ${i};
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}};function pme(r){let{inputs:e,backend:t}=r,{params:n,indices:o}=e,a=o.shape,i=a[a.length-1],s=w.sizeFromShape(n.shape),[u,l,c,p]=S.prepareAndValidate(n,o),f=le({inputs:{x:o},backend:t,attrs:{shape:[l,i]}}),d=le({inputs:{x:n},backend:t,attrs:{shape:[w.sizeFromShape(n.shape)/c,c]}});if(t.shouldExecuteOnCPU([n,o])||n.dtype==="string"){let v=t.readSync(o.dataId),x=t.bufferSync(n),y=k$(v,x,n.dtype,l,i,c,p,n.shape,s);return t.makeTensorInfo(u,n.dtype,y.values)}let m=new h1(i,p,[l,c]),h=t.runWebGLProgram(m,[d,f],d.dtype),g=le({inputs:{x:h},backend:t,attrs:{shape:u}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(h),g}var XO={kernelName:oi,backendName:"webgl",kernelFunc:pme};var g1=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=Ve(this.rank),o=fme(e,2);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}};function fme(r,e){let t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let o=0;o<r.length;o++)o===2?n.push("int(getIndices(resRC.x, resRC.z))"):n.push(`${t[o]}`);return n.join()}function v1(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,indices:a}=e,{axis:i,batchDims:s}=n,u=w.parseAxisParam(i,o.shape)[0],l=t.readSync(a.dataId),c=o.shape[u];for(let b=0;b<l.length;++b){let k=l[b];w.assert(k<=c-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${c-1}]`)}let p=S.segment_util.collectGatherOpShapeInfo(o,a,u,s),f=w.sizeFromShape(a.shape),d=[],m=le({inputs:{x:o},backend:t,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),h=le({inputs:{x:a},backend:t,attrs:{shape:[p.batchSize,f/p.batchSize]}});d.push(m),d.push(h);let g=[p.batchSize,p.outerSize,f/p.batchSize,p.sliceSize];if(t.shouldExecuteOnCPU([o,a])||o.dtype==="string"){let b=t.bufferSync(h),k=t.bufferSync(m),N=_$(k,b,g);return d.forEach(E=>t.disposeIntermediateTensorInfo(E)),t.makeTensorInfo(p.outputShape,N.dtype,N.values)}let v=new g1(m.shape,g),x=t.runWebGLProgram(v,[m,h],m.dtype);d.push(x);let y=le({inputs:{x},backend:t,attrs:{shape:p.outputShape}});return d.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}var YO={kernelName:yl,backendName:"webgl",kernelFunc:v1};var dme="return float(a > b);",mme=`
  return vec4(greaterThan(a, b));
`,hme=ot({opSnippet:dme,packedOpSnippet:mme,cpuKernelImpl:S$,dtype:"bool"}),ZO={kernelName:ai,backendName:"webgl",kernelFunc:hme};var gme="return float(a >= b);",vme=`
  return vec4(greaterThanEqual(a, b));
`,xme=ot({opSnippet:gme,packedOpSnippet:vme,dtype:"bool",cpuKernelImpl:I$}),JO={kernelName:si,backendName:"webgl",kernelFunc:xme};function yme(r){let{inputs:e,backend:t}=r,{input:n}=e;return Qh(n,!0,t)}var QO={kernelName:Cm,backendName:"webgl",kernelFunc:yme};var bme="return float(!isnan(x) && !isinf(x));",wme=ke({opSnippet:bme,dtype:"bool"}),eM={kernelName:Ip,backendName:"webgl",kernelFunc:wme};var kme="return float(isinf(x));",_me=ke({opSnippet:kme,dtype:"bool"}),tM={kernelName:Cp,backendName:"webgl",kernelFunc:_me};var Sme="return float(isnan(x));",Ime=ke({opSnippet:Sme,dtype:"bool"}),rM={kernelName:Np,backendName:"webgl",kernelFunc:Ime};var Cme="return float(a < b);",Nme=`
  return vec4(lessThan(a, b));
`,Eme=ot({opSnippet:Cme,packedOpSnippet:Nme,cpuKernelImpl:C$,dtype:"bool"}),nM={kernelName:ii,backendName:"webgl",kernelFunc:Eme};var Tme="return float(a <= b);",Ame=`
  return vec4(lessThanEqual(a, b));
`,Fme=ot({opSnippet:Tme,packedOpSnippet:Ame,cpuKernelImpl:N$,dtype:"bool"}),oM={kernelName:ui,backendName:"webgl",kernelFunc:Fme};function Dme(r){let{backend:e,attrs:t}=r,{start:n,stop:o,num:a}=t,i=E$(n,o,a);return e.makeTensorInfo([i.length],"float32",i)}var aM={kernelName:Em,backendName:"webgl",kernelFunc:Dme};var Rme=`if (x < 0.0) return NAN;
  return log(x);`,$me=`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,Pme=ke({opSnippet:Rme,packedOpSnippet:$me,cpuKernelImpl:T$}),sM={kernelName:li,backendName:"webgl",kernelFunc:Pme};var Ome="return log(1.0 + x);",Mme=ke({opSnippet:Ome}),iM={kernelName:Ep,backendName:"webgl",kernelFunc:Mme};var Bme="return float(a >= 1.0 && b >= 1.0);",Lme=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Vme=ot({opSnippet:Bme,packedOpSnippet:Lme,dtype:"bool"}),uM={kernelName:ci,backendName:"webgl",kernelFunc:Vme};var Wme="return float(!(x >= 1.0));",zme=ke({opSnippet:Wme}),lM={kernelName:Tp,backendName:"webgl",kernelFunc:zme};var Ume="return float(a >= 1.0 || b >= 1.0);",Gme=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,jme=ot({opSnippet:Ume,packedOpSnippet:Gme,dtype:"bool"}),cM={kernelName:Ap,backendName:"webgl",kernelFunc:jme};var x1=class{constructor(e,t,n,o,a){this.variableNames=["x"],this.outputShape=[];let i=t,s=e[3]-1;this.outputShape=e;let u,l=`float(${n}) + float(${o}) * sum`;a===.5?u=`inversesqrt(${l})`:a===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${s}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}};var y1=class{constructor(e,t,n,o,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=t,s=e[3]-1;this.outputShape=e;let u,l=`float(${n}) + float(${o}) * sum`;a===.5?u=`inversesqrt(${l})`:a===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}};var Hme=r=>{let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{depthRadius:a,bias:i,alpha:s,beta:u}=n,l=X().getBool("WEBGL_PACK_NORMALIZATION")?new y1(o.shape,a,i,s,u):new x1(o.shape,a,i,s,u);return t.runWebGLProgram(l,[o],o.dtype)},pM={kernelName:Tm,backendName:"webgl",kernelFunc:Hme};var b1=class{constructor(e,t,n,o,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=o,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${a})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}};var qme=r=>{let{inputs:e,backend:t,attrs:n}=r,{x:o,y:a,dy:i}=e,{depthRadius:s,bias:u,alpha:l,beta:c}=n,p=new b1(o.shape,s,u,l,c);return t.runWebGLProgram(p,[o,a,i],o.dtype)},fM={kernelName:Am,backendName:"webgl",kernelFunc:qme};function dM(r,e,t,n){let o=w.sizeFromShape(e),i=w.sizeFromShape(r.shape)/o,s=le({inputs:{x:r},attrs:{shape:[i,o]},backend:n}),u=cn(s,r.dtype,"max",n),l=le({inputs:{x:u},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),l}function w1(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{reductionIndices:a,keepDims:i}=n,s=o.shape.length,u=w.parseAxisParam(a,o.shape),l=u,c=S.getAxesPermutation(l,s),p=c!=null,f=t.shouldExecuteOnCPU([o]),d=o;if(p){if(f){let y=t.texData.get(d.dataId).values,b=new Array(s);for(let E=0;E<b.length;E++)b[E]=o.shape[c[E]];let k=mu(y,o.shape,o.dtype,c,b);d=t.makeTensorInfo(b,o.dtype);let N=t.texData.get(d.dataId);N.values=k}else d=ja(o,c,t);l=S.getInnerMostAxes(l.length,s)}S.assertAxesAreInnerMostDims("max",l,s);let[m,h]=S.computeOutAndReduceShapes(d.shape,l),g=m;i&&(g=S.expandShapeToKeepDim(m,u));let v;if(f){let y=t.texData.get(d.dataId).values,b=A$(y,w.sizeFromShape(h),g,o.dtype);v=t.makeTensorInfo(g,o.dtype);let k=t.texData.get(v.dataId);k.values=b}else v=dM(d,h,g,t);return p&&t.disposeIntermediateTensorInfo(d),v}var mM={kernelName:pi,backendName:"webgl",kernelFunc:w1};var Kme=Wh+`
  return max(a, b);
`,Xme=`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Ua+`
  return result;
`,Yme=ot({opSnippet:Kme,packedOpSnippet:Xme,cpuKernelImpl:F$}),hM={kernelName:fi,backendName:"webgl",kernelFunc:Yme};function Zme(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e;go(o,"maxPool");let{filterSize:a,strides:i,pad:s,dimRoundingMode:u}=n,l=1;w.assert(S.eitherStridesOrDilationsAreOne(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let c=S.computePool2DInfo(o.shape,a,i,l,s,u);if(c.filterWidth===1&&c.filterHeight===1&&w.arraysEqual(c.inShape,c.outShape))return Kt({inputs:{x:o},backend:t});let p=new vo(c,"max",!1);return t.runWebGLProgram(p,[o],o.dtype)}var gM={kernelName:di,backendName:"webgl",kernelFunc:Zme};function Jme(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{filterSize:a,strides:i,pad:s,dataFormat:u,dimRoundingMode:l}=n,c=[1,1,1],p=S.computePool3DInfo(o.shape,a,i,c,s,l,u),f=new vu(p,"max",!1);return t.runWebGLProgram(f,[o],o.dtype)}var vM={kernelName:Dm,backendName:"webgl",kernelFunc:Jme};var k1=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,o=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=a-1-e.padInfo.top,u=i-1-e.padInfo.left,l=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},_1=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,p=u-1-e.padInfo.front,f=l-1-e.padInfo.top,d=c-1-e.padInfo.left,m=u*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${f}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${s}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Qme(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a}=e,i=a,{filterSize:s,strides:u,pad:l,dimRoundingMode:c}=n,p=[1,1,1],f=S.computePool3DInfo(i.shape,s,u,p,l,c),d=new vu(f,"max",!0),m=t.runWebGLProgram(d,[i],i.dtype),h=new _1(f),g=t.runWebGLProgram(h,[o,m],i.dtype);return t.disposeIntermediateTensorInfo(m),g}var xM={kernelName:Rm,backendName:"webgl",kernelFunc:Qme};function ehe(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a,output:i}=e,s=a;go([a,i],"maxPoolGrad");let{filterSize:u,strides:l,pad:c,dimRoundingMode:p}=n,f=S.computePool2DInfo(s.shape,u,l,1,c,p),d=!0,m=new vo(f,"max",d),h=t.runWebGLProgram(m,[s],s.dtype),g=new k1(f),v=t.runWebGLProgram(g,[o,h],s.dtype);return t.disposeIntermediateTensorInfo(h),v}var yM={kernelName:Fm,backendName:"webgl",kernelFunc:ehe};function bM(r,e,t,n){let o=new vo(t,"max",!1),a=n.runWebGLProgram(o,[r],"float32");o=new vo(t,"max",!0,!0,e);let i=n.runWebGLProgram(o,[r],"float32");return[a,i]}var wM={kernelName:$m,backendName:"webgl",kernelFunc:({inputs:r,attrs:e,backend:t})=>{let{x:n}=r,{filterSize:o,strides:a,pad:i,includeBatchInIndex:s}=e,u=t;w.assert(n.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${n.shape.length}.`);let l=[1,1];w.assert(S.eitherStridesOrDilationsAreOne(a,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);let c=S.computePool2DInfo(n.shape,o,a,l,i),[p,f]=bM(n,s,c,u);return[p,f]}};function kM(r,e,t,n){let o=w.sizeFromShape(e),i=w.sizeFromShape(r.shape)/o,s=le({inputs:{x:r},attrs:{shape:[i,o]},backend:n}),u=cn(s,"float32","mean",n),l=le({inputs:{x:u},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),l}var _M={kernelName:mi,backendName:"webgl",kernelFunc:({inputs:r,attrs:e,backend:t})=>{let{x:n}=r,{keepDims:o,axis:a}=e,i=t,s=n.shape.length,u=w.parseAxisParam(a,n.shape),l=u,c=S.getAxesPermutation(l,s),p=c!=null,f=i.shouldExecuteOnCPU([n]),d=[],m=n;if(p){if(f){let b=i.texData.get(m.dataId).values,k=new Array(s);for(let T=0;T<k.length;T++)k[T]=n.shape[c[T]];let N=mu(b,n.shape,n.dtype,c,k);m=i.makeTensorInfo(k,n.dtype);let E=i.texData.get(m.dataId);E.values=N}else m=ja(n,c,i);d.push(m),l=S.getInnerMostAxes(l.length,s)}S.assertAxesAreInnerMostDims("sum",l,s);let[h,g]=S.computeOutAndReduceShapes(m.shape,l),v=h;o&&(v=S.expandShapeToKeepDim(h,u));let x=kM(m,g,v,i);for(let y of d)i.disposeIntermediateTensorInfo(y);return x}};function the(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n,s=o.shape.length,u=w.parseAxisParam(a,o.shape),l=u,c=S.getAxesPermutation(l,s),p=o;c!=null&&(p=_t({inputs:{x:o},backend:t,attrs:{perm:c}}),l=S.getInnerMostAxes(l.length,o.shape.length)),S.assertAxesAreInnerMostDims("min",l,s);let[f,d]=S.computeOutAndReduceShapes(p.shape,l),m=w.sizeFromShape(d),h=le({inputs:{x:p},backend:t,attrs:{shape:[-1,m]}}),g=cn(h,h.dtype,"min",t),v;if(i){let x=S.expandShapeToKeepDim(f,u);v=le({inputs:{x:g},backend:t,attrs:{shape:x}})}else v=le({inputs:{x:g},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(p),v}var SM={kernelName:hi,backendName:"webgl",kernelFunc:the};var rhe=Wh+`
  return min(a, b);
`,nhe=`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Ua+`
  return result;
`,ohe=ot({opSnippet:rhe,packedOpSnippet:nhe,cpuKernelImpl:D$}),IM={kernelName:gi,backendName:"webgl",kernelFunc:ohe};var S1=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((c,p)=>c[0]+e[p]+c[1]);let o=e.length,a=Ve(o),i=t.map(c=>c[0]).join(","),s=t.map((c,p)=>c[0]+e[p]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),l=n==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${s});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}};var I1=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((m,h)=>m[0]+e[h]+m[1]);let o=e.length,a=Ve(o),i=t.map(m=>m[0]).join(","),s=t.map((m,h)=>m[0]+e[h]).join(","),u=qt("rc",o),l=qt("source",o),c=`${u[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${l.slice(-2).join()})`,f=n==="reflect"?0:1,d="";if(o===1){let m=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;d=`
        ${a} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${l.join()}), ${p});
        ${u[o-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${l.join()}), ${p});
        }
      `}else{let m=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;d=`
        ${a} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${l.join()}), ${p});
        ${u[o-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${l.join()}), ${p});
        }
        rc = outputLoc;
        ${u[o-2]} += 1;
        if(${u[o-2]} < ${this.outputShape[o-2]}) {
          ${m}
          result[2] = getChannel(getX(${l.join()}), ${p});
          ${u[o-1]} += 1;
          if(${c}) {
            ${m}
            result[3] = getChannel(getX(${l.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${s});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}};var ahe=({inputs:r,backend:e,attrs:t})=>{let{x:n}=r,{paddings:o,mode:a}=t,i=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I1(n.shape,o,a):new S1(n.shape,o,a);return e.runWebGLProgram(i,[n],n.dtype)},CM={kernelName:vi,backendName:"webgl",kernelFunc:ahe};var she=`if (b == 0.0) return NAN;
  return mod(a, b);`,ihe=`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  `+Ua+`
  return result;
`,uhe=ot({opSnippet:she,packedOpSnippet:ihe}),NM={kernelName:Fp,backendName:"webgl",kernelFunc:uhe};var C1=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}};var lhe=`
if (a == b) {
  return 1.0;
};
return a / b;`,che=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,N1=ot({opSnippet:lhe,packedOpSnippet:che,checkOutOfBounds:!0}),EM={kernelName:Zs,backendName:"webgl",kernelFunc:N1};var TM="return a - b;",E1=ot({opSnippet:TM,packedOpSnippet:TM,supportsComplex:!0,cpuKernelImpl:K$}),AM={kernelName:Oi,backendName:"webgl",kernelFunc:E1};function T1(r){let{inputs:e,backend:t,attrs:n}=r,{logits:o}=e,{dim:a}=n,i=w.parseAxisParam([a],o.shape),s=w1({inputs:{x:o},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),u=S.expandShapeToKeepDim(s.shape,i),l=le({inputs:{x:s},backend:t,attrs:{shape:u}}),c=E1({inputs:{a:o,b:l},backend:t}),p=c1({inputs:{x:c},backend:t}),f=hu({inputs:{x:p},backend:t,attrs:{axis:i,keepDims:!1}}),d=le({inputs:{x:f},backend:t,attrs:{shape:u}}),m=N1({inputs:{a:p,b:d},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),m}var FM={kernelName:Ri,backendName:"webgl",kernelFunc:T1};function phe(r){let{inputs:e,backend:t,attrs:n}=r,{logits:o}=e,{numSamples:a,seed:i,normalized:s}=n,u=s?o:T1({inputs:{logits:o},backend:t,attrs:{dim:o.shape.length-1}}),l=u.shape[0],c=u.shape[1],p=new C1(l,c,a),f=[[i]],d=t.runWebGLProgram(p,[u],"int32",f);return s||t.disposeIntermediateTensorInfo(u),d}var DM={kernelName:Pm,backendName:"webgl",kernelFunc:phe};var RM="return -x;";function fhe(r){let{inputs:e,backend:t}=r,{x:n}=e;if(t.shouldExecuteOnCPU([n])){let a=t.texData.get(n.dataId),[i,s]=$$(a.values,n.shape,n.dtype);return t.makeTensorInfo(s,n.dtype,i)}let o;return X().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new Zn(n.shape,RM):o=new qr(n.shape,RM),t.runWebGLProgram(o,[n],n.dtype)}var $M={kernelName:bl,backendName:"webgl",kernelFunc:fhe};var dhe=Sr.nonMaxSuppressionV3Impl;function mhe(r){S.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:e,backend:t,attrs:n}=r,{boxes:o,scores:a}=e,{maxOutputSize:i,iouThreshold:s,scoreThreshold:u}=n,l=t.readSync(o.dataId),c=t.readSync(a.dataId),{selectedIndices:p}=dhe(l,c,i,s,u);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}var PM={kernelName:yi,backendName:"webgl",kernelFunc:mhe};var hhe=Sr.nonMaxSuppressionV4Impl;function ghe(r){S.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:e,backend:t,attrs:n}=r,{boxes:o,scores:a}=e,{maxOutputSize:i,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:l}=n,c=t.readSync(o.dataId),p=t.readSync(a.dataId),{selectedIndices:f,validOutputs:d}=hhe(c,p,i,s,u,l);return[t.makeTensorInfo([f.length],"int32",new Int32Array(f)),t.makeTensorInfo([],"int32",new Int32Array([d]))]}var OM={kernelName:bi,backendName:"webgl",kernelFunc:ghe};var vhe=Sr.nonMaxSuppressionV5Impl;function xhe(r){S.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:e,backend:t,attrs:n}=r,{boxes:o,scores:a}=e,{maxOutputSize:i,iouThreshold:s,scoreThreshold:u,softNmsSigma:l}=n,c=t.readSync(o.dataId),p=t.readSync(a.dataId),f=i,d=s,m=u,h=l,{selectedIndices:g,selectedScores:v}=vhe(c,p,f,d,m,h);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([v.length],"float32",new Float32Array(v))]}var MM={kernelName:wi,backendName:"webgl",kernelFunc:xhe};var A1=class{constructor(e,t,n,o){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${n}),
                      float(index == coords.y)));
      }
    `}};var yhe=r=>{let{inputs:e,backend:t,attrs:n}=r,{indices:o}=e,{depth:a,onValue:i,offValue:s}=n,u=w.sizeFromShape(o.shape),l=new A1(u,a,i,s),c=le({inputs:{x:o},backend:t,attrs:{shape:[u]}}),p=t.runWebGLProgram(l,[c],o.dtype);t.disposeIntermediateTensorInfo(c);let f=[...o.shape,a],d=le({inputs:{x:p},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(p),d},BM={kernelName:ki,backendName:"webgl",kernelFunc:yhe};function af(r){let{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="complex64"){let o=ra({inputs:{input:n},backend:t}),a=af({inputs:{x:o},backend:t}),i=xu({inputs:{input:n},backend:t}),s=af({inputs:{x:i},backend:t}),u=Kr({inputs:{real:a,imag:s},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(s),u}else return na({attrs:{shape:n.shape,dtype:n.dtype,value:n.dtype==="string"?"":0},backend:t})}var LM={kernelName:Al,backendName:"webgl",kernelFunc:af};function VM(r){let{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(n.dtype==="complex64"){let o=ra({inputs:{input:n},backend:t}),a=VM({inputs:{x:o},backend:t}),i=xu({inputs:{input:n},backend:t}),s=af({inputs:{x:i},backend:t}),u=Kr({inputs:{real:a,imag:s},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(s),u}else return na({attrs:{shape:n.shape,dtype:n.dtype,value:1},backend:t})}var WM={kernelName:wl,backendName:"webgl",kernelFunc:VM};function bhe(r){let{inputs:e,backend:t,attrs:n}=r,{axis:o}=n;if(e.length===1)return Zh({inputs:{input:e[0]},backend:t,attrs:{dim:o}});let a=e[0].shape,i=e[0].dtype;e.forEach(c=>{w.assertShapesMatch(a,c.shape,"All tensors passed to stack must have matching shapes"),w.assert(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let s=[],u=e.map(c=>{let p=Zh({inputs:{input:c},backend:t,attrs:{dim:o}});return s.push(p),p}),l=Zw({inputs:u,backend:t,attrs:{axis:o}});return s.forEach(c=>t.disposeIntermediateTensorInfo(c)),l}var zM={kernelName:kl,backendName:"webgl",kernelFunc:bhe};var F1=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((l,c)=>l[0]+e[c]+l[1]);let o=e.length,a=Ve(o),i=t.map(l=>l[0]).join(","),s=t.map((l,c)=>l[0]+e[c]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${s});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}};var D1=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((h,g)=>h[0]+e[g]+h[1]);let o=e.length,a=Ve(o),i=t.map(h=>h[0]).join(","),s=t.map((h,g)=>h[0]+e[g]).join(","),u=qt("rc",o),l=qt("source",o),c=`${u[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${l.slice(-2).join()})`,f=[`${a} rc = outputLoc;`,`${u[o-1]} += 1;
       if(${c}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${u[o-2]} += 1;
       if(${u[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${u[o-1]} += 1;
         if(${c}) {`],d=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",m="";for(let h=0,g=o===1?2:4;h<g;h++)m+=`
        ${f[h]}
        if (${d}) {
          result[${h}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${h}] = getChannel(getX(${l.join()}), ${p});
        }
      `;m+=o===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${s});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}};var R1=r=>{let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{paddings:a,constantValue:i}=n;if(w.sizeFromShape(o.shape)===0){let l=a.map((c,p)=>c[0]+o.shape[p]+c[1]);return na({backend:t,attrs:{shape:l,value:i,dtype:o.dtype}})}let s=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new D1(o.shape,a,i):new F1(o.shape,a,i),u=[[i]];return t.runWebGLProgram(s,[o],o.dtype,u)},UM={kernelName:_i,backendName:"webgl",kernelFunc:R1};var whe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,khe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  `+Ua+`
  return result;
`,_he=ot({opSnippet:whe,packedOpSnippet:khe}),GM={kernelName:Si,backendName:"webgl",kernelFunc:_he};function She(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n,s=o.shape.length,u=[],l=w.parseAxisParam(a,o.shape),c=l,p=S.getAxesPermutation(c,s),f=o;p!=null&&(f=_t({inputs:{x:o},backend:t,attrs:{perm:p}}),c=S.getInnerMostAxes(c.length,s),u.push(f)),S.assertAxesAreInnerMostDims("prod",c,s);let d;if(t.shouldExecuteOnCPU([f])){let m=t.texData.get(f.dataId).values,{outVals:h,outShape:g,outDtype:v}=O$(f.shape,f.dtype,m,c);d=t.makeTensorInfo(g,v,h)}else{let[m,h]=S.computeOutAndReduceShapes(f.shape,c),g=w.sizeFromShape(h),v=le({inputs:{x:f},backend:t,attrs:{shape:[-1,g]}}),x=Ji(o.dtype),y=cn(v,x,"prod",t);d=le({inputs:{x:y},backend:t,attrs:{shape:m}}),u.push(v),u.push(y)}if(i){u.push(d);let m=S.expandShapeToKeepDim(d.shape,l);d=le({inputs:{x:d},backend:t,attrs:{shape:m}})}return u.forEach(m=>t.disposeIntermediateTensorInfo(m)),d}var jM={kernelName:Ii,backendName:"webgl",kernelFunc:She};var $1=r=>{let{backend:e,attrs:t}=r,{start:n,stop:o,step:a,dtype:i}=t,s=M$(n,o,a,i);return e.makeTensorInfo([s.length],i,s)},HM={kernelName:_l,backendName:"webgl",kernelFunc:$1};var Ihe="return 1.0 / x;",Che=ke({opSnippet:Ihe}),qM={kernelName:Dp,backendName:"webgl",kernelFunc:Che};var Nhe=hr+`
  return (x < 0.0) ? 0.0 : x;
`,Ehe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,The=ke({opSnippet:Nhe,packedOpSnippet:Ehe}),KM={kernelName:Go,backendName:"webgl",kernelFunc:The};var Ahe=hr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Fhe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dhe=ke({opSnippet:Ahe,packedOpSnippet:Fhe}),XM={kernelName:jo,backendName:"webgl",kernelFunc:Dhe};var P1=class{constructor(e,t,n,o,a){this.variableNames=["A"],this.outputShape=[];let[i,s,u,l]=e;this.outputShape=[i,t,n,l];let c=[o&&t>1?s-1:s,o&&n>1?u-1:u],p=[o&&t>1?t-1:t,o&&n>1?n-1:n],f;a?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/p[0]},
          ${c[1]/p[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}};var O1=class{constructor(e,t,n,o,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,u,l]=e;this.outputShape=[i,t,n,l];let c=[o&&t>1?s-1:s,o&&n>1?u-1:u],p=[o&&t>1?t-1:t,o&&n>1?n-1:n],f;a?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/p[0]},
          ${c[1]/p[1]},
          ${c[1]/p[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function Rhe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o}=e,{alignCorners:a,halfPixelCenters:i,size:s}=n,[u,l]=s,c=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new O1(o.shape,u,l,a,i):new P1(o.shape,u,l,a,i);return t.runWebGLProgram(c,[o],"float32")}var YM={kernelName:Ci,backendName:"webgl",kernelFunc:Rhe};var M1=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,o,a]=t,[,i,s]=e,u=[n&&i>1?o-1:o,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=u[0]/l[0],p=u[1]/l[1],f=1/c,d=1/p,m=Math.ceil(f)*2+2,h=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${p});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${d});

        const int winHeight = int(${m});
        const int winWidth = int(${h});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function $he(r){let{inputs:e,backend:t,attrs:n}=r,{images:o,dy:a}=e,{alignCorners:i}=n,s=new M1(a.shape,o.shape,i);return t.runWebGLProgram(s,[a],a.dtype)}var ZM={kernelName:Lm,backendName:"webgl",kernelFunc:$he};var B1=class{constructor(e,t,n,o,a){this.variableNames=["A"],this.outputShape=[];let[i,s,u,l]=e;this.outputShape=[i,t,n,l];let c=[o&&t>1?s-1:s,o&&n>1?u-1:u],p=[o&&t>1?t-1:t,o&&n>1?n-1:n],f=o?"0.5":"0.0",d;a?d="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/p[0]},
          ${c[1]/p[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}};var L1=class{constructor(e,t,n,o,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,u,l]=e;this.outputShape=[i,t,n,l];let c=[o&&t>1?s-1:s,o&&n>1?u-1:u],p=[o&&t>1?t-1:t,o&&n>1?n-1:n],f=o?"0.5":"0.0",d;a?d="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/p[0]},
          ${c[1]/p[1]},
          ${c[1]/p[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function Phe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o}=e,{alignCorners:a,halfPixelCenters:i,size:s}=n,[u,l]=s,c=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new L1(o.shape,u,l,a,i):new B1(o.shape,u,l,a,i);return t.runWebGLProgram(c,[o],o.dtype)}var JM={kernelName:Mm,backendName:"webgl",kernelFunc:Phe};var V1=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,o,a]=t,[,i,s]=e,u=[n&&i>1?o-1:o,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=u[0]/l[0],p=u[1]/l[1],f=1/c,d=1/p,m=Math.ceil(f)*2+2,h=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${p});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${d});

        const int winHeight = int(${m});
        const int winWidth = int(${h});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function Ohe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o,dy:a}=e,{alignCorners:i}=n,s=new V1(a.shape,o.shape,i);return t.runWebGLProgram(s,[a],a.dtype)}var QM={kernelName:Bm,backendName:"webgl",kernelFunc:Ohe};var W1=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let o=s=>t.indexOf(s)!==-1&&e[s]!==1?`${e[s]} - coords[${s}] - 1`:`coords[${s}]`,a=e.map((s,u)=>o(u)).join(","),i=Ve(n);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}};var z1=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;let o=qt("rc",n),a=`${o[n-1]} + 1 < ${this.outputShape[n-1]}`,i=`${o[n-2]} + 1 < ${this.outputShape[n-2]}`,s=Ve(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(o.slice())};
          if(${a}){
            result.g = ${l(o.slice())};
          }
          if(${i}) {
            result.b = ${c(o.slice())};
            if(${a}) {
              result.a = ${p(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(m){return f(m)}function l(m){return m[n-1]="("+m[n-1]+" + 1)",f(m)}function c(m){return m[n-2]="("+m[n-2]+" + 1)",f(m)}function p(m){return m[n-1]="("+m[n-1]+" + 1)",m[n-2]="("+m[n-2]+" + 1)",f(m)}function f(m){let h=e.map((x,y)=>d(y,m)),g=h.join(","),v=h.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${v}))`}function d(m,h){return t.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${h[m]} - 1`:`${h[m]}`}}};function Mhe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{dims:a}=n,i=o.shape.length,s=w.parseAxisParam(a,o.shape);if(i===0)return Kt({inputs:{x:o},backend:t});let u=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z1(o.shape,s):new W1(o.shape,s);return t.runWebGLProgram(u,[o],o.dtype)}var eB={kernelName:Ni,backendName:"webgl",kernelFunc:Mhe};var U1=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],o=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var tB={kernelName:Ui,backendName:"webgl",kernelFunc:({inputs:r,attrs:e,backend:t})=>{let{image:n}=r,{radians:o,fillValue:a,center:i}=e,s=t,u=new U1(n.shape,a),[l,c]=S.getImageCenter(i,n.shape[1],n.shape[2]),p=[[l,c,Math.sin(o),Math.cos(o)]];return s.runWebGLProgram(u,[n],n.dtype,p)}};var Bhe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Lhe=ke({opSnippet:Bhe}),rB={kernelName:Ei,backendName:"webgl",kernelFunc:Lhe};var Vhe="return inversesqrt(x);",Whe=ke({opSnippet:Vhe,cpuKernelImpl:B$}),nB={kernelName:Ti,backendName:"webgl",kernelFunc:Whe};var sf=class{constructor(e,t,n,o,a,i,s=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let u=Ve(a.length),l=Ve(i.length),c="";n===1?c="i":n===2&&(c="i, j");let p=`getIndices(${c})`,f="";o===1?f="i":o===2&&(f="i, coords[1]");let d=`getUpdates(${f})`,m=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${l} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${m};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${d};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}};function zhe(r){let{inputs:e,backend:t,attrs:n}=r,{indices:o,updates:a}=e,{shape:i}=n,{sliceRank:s,numUpdates:u,sliceSize:l,strides:c,outputSize:p}=S.calculateShapes(a,o,i),f=[p/l,l];if(p===0)return t.makeTensorInfo(i,o.dtype);let d=le({inputs:{x:o},backend:t,attrs:{shape:[u,s]}}),m=le({inputs:{x:a},backend:t,attrs:{shape:[u,l]}}),h=t.makeTensorInfo([],"float32",new Float32Array([0])),g=new sf(u,s,d.shape.length,m.shape.length,c,f),v=t.runWebGLProgram(g,[m,d,h],m.dtype),x=le({inputs:{x:v},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(h),x}var oB={kernelName:Ai,backendName:"webgl",kernelFunc:zhe};var G1=class{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let o,a;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)a="resRC",o="resRC";else{let s=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[];for(let c=0;c<t.length;c++)l.push(`${s[c]}`),c<e&&u.push(`${s[c]}`);o=u.join(),a=l.join()}let i=Ve(n);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}};function Uhe(r){let{inputs:e,backend:t}=r,{condition:n,t:o,e:a}=e,i=new G1(n.shape.length,o.shape,o.shape.length);return t.runWebGLProgram(i,[n,o,a],ur(o.dtype,a.dtype))}var aB={kernelName:Sl,backendName:"webgl",kernelFunc:Uhe};var Ghe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${S.SELU_SCALEALPHA};
  float scale = ${S.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,jhe=ke({opSnippet:Ghe}),sB={kernelName:Rp,backendName:"webgl",kernelFunc:jhe};var iB="return 1.0 / (1.0 + exp(-1.0 * x));",Hhe=ke({opSnippet:iB,packedOpSnippet:iB,cpuKernelImpl:L$}),uB={kernelName:Ho,backendName:"webgl",kernelFunc:Hhe};var qhe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Khe=ke({opSnippet:qhe}),lB={kernelName:Pp,backendName:"webgl",kernelFunc:Khe};var Xhe=zh+`
  return sin(x);
`,Yhe=ke({opSnippet:Xhe}),cB={kernelName:Fi,backendName:"webgl",kernelFunc:Yhe};var Zhe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Jhe=ke({opSnippet:Zhe}),pB={kernelName:$p,backendName:"webgl",kernelFunc:Jhe};var Qhe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,ege=ke({opSnippet:Qhe}),fB={kernelName:Op,backendName:"webgl",kernelFunc:ege};var tge=r=>{let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockShape:a,paddings:i}=n;w.assert(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let s=a.reduce((v,x)=>v*x),u=[[0,0]];u.push(...i);for(let v=1+a.length;v<o.shape.length;++v)u.push([0,0]);let l=[],c=R1({inputs:{x:o},backend:t,attrs:{paddings:u,constantValue:0}}),p=S.getReshaped(c.shape,a,s,!1),f=S.getPermuted(p.length,a.length,!1),d=S.getReshapedPermuted(c.shape,a,s,!1),m=le({inputs:{x:c},backend:t,attrs:{shape:p}}),h=_t({inputs:{x:m},backend:t,attrs:{perm:f}}),g=le({inputs:{x:h},backend:t,attrs:{shape:d}});return l.push(c),l.push(m),l.push(h),l.forEach(v=>t.disposeIntermediateTensorInfo(v)),g},dB={kernelName:Cl,backendName:"webgl",kernelFunc:tge};function rge(r){let{inputs:e,backend:t}=r,{indices:n,values:o,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${n.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let s=t.readSync(n.dataId),u=t.readSync(o.dataId),l=t.readSync(a.dataId),c=t.readSync(i.dataId)[0],[p,f,d,m,h]=W$(s,n.shape,n.dtype,u,o.dtype,l,c);return[t.makeTensorInfo(f,n.dtype,p),t.makeTensorInfo([f[0]],o.dtype,d),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(g=>Number(g)))),t.makeTensorInfo([h.length],n.dtype,new Int32Array(h))]}var mB={kernelName:Vm,backendName:"webgl",kernelFunc:rge};function nge(r){let{inputs:e,backend:t}=r,{inputIndices:n,inputShape:o,newShape:a}=e;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${n.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);let i=Array.from(t.readSync(o.dataId)),s=t.readSync(n.dataId),u=Array.from(t.readSync(a.dataId)),[l,c,p]=z$(s,n.shape,n.dtype,i,u);return[t.makeTensorInfo(c,n.dtype,l),t.makeTensorInfo([p.length],a.dtype,new Int32Array(p))]}var hB={kernelName:Wm,backendName:"webgl",kernelFunc:nge};function oge(r){let{inputs:e,backend:t}=r,{data:n,indices:o,segmentIds:a}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);let i=t.readSync(n.dataId),s=t.readSync(o.dataId),u=t.readSync(a.dataId),[l,c]=Lh(i,n.shape,n.dtype,s,u,!0);return t.makeTensorInfo(c,n.dtype,l)}var gB={kernelName:zm,backendName:"webgl",kernelFunc:oge};function age(r){let{inputs:e,backend:t}=r,{data:n,indices:o,segmentIds:a}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);let i=t.readSync(n.dataId),s=t.readSync(o.dataId),u=t.readSync(a.dataId),[l,c]=Lh(i,n.shape,n.dtype,s,u);return t.makeTensorInfo(c,n.dtype,l)}var vB={kernelName:Um,backendName:"webgl",kernelFunc:age};function sge(r){let{inputs:e,backend:t,attrs:n}=r,{sparseIndices:o,sparseValues:a,defaultValue:i}=e,{outputShape:s}=n,{sliceRank:u,numUpdates:l,strides:c,outputSize:p}=S.calculateShapes(a,o,s),f=!1,d=new sf(l,u,o.shape.length,a.shape.length,c,[p,1],f),m=t.runWebGLProgram(d,[a,o,i],a.dtype),h=le({inputs:{x:m},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(m),h}var xB={kernelName:Gm,backendName:"webgl",kernelFunc:sge};function ige(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{numOrSizeSplits:a,axis:i}=n,s=w.parseAxisParam(i,o.shape)[0],u=S.prepareSplitSize(o,a,s),l=o.shape.length,c=new Array(l).fill(0),p=o.shape.slice();return u.map(f=>{let d=[...p];d[s]=f;let m=Qn({inputs:{x:o},backend:t,attrs:{begin:c,size:d}});return c[s]+=f,m})}var yB={kernelName:Nl,backendName:"webgl",kernelFunc:ige};var bB="return sqrt(x);",uge=ke({opSnippet:bB,packedOpSnippet:bB,cpuKernelImpl:U$}),wB={kernelName:Di,backendName:"webgl",kernelFunc:uge};var lge="return x * x;",cge=ke({opSnippet:lge}),kB={kernelName:El,backendName:"webgl",kernelFunc:cge};var _B="return (a - b) * (a - b);",pge=ot({opSnippet:_B,packedOpSnippet:_B}),SB={kernelName:$i,backendName:"webgl",kernelFunc:pge};function fge({inputs:r,attrs:e,backend:t}){let{x:n}=r,o=hr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new qr(n.shape,o);return t.runWebGLProgram(a,[n],n.dtype)}var IB={kernelName:co,backendName:"webgl",kernelFunc:fge};var j1=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let o=n.length,a=Ve(n.length),i=Ve(n.length),s="";if(o===1)s="coords * strides + begin";else{let u=0;s=n.map((l,c)=>(u++,n.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${u-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}};function dge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{begin:a,end:i,strides:s,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:f}=n,{finalShapeSparse:d,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:v,begin:x,end:y,strides:b}=Tt.sliceInfo(o.shape,a,i,s,u,l,c,p,f),k;if(h)k=le({inputs:{x:o},backend:t,attrs:{shape:m}});else if(g||v){w.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let E=Tt.computeOutShape(x,y,b),T=Qn({inputs:{x:o},backend:t,attrs:{begin:x,size:E}});k=le({inputs:{x:T},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(T)}else if(t.shouldExecuteOnCPU([o])){let T=t.readSync(o.dataId),R=Me(o.shape,o.dtype,T),$=G$(d,R,b,x);k=t.makeTensorInfo(m,o.dtype,$.values)}else{let T=new j1(x,b,d);k=t.runWebGLProgram(T,[o],o.dtype)}let N=le({inputs:{x:k},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(k),N}var CB={kernelName:Pi,backendName:"webgl",kernelFunc:dge};function mge(r){let{inputs:e,backend:t,attrs:n}=r,{separator:o,nGramWidths:a,leftPad:i,rightPad:s,padWidth:u,preserveShortSequences:l}=n,{data:c,dataSplits:p}=e,f=t.readSync(c.dataId),d=t.readSync(p.dataId),[m,h]=j$(f,d,o,a,i,s,u,l);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(p.shape,"int32",h)]}var NB={kernelName:jm,backendName:"webgl",kernelFunc:mge};function hge(r){let{inputs:e,backend:t,attrs:n}=r,{skipEmpty:o}=n,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let s=t.readSync(a.dataId),u=t.readSync(i.dataId)[0],[l,c,p]=H$(s,u,o),f=c.length;return[t.makeTensorInfo([f,2],"int32",l),t.makeTensorInfo([f],"string",c),t.makeTensorInfo([2],"int32",new Int32Array(p))]}var EB={kernelName:Hm,backendName:"webgl",kernelFunc:hge};function gge(r){let{inputs:e,backend:t,attrs:n}=r,{numBuckets:o}=n,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");let i=t.readSync(a.dataId),s=q$(i,o);return t.makeTensorInfo(a.shape,"int32",s)}var TB={kernelName:qm,backendName:"webgl",kernelFunc:gge};var vge="return tan(x);",xge=ke({opSnippet:vge}),AB={kernelName:Mi,backendName:"webgl",kernelFunc:xge};var yge=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,bge=ke({opSnippet:yge}),FB={kernelName:Bi,backendName:"webgl",kernelFunc:bge};var H1=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;let o=Ve(this.rank),a=wge(e);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}};function wge(r){let e=r.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${r[0]})`;let t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let o=0;o<r.length;o++)n.push(`imod(${t[o]}, ${r[o]})`);return n.join()}function q1(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{reps:a}=n;if(o.dtype==="string"||o.shape.length>5){let u=t.readSync(o.dataId),l=o.dtype==="string"?u.map(f=>w.decodeString(f)):u,c=Me(o.shape,o.dtype,l),p=X$(c,a);return t.makeTensorInfo(p.shape,p.dtype,p.values)}let i=new H1(o.shape,a);return t.runWebGLProgram(i,[o],o.dtype)}var DB={kernelName:Li,backendName:"webgl",kernelFunc:q1};var K1=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},X1=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function bu(r,e){e!==null&&r.disposeIntermediateTensorInfo(e)}function RB(r){let e=1;for(;e<r;)e*=2;return e}function kge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{k:a,sorted:i}=n,s=X().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=X().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=o.shape,c=l[l.length-1];if(t.shouldExecuteOnCPU([o])||c<s||a>u){let $=t.readSync(o.dataId),[O,M]=Y$($,l,o.dtype,a,i);return[t.makeTensorInfo(O.shape,O.dtype,O.values),t.makeTensorInfo(M.shape,M.dtype,M.values)]}if(a===0)return l[l.length-1]=0,[t.makeTensorInfo(l,o.dtype,[]),t.makeTensorInfo(l,"int32",[])];if(c===1)return[o,na({attrs:{shape:l,dtype:"int32",value:0},backend:t})];let p=t.texData.get(o.dataId),f=p!==null&&p.isPacked,d=f?t.unpackTensor(o):o,h=w.sizeFromShape(l)/c,g=le({inputs:{x:d},attrs:{shape:[h,c]},backend:t});f&&bu(t,d);let v=RB(a),x=RB(c),y=null,b=()=>y===null?[g,g]:[g,y],k=($,O,M)=>{let B=b(),L=new K1(M),W=[[c],[y===null?1:0],[Number.NEGATIVE_INFINITY],[$],[O]],K=y;y=t.runWebGLProgram(L,B,"int32",W),bu(t,K)};for(let $=1;$<v;$*=2){let O=$*2;for(let M=$;M>=1;M/=2)k(O,M,[h,x])}for(let $=x;$>v;$/=2){let O=b(),M=new X1([h,$/2]),L=[[c],[y===null?1:0],[v]],H=y;y=t.runWebGLProgram(M,O,"int32",L),bu(t,H);let W=v/2,K=W*2;for(let J=W;J>=1;J/=2)k(K,J,y.shape)}let N=y;y=Qn({inputs:{x:y},backend:t,attrs:{begin:0,size:[h,a]}}),bu(t,N);let E=v1({inputs:{x:g,indices:y},backend:t,attrs:{axis:1,batchDims:1}});bu(t,g);let T=l.slice(0,-1);T.push(a),N=y,y=le({inputs:{x:y},attrs:{shape:T},backend:t}),bu(t,N);let R=E;return E=le({inputs:{x:E},attrs:{shape:T},backend:t}),bu(t,R),[E,y]}var $B={kernelName:Vi,backendName:"webgl",kernelFunc:kge};var Y1=class{constructor(e,t,n,o,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let s=n==="nearest"?1:2,u;switch(o){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${s} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function _ge(r){let{inputs:e,backend:t,attrs:n}=r,{image:o,transforms:a}=e,{interpolation:i,fillMode:s,fillValue:u,outputShape:l}=n,[c,p,f,d]=o.shape,[m,h]=l!=null?l:[p,f],g=[c,m,h,d],v=new Y1(p,f,i,s,u,g);return t.runWebGLProgram(v,[o,a],"float32")}var PB={kernelName:Wi,backendName:"webgl",kernelFunc:_ge};function Sge(r){let{inputs:e,attrs:t,backend:n}=r,{axis:o}=t,{x:a}=e;go(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=n.readSync(a.dataId),{outputValues:s,outputShape:u,indices:l}=Z$(i,o,a.shape,a.dtype);return[n.makeTensorInfo(u,a.dtype,s),n.makeTensorInfo([l.length],"int32",l)]}var OB={kernelName:Km,backendName:"webgl",kernelFunc:Sge};function Ige(r){let{inputs:e,backend:t,attrs:n}=r,{value:o}=e,{axis:a}=n;a<0&&(a+=o.shape.length);let i=o,s=i.shape.length,u=o.shape[a],l=new Array(s-1),c=0;for(let h=0;h<s;h++)h!==a&&(l[c++]=i.shape[h]);let p=[],f=new Array(s).fill(0),d=i.shape.slice();d[a]=1;let m=new Array(u);for(let h=0;h<m.length;h++){f[a]=h;let g=Qn({inputs:{x:i},backend:t,attrs:{begin:f,size:d}}),v=le({inputs:{x:g},backend:t,attrs:{shape:l}});m[h]=v,p.push(g)}return p.forEach(h=>t.disposeIntermediateTensorInfo(h)),m}var MB={kernelName:Tl,backendName:"webgl",kernelFunc:Ige};var Z1=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,o=e.batchSize,a=e.inSize,i=e.numSegments,s=i*Math.ceil(a/n);this.outputShape=[o,s];let u="0.0",l="sumValue",c=Math.floor(n/4)*4,p=n%4,f=`
        sumValue += dot(values, segFilter);
    `,d="";a%n>0&&(d=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let m="";a%n>0&&(m=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${l});
      }
    `}};function Cge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,segmentIds:a}=e,{numSegments:i}=n,s=o.shape.length,u=[],l=0,c=S.getAxesPermutation([l],s),p=o;c!=null&&(p=_t({inputs:{x:o},backend:t,attrs:{perm:c}}),u.push(p),l=S.getInnerMostAxes(1,s)[0]);let f=S.segment_util.computeOutShape(p.shape,l,i),d=w.sizeFromShape([p.shape[l]]),m=le({inputs:{x:p},backend:t,attrs:{shape:[-1,d]}});u.push(m);let h=Ji(o.dtype),g=(b,k,N,E,T)=>{let R=b.shape[0],$=b.shape[1],O=S.segment_util.segOpComputeOptimalWindowSize($,T),M={windowSize:O,inSize:$,batchSize:R,numSegments:T},B=new Z1(M,k),L=t.compileAndRun(B,[b,N],E);if(u.push(L),L.shape[1]===T)return L;let H=$1({backend:t,attrs:{start:0,stop:T,step:1,dtype:"float32"}}),W=q1({inputs:{x:H},backend:t,attrs:{reps:[$/O]}});return u.push(H),u.push(W),g(L,k,W,E,T)},v=g(m,"unsortedSegmentSum",a,h,i),x=le({inputs:{x:v},backend:t,attrs:{shape:f}}),y=x;if(c!=null){u.push(x);let b=S.getUndoAxesPermutation(c);y=_t({inputs:{x:y},backend:t,attrs:{perm:b}})}return u.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}var BB={kernelName:Xm,backendName:"webgl",kernelFunc:Cge};var Nge=[pM,fM,IP,NP,EP,TP,FP,DP,RP,$P,MP,BP,LP,VP,zP,WP,UP,jP,GP,HP,qP,KP,XP,ZP,JP,QP,nO,aO,sO,uO,dP,cO,fO,dO,pO,hO,gO,mO,vO,xO,yO,kO,_O,SO,CO,NO,IO,EO,TO,AO,FO,DO,RO,$O,OO,MO,LO,VO,WO,zO,GO,jO,HO,qO,KO,XO,YO,ZO,JO,fP,QO,lO,eM,tM,rM,mP,nM,oM,aM,iM,sM,uM,lM,cM,mM,vM,gM,xM,yM,wM,hM,_M,SM,IM,CM,NM,DM,yP,$M,PM,OM,MM,eO,BM,WM,zM,UM,GM,hP,jM,HM,tO,EM,qM,XM,KM,wP,YM,ZM,JM,QM,eB,tB,rB,nB,oB,aB,sB,uB,lB,cB,pB,YP,FM,fB,dB,mB,hB,gB,vB,xB,yB,wB,kB,SB,IB,CB,NB,EB,TB,AM,_P,AB,FB,DB,$B,PB,SP,OB,MB,BB,LM];for(let r of Nge)Fl(r);var Ege=Sr.whereImpl,nc=class extends so{constructor(){super();this.blockSize=48,this.firstUse=!0,this.data=new Da(this,Xn())}nextDataId(){return nc.nextDataId++}write(e,t,n){this.firstUse&&(this.firstUse=!1,X().get("IS_NODE")&&S.warn(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));let o={id:this.nextDataId()};return this.data.set(o,{values:e,dtype:n,refCount:1}),o}makeTensorInfo(e,t,n){let o;if(t==="string"&&n!=null&&n.length>0&&w.isString(n[0])){let a=n.map(i=>w.encodeString(i));o=this.write(a,e,t)}else o=this.write(n,e,t);return{dataId:o,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){let t=this.data.get(e);t.refCount--}}move(e,t,n,o,a){this.data.set(e,{values:t,dtype:o,refCount:a})}numDataIds(){return this.data.numDataIds()}read(e){return Be(this,null,function*(){return this.readSync(e)})}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t==="complex64"){let o=this.readSync(n.real.dataId),a=this.readSync(n.imag.dataId);return S.mergeRealAndImagArrays(o,a)}return this.data.get(e).values}bufferSync(e){let t=this.readSync(e.dataId),n=t;if(e.dtype==="string")try{n=t.map(o=>w.decodeString(o))}catch(o){throw new Error("Failed to decode encoded string bytes into utf-8")}return Me(e.shape,e.dtype,n)}makeOutput(e,t,n){let o=this.write(e,t,n);return Xn().makeTensorFromDataId(o,t,n,this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}time(e){return Be(this,null,function*(){let t=w.now();return e(),{kernelMs:w.now()-t}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){oe([e],"where");let t=this.readSync(e.dataId);return Ege(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};nc.nextDataId=0;Vl("cpu",()=>new nc,1);var J1=Oe(Vo,r=>r>=0?r:Math.exp(r)-1),LB={kernelName:Vo,backendName:"cpu",kernelFunc:J1};function Q1(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{alpha:a}=n;oe([o],"leakyRelu");let i=w.sizeFromShape(o.shape),s=t.data.get(o.dataId).values,u=w.getTypedArrayFromDType("float32",i);for(let l=0;l<s.length;l++)u[l]=s[l]<0?a*s[l]:s[l];return t.makeTensorInfo(o.shape,"float32",u)}var VB={kernelName:Wo,backendName:"cpu",kernelFunc:Q1};var Tge=qe((r,e)=>r<0?e*r:r);function ek(r){let{inputs:e,backend:t}=r,{x:n,alpha:o}=e;oe([n,o],"prelu");let a=t.data.get(n.dataId).values,i=t.data.get(o.dataId).values,[s,u]=Tge(n.shape,o.shape,a,i,"float32");return t.makeTensorInfo(u,"float32",s)}var WB={kernelName:Uo,backendName:"cpu",kernelFunc:ek};var tk=Oe(Go,r=>Math.max(0,r)),zB={kernelName:Go,backendName:"cpu",kernelFunc:tk};var rk=Oe(jo,r=>Math.min(Math.max(0,r),6)),UB={kernelName:jo,backendName:"cpu",kernelFunc:rk};function oc(r,e,t,n,o){if(t==="linear")return Ir({inputs:{x:e},backend:r});if(t==="relu")return tk({inputs:{x:e},backend:r});if(t==="elu")return J1({inputs:{x:e},backend:r});if(t==="relu6")return rk({inputs:{x:e},backend:r});if(t==="prelu")return ek({inputs:{x:e,alpha:n},backend:r});if(t==="leakyrelu")return Q1({inputs:{x:e},backend:r,attrs:{alpha:o}});if(t==="sigmoid")return M0({inputs:{x:e},backend:r});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}function Xe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{shape:a}=n,i=w.sizeFromShape(o.shape),s=w.inferFromImplicitShape(a,i),u=w.sizeFromShape(s);w.assert(i===u,()=>`The new shape (${s}) has ${u} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.incRef(o.dataId);let l=t.data.get(o.dataId);if(l.complexTensorInfos!=null){let c=l.complexTensorInfos.real,p=l.complexTensorInfos.imag;c.shape=s,p.shape=s}return{dataId:o.dataId,shape:s,dtype:o.dtype}}var GB={kernelName:Pa,backendName:"cpu",kernelFunc:Xe};function nk(r){let{inputs:e,backend:t,attrs:n}=r,{a:o,b:a}=e,{transposeA:i,transposeB:s}=n;oe([o,a],"matMul");let u=o.shape.length,l=a.shape.length,c=i?o.shape[u-2]:o.shape[u-1],p=s?a.shape[l-1]:a.shape[l-2],f=i?o.shape[u-1]:o.shape[u-2],d=s?a.shape[l-2]:a.shape[l-1],m=o.shape.slice(0,-2),h=a.shape.slice(0,-2),g=w.sizeFromShape(m),v=w.sizeFromShape(h),x=g===v||g===1||v===1;w.assert(u>=2&&l>=2&&x,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${m}) and (${h}).`);let b=(g>v?o.shape.slice(0,-2):a.shape.slice(0,-2)).concat([f,d]);w.assert(c===p,()=>`Error in matMul: inner shapes (${c}) and (${p}) of Tensors with shapes ${o.shape} and ${a.shape} and transposeA=${i} and transposeB=${s} must match.`);let k=i?[g,c,f]:[g,f,c],N=s?[v,d,p]:[v,p,d],E=Xe({inputs:{x:o},backend:t,attrs:{shape:k}}),T=Xe({inputs:{x:a},backend:t,attrs:{shape:N}}),R=i?E.shape[1]:E.shape[2],$=i?E.shape[2]:E.shape[1],O=s?T.shape[1]:T.shape[2],M=Math.max(g,v),B=t.data.get(E.dataId).values,L=t.data.get(T.dataId).values,H=w.computeStrides(E.shape),W=w.computeStrides(T.shape),[K,J,Q]=i?[H[0],1,H[1]]:[H[0],H[1],1],[ee,Y,ne]=s?[1,W[1],W[0]]:[W[1],1,W[0]],te=$*O,ce=Me([M,$,O],E.dtype),pe=ce.values,se=t.blockSize;for(let fe=0;fe<M;fe++)for(let ye=0;ye<$;ye+=se)for(let _e=0;_e<O;_e+=se)for(let Ae=0;Ae<R;Ae+=se){let We=Math.min(ye+se,$),Ze=Math.min(_e+se,O),ut=Math.min(Ae+se,R);for(let lt=ye;lt<We;lt++)for(let tt=_e;tt<Ze;tt++){let Ue=0;for(let Ge=Ae;Ge<ut;Ge++){let Ie=Math.min(fe,g-1)*K,cr=Math.min(fe,v-1)*ne,ft=B[Ie+lt*J+Ge*Q],St=L[Ge*ee+tt*Y+cr];Ue+=ft*St}pe[fe*te+(lt*O+tt)]+=Ue}}return t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo(T),t.makeTensorInfo(b,ce.dtype,ce.values)}var jB={kernelName:Ws,backendName:"cpu",kernelFunc:nk};function Age(r){let{inputs:e,backend:t,attrs:n}=r,{a:o,b:a,bias:i,preluActivationWeights:s}=e,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:p}=n,f,d,m,h=[];f=nk({inputs:{a:o,b:a},attrs:{transposeA:u,transposeB:l},backend:t}),i&&(d=Jo({inputs:{a:f,b:i},backend:t}),h.push(f),f=d),c&&(m=oc(t,f,c,s,p),h.push(f),f=m);for(let v of h)t.disposeIntermediateTensorInfo(v);return f}var HB={kernelName:Gi,backendName:"cpu",kernelFunc:Age};var Fge=Oe(gp,r=>Math.acos(r)),qB={kernelName:gp,backendName:"cpu",kernelFunc:Fge};var Dge=Oe(vp,r=>Math.acosh(r)),KB={kernelName:vp,backendName:"cpu",kernelFunc:Dge};function Rge(r){let{inputs:e,backend:t}=r,n=e;oe(e,"addN");let o=n.map(s=>t.data.get(s.dataId).values),a=Me(n[0].shape,n[0].dtype),i=a.values;for(let s=0;s<n.length;s++){let u=o[s];for(let l=0;l<i.length;l++)i[l]+=u[l]}return t.makeTensorInfo(a.shape,a.dtype,a.values)}var XB={kernelName:Os,backendName:"cpu",kernelFunc:Rge};function $ge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n;oe(o,"all");let s=w.parseAxisParam(a,o.shape),u=s,l=S.getAxesPermutation(u,o.shape.length),c=o;l!=null&&(c=Jt({inputs:{x:o},backend:t,attrs:{perm:l}}),u=S.getInnerMostAxes(u.length,o.shape.length)),S.assertAxesAreInnerMostDims("all",u,c.shape.length);let[p,f]=S.computeOutAndReduceShapes(c.shape,u),d=w.sizeFromShape(f),m=w.makeZerosTypedArray(w.sizeFromShape(p),c.dtype),h=t.data.get(c.dataId).values;for(let v=0;v<m.length;++v){let x=v*d,y=h[x];for(let b=0;b<d;++b){let k=h[x+b];y=y&&k}m[v]=y}l!=null&&t.disposeIntermediateTensorInfo(c);let g=t.makeTensorInfo(p,c.dtype,m);if(i){let v=S.expandShapeToKeepDim(p,s),x=Xe({inputs:{x:g},backend:t,attrs:{shape:v}});return t.disposeIntermediateTensorInfo(g),x}return g}var YB={kernelName:Ms,backendName:"cpu",kernelFunc:$ge};function Pge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n;oe(o,"any");let s=w.parseAxisParam(a,o.shape),u=s,l=S.getAxesPermutation(u,o.shape.length),c=o;l!=null&&(c=Jt({inputs:{x:o},backend:t,attrs:{perm:l}}),u=S.getInnerMostAxes(u.length,o.shape.length)),S.assertAxesAreInnerMostDims("any",u,c.shape.length);let[p,f]=S.computeOutAndReduceShapes(c.shape,u),d=w.sizeFromShape(f),m=w.makeZerosTypedArray(w.sizeFromShape(p),c.dtype),h=t.data.get(c.dataId).values;for(let v=0;v<m.length;++v){let x=v*d,y=h[x];for(let b=0;b<d;++b){let k=h[x+b];y=y||k}m[v]=y}l!=null&&t.disposeIntermediateTensorInfo(c);let g=t.makeTensorInfo(p,c.dtype,m);if(i){let v=S.expandShapeToKeepDim(p,s),x=Xe({inputs:{x:g},backend:t,attrs:{shape:v}});return t.disposeIntermediateTensorInfo(g),x}return g}var ZB={kernelName:Bs,backendName:"cpu",kernelFunc:Pge};function Oge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a}=n;oe(o,"argMax");let i=w.parseAxisParam(a,o.shape),s=S.getAxesPermutation(i,o.shape.length),u=o,l=[];s!=null&&(u=Jt({inputs:{x:o},backend:t,attrs:{perm:s}}),l.push(u),i=S.getInnerMostAxes(i.length,u.shape.length)),i=[i[0]],S.assertAxesAreInnerMostDims("argMax",i,u.shape.length);let[c,p]=S.computeOutAndReduceShapes(u.shape,i),f=w.sizeFromShape(c),d=w.makeZerosTypedArray(f,"int32"),m=w.sizeFromShape(p),h=t.data.get(u.dataId).values;for(let g=0;g<d.length;++g){let v=g*m,x=h[v],y=0;for(let b=0;b<m;++b){let k=h[v+b];k>x&&(x=k,y=b)}d[g]=y}return l.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.makeTensorInfo(c,"int32",d)}var JB={kernelName:Ls,backendName:"cpu",kernelFunc:Oge};function Mge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a}=n;oe(o,"argMin");let i=w.parseAxisParam(a,o.shape),s=S.getAxesPermutation(i,o.shape.length),u=o,l=[];s!=null&&(u=Jt({inputs:{x:o},backend:t,attrs:{perm:s}}),l.push(u),i=S.getInnerMostAxes(i.length,u.shape.length)),i=[i[0]],S.assertAxesAreInnerMostDims("argMin",i,u.shape.length);let[c,p]=S.computeOutAndReduceShapes(u.shape,i),f=w.sizeFromShape(c),d=w.makeZerosTypedArray(f,"int32"),m=w.sizeFromShape(p),h=t.data.get(u.dataId).values;for(let g=0;g<d.length;++g){let v=g*m,x=h[v],y=0;for(let b=0;b<m;++b){let k=h[v+b];k<x&&(x=k,y=b)}d[g]=y}return l.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.makeTensorInfo(c,"int32",d)}var QB={kernelName:im,backendName:"cpu",kernelFunc:Mge};var Bge=Oe(xp,r=>Math.asin(r)),eL={kernelName:xp,backendName:"cpu",kernelFunc:Bge};var Lge=Oe(yp,r=>Math.asinh(r)),tL={kernelName:yp,backendName:"cpu",kernelFunc:Lge};var Vge=Oe(bp,r=>Math.atan(r)),rL={kernelName:bp,backendName:"cpu",kernelFunc:Vge};var Wge=qe((r,e)=>Math.atan2(r,e)),zge=Qe(kp,Wge),nL={kernelName:kp,backendName:"cpu",kernelFunc:zge};var Uge=Oe(wp,r=>Math.atanh(r)),oL={kernelName:wp,backendName:"cpu",kernelFunc:Uge};function ac(r,e,t,n,o,a){let i=o.strideHeight,s=o.strideWidth,u=o.dilationHeight,l=o.dilationWidth,c=o.effectiveFilterHeight,p=o.effectiveFilterWidth,f=o.padInfo.top,d=o.padInfo.left,m=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,h=Me(o.outShape,t),g=h.values,v=o.outShape[1]*o.outShape[2]*o.outShape[3],x=o.outShape[2]*o.outShape[3],y=o.outShape[3];for(let b=0;b<o.batchSize;++b){let k=b*v,N=b*n[0];for(let E=0;E<o.inChannels;++E)for(let T=0;T<o.outHeight;++T){let R=T*i-f,$=Math.max(0,R),O=Math.min(o.inHeight,c+R),M=k+T*x;for(let B=0;B<o.outWidth;++B){let L=B*s-d,H=Math.max(0,L),W=Math.min(o.inWidth,p+L),K=m,J=0,Q=0;for(let Y=$;Y<O;Y+=u){let ne=N+Y*n[1];for(let te=H;te<W;te+=l){let ce=ne+te*n[2],pe=r[ce+E];a==="max"&&pe>K?K=pe:a==="avg"&&(J+=pe,Q++)}if(isNaN(K))break}let ee=M+B*y+E;g[ee]=a==="avg"?J/Q:K}}}return h}function eg(r,e,t,n,o=!1,a=!1){let i=Me(n.outShape,"int32"),s=n.strideHeight,u=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,p=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=n.padInfo.top,m=n.padInfo.left,h=Me(e,t,r);for(let g=0;g<n.batchSize;++g)for(let v=0;v<n.inChannels;++v)for(let x=0;x<n.outHeight;++x){let y=x*s-d,b=y;for(;b<0;)b+=l;let k=Math.min(n.inHeight,p+y);for(let N=0;N<n.outWidth;++N){let E=N*u-m,T=E;for(;T<0;)T+=c;let R=Math.min(n.inWidth,f+E),$=Number.NEGATIVE_INFINITY,O=-1;for(let M=b;M<k;M+=l){let B=M-y;for(let L=T;L<R;L+=c){let H=L-E,W=h.get(g,M,L,v);W>$&&($=W,o?O=a?((g*n.inHeight+M)*n.inWidth+L)*n.inChannels+v:(M*n.inWidth+L)*n.inChannels+v:O=B*f+H)}}i.set(O,g,x,N,v)}}return i}function tg(r,e,t,n,o,a){let i=o.strideDepth,s=o.strideHeight,u=o.strideWidth,l=o.dilationDepth,c=o.dilationHeight,p=o.dilationWidth,f=o.effectiveFilterDepth,d=o.effectiveFilterHeight,m=o.effectiveFilterWidth,h=o.padInfo.front,g=o.padInfo.top,v=o.padInfo.left,x=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=Me(o.outShape,t),b=y.values,k=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],N=o.outShape[2]*o.outShape[3]*o.outShape[4],E=o.outShape[3]*o.outShape[4],T=o.outShape[4];for(let R=0;R<o.batchSize;++R){let $=R*k,O=R*n[0];for(let M=0;M<o.inChannels;++M)for(let B=0;B<o.outDepth;++B){let L=B*i-h,H=L;for(;H<0;)H+=l;let W=Math.min(o.inDepth,f+L),K=$+B*N;for(let J=0;J<o.outHeight;++J){let Q=J*s-g,ee=Q;for(;ee<0;)ee+=c;let Y=Math.min(o.inHeight,d+Q),ne=K+J*E;for(let te=0;te<o.outWidth;++te){let ce=te*u-v,pe=ce;for(;pe<0;)pe+=p;let se=Math.min(o.inWidth,m+ce),fe=ne+te*T,ye=x,_e=0,Ae=0;for(let Ze=H;Ze<W;Ze+=l){let ut=O+Ze*n[1];for(let lt=ee;lt<Y;lt+=c){let tt=ut+lt*n[2];for(let Ue=pe;Ue<se;Ue+=p){let Ge=tt+Ue*n[3],Ie=r[Ge+M];if(a==="max"&&Ie>ye?ye=Ie:a==="avg"&&(_e+=Ie,Ae++),isNaN(ye))break}if(isNaN(ye))break}if(isNaN(ye))break}let We=fe+M;b[We]=a==="avg"?_e/Ae:ye}}}}return y}function aL(r,e){let t=Me(e.outShape,"int32"),n=e.strideDepth,o=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,m=e.padInfo.left;for(let h=0;h<e.batchSize;++h)for(let g=0;g<e.inChannels;++g)for(let v=0;v<e.outDepth;++v){let x=v*n-f,y=x;for(;y<0;)y+=i;let b=Math.min(e.inDepth,l+x);for(let k=0;k<e.outHeight;++k){let N=k*o-d,E=N;for(;E<0;)E+=s;let T=Math.min(e.inHeight,c+N);for(let R=0;R<e.outWidth;++R){let $=R*a-m,O=$;for(;O<0;)O+=u;let M=Math.min(e.inWidth,p+$),B=Number.NEGATIVE_INFINITY,L=-1;for(let H=y;H<b;H+=i){let W=H-x;for(let K=E;K<T;K+=s){let J=K-N;for(let Q=O;Q<M;Q+=u){let ee=Q-$,Y=r.get(h,H,K,Q,g);Y>=B&&(B=Y,L=W*c*p+J*c+ee)}}}t.set(L,h,v,k,R,g)}}}return t}function Gge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e;oe(o,"avgPool");let{filterSize:a,strides:i,pad:s,dimRoundingMode:u}=n,l=1;w.assert(S.eitherStridesOrDilationsAreOne(i,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let c=S.computePool2DInfo(o.shape,a,i,l,s,u),p;if(c.filterWidth===1&&c.filterHeight===1&&w.arraysEqual(c.inShape,c.outShape))p=Ir({inputs:{x:o},backend:t});else{let f=t.data.get(o.dataId).values,d=w.computeStrides(o.shape),m=ac(f,o.shape,o.dtype,d,c,"avg");p=t.makeTensorInfo(c.outShape,o.dtype,m.values)}return p}var sL={kernelName:Vs,backendName:"cpu",kernelFunc:Gge};function jge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{filterSize:a,strides:i,pad:s,dimRoundingMode:u,dataFormat:l}=n;oe(o,"avgPool3d");let c=S.computePool3DInfo(o.shape,a,i,1,s,u,l),p=t.data.get(o.dataId).values,f=tg(p,o.shape,o.dtype,w.computeStrides(o.shape),c,"avg");return t.makeTensorInfo(f.shape,"float32",f.values)}var iL={kernelName:lm,backendName:"cpu",kernelFunc:jge};function Hge(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a}=e,{filterSize:i,strides:s,pad:u,dimRoundingMode:l}=n;oe([o,a],"avgPool3DGrad");let c=S.computePool3DInfo(a.shape,i,s,1,u,l),p=c.strideDepth,f=c.strideHeight,d=c.strideWidth,m=c.filterDepth,h=c.filterHeight,g=c.filterWidth,v=c.dilationDepth,x=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterDepth,k=c.effectiveFilterHeight,N=c.effectiveFilterWidth,E=b-1-c.padInfo.front,T=N-1-c.padInfo.left,R=k-1-c.padInfo.top,$=Me(a.shape,"float32"),O=1/(m*h*g),M=t.bufferSync(o);for(let B=0;B<c.batchSize;++B)for(let L=0;L<c.inChannels;++L)for(let H=0;H<c.inDepth;++H)for(let W=0;W<c.inHeight;++W)for(let K=0;K<c.inWidth;++K){let J=H-E,Q=W-R,ee=K-T,Y=0;for(let ne=0;ne<b;ne+=v){let te=(J+ne)/p;if(!(te<0||te>=c.outDepth||Math.floor(te)!==te))for(let ce=0;ce<k;ce+=x){let pe=(Q+ce)/f;if(!(pe<0||pe>=c.outHeight||Math.floor(pe)!==pe))for(let se=0;se<N;se+=y){let fe=(ee+se)/d;if(fe<0||fe>=c.outWidth||Math.floor(fe)!==fe)continue;Y+=M.get(B,te,pe,fe,L)}}}$.set(Y*O,B,H,W,K,L)}return t.makeTensorInfo($.shape,$.dtype,$.values)}var uL={kernelName:cm,backendName:"cpu",kernelFunc:Hge};function qge(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a}=e,i=a;oe([o,a],"avgPoolGrad");let{filterSize:s,strides:u,pad:l}=n,c=S.computePool2DInfo(i.shape,s,u,1,l),p=c.strideHeight,f=c.strideWidth,d=c.filterHeight,m=c.filterWidth,h=c.dilationHeight,g=c.dilationWidth,v=c.effectiveFilterHeight,x=c.effectiveFilterWidth,y=x-1-c.padInfo.left,b=v-1-c.padInfo.top,k=Me(i.shape,"float32"),N=1/(d*m),E=t.data.get(o.dataId).values,T=Me(o.shape,"float32",E);for(let R=0;R<c.batchSize;++R)for(let $=0;$<c.inChannels;++$)for(let O=0;O<c.inHeight;++O)for(let M=0;M<c.inWidth;++M){let B=O-b,L=M-y,H=0;for(let W=0;W<v;W+=h){let K=(B+W)/p;if(!(K<0||K>=c.outHeight||Math.floor(K)!==K))for(let J=0;J<x;J+=g){let Q=(L+J)/f;if(Q<0||Q>=c.outWidth||Math.floor(Q)!==Q)continue;H+=T.get(R,K,Q,$)}}k.set(H*N,R,O,M,$)}return t.makeTensorInfo(k.shape,k.dtype,k.values)}var lL={kernelName:um,backendName:"cpu",kernelFunc:qge};function Kge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,scale:a,offset:i,mean:s,variance:u}=e;w.assert(s.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),w.assert(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),w.assert(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),oe([o,s,u,a,i],"batchNorm");let{varianceEpsilon:l}=n;l==null&&(l=.001);let c=t.data.get(o.dataId).values,p=t.data.get(s.dataId).values,f=t.data.get(u.dataId).values,d=a?t.data.get(a.dataId).values:new Float32Array([1]),m=i?t.data.get(i.dataId).values:new Float32Array([0]),h=new Float32Array(c.length),g=m.length,v=d.length,x=f.length,y=p.length,b=0,k=0,N=0,E=0;for(let T=0;T<c.length;++T)h[T]=m[b++]+(c[T]-p[k++])*d[N++]/Math.sqrt(f[E++]+l),b>=g&&(b=0),k>=y&&(k=0),N>=v&&(N=0),E>=x&&(E=0);return t.makeTensorInfo(o.shape,o.dtype,h)}var cL={kernelName:ni,backendName:"cpu",kernelFunc:Kge};function Xge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockShape:a,crops:i}=n;oe([o],"batchToSpaceND");let s=a.reduce((v,x)=>v*x),u=S.getReshaped(o.shape,a,s),l=S.getPermuted(u.length,a.length),c=S.getReshapedPermuted(o.shape,a,s),p=S.getSliceBeginCoords(i,a.length),f=S.getSliceSize(c,i,a.length),d=Xe({inputs:{x:o},backend:t,attrs:{shape:u}}),m=Jt({inputs:{x:d},backend:t,attrs:{perm:l}}),h=Xe({inputs:{x:m},backend:t,attrs:{shape:c}}),g=Bn({inputs:{x:h},backend:t,attrs:{begin:p,size:f}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(h),g}var pL={kernelName:ml,backendName:"cpu",kernelFunc:Xge};function Yge(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,weights:a}=e,{size:i}=n,s=t.data.get(o.dataId).values,u=t.data.get(a.dataId).values,l=Gl(s,u,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,l)}var fL={kernelName:pm,backendName:"cpu",kernelFunc:Yge};function Zge(r){let{inputs:e,backend:t}=r,{s0:n,s1:o}=e,a=t.data.get(n.dataId).values,i=t.data.get(o.dataId).values,s=S.assertAndGetBroadcastShape(Array.from(a),Array.from(i));return t.makeTensorInfo([s.length],"int32",Int32Array.from(s))}var dL={kernelName:fm,backendName:"cpu",kernelFunc:Zge};var Jge=Oe($a,(r,e)=>{let t=e;return r>t.clipValueMax?t.clipValueMax:r<t.clipValueMin?t.clipValueMin:r}),mL={kernelName:$a,backendName:"cpu",kernelFunc:Jge};var Qge=r=>{let{x:e}=r.inputs,t=r.backend,n=new Float32Array(w.sizeFromShape(e.shape)),o=t.data.get(e.dataId),a=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,s=t.data.get(a.dataId).values,u=t.data.get(i.dataId).values;for(let l=0;l<s.length;l++){let c=s[l],p=u[l];n[l]=Math.hypot(c,p)}return t.makeOutput(n,e.shape,"float32")},hL={kernelName:dm,backendName:"cpu",kernelFunc:Qge};function xo(r){let{inputs:e,backend:t}=r,{input:n}=e,o=t.data.get(n.dataId).complexTensorInfos.imag,a=t.data.get(o.dataId).values;return t.makeTensorInfo(o.shape,o.dtype,a)}var gL={kernelName:Nm,backendName:"cpu",kernelFunc:xo};function Ha(r){let{inputs:e,backend:t,attrs:n}=r,{axis:o}=n,a=w.parseAxisParam(o,e[0].shape)[0],i=S.computeOutShape(e.map(h=>h.shape),a);if(w.sizeFromShape(i)===0)return t.makeTensorInfo(i,e[0].dtype,[]);let s=e.filter(h=>w.sizeFromShape(h.shape)>0);if(s.length===1)return Ir({inputs:{x:s[0]},backend:t});let u=s.map(h=>h.shape);if(S.assertParamsConsistent(u,a),s[0].dtype==="complex64"){let h=s.map(b=>Pn({inputs:{input:b},backend:t})),g=s.map(b=>xo({inputs:{input:b},backend:t})),v=Ha({inputs:h,backend:t,attrs:{axis:a}}),x=Ha({inputs:g,backend:t,attrs:{axis:a}}),y=lr({inputs:{real:v,imag:x},backend:t});return h.forEach(b=>t.disposeIntermediateTensorInfo(b)),g.forEach(b=>t.disposeIntermediateTensorInfo(b)),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),y}let l=s.map(h=>{let g=w.sizeFromShape(h.shape.slice(a));return Xe({inputs:{x:h},backend:t,attrs:{shape:[-1,g]}})}),c=l.map(h=>({vals:t.data.get(h.dataId).values,shape:h.shape}));i=S.computeOutShape(l.map(h=>h.shape),1);let p=l[0].shape[0]===1,f=au(c,i,e[0].dtype,p),d=S.computeOutShape(s.map(h=>h.shape),a),m=t.makeTensorInfo(d,e[0].dtype,f);return l.forEach(h=>t.disposeIntermediateTensorInfo(h)),m}var vL={kernelName:gl,backendName:"cpu",kernelFunc:Ha};function ok(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dataFormat:u,dilations:l,dimRoundingMode:c}=n;oe([o,a],"conv2d");let p=S.convertConv2DDataFormat(u),f=S.computeConv2DInfo(o.shape,a.shape,i,l,s,c,!1,p),d=f.filterHeight,m=f.filterWidth,h=f.dilationHeight,g=f.dilationWidth,v=f.padInfo.left,x=f.padInfo.top,y=f.dataFormat==="channelsLast",b=new mt(f.outShape,o.dtype),k=w.computeStrides(o.shape),N=w.computeStrides(a.shape),E=k[0],T=y?k[1]:k[2],R=y?k[2]:1,$=y?1:k[1],O=b.strides[0],M=y?b.strides[1]:b.strides[2],B=y?b.strides[2]:1,L=y?1:b.strides[1],H=t.data.get(o.dataId).values,W=t.data.get(a.dataId).values,K=b.values;for(let J=0;J<f.batchSize;++J){let Q=J*E,ee=J*O;for(let Y=0;Y<f.outHeight;++Y){let ne=ee+Y*M,te=Y*f.strideHeight-x;for(let ce=0;ce<d;++ce){let pe=te+ce*h;if(pe<0||pe>=f.inHeight)continue;let se=ce*N[0],fe=Q+pe*T;for(let ye=0;ye<f.outWidth;++ye){let _e=ne+ye*B,Ae=ye*f.strideWidth-v;for(let We=0;We<m;++We){let Ze=Ae+We*g;if(Ze<0||Ze>=f.inWidth)continue;let ut=se+We*N[1],lt=fe+Ze*R,tt=ut;for(let Ue=0;Ue<f.inChannels;++Ue){let Ge=H[lt+Ue*$];for(let Ie=0;Ie<f.outChannels;++Ie)K[_e+Ie*L]+=Ge*W[tt+Ie];tt+=f.outChannels}}}}}}return t.makeTensorInfo(b.shape,b.dtype,K)}var xL={kernelName:Us,backendName:"cpu",kernelFunc:ok};function eve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,dy:a}=e,{strides:i,pad:s,dataFormat:u,dimRoundingMode:l,filterShape:c}=n;oe([o,a],"conv2dBackpropFilter");let p=S.convertConv2DDataFormat(u),f=S.computeConv2DInfo(o.shape,c,i,1,s,l,!1,p),{strideHeight:d,strideWidth:m,filterHeight:h,filterWidth:g}=f,v=f.dataFormat==="channelsLast",x=new mt(f.filterShape,"float32"),y=f.padInfo.left,b=f.padInfo.top,k=t.data.get(o.dataId).values,N=t.data.get(a.dataId).values,E=new mt(o.shape,o.dtype,k),T=new mt(a.shape,a.dtype,N);for(let R=0;R<h;++R){let $=Math.max(0,Math.ceil((b-R)/d)),O=Math.min(f.outHeight,(f.inHeight+b-R)/d);for(let M=0;M<g;++M){let B=Math.max(0,Math.ceil((y-M)/m)),L=Math.min(f.outWidth,(f.inWidth+y-M)/m);for(let H=0;H<f.inChannels;++H)for(let W=0;W<f.outChannels;++W){let K=0;for(let J=0;J<f.batchSize;++J)for(let Q=$;Q<O;++Q){let ee=R+Q*d-b;for(let Y=B;Y<L;++Y){let ne=M+Y*m-y;v?K+=E.get(J,ee,ne,H)*T.get(J,Q,Y,W):K+=E.get(J,H,ee,ne)*T.get(J,W,Q,Y)}}x.set(K,R,M,H,W)}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}var yL={kernelName:mm,backendName:"cpu",kernelFunc:eve};function tve(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,filter:a}=e,{inputShape:i,strides:s,pad:u,dataFormat:l,dimRoundingMode:c}=n;oe([o,a],"conv2dBackpropInput");let p=w.computeStrides(a.shape),f=w.computeStrides(o.shape),d=S.convertConv2DDataFormat(l),m=S.computeConv2DInfo(i,a.shape,s,1,u,c,!1,d),h=new mt(m.inShape,"float32"),g=h.values,v=t.data.get(o.dataId).values,x=t.data.get(a.dataId).values,[y,b,k]=p,{batchSize:N,filterHeight:E,filterWidth:T,inChannels:R,inHeight:$,inWidth:O,outChannels:M,outHeight:B,outWidth:L,strideHeight:H,strideWidth:W}=m;d=m.dataFormat;let K=E-1-m.padInfo.top,J=T-1-m.padInfo.left,Q=d==="channelsLast",ee=h.strides[0],Y=Q?h.strides[1]:h.strides[2],ne=Q?h.strides[2]:1,te=Q?1:h.strides[1],ce=f[0],pe=Q?f[1]:f[2],se=Q?f[2]:1,fe=Q?1:f[1];for(let ye=0;ye<N;++ye)for(let _e=0;_e<R;++_e)for(let Ae=0;Ae<$;++Ae){let We=Ae-K,Ze=Math.max(0,Math.ceil(We/H)),ut=Math.min(B,(E+We)/H);for(let lt=0;lt<O;++lt){let tt=lt-J,Ue=Math.max(0,Math.ceil(tt/W)),Ge=Math.min(L,(T+tt)/W),Ie=0;for(let ft=Ze;ft<ut;++ft){let St=ft*H-We;for(let Qt=Ue;Qt<Ge;++Qt){let Xr=Qt*W-tt,Xt=ce*ye+pe*ft+se*Qt,ht=y*(E-1-St)+b*(T-1-Xr)+k*_e;for(let Nr=0;Nr<M;++Nr){let Ft=v[Xt+fe*Nr],pr=x[ht+Nr];Ie+=Ft*pr}}}let cr=ee*ye+Y*Ae+ne*lt+te*_e;g[cr]=Ie}}return t.makeTensorInfo(h.shape,h.dtype,h.values)}var bL={kernelName:Gs,backendName:"cpu",kernelFunc:tve};function rve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dilations:u}=n;oe([o,a],"conv3d");let l=S.computeConv3DInfo(o.shape,a.shape,i,u,s),{filterDepth:c,filterHeight:p,filterWidth:f,dilationDepth:d,dilationHeight:m,dilationWidth:h,padInfo:g}=l,v=g.front,x=g.left,y=g.top,b=new mt(l.outShape,o.dtype),k=t.data.get(o.dataId).values,N=t.data.get(a.dataId).values,E=b.values,T=w.computeStrides(o.shape),R=w.computeStrides(a.shape);for(let $=0;$<l.batchSize;++$){let O=$*T[0],M=$*b.strides[0];for(let B=0;B<l.outDepth;++B){let L=M+B*b.strides[1],H=B*l.strideDepth-v;for(let W=0;W<c;++W){let K=H+W*d;if(K<0||K>=l.inDepth)continue;let J=W*R[0],Q=O+K*T[1];for(let ee=0;ee<l.outHeight;++ee){let Y=L+ee*b.strides[2],ne=ee*l.strideHeight-y;for(let te=0;te<p;++te){let ce=ne+te*m;if(ce<0||ce>=l.inHeight)continue;let pe=J+te*R[1],se=Q+ce*T[2];for(let fe=0;fe<l.outWidth;++fe){let ye=Y+fe*l.outChannels,_e=fe*l.strideWidth-x;for(let Ae=0;Ae<f;++Ae){let We=_e+Ae*h;if(We<0||We>=l.inWidth)continue;let Ze=pe+Ae*R[2],ut=se+We*l.inChannels,lt=Ze;for(let tt=0;tt<l.inChannels;++tt){let Ue=k[ut+tt];for(let Ge=0;Ge<l.outChannels;++Ge)E[ye+Ge]+=Ue*N[lt+Ge];lt+=l.outChannels}}}}}}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}var wL={kernelName:hm,backendName:"cpu",kernelFunc:rve};function nve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,dy:a}=e,{strides:i,pad:s,filterShape:u}=n;oe([o,a],"conv3dBackpropFilterV2");let l=w.computeStrides(o.shape),c=w.computeStrides(a.shape),p=S.computeConv3DInfo(o.shape,u,i,1,s),f=p.strideDepth,d=p.strideHeight,m=p.strideWidth,h=p.filterDepth,g=p.filterHeight,v=p.filterWidth,x=new mt(p.filterShape,"float32"),y=x.values,[b,k,N,E]=x.strides,T=t.data.get(a.dataId).values,[R,$,O,M]=c,B=t.data.get(o.dataId).values,[L,H,W,K]=l,J=p.padInfo.front,Q=p.padInfo.left,ee=p.padInfo.top;for(let Y=0;Y<h;++Y){let ne=Math.max(0,Math.ceil((J-Y)/f)),te=Math.min(p.outDepth,(p.inDepth+J-Y)/f),ce=Y*b;for(let pe=0;pe<g;++pe){let se=Math.max(0,Math.ceil((ee-pe)/d)),fe=Math.min(p.outHeight,(p.inHeight+ee-pe)/d),ye=pe*k+ce;for(let _e=0;_e<v;++_e){let Ae=Math.max(0,Math.ceil((Q-_e)/m)),We=Math.min(p.outWidth,(p.inWidth+Q-_e)/m),Ze=_e*N+ye;for(let ut=0;ut<p.inChannels;++ut){let lt=ut*E+Ze;for(let tt=0;tt<p.outChannels;++tt){let Ue=0;for(let Ge=0;Ge<p.batchSize;++Ge){let Ie=Ge*L,cr=Ge*R;for(let ft=ne;ft<te;++ft){let Qt=(Y+ft*f-J)*H+Ie,Xr=ft*$+cr;for(let Xt=se;Xt<fe;++Xt){let Nr=(pe+Xt*d-ee)*W+Qt,Ft=Xt*O+Xr;for(let pr=Ae;pr<We;++pr){let qa=(_e+pr*m-Q)*K+Nr,Ka=pr*M+Ft;Ue+=B[qa+ut]*T[Ka+tt]}}}}y[lt+tt]=Ue}}}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}var kL={kernelName:gm,backendName:"cpu",kernelFunc:nve};function ove(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,filter:a}=e,{pad:i,strides:s,inputShape:u}=n;oe([o],"conv3dBackpropInputV2");let l=w.computeStrides(o.shape),c=w.computeStrides(a.shape),p=S.computeConv3DInfo(u,a.shape,s,1,i),f=new mt(p.inShape,"float32"),d=f.values,[m,h,g,v]=f.strides,x=t.data.get(o.dataId).values,[y,b,k,N]=l,E=t.data.get(a.dataId).values,[T,R,$,O]=c,{batchSize:M,filterDepth:B,filterHeight:L,filterWidth:H,inChannels:W,inDepth:K,inHeight:J,inWidth:Q,outChannels:ee,outDepth:Y,outHeight:ne,outWidth:te,strideDepth:ce,strideHeight:pe,strideWidth:se}=p,fe=B-1-p.padInfo.front,ye=L-1-p.padInfo.top,_e=H-1-p.padInfo.left;for(let Ae=0;Ae<M;++Ae)for(let We=0;We<W;++We)for(let Ze=0;Ze<K;++Ze){let ut=Ze-fe,lt=Math.max(0,Math.ceil(ut/ce)),tt=Math.min(Y,(B+ut)/ce);for(let Ue=0;Ue<J;++Ue){let Ge=Ue-ye,Ie=Math.max(0,Math.ceil(Ge/pe)),cr=Math.min(ne,(L+Ge)/pe);for(let ft=0;ft<Q;++ft){let St=ft-_e,Qt=Math.max(0,Math.ceil(St/se)),Xr=Math.min(te,(H+St)/se),Xt=0;for(let ht=lt;ht<tt;++ht){let Nr=ht*ce-ut;for(let Ft=Ie;Ft<cr;++Ft){let pr=Ft*pe-Ge;for(let Dt=Qt;Dt<Xr;++Dt){let qa=Dt*se-St,Ka=y*Ae+b*ht+k*Ft+N*Dt,Vn=T*(B-1-Nr)+R*(L-1-pr)+$*(H-1-qa)+O*We;for(let wo=0;wo<ee;++wo){let cc=x[Ka+wo],_u=E[Vn+wo];Xt+=cc*_u}}}}d[m*Ae+h*Ze+g*Ue+v*ft+We]=Xt}}}return t.makeTensorInfo(f.shape,f.dtype,f.values)}var _L={kernelName:vm,backendName:"cpu",kernelFunc:ove};var ave=Oe(js,r=>Math.cos(r)),SL={kernelName:js,backendName:"cpu",kernelFunc:ave};var sve=Oe(Hs,r=>Math.cosh(r)),IL={kernelName:Hs,backendName:"cpu",kernelFunc:sve};function ive(r){let{inputs:e,backend:t,attrs:n}=r,{image:o,boxes:a,boxInd:i}=e,{cropSize:s,method:u,extrapolationValue:l}=n,[c,p,f,d]=o.shape,m=a.shape[0],[h,g]=s,v=Me([m,h,g,d],"float32"),x=t.data.get(a.dataId).values,y=t.data.get(i.dataId).values,b=t.data.get(o.dataId).values,k=w.computeStrides(o.shape),N=w.computeStrides(v.shape);for(let E=0;E<m;E++){let T=E*4,R=x[T],$=x[T+1],O=x[T+2],M=x[T+3],B=y[E];if(B>=c)continue;let L=h>1?(O-R)*(p-1)/(h-1):0,H=g>1?(M-$)*(f-1)/(g-1):0;for(let W=0;W<h;W++){let K=h>1?R*(p-1)+W*L:.5*(R+O)*(p-1);if(K<0||K>p-1){for(let J=0;J<g;J++)for(let Q=0;Q<d;Q++){let ee=Q+J*N[2]+W*N[1]+E*N[0];v.values[ee]=l}continue}if(u==="bilinear"){let J=Math.floor(K),Q=Math.ceil(K),ee=K-J;for(let Y=0;Y<g;Y++){let ne=g>1?$*(f-1)+Y*H:.5*($+M)*(f-1);if(ne<0||ne>f-1){for(let se=0;se<d;se++){let fe=se+Y*N[2]+W*N[1]+E*N[0];v.values[fe]=l}continue}let te=Math.floor(ne),ce=Math.ceil(ne),pe=ne-te;for(let se=0;se<d;se++){let fe=se+te*k[2]+J*k[1]+B*k[0],ye=b[fe];fe=se+ce*k[2]+J*k[1]+B*k[0];let _e=b[fe];fe=se+te*k[2]+Q*k[1]+B*k[0];let Ae=b[fe];fe=se+ce*k[2]+Q*k[1]+B*k[0];let We=b[fe],Ze=ye+(_e-ye)*pe,ut=Ae+(We-Ae)*pe;fe=se+Y*N[2]+W*N[1]+E*N[0],v.values[fe]=Ze+(ut-Ze)*ee}}}else for(let J=0;J<g;++J){let Q=g>1?$*(f-1)+J*H:.5*($+M)*(f-1);if(Q<0||Q>f-1){for(let ne=0;ne<d;ne++){let te=ne+J*N[2]+W*N[1]+E*N[0];v.values[te]=l}continue}let ee=Math.round(Q),Y=Math.round(K);for(let ne=0;ne<d;ne++){let te=ne+ee*k[2]+Y*k[1]+B*k[0],ce=ne+J*N[2]+W*N[1]+E*N[0];v.values[ce]=b[te]}}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}var CL={kernelName:Ks,backendName:"cpu",kernelFunc:ive};function uve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,exclusive:i,reverse:s}=n;oe(o,"cumsum");let u=S.getAxesPermutation([a],o.shape.length),l=o;u!=null&&(l=Jt({inputs:{x:o},backend:t,attrs:{perm:u}}));let c=S.getInnerMostAxes(1,o.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);let p=ur(l.dtype,"int32"),f=w.makeZerosTypedArray(w.sizeFromShape(l.shape),p),d=t.data.get(l.dataId).values,m=l.shape[l.shape.length-1],h=s?(v,x)=>v+m-x-1:(v,x)=>v+x;for(let v=0;v<d.length;v+=m)for(let x=0;x<m;x++){let y=h(v,x);if(x===0)f[y]=i?0:d[y];else{let b=h(v,x-1);f[y]=i?d[b]+f[b]:d[y]+f[b]}}let g=t.makeTensorInfo(l.shape,p,f);if(u!=null){let v=S.getUndoAxesPermutation(u),x=Jt({inputs:{x:g},backend:t,attrs:{perm:v}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(l),x}return g}var NL={kernelName:qs,backendName:"cpu",kernelFunc:uve};function lve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,weights:a}=e,{size:i,binaryOutput:s}=n;if(o.shape.length===1){let u=t.data.get(o.dataId).values,l=t.data.get(a.dataId).values,c=Gl(u,l,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,c)}else if(o.shape.length===2){let u=t.bufferSync(o),l=t.bufferSync(a),c=ch(u,l,i,s);return t.makeTensorInfo(c.shape,a.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var EL={kernelName:xm,backendName:"cpu",kernelFunc:lve};function cve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockSize:a,dataFormat:i}=n;w.assert(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);let s=o.shape[0],u=o.shape[1],l=o.shape[2],c=o.shape[3],p=u*a,f=l*a,d=c/(a*a),m=t.data.get(o.dataId).values,h=new Float32Array(s*p*f*d),g=0;for(let v=0;v<s;++v)for(let x=0;x<p;++x){let y=Math.floor(x/a),b=x%a;for(let k=0;k<f;++k){let N=Math.floor(k/a),E=k%a,T=(b*a+E)*d;for(let R=0;R<d;++R){let O=R+T+c*(N+l*(y+u*v));h[g++]=m[O]}}}return t.makeTensorInfo([s,p,f,d],o.dtype,h)}var TL={kernelName:Xs,backendName:"cpu",kernelFunc:cve};function ak(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a}=e,{strides:i,pad:s,dilations:u,dimRoundingMode:l}=n;oe([o,a],"depthwiseConv2DNative");let c=w.computeStrides(o.shape),p=w.computeStrides(a.shape),f=u;f==null&&(f=[1,1]),w.assert(S.eitherStridesOrDilationsAreOne(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);let d=S.computeConv2DInfo(o.shape,a.shape,i,f,s,l,!0),{filterHeight:m,filterWidth:h,dilationHeight:g,dilationWidth:v,padInfo:x}=d,y=x.left,b=x.top,k=d.outChannels/d.inChannels,N=new mt(d.outShape,o.dtype),E=t.data.get(o.dataId).values,T=t.data.get(a.dataId).values,R=N.values;for(let $=0;$<d.batchSize;++$){let O=$*c[0],M=$*N.strides[0];for(let B=0;B<d.outHeight;++B){let L=M+B*N.strides[1],H=B*d.strideHeight-b;for(let W=0;W<m;++W){let K=H+W*g;if(K<0||K>=d.inHeight)continue;let J=W*p[0],Q=O+K*c[1];for(let ee=0;ee<d.outWidth;++ee){let Y=L+ee*N.strides[2],ne=ee*d.strideWidth-y;for(let te=0;te<h;++te){let ce=ne+te*v;if(ce<0||ce>=d.inWidth)continue;let pe=J+te*p[1],se=Q+ce*d.inChannels,fe=Y,ye=pe;for(let _e=0;_e<d.inChannels;++_e){let Ae=E[se+_e];for(let We=0;We<k;++We)R[fe+We]+=Ae*T[ye+We];fe+=k,ye+=k}}}}}}return t.makeTensorInfo(N.shape,N.dtype,N.values)}var AL={kernelName:Ys,backendName:"cpu",kernelFunc:ak};function pve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,dy:a}=e,{strides:i,dilations:s,pad:u,dimRoundingMode:l,filterShape:c}=n;oe([o,a],"depthwiseConv2dNativeBackpropFilter");let p=S.computeConv2DInfo(o.shape,c,i,s,u,l,!0),{strideHeight:f,strideWidth:d,filterHeight:m,filterWidth:h}=p,g=new mt(p.filterShape,"float32"),v=p.padInfo.left,x=p.padInfo.top,y=p.outChannels/p.inChannels,b=t.data.get(o.dataId).values,k=new mt(o.shape,o.dtype,b),N=t.data.get(a.dataId).values,E=new mt(a.shape,a.dtype,N);for(let T=0;T<m;++T){let R=Math.max(0,Math.ceil((x-T)/f)),$=Math.min(p.outHeight,(p.inHeight+x-T)/f);for(let O=0;O<h;++O){let M=Math.max(0,Math.ceil((v-O)/d)),B=Math.min(p.outWidth,(p.inWidth+v-O)/d);for(let L=0;L<p.outChannels;++L){let H=Math.trunc(L/y),W=L%y,K=0;for(let J=0;J<p.batchSize;++J)for(let Q=R;Q<$;++Q){let ee=T+Q*f-x;for(let Y=M;Y<B;++Y){let ne=O+Y*d-v;K+=k.get(J,ee,ne,H)*E.get(J,Q,Y,L)}}g.set(K,T,O,H,W)}}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}var FL={kernelName:ym,backendName:"cpu",kernelFunc:pve};function fve(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,filter:a}=e,{strides:i,dilations:s,pad:u,dimRoundingMode:l,inputShape:c}=n;oe([o,a],"depthwiseConv2DNativeBackpropInput");let p=w.computeStrides(o.shape),f=w.computeStrides(a.shape),d=S.computeConv2DInfo(c,a.shape,i,s,u,l,!0),m=new mt(d.inShape,"float32"),h=m.values,[g,v,x]=m.strides,y=t.data.get(o.dataId).values,[b,k,N]=p,E=t.data.get(a.dataId).values,[T,R,$]=f,{batchSize:O,filterHeight:M,filterWidth:B,inChannels:L,inHeight:H,inWidth:W,outChannels:K,outHeight:J,outWidth:Q,strideHeight:ee,strideWidth:Y}=d,ne=M-1-d.padInfo.top,te=B-1-d.padInfo.left,ce=K/L;for(let pe=0;pe<O;++pe)for(let se=0;se<L;++se)for(let fe=0;fe<H;++fe){let ye=fe-ne,_e=Math.max(0,Math.ceil(ye/ee)),Ae=Math.min(J,(M+ye)/ee);for(let We=0;We<W;++We){let Ze=We-te,ut=Math.max(0,Math.ceil(Ze/Y)),lt=Math.min(Q,(B+Ze)/Y),tt=0;for(let Ue=_e;Ue<Ae;++Ue){let Ge=Ue*ee-ye;for(let Ie=ut;Ie<lt;++Ie){let cr=Ie*Y-Ze,ft=b*pe+k*Ue+N*Ie,St=T*(M-1-Ge)+R*(B-1-cr)+$*se;for(let Qt=0;Qt<ce;++Qt){let Xr=se*ce+Qt,Xt=y[ft+Xr],ht=E[St+Qt];tt+=Xt*ht}}}h[g*pe+v*fe+x*We+se]=tt}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}var DL={kernelName:bm,backendName:"cpu",kernelFunc:fve};function dve(r){let{inputs:e,backend:t}=r,{x:n}=e,o=w.sizeFromShape(n.shape),a=t.data.get(n.dataId).values,i=Me([o,o],n.dtype),s=i.values;for(let l=0;l<a.length;l++)s[l*o+l]=a[l];let u=[...n.shape,...n.shape];return t.makeTensorInfo(u,i.dtype,i.values)}var RL={kernelName:wm,backendName:"cpu",kernelFunc:dve};var $L={kernelName:km,backendName:"cpu",kernelFunc:({inputs:r,backend:e,attrs:t})=>{let{x:n,filter:o}=r,{strides:a,pad:i,dilations:s}=t,u=e,l=u.data.get(n.dataId).values,c=n.shape.length,p=u.data.get(o.dataId).values,f=o.shape.length,{batchSize:d,inHeight:m,inWidth:h,inChannels:g,outHeight:v,outWidth:x,padInfo:y,strideHeight:b,strideWidth:k,filterHeight:N,filterWidth:E,dilationHeight:T,dilationWidth:R,outShape:$}=S.computeDilation2DInfo(n.shape,o.shape,a,i,"NHWC",s),O=w.sizeFromShape($),M=$.length,B=w.getArrayFromDType(n.dtype,O);for(let H=0;H<d;++H)for(let W=0;W<v;++W){let K=W*b-y.top;for(let J=0;J<x;++J){let Q=J*k-y.left;for(let ee=0;ee<g;++ee){let Y=Number.MIN_SAFE_INTEGER;for(let te=0;te<N;++te){let ce=K+te*T;if(ce>=0&&ce<m)for(let pe=0;pe<E;++pe){let se=Q+pe*R;if(se>=0&&se<h){let fe=w.locToIndex([H,ce,se,ee],c,w.computeStrides(n.shape)),ye=w.locToIndex([te,pe,ee],f,w.computeStrides(o.shape)),_e=l[fe]+p[ye];_e>Y&&(Y=_e)}}}let ne=w.locToIndex([H,W,J,ee],M,w.computeStrides($));B[ne]=Y}}}return{dataId:u.write(w.toTypedArray(B,n.dtype),$,n.dtype),shape:$,dtype:n.dtype}}};var PL={kernelName:Sb,backendName:"cpu",kernelFunc:({inputs:r,backend:e,attrs:t})=>{let{x:n,filter:o,dy:a}=r,{strides:i,pad:s,dilations:u}=t,l=e,c=w.toNestedArray(n.shape,l.data.get(n.dataId).values),p=w.toNestedArray(o.shape,l.data.get(o.dataId).values),{batchSize:f,inHeight:d,inWidth:m,inChannels:h,outHeight:g,outWidth:v,padInfo:x,strideHeight:y,strideWidth:b,filterHeight:k,filterWidth:N,dilationHeight:E,dilationWidth:T,outShape:R}=S.computeDilation2DInfo(n.shape,o.shape,i,s,"NHWC",u);w.assert(a.rank===R.length,()=>`Error in ${Sb}, dy must have the same rank as output ${R.length}, but got ${a.rank}`);let $=w.toNestedArray(R,l.data.get(a.dataId).values),O=w.makeZerosNestedTypedArray(o.shape,o.dtype);for(let B=0;B<f;++B)for(let L=0;L<g;++L){let H=L*y-x.top;for(let W=0;W<v;++W){let K=W*b-x.left;for(let J=0;J<h;++J){let Q=Number.MIN_SAFE_INTEGER,ee=0,Y=0;for(let ne=0;ne<k;++ne){let te=H+ne*E;if(te>=0&&te<d)for(let ce=0;ce<N;++ce){let pe=K+ce*T;if(pe>=0&&pe<m){let se=c[B][te][pe][J]+p[ne][ce][J];se>Q&&(Q=se,ee=ne,Y=ce)}}}O[ee][Y][J]+=$[B][L][W][J]}}}return{dataId:l.write(w.toTypedArray(O,n.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};var OL={kernelName:_b,backendName:"cpu",kernelFunc:({inputs:r,backend:e,attrs:t})=>{let{x:n,filter:o,dy:a}=r,{strides:i,pad:s,dilations:u}=t,l=e,c=w.toNestedArray(n.shape,l.data.get(n.dataId).values),p=w.toNestedArray(o.shape,l.data.get(o.dataId).values),{batchSize:f,inHeight:d,inWidth:m,inChannels:h,outHeight:g,outWidth:v,padInfo:x,strideHeight:y,strideWidth:b,filterHeight:k,filterWidth:N,dilationHeight:E,dilationWidth:T,outShape:R}=S.computeDilation2DInfo(n.shape,o.shape,i,s,"NHWC",u);w.assert(a.rank===R.length,()=>`Error in ${_b}, dy must have the same rank as output ${R.length}, but got ${a.rank}`);let $=w.toNestedArray(R,l.data.get(a.dataId).values),O=w.makeZerosNestedTypedArray(n.shape,n.dtype);for(let B=0;B<f;++B)for(let L=0;L<g;++L){let H=L*y-x.top;for(let W=0;W<v;++W){let K=W*b-x.left;for(let J=0;J<h;++J){let Q=Number.MIN_SAFE_INTEGER,ee=H<0?0:H,Y=K<0?0:K;for(let ne=0;ne<k;++ne){let te=H+ne*E;if(te>=0&&te<d)for(let ce=0;ce<N;++ce){let pe=K+ce*T;if(pe>=0&&pe<m){let se=c[B][te][pe][J]+p[ne][ce][J];se>Q&&(Q=se,ee=te,Y=pe)}}}O[B][ee][Y][J]+=$[B][L][W][J]}}}return{dataId:l.write(w.toTypedArray(O,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};function oa(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n;oe(o,"sum");let s;o.dtype==="bool"?s=On({inputs:{x:o},backend:t,attrs:{dtype:"int32"}}):s=Ir({inputs:{x:o},backend:t});let u=s.shape.length,l=w.parseAxisParam(a,s.shape),c=S.getAxesPermutation(l,u),p=l,f=s;c!=null&&(f=Jt({inputs:{x:s},backend:t,attrs:{perm:c}}),p=S.getInnerMostAxes(p.length,u)),S.assertAxesAreInnerMostDims("sum",p,f.shape.length);let[d,m]=S.computeOutAndReduceShapes(f.shape,p),h=S.upcastType(f.dtype,"int32"),g=zl(t,d,h),v=w.sizeFromShape(m),x=t.data.get(g.dataId).values,y=t.data.get(f.dataId).values;for(let b=0;b<x.length;++b){let k=b*v,N=0;for(let E=0;E<v;++E)N+=y[k+E];x[b]=N}if(i){let b=S.expandShapeToKeepDim(g.shape,l),k=g;g=Xe({inputs:{x:g},backend:t,attrs:{shape:b}}),t.disposeIntermediateTensorInfo(k)}return t.disposeIntermediateTensorInfo(s),c!=null&&t.disposeIntermediateTensorInfo(f),g}var ML={kernelName:qo,backendName:"cpu",kernelFunc:oa};function mve(r){let{inputs:e,backend:t,attrs:n}=r,{equation:o}=n,a=e,{allDims:i,summedDims:s,idDims:u}=S.decodeEinsumEquation(o,a.length);S.checkEinsumDimSizes(i.length,u,a);let{path:l,steps:c}=S.getEinsumComputePath(s,u),p=c.length,f=null,d=i.length,m=[];for(let h=0;h<p;++h){for(let g of c[h]){let{permutationIndices:v,expandDims:x}=S.getEinsumPermutation(d,u[g]),y;S.isIdentityPermutation(v)?y=a[g]:(y=Jt({inputs:{x:a[g]},backend:t,attrs:{perm:v}}),m.push(y));let b=y.shape.slice();for(let k=0;k<x.length;++k)b.splice(x[k],0,1);w.arraysEqual(y.shape,b)||(y=Xe({inputs:{x:y},backend:t,attrs:{shape:b}}),m.push(y)),f===null?f=y:(f=su({inputs:{a:y,b:f},backend:t}),m.push(f))}h<p-1&&(l[h]>=0&&(f=oa({inputs:{x:f},backend:t,attrs:{axis:l[h]-(i.length-d),keepDims:!1}}),m.push(f)),d--)}for(let h of m)h!==f&&t.disposeIntermediateTensorInfo(h);return f}var BL={kernelName:_m,backendName:"cpu",kernelFunc:mve};function hve(r){let{inputs:e,backend:t}=r,{dy:n,y:o}=e;oe([n,o],"eluGrad");let a=new Float32Array(w.sizeFromShape(o.shape)),i=t.data.get(o.dataId).values,s=t.data.get(n.dataId).values;for(let u=0;u<i.length;++u){let l=i[u];l>=1?a[u]=s[u]:a[u]=s[u]*(l+1)}return t.makeTensorInfo(o.shape,"float32",a)}var LL={kernelName:Sm,backendName:"cpu",kernelFunc:hve};var gve=S.ERF_P,vve=S.ERF_A1,xve=S.ERF_A2,yve=S.ERF_A3,bve=S.ERF_A4,wve=S.ERF_A5,kve=Oe(_p,r=>{let e=Math.sign(r),t=Math.abs(r),n=1/(1+gve*t);return e*(1-((((wve*n+bve)*n+yve)*n+xve)*n+vve)*n*Math.exp(-t*t))}),VL={kernelName:_p,backendName:"cpu",kernelFunc:kve};function sc(r){let{inputs:e,backend:t,attrs:n}=r,{input:o}=e,{dim:a}=n,i=o.shape.length,s=o.shape.slice(),u=a;return a<0&&(w.assert(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+a+1),s.splice(u,0,1),Xe({inputs:{x:o},backend:t,attrs:{shape:s}})}var WL={kernelName:vl,backendName:"cpu",kernelFunc:sc};var _ve=qe((r,e)=>r/e),uf=Qe(Zs,_ve),lf={kernelName:Zs,backendName:"cpu",kernelFunc:uf};function rg(r,e,t){let n=r.shape,o=n[0],a=n[1],i=t.data.get(r.dataId),s=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,l=[o,a],c=w.sizeFromShape(l),p=w.getTypedArrayFromDType("float32",c),f=w.getTypedArrayFromDType("float32",c);for(let g=0;g<o;g++){let v=Bn({inputs:{x:s},backend:t,attrs:{begin:[g,0],size:[1,a]}}),x=Bn({inputs:{x:u},backend:t,attrs:{begin:[g,0],size:[1,a]}}),y=lr({inputs:{real:v,imag:x},backend:t}),{real:b,imag:k}=Sve(y,e,t),N=S.mergeRealAndImagArrays(b,k);for(let E=0;E<a;E++){let T=S.getComplexWithIndex(N,E);p[g*a+E]=T.real,f[g*a+E]=T.imag}t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y)}let d=t.makeTensorInfo(l,"float32",p),m=t.makeTensorInfo(l,"float32",f),h=lr({inputs:{real:d,imag:m},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),h}function Sve(r,e,t){let n=w.sizeFromShape(r.shape),o=t.data.get(r.dataId),a=t.data.get(o.complexTensorInfos.real.dataId).values,i=t.data.get(o.complexTensorInfos.imag.dataId).values;if(Ive(n)){let s=sk(a,i,n,e,t),u=[r.shape[0],r.shape[1]];if(e){let l=t.makeTensorInfo(u,"float32",s.real),c=t.makeTensorInfo(u,"float32",s.imag),p=t.makeTensorInfo([],"float32",w.createScalarValue(n,"float32")),f=Ir({inputs:{x:p},backend:t}),d=lf.kernelFunc({inputs:{a:l,b:p},backend:t}),m=lf.kernelFunc({inputs:{a:c,b:f},backend:t}),h=t.data.get(d.dataId).values,g=t.data.get(m.dataId).values;return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),{real:h,imag:g}}return s}else{let s=S.mergeRealAndImagArrays(a,i),u=Cve(s,n,e);return S.splitRealAndImagArrays(u)}}function Ive(r){return(r&r-1)==0}function sk(r,e,t,n,o){if(t===1)return{real:r,imag:e};let a=S.mergeRealAndImagArrays(r,e),i=t/2,s=S.complexWithEvenIndex(a),u=s.real,l=s.imag,c=[u.length],p=o.makeTensorInfo(c,"float32",u),f=o.makeTensorInfo(c,"float32",l),d=lr({inputs:{real:p,imag:f},backend:o}),m=S.complexWithOddIndex(a),h=m.real,g=m.imag,v=[h.length],x=o.makeTensorInfo(v,"float32",h),y=o.makeTensorInfo(v,"float32",g),b=lr({inputs:{real:x,imag:y},backend:o}),k=sk(u,l,i,n,o),N=k.real,E=k.imag,T=[N.length],R=o.makeTensorInfo(T,"float32",N),$=o.makeTensorInfo(T,"float32",E),O=lr({inputs:{real:R,imag:$},backend:o}),M=sk(h,g,i,n,o),B=M.real,L=M.imag,H=[B.length],W=o.makeTensorInfo(H,"float32",B),K=o.makeTensorInfo(H,"float32",L),J=lr({inputs:{real:W,imag:K},backend:o}),Q=S.exponents(t,n),ee=[Q.real.length],Y=o.makeTensorInfo(ee,"float32",Q.real),ne=o.makeTensorInfo(ee,"float32",Q.imag),te=lr({inputs:{real:Y,imag:ne},backend:o}),ce=su({inputs:{a:te,b:J},backend:o}),pe=Jo({inputs:{a:O,b:ce},backend:o}),se=Up({inputs:{a:O,b:ce},backend:o}),fe=Pn({inputs:{input:pe},backend:o}),ye=Pn({inputs:{input:se},backend:o}),_e=xo({inputs:{input:pe},backend:o}),Ae=xo({inputs:{input:se},backend:o}),We=Ha({inputs:[fe,ye],backend:o,attrs:{axis:0}}),Ze=Ha({inputs:[_e,Ae],backend:o,attrs:{axis:0}}),ut=o.data.get(We.dataId).values,lt=o.data.get(Ze.dataId).values;return o.disposeIntermediateTensorInfo(p),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(b),o.disposeIntermediateTensorInfo(R),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(O),o.disposeIntermediateTensorInfo(W),o.disposeIntermediateTensorInfo(K),o.disposeIntermediateTensorInfo(J),o.disposeIntermediateTensorInfo(Y),o.disposeIntermediateTensorInfo(ne),o.disposeIntermediateTensorInfo(te),o.disposeIntermediateTensorInfo(ce),o.disposeIntermediateTensorInfo(pe),o.disposeIntermediateTensorInfo(se),o.disposeIntermediateTensorInfo(fe),o.disposeIntermediateTensorInfo(_e),o.disposeIntermediateTensorInfo(ye),o.disposeIntermediateTensorInfo(Ae),o.disposeIntermediateTensorInfo(We),o.disposeIntermediateTensorInfo(Ze),{real:ut,imag:lt}}function Cve(r,e,t){let n=new Float32Array(e*2);for(let o=0;o<e;o++){let a=0,i=0;for(let s=0;s<e;s++){let u=S.exponent(o*s,e,t),l=S.getComplexWithIndex(r,s);a+=l.real*u.real-l.imag*u.imag,i+=l.real*u.imag+l.imag*u.real}t&&(a/=e,i/=e),S.assignToTypedArray(n,a,i,o)}return n}function Nve(r){let{inputs:e,backend:t}=r,{input:n}=e,o=w.sizeFromShape(n.shape),a=n.shape[n.shape.length-1],i=o/a,s=Xe({inputs:{x:n},backend:t,attrs:{shape:[i,a]}}),u=rg(s,!1,t),l=Xe({inputs:{x:u},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(u),l}var zL={kernelName:Im,backendName:"cpu",kernelFunc:Nve};function cf(r){let{backend:e,attrs:t}=r,{shape:n,value:o,dtype:a}=t,i=a||w.inferDtype(o),s=w.getArrayFromDType(i,w.sizeFromShape(n));return Eve(s,o,i),e.makeTensorInfo(n,i,s)}var UL={kernelName:xl,backendName:"cpu",kernelFunc:cf};function Eve(r,e,t){r.fill(e)}var GL={kernelName:ei,backendName:"cpu",kernelFunc:({inputs:r,attrs:e,backend:t})=>{let{image:n}=r,o=t,a=w.getTypedArrayFromDType(n.dtype,w.sizeFromShape(n.shape)),[i,s,u,l]=n.shape,c=o.data.get(n.dataId).values;for(let f=0;f<i;f++){let d=f*u*s*l;for(let m=0;m<s;m++){let h=m*(u*l);for(let g=0;g<u;g++){let v=g*l;for(let x=0;x<l;x++){let y=Math.round(u-g-1),b=d+h+v+x,k=c[b];if(y>=0&&y<u){let N=y*l,E=d+h+N+x;k=c[E]}a[b]=k}}}}return{dataId:o.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};var Tve=qe((r,e)=>Math.floor(r/e)),Ave=Qe(ri,Tve,null,"int32"),jL={kernelName:ri,backendName:"cpu",kernelFunc:Ave};function Fve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a,bias:i,preluActivationWeights:s}=e,{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:f,activation:d,leakyreluAlpha:m}=n,h=ok({inputs:{x:o,filter:a},backend:t,attrs:{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:f}});if(i){let g=h;h=Jo({inputs:{a:h,b:i},backend:t}),t.disposeIntermediateTensorInfo(g)}if(d){let g=h;h=oc(t,h,d,s,m),t.disposeIntermediateTensorInfo(g)}return h}var HL={kernelName:ji,backendName:"cpu",kernelFunc:Fve};function Dve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,filter:a,bias:i,preluActivationWeights:s}=e,{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:f,activation:d,leakyreluAlpha:m}=n,h=ak({inputs:{x:o,filter:a},backend:t,attrs:{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:f}});if(i){let g=h;h=Jo({inputs:{a:h,b:i},backend:t}),t.disposeIntermediateTensorInfo(g)}if(d){let g=h;h=oc(t,h,d,s,m),t.disposeIntermediateTensorInfo(g)}return h}var qL={kernelName:Hi,backendName:"cpu",kernelFunc:Dve};function Rve(r){let{inputs:e,backend:t}=r,{params:n,indices:o}=e,a=w.sizeFromShape(n.shape),i=o.shape,s=i[i.length-1],[u,l,c,p]=S.prepareAndValidate(n,o);if(l===0)return t.makeTensorInfo(u,n.dtype,[]);let f=t.data.get(o.dataId).values,d=t.bufferSync(n),m=ph(f,d,n.dtype,l,s,c,p,n.shape,a);return t.makeTensorInfo(u,n.dtype,m.values)}var KL={kernelName:oi,backendName:"cpu",kernelFunc:Rve};function $ve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,indices:a}=e,{axis:i,batchDims:s}=n;oe([o,a],"gatherV2");let u=w.parseAxisParam(i,o.shape)[0],l=t.data.get(a.dataId).values,c=o.shape[u];for(let b=0;b<l.length;++b){let k=l[b];w.assert(k<=c-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${c-1}]`)}let p=s;s==null&&(p=0);let f=w.sizeFromShape(a.shape),d=S.segment_util.collectGatherOpShapeInfo(o,a,u,p),m=Xe({inputs:{x:o},backend:t,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),h=Xe({inputs:{x:a},backend:t,attrs:{shape:[d.batchSize,f/d.batchSize]}}),g=[d.batchSize,d.outerSize,f/d.batchSize,d.sliceSize],v=t.bufferSync(h),x=t.bufferSync(m),y=fh(x,v,g);return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(h),t.makeTensorInfo(d.outputShape,y.dtype,y.values)}var XL={kernelName:yl,backendName:"cpu",kernelFunc:$ve};function Pve(r){let{inputs:e,backend:t}=r,{input:n}=e,o=w.sizeFromShape(n.shape),a=n.shape[n.shape.length-1],i=o/a,s=Xe({inputs:{x:n},backend:t,attrs:{shape:[i,a]}}),u=rg(s,!0,t),l=Xe({inputs:{x:u},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(u),l}var YL={kernelName:Cm,backendName:"cpu",kernelFunc:Pve};var Ove=Oe(Ip,r=>Number.isFinite(r)?1:0,"bool"),ZL={kernelName:Ip,backendName:"cpu",kernelFunc:Ove};var Mve=Oe(Cp,r=>Math.abs(r)===1/0?1:0,"bool"),JL={kernelName:Cp,backendName:"cpu",kernelFunc:Mve};var Bve=Oe(Np,r=>Number.isNaN(r)?1:0,"bool"),QL={kernelName:Np,backendName:"cpu",kernelFunc:Bve};function Lve(r){let{backend:e,attrs:t}=r,{start:n,stop:o,num:a}=t,i=dh(n,o,a);return e.makeTensorInfo([i.length],"float32",i)}var e4={kernelName:Em,backendName:"cpu",kernelFunc:Lve};var Vve=Oe(Ep,r=>Math.log1p(r)),t4={kernelName:Ep,backendName:"cpu",kernelFunc:Vve};var Wve=qe((r,e)=>r&&e),zve=Qe(ci,Wve,null,"bool"),r4={kernelName:ci,backendName:"cpu",kernelFunc:zve};var Uve=Oe(Tp,r=>r?0:1,"bool"),n4={kernelName:Tp,backendName:"cpu",kernelFunc:Uve};var Gve=qe((r,e)=>r||e),jve=Qe(Ap,Gve,null,"bool"),o4={kernelName:Ap,backendName:"cpu",kernelFunc:jve};function Hve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{depthRadius:a,bias:i,alpha:s,beta:u}=n;oe(o,"LRN");let l=o.shape[3],c=l-1,p=t.data.get(o.dataId).values,f=w.sizeFromShape(o.shape),d=new Float32Array(f);function m(h){let g=h%l,v=h-g+Math.max(0,g-a),x=h-g+Math.min(g+a,c),y=0;for(;v<=x;v++){let b=p[v];y+=b*b}return y}for(let h=0;h<f;h++){let g=m(h),v=p[h]*Math.pow(i+s*g,-u);d[h]=v}return t.makeTensorInfo(o.shape,o.dtype,d)}var a4={kernelName:Tm,backendName:"cpu",kernelFunc:Hve};function qve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,y:a,dy:i}=e,{depthRadius:s,bias:u,alpha:l,beta:c}=n;oe(i,"LRNGrad");let p=w.sizeFromShape(i.shape),f=i.shape[3],d=t.data.get(i.dataId).values,m=t.data.get(o.dataId).values,h=t.data.get(a.dataId).values,g=new Float32Array(p),v=p;for(let x=0;x<v;x++){let y=x%f,b=x-y+Math.max(0,y-s),k=x-y+Math.min(f,y+s+1),N=0;for(let E=b;E<k;E++)N+=Math.pow(m[E],2);N=l*N+u;for(let E=b;E<k;E++){let T=-2*l*c*m[E]*h[x]/N;x===E&&(T+=Math.pow(N,-c)),T*=d[x],g[E]+=T}}return t.makeTensorInfo(i.shape,o.dtype,g)}var s4={kernelName:Am,backendName:"cpu",kernelFunc:qve};function ik(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{reductionIndices:a,keepDims:i}=n,s=t,u=o.shape,l=u.length,c=w.parseAxisParam(a,u),p=c,f=S.getAxesPermutation(p,l),d=s.data.get(o.dataId).values;if(f!=null){let b=new Array(l);for(let k=0;k<b.length;k++)b[k]=u[f[k]];d=jl(d,u,o.dtype,f,b),p=S.getInnerMostAxes(p.length,l),u=b}oe(o,"max"),S.assertAxesAreInnerMostDims("max",p,l);let[m,h]=S.computeOutAndReduceShapes(u,p),g=w.sizeFromShape(h),v=mh(d,g,m,o.dtype),x=s.write(v,m,o.dtype),y=m;return i&&(y=S.expandShapeToKeepDim(m,c)),{dataId:x,shape:y,dtype:o.dtype}}var i4={kernelName:pi,backendName:"cpu",kernelFunc:ik};function Kve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e;oe(o,"maxPool");let{filterSize:a,strides:i,pad:s,dimRoundingMode:u}=n,l=1;w.assert(S.eitherStridesOrDilationsAreOne(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let c=S.computePool2DInfo(o.shape,a,i,l,s,u),p;if(c.filterWidth===1&&c.filterHeight===1&&w.arraysEqual(c.inShape,c.outShape))p=Ir({inputs:{x:o},backend:t});else{let f=t.data.get(o.dataId).values,d=w.computeStrides(o.shape),m=ac(f,o.shape,o.dtype,d,c,"max");p=t.makeTensorInfo(c.outShape,o.dtype,m.values)}return p}var u4={kernelName:di,backendName:"cpu",kernelFunc:Kve};function Xve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{filterSize:a,strides:i,pad:s,dimRoundingMode:u,dataFormat:l}=n;oe(o,"maxPool3d");let c=S.computePool3DInfo(o.shape,a,i,1,s,u,l),p=t.data.get(o.dataId).values,f=tg(p,o.shape,o.dtype,w.computeStrides(o.shape),c,"max");return t.makeTensorInfo(f.shape,"float32",f.values)}var l4={kernelName:Dm,backendName:"cpu",kernelFunc:Xve};function Yve(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a}=e,{filterSize:i,strides:s,pad:u,dimRoundingMode:l}=n;oe([o,a],"maxPool3DGrad");let c=S.computePool3DInfo(a.shape,i,s,1,u,l),p=t.bufferSync(a),f=aL(p,c),d=c.strideDepth,m=c.strideHeight,h=c.strideWidth,g=c.dilationDepth,v=c.dilationHeight,x=c.dilationWidth,y=c.effectiveFilterDepth,b=c.effectiveFilterHeight,k=c.effectiveFilterWidth,N=y-1-c.padInfo.front,E=k-1-c.padInfo.left,T=b-1-c.padInfo.top,R=Me(a.shape,"float32"),$=t.bufferSync(o);for(let O=0;O<c.batchSize;++O)for(let M=0;M<c.inChannels;++M)for(let B=0;B<c.inDepth;++B)for(let L=0;L<c.inHeight;++L)for(let H=0;H<c.inWidth;++H){let W=B-N,K=L-T,J=H-E,Q=0;for(let ee=0;ee<y;ee+=g){let Y=(W+ee)/d;if(!(Y<0||Y>=c.outDepth||Math.floor(Y)!==Y))for(let ne=0;ne<b;ne+=v){let te=(K+ne)/m;if(!(te<0||te>=c.outHeight||Math.floor(te)!==te))for(let ce=0;ce<k;ce+=x){let pe=(J+ce)/h;if(pe<0||pe>=c.outWidth||Math.floor(pe)!==pe)continue;let se=y*b*k-1-f.get(O,Y,te,pe,M),fe=ee*b*k+ne*k+ce,ye=se===fe?1:0;if(ye===0)continue;Q+=$.get(O,Y,te,pe,M)*ye}}}R.set(Q,O,B,L,H,M)}return t.makeTensorInfo(R.shape,R.dtype,R.values)}var c4={kernelName:Rm,backendName:"cpu",kernelFunc:Yve};function Zve(r){let{inputs:e,backend:t,attrs:n}=r,{dy:o,input:a,output:i}=e,s=a;oe([a,i],"maxPoolGrad");let{filterSize:u,strides:l,pad:c,dimRoundingMode:p}=n,f=S.computePool2DInfo(s.shape,u,l,1,c,p),d=t.data.get(s.dataId).values,m=Me(f.outShape,s.dtype,eg(d,s.shape,s.dtype,f).values),h=f.strideHeight,g=f.strideWidth,v=f.dilationHeight,x=f.dilationWidth,y=f.effectiveFilterHeight,b=f.effectiveFilterWidth,k=b-1-f.padInfo.left,N=y-1-f.padInfo.top,E=Me(s.shape,"float32"),T=t.data.get(o.dataId).values,R=Me(o.shape,"float32",T);for(let $=0;$<f.batchSize;++$)for(let O=0;O<f.inChannels;++O)for(let M=0;M<f.inHeight;++M)for(let B=0;B<f.inWidth;++B){let L=M-N,H=B-k,W=0;for(let K=0;K<y;K+=v){let J=(L+K)/h;if(!(J<0||J>=f.outHeight||Math.floor(J)!==J))for(let Q=0;Q<b;Q+=x){let ee=(H+Q)/g;if(ee<0||ee>=f.outWidth||Math.floor(ee)!==ee)continue;let Y=y*b-1-m.get($,J,ee,O),ne=K*b+Q,te=Y===ne?1:0;if(te===0)continue;W+=R.get($,J,ee,O)*te}}E.set(W,$,M,B,O)}return t.makeTensorInfo(E.shape,E.dtype,E.values)}var p4={kernelName:Fm,backendName:"cpu",kernelFunc:Zve};function f4(r,e,t,n,o){let a=w.computeStrides(e),i=ac(r,e,t,a,o,"max"),s=eg(r,e,t,o,!0,n);return[i.values,s.values]}var d4={kernelName:$m,backendName:"cpu",kernelFunc:({inputs:r,attrs:e,backend:t})=>{let{x:n}=r,{filterSize:o,strides:a,pad:i,includeBatchInIndex:s}=e,u=t;oe(n,"MaxPoolWithArgmax");let l=u.data.get(n.dataId).values,c=S.computePool2DInfo(n.shape,o,a,[1,1],i),[p,f]=f4(l,n.shape,n.dtype,s,c),d=u.write(p,c.outShape,n.dtype),m=u.write(f,c.outShape,n.dtype);return[{dataId:d,shape:c.outShape,dtype:n.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};function Jve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n,s=w.parseAxisParam(a,o.shape),l=S.computeOutAndReduceShapes(o.shape,s)[1],c=w.sizeFromShape(l),p=[],f=t.makeTensorInfo([],"float32",new Float32Array([c]));p.push(f);let d=On({inputs:{x:o},backend:t,attrs:{dtype:"float32"}});p.push(d);let m=uf({inputs:{a:d,b:f},backend:t});p.push(m);let h=oa({inputs:{x:m},backend:t,attrs:{axis:a,keepDims:i}});return p.forEach(g=>t.disposeIntermediateTensorInfo(g)),h}var m4={kernelName:mi,backendName:"cpu",kernelFunc:Jve};function Qve(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{axis:a,keepDims:i}=n;oe(o,"min");let s=w.parseAxisParam(a,o.shape),u=s,l=S.getAxesPermutation(u,o.shape.length),c=o;l!=null&&(c=Jt({inputs:{x:o},backend:t,attrs:{perm:l}}),u=S.getInnerMostAxes(u.length,o.shape.length)),S.assertAxesAreInnerMostDims("min",u,c.shape.length);let[p,f]=S.computeOutAndReduceShapes(c.shape,u),d=w.sizeFromShape(f),m=w.makeZerosTypedArray(w.sizeFromShape(p),c.dtype),h=t.data.get(c.dataId).values;for(let v=0;v<m.length;++v){let x=v*d,y=h[x];for(let b=0;b<d;++b){let k=h[x+b];(Number.isNaN(k)||k<y)&&(y=k)}m[v]=y}l!=null&&t.disposeIntermediateTensorInfo(c);let g=t.makeTensorInfo(p,c.dtype,m);if(i){let v=S.expandShapeToKeepDim(p,s),x=Xe({inputs:{x:g},backend:t,attrs:{shape:v}});return t.disposeIntermediateTensorInfo(g),x}return g}var h4={kernelName:hi,backendName:"cpu",kernelFunc:Qve};function exe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{paddings:a,mode:i}=n;oe(o,"mirrorPad");let s=a.map((y,b)=>y[0]+o.shape[b]+y[1]),u=a.map(y=>y[0]),l=a.map((y,b)=>y[0]+o.shape[b]),c=i==="reflect"?0:1,p=t.data.get(o.dataId).values,f=o.shape.length,d=w.computeStrides(o.shape),m=w.sizeFromShape(s),h=s.length,g=w.computeStrides(s),v=w.getTypedArrayFromDType(o.dtype,m);for(let y=0;y<m;y++){let b=w.indexToLoc(y,h,g);for(let N=0;N<h;N++)b[N]<u[N]?b[N]=u[N]*2-b[N]-c:b[N]>=l[N]&&(b[N]=(l[N]-1)*2-b[N]+c);b=b.map((N,E)=>N-u[E]);let k=w.locToIndex(b,f,d);v[y]=p[k]}return{dataId:t.write(v,s,o.dtype),shape:s,dtype:o.dtype}}var g4={kernelName:vi,backendName:"cpu",kernelFunc:exe};var txe=qe((r,e)=>{let t=r%e;return r<0&&e<0||r>=0&&e>=0?t:(t+e)%e}),rxe=Qe(Fp,txe),v4={kernelName:Fp,backendName:"cpu",kernelFunc:rxe};var y4=kc(LA());function uk(r){let{inputs:e,backend:t,attrs:n}=r,{logits:o}=e,{dim:a}=n,i=o.shape.length,s=a;if(s===-1&&(s=i-1),s!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${s}`);let u=w.parseAxisParam([s],o.shape),l=ik({inputs:{x:o},backend:t,attrs:{reductionIndices:u,keepDims:!1}}),c=S.expandShapeToKeepDim(l.shape,u),p=Xe({inputs:{x:l},backend:t,attrs:{shape:c}}),f=Up({inputs:{a:o,b:p},backend:t}),d=_0({inputs:{x:f},backend:t}),m=oa({inputs:{x:d},backend:t,attrs:{axis:u,keepDims:!1}}),h=Xe({inputs:{x:m},backend:t,attrs:{shape:c}}),g=uf({inputs:{a:d,b:h},backend:t});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(h),g}var x4={kernelName:Ri,backendName:"cpu",kernelFunc:uk};function nxe(r){let{inputs:e,backend:t,attrs:n}=r,{logits:o}=e,{numSamples:a,seed:i,normalized:s}=n;oe(o,"multinomial");let u=s?o:uk({inputs:{logits:o},backend:t,attrs:{dim:-1}}),l=u.shape[0],c=u.shape[1],p=t.data.get(u.dataId).values,f=[l,a],d=w.makeZerosTypedArray(w.sizeFromShape(f),"int32");for(let m=0;m<l;++m){let h=m*c,g=new Float32Array(c-1);g[0]=p[h];for(let y=1;y<g.length;++y)g[y]=g[y-1]+p[h+y];let v=y4.alea(i.toString()),x=m*a;for(let y=0;y<a;++y){let b=v();d[x+y]=g.length;for(let k=0;k<g.length;k++)if(b<g[k]){d[x+y]=k;break}}}return s||t.disposeIntermediateTensorInfo(u),t.makeTensorInfo(f,"int32",d)}var b4={kernelName:Pm,backendName:"cpu",kernelFunc:nxe};var oxe=Sr.nonMaxSuppressionV3Impl;function axe(r){let{inputs:e,backend:t,attrs:n}=r,{boxes:o,scores:a}=e,{maxOutputSize:i,iouThreshold:s,scoreThreshold:u}=n;oe(o,"NonMaxSuppression");let l=t.data.get(o.dataId).values,c=t.data.get(a.dataId).values,{selectedIndices:p}=oxe(l,c,i,s,u);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}var w4={kernelName:yi,backendName:"cpu",kernelFunc:axe};var sxe=Sr.nonMaxSuppressionV4Impl;function ixe(r){let{inputs:e,backend:t,attrs:n}=r,{boxes:o,scores:a}=e,{maxOutputSize:i,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:l}=n;oe(o,"NonMaxSuppressionPadded");let c=t.data.get(o.dataId).values,p=t.data.get(a.dataId).values,{selectedIndices:f,validOutputs:d}=sxe(c,p,i,s,u,l);return[t.makeTensorInfo([f.length],"int32",new Int32Array(f)),t.makeTensorInfo([],"int32",new Int32Array([d]))]}var k4={kernelName:bi,backendName:"cpu",kernelFunc:ixe};var uxe=Sr.nonMaxSuppressionV5Impl;function lxe(r){let{inputs:e,backend:t,attrs:n}=r,{boxes:o,scores:a}=e,{maxOutputSize:i,iouThreshold:s,scoreThreshold:u,softNmsSigma:l}=n;oe(o,"NonMaxSuppressionWithScore");let c=t.data.get(o.dataId).values,p=t.data.get(a.dataId).values,f=i,d=s,m=u,h=l,{selectedIndices:g,selectedScores:v}=uxe(c,p,f,d,m,h);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([v.length],"float32",new Float32Array(v))]}var _4={kernelName:wi,backendName:"cpu",kernelFunc:lxe};function cxe(r){let{inputs:e,backend:t,attrs:n}=r,{indices:o}=e,{depth:a,onValue:i,offValue:s}=n;oe(o,"oneHot");let u=w.sizeFromShape(o.shape),l=new Float32Array(u*a);l.fill(s);let c=t.data.get(o.dataId).values;for(let p=0;p<u;++p)c[p]>=0&&c[p]<a&&(l[p*a+c[p]]=i);return t.makeTensorInfo([...o.shape,a],"int32",l)}var S4={kernelName:ki,backendName:"cpu",kernelFunc:cxe};function pf(r){let{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){let o=Pn({inputs:{input:n},backend:t}),a=pf({inputs:{x:o},backend:t}),i=xo({inputs:{input:n},backend:t}),s=pf({inputs:{x:i},backend:t}),u=lr({inputs:{real:a,imag:s},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(s),u}else return cf({backend:t,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}var I4={kernelName:Al,backendName:"cpu",kernelFunc:pf};function C4(r){let{inputs:e,backend:t}=r,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){let o=Pn({inputs:{input:n},backend:t}),a=C4({inputs:{x:o},backend:t}),i=xo({inputs:{input:n},backend:t}),s=pf({inputs:{x:i},backend:t}),u=lr({inputs:{real:a,imag:s},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(s),u}else return cf({backend:t,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}var N4={kernelName:wl,backendName:"cpu",kernelFunc:C4};function lk(r){let{inputs:e,backend:t,attrs:n}=r,{axis:o}=n;if(e.length===1)return sc({inputs:{input:e[0]},backend:t,attrs:{dim:o}});let a=e[0].shape,i=e[0].dtype;e.forEach(c=>{w.assertShapesMatch(a,c.shape,"All tensors passed to stack must have matching shapes"),w.assert(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let s=[],u=e.map(c=>{let p=sc({inputs:{input:c},backend:t,attrs:{dim:o}});return s.push(p),p}),l=Ha({inputs:u,backend:t,attrs:{axis:o}});return s.forEach(c=>t.disposeIntermediateTensorInfo(c)),l}var E4={kernelName:kl,backendName:"cpu",kernelFunc:lk};function pxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{paddings:a,constantValue:i}=n;oe(o,"pad");let s=a.map((x,y)=>x[0]+o.shape[y]+x[1]),u=a.map(x=>x[0]),l=t.data.get(o.dataId).values,c=w.sizeFromShape(o.shape),p=o.shape.length,f=w.computeStrides(o.shape),d=w.sizeFromShape(s),m=s.length,h=w.computeStrides(s),g=w.getTypedArrayFromDType(o.dtype,d);i!==0&&g.fill(i);for(let x=0;x<c;x++){let b=w.indexToLoc(x,p,f).map((N,E)=>N+u[E]),k=w.locToIndex(b,m,h);g[k]=l[x]}return{dataId:t.write(g,s,o.dtype),shape:s,dtype:o.dtype}}var ng={kernelName:_i,backendName:"cpu",kernelFunc:pxe};var fxe=qe((r,e)=>Math.pow(r,e)),dxe=Qe(Si,fxe),T4={kernelName:Si,backendName:"cpu",kernelFunc:dxe};function mxe(r){let{backend:e,attrs:t}=r,{start:n,stop:o,dtype:a,step:i}=t,s=iu(n,o,i,a);return e.makeTensorInfo([s.length],a,s)}var A4={kernelName:_l,backendName:"cpu",kernelFunc:mxe};var hxe=Oe(Dp,r=>1/r),F4={kernelName:Dp,backendName:"cpu",kernelFunc:hxe};function gxe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o}=e,{alignCorners:a,halfPixelCenters:i,size:s}=n;oe(o,"resizeBilinear");let u=w.computeStrides(o.shape),[l,c]=s,[p,f,d,m]=o.shape,h=t.data.get(o.dataId).values,g=new Float32Array(w.sizeFromShape([p,l,c,m])),v=[a&&l>1?f-1:f,a&&c>1?d-1:d],x=[a&&l>1?l-1:l,a&&c>1?c-1:c],y=0,b=v[0]/x[0],k=v[1]/x[1];for(let N=0;N<p;N++)for(let E=0;E<l;E++){let T;i?T=b*(E+.5)-.5:T=b*E;let R=Math.max(0,Math.floor(T)),$=T-R,O=Math.min(f-1,Math.ceil(T)),M=N*u[0]+R*u[1],B=N*u[0]+O*u[1];for(let L=0;L<c;L++){let H;i?H=k*(L+.5)-.5:H=k*L;let W=Math.max(0,Math.floor(H)),K=H-W,J=Math.min(d-1,Math.ceil(H)),Q=M+W*u[2],ee=B+W*u[2],Y=M+J*u[2],ne=B+J*u[2];for(let te=0;te<m;te++){let ce=h[Q+te],pe=h[ee+te],se=h[Y+te],fe=h[ne+te],ye=ce+(se-ce)*K,_e=pe+(fe-pe)*K,Ae=ye+(_e-ye)*$;g[y++]=Ae}}}return t.makeTensorInfo([p,l,c,m],"float32",g)}var D4={kernelName:Ci,backendName:"cpu",kernelFunc:gxe};function vxe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o,dy:a}=e,{alignCorners:i}=n;oe([a,o],"resizeBilinearGrad");let s=w.computeStrides(o.shape),[u,l,c,p]=o.shape,[,f,d]=a.shape,m=new Float32Array(u*l*c*p),h=[i&&f>1?l-1:l,i&&d>1?c-1:c],g=[i&&f>1?f-1:f,i&&d>1?d-1:d],v=h[0]/g[0],x=h[1]/g[1],y=t.data.get(a.dataId).values,b=0;for(let k=0;k<u;k++){let N=k*s[0];for(let E=0;E<f;E++){let T=E*v,R=Math.floor(T),$=Math.min(Math.ceil(T),l-1),O=N+R*s[1],M=N+$*s[1],B=T-R,L=1-B;for(let H=0;H<d;H++){let W=H*x,K=Math.floor(W),J=Math.min(Math.ceil(W),c-1),Q=W-K,ee=1-Q,Y=O+K*s[2],ne=O+J*s[2],te=M+K*s[2],ce=M+J*s[2],pe=L*ee,se=L*Q,fe=B*ee,ye=B*Q;for(let _e=0;_e<p;_e++){let Ae=y[b++];m[Y+_e]+=Ae*pe,m[ne+_e]+=Ae*se,m[te+_e]+=Ae*fe,m[ce+_e]+=Ae*ye}}}}return t.makeTensorInfo([u,c,l,p],"float32",m)}var R4={kernelName:Lm,backendName:"cpu",kernelFunc:vxe};function xxe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o}=e,{alignCorners:a,halfPixelCenters:i,size:s}=n;oe(o,"resizeNearestNeighbor");let u=w.computeStrides(o.shape),[l,c]=s,[p,f,d,m]=o.shape,h=t.data.get(o.dataId).values,g=new Float32Array(p*l*c*m),v=[a&&l>1?f-1:f,a&&c>1?d-1:d],x=[a&&l>1?l-1:l,a&&c>1?c-1:c],y=v[0]/x[0],b=v[1]/x[1],k=0;for(let N=0;N<p;N++){let E=N*u[0];for(let T=0;T<l;T++){let R=i?y*(T+.5):y*T,$=Math.min(f-1,a?Math.round(R):Math.floor(R));i&&($=Math.max(0,$));let O=E+$*u[1];for(let M=0;M<c;M++){let B=i?b*(M+.5):b*M,L=Math.min(d-1,a?Math.round(B):Math.floor(B));i&&(L=Math.max(0,L));let H=O+L*u[2];for(let W=0;W<m;W++){let K=h[H+W];g[k++]=K}}}}return t.makeTensorInfo([p,l,c,m],o.dtype,g)}var $4={kernelName:Mm,backendName:"cpu",kernelFunc:xxe};function yxe(r){let{inputs:e,backend:t,attrs:n}=r,{images:o,dy:a}=e,{alignCorners:i}=n;oe([a,o],"resizeNearestNeighborGrad");let s=w.computeStrides(o.shape),u=w.computeStrides(a.shape),[l,c,p,f]=o.shape,[,d,m]=a.shape,h=new Float32Array(l*c*p*f),g=t.data.get(a.dataId).values,v=[i&&d>1?c-1:c,i&&m>1?p-1:p],x=[i&&d>1?d-1:d,i&&m>1?m-1:m],y=v[0]/x[0],b=v[1]/x[1],k=1/y,N=1/b,E=Math.ceil(k)*2+2,T=Math.ceil(N)*2+2;for(let R=0;R<l;R++){let $=R*s[0];for(let O=0;O<c;O++){let M=$+O*s[1],B=Math.floor(O*k),L=Math.floor(B-E/2);for(let H=0;H<p;H++){let W=M+H*s[2],K=Math.floor(H*N),J=Math.floor(K-T/2);for(let Q=0;Q<f;Q++){let ee=0;for(let Y=0;Y<E;Y++){let ne=Y+L;if(ne<0||ne>=d)continue;let te=$+ne*u[1],ce=ne*y,pe=Math.min(c-1,i?Math.round(ce):Math.floor(ce));if(O===pe)for(let se=0;se<T;se++){let fe=se+J;if(fe<0||fe>=m)continue;let ye=te+fe*u[2],_e=fe*b,Ae=Math.min(p-1,i?Math.round(_e):Math.floor(_e));H===Ae&&(ee+=g[ye+Q])}}h[W+Q]=ee}}}}return t.makeTensorInfo(o.shape,o.dtype,h)}var P4={kernelName:Bm,backendName:"cpu",kernelFunc:yxe};function bxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{dims:a}=n;oe(o,"reverse");let i=o.shape.length,s=w.parseAxisParam(a,o.shape);if(i===0)return Ir({inputs:{x:o},backend:t});let u=new mt(o.shape,o.dtype),l=t.bufferSync(o);for(let c=0;c<u.size;c++){let p=u.indexToLoc(c),f=p.slice();s.forEach(d=>f[d]=o.shape[d]-1-f[d]),u.set(l.get(...f),...p)}return t.makeTensorInfo(u.shape,u.dtype,u.values)}var O4={kernelName:Ni,backendName:"cpu",kernelFunc:bxe};var M4={kernelName:Ui,backendName:"cpu",kernelFunc:({inputs:r,attrs:e,backend:t})=>{let{image:n}=r,{radians:o,fillValue:a,center:i}=e,s=t,u=w.getTypedArrayFromDType(n.dtype,w.sizeFromShape(n.shape)),[l,c,p,f]=n.shape,[d,m]=S.getImageCenter(i,c,p),h=255,g=Math.sin(o),v=Math.cos(o),x=s.data.get(n.dataId).values;for(let b=0;b<l;b++){let k=b*p*c*f;for(let N=0;N<c;N++){let E=N*(p*f);for(let T=0;T<p;T++){let R=T*f;for(let $=0;$<f;$++){let O=[l,N,T,$],M=O[2],B=O[1],L=(M-d)*v-(B-m)*g,H=(M-d)*g+(B-m)*v;L=Math.round(L+d),H=Math.round(H+m);let W=a;if(typeof a!="number"&&($===3?W=h:W=a[$]),L>=0&&L<p&&H>=0&&H<c){let J=H*(p*f),Q=L*f,ee=k+J+Q+$;W=x[ee]}let K=k+E+R+$;u[K]=W}}}}return{dataId:s.write(u,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};var wxe=Oe(Ei,r=>{let e=Math.floor(r);return r-e<.5?Math.floor(r):r-e>.5?Math.ceil(r):e%2==0?e:e+1}),B4={kernelName:Ei,backendName:"cpu",kernelFunc:wxe};function og(r,e,t,n,o,a,i,s,u,l){let c=[n/o,o],p=r.values,f=e.values;if(n===0)return Me(t,e.dtype);let d=Me(c,e.dtype);d.values.fill(u);for(let m=0;m<a;m++){let h=[],g=0;for(let v=0;v<i;v++){let x=p[m*i+v];h.push(x),g+=x*s[v]}if(g<0||g>=n/o)throw new Error(`Invalid indices: ${h} does not index into ${t}`);for(let v=0;v<o;v++)l?d.values[g*o+v]+=f[m*o+v]:d.values[g*o+v]=e.rank===0?f[0]:f[m*o+v]}return d}function kxe(r){let{inputs:e,backend:t,attrs:n}=r,{indices:o,updates:a}=e,{shape:i}=n,{sliceRank:s,numUpdates:u,sliceSize:l,strides:c,outputSize:p}=S.calculateShapes(a,o,i),f=!0,d=t.bufferSync(o),m=t.bufferSync(a),h=og(d,m,i,p,l,u,s,c,0,f);return t.makeTensorInfo(i,h.dtype,h.values)}var L4={kernelName:Ai,backendName:"cpu",kernelFunc:kxe};function _xe(r){let{inputs:e,backend:t}=r,{condition:n,t:o,e:a}=e;oe([n,o,a],"select");let i=n.shape.length,s=t.data.get(n.dataId).values,u=t.data.get(o.dataId).values,l=t.data.get(a.dataId).values,c=ur(o.dtype,a.dtype),p=w.makeZerosTypedArray(w.sizeFromShape(o.shape),c),f=0,d=i===0||i>1||o.shape.length===1?1:w.sizeFromShape(o.shape.slice(1));for(let m=0;m<s.length;m++)for(let h=0;h<d;h++)s[m]===1?p[f++]=u[m]:p[f++]=l[m];return t.makeTensorInfo(o.shape,c,p)}var V4={kernelName:Sl,backendName:"cpu",kernelFunc:_xe};var Sxe=S.SELU_SCALEALPHA,Ixe=S.SELU_SCALE,Cxe=Oe(Rp,r=>r>=0?Ixe*r:Sxe*(Math.exp(r)-1)),W4={kernelName:Rp,backendName:"cpu",kernelFunc:Cxe};var Nxe=Oe(Pp,r=>r<0?-1:r>0?1:0),z4={kernelName:Pp,backendName:"cpu",kernelFunc:Nxe};var Exe=Oe(Fi,r=>Math.sin(r)),U4={kernelName:Fi,backendName:"cpu",kernelFunc:Exe};var Txe=Oe($p,r=>Math.sinh(r)),G4={kernelName:$p,backendName:"cpu",kernelFunc:Txe};var Axe=11920928955078125e-23,j4=Math.log(Axe)+2,Fxe=Oe(Op,r=>{let e=r>-j4,t=r<j4,n=Math.exp(r),o;return t?o=n:e?o=r:o=Math.log(1+n),o}),H4={kernelName:Op,backendName:"cpu",kernelFunc:Fxe};function Dxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{blockShape:a,paddings:i}=n;oe([o],"spaceToBatchND");let s=w.sizeFromShape(a),u=[[0,0]];u.push(...i);for(let N=1+a.length;N<o.shape.length;++N)u.push([0,0]);let l=ng.kernelFunc({inputs:{x:o},backend:t,attrs:{paddings:u,constantValue:0}}),c=S.getReshaped(l.shape,a,s,!1),p=S.getPermuted(c.length,a.length,!1),f=S.getReshapedPermuted(l.shape,a,s,!1),h=Xe({inputs:{x:l},backend:t,attrs:{shape:c}}),x=Jt({inputs:{x:h},backend:t,attrs:{perm:p}}),k=Xe({inputs:{x},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(x),k}var q4={kernelName:Cl,backendName:"cpu",kernelFunc:Dxe};function Rxe(r){let{inputs:e,backend:t}=r,{indices:n,values:o,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${n.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let s=t.data.get(n.dataId).values,u=t.data.get(o.dataId).values,l=t.data.get(a.dataId).values,c=t.data.get(i.dataId).values[0],[p,f,d,m,h]=hh(s,n.shape,n.dtype,u,o.dtype,l,c);return[t.makeTensorInfo(f,n.dtype,p),t.makeTensorInfo([f[0]],o.dtype,d),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(g=>Number(g)))),t.makeTensorInfo([h.length],n.dtype,new Int32Array(h))]}var K4={kernelName:Vm,backendName:"cpu",kernelFunc:Rxe};function $xe(r){let{inputs:e,backend:t}=r,{inputIndices:n,inputShape:o,newShape:a}=e;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${n.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);let i=Array.from(t.data.get(o.dataId).values),s=t.data.get(n.dataId).values,u=Array.from(t.data.get(a.dataId).values),[l,c,p]=gh(s,n.shape,n.dtype,i,u);return[t.makeTensorInfo(c,n.dtype,l),t.makeTensorInfo([p.length],a.dtype,new Int32Array(p))]}var X4={kernelName:Wm,backendName:"cpu",kernelFunc:$xe};function Pxe(r){let{inputs:e,backend:t}=r,{data:n,indices:o,segmentIds:a}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);let i=t.data.get(n.dataId).values,s=t.data.get(o.dataId).values,u=t.data.get(a.dataId).values,[l,c]=Hl(i,n.shape,n.dtype,s,u,!0);return t.makeTensorInfo(c,n.dtype,l)}var Y4={kernelName:zm,backendName:"cpu",kernelFunc:Pxe};function Oxe(r){let{inputs:e,backend:t}=r,{data:n,indices:o,segmentIds:a}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);let i=t.data.get(n.dataId).values,s=t.data.get(o.dataId).values,u=t.data.get(a.dataId).values,[l,c]=Hl(i,n.shape,n.dtype,s,u);return t.makeTensorInfo(c,n.dtype,l)}var Z4={kernelName:Um,backendName:"cpu",kernelFunc:Oxe};function Mxe(r){let{inputs:e,backend:t,attrs:n}=r,{sparseIndices:o,sparseValues:a,defaultValue:i}=e,{outputShape:s}=n,{sliceRank:u,numUpdates:l,sliceSize:c,strides:p,outputSize:f}=S.calculateShapes(a,o,s),d=!1,m=t.bufferSync(o),h=t.bufferSync(a),g=t.data.get(i.dataId).values[0],v=og(m,h,s,f,c,l,u,p,g,d);return t.makeTensorInfo(s,v.dtype,v.values)}var J4={kernelName:Gm,backendName:"cpu",kernelFunc:Mxe};function Bxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{numOrSizeSplits:a,axis:i}=n,s=w.parseAxisParam(i,o.shape)[0],u=S.prepareSplitSize(o,a,s),l=new Array(o.shape.length).fill(0),c=o.shape.slice();return u.map(p=>{let f=[...c];f[s]=p;let d=Bn({inputs:{x:o},backend:t,attrs:{begin:l,size:f}});return l[s]+=p,d})}var Q4={kernelName:Nl,backendName:"cpu",kernelFunc:Bxe};var eV={kernelName:El,backendName:"cpu",kernelFunc:({inputs:r,backend:e})=>{let{x:t}=r,n=e;oe(t,"square");let o=n.data.get(t.dataId).values,a=new Float32Array(o.length);for(let s=0;s<o.length;++s){let u=o[s];a[s]=u*u}return{dataId:n.write(a,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};var Lxe=Oe(co,(r,e)=>{let t=e;return isNaN(r)?NaN:r>0?1:t.alpha}),tV={kernelName:co,backendName:"cpu",kernelFunc:Lxe};function Vxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{begin:a,end:i,strides:s,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:f}=n;oe(o,"stridedSlice");let{finalShapeSparse:d,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:v,begin:x,end:y,strides:b}=Tt.sliceInfo(o.shape,a,i,s,u,l,c,p,f),k;if(h)k=Xe({inputs:{x:o},backend:t,attrs:{shape:m}});else if(g||v){w.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let N=Tt.computeOutShape(x,y,b),E=Bn({inputs:{x:o},backend:t,attrs:{begin:x,size:N}});k=Xe({inputs:{x:E},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(E)}else{let N=t.bufferSync(o),E=vh(d,N,b,x);k=t.makeTensorInfo(m,E.dtype,E.values)}return k}var rV={kernelName:Pi,backendName:"cpu",kernelFunc:Vxe};function Wxe(r){let{inputs:e,backend:t,attrs:n}=r,{separator:o,nGramWidths:a,leftPad:i,rightPad:s,padWidth:u,preserveShortSequences:l}=n,{data:c,dataSplits:p}=e,f=t.data.get(c.dataId).values,d=t.data.get(p.dataId).values,[m,h]=xh(f,d,o,a,i,s,u,l);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(p.shape,"int32",h)]}var nV={kernelName:jm,backendName:"cpu",kernelFunc:Wxe};function zxe(r){let{inputs:e,backend:t,attrs:n}=r,{skipEmpty:o}=n,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let s=t.data.get(a.dataId).values,u=t.data.get(i.dataId).values[0],[l,c,p]=yh(s,u,o),f=c.length;return[t.makeTensorInfo([f,2],"int32",l),t.makeTensorInfo([f],"string",c),t.makeTensorInfo([2],"int32",new Int32Array(p))]}var oV={kernelName:Hm,backendName:"cpu",kernelFunc:zxe};function Uxe(r){let{inputs:e,backend:t,attrs:n}=r,{numBuckets:o}=n,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");let i=t.data.get(a.dataId).values,s=bh(i,o);return t.makeTensorInfo(a.shape,"int32",s)}var aV={kernelName:qm,backendName:"cpu",kernelFunc:Uxe};var Gxe=Oe(Mi,r=>Math.tan(r)),sV={kernelName:Mi,backendName:"cpu",kernelFunc:Gxe};var jxe=Oe(Bi,r=>Math.tanh(r)),iV={kernelName:Bi,backendName:"cpu",kernelFunc:jxe};function Hxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{reps:a}=n;oe(o,"tile");let i=wh(t.bufferSync(o),a);return t.makeTensorInfo(i.shape,i.dtype,i.values)}var uV={kernelName:Li,backendName:"cpu",kernelFunc:Hxe};function qxe(r){let{inputs:e,backend:t,attrs:n}=r,{x:o}=e,{k:a,sorted:i}=n;oe(o,"topk");let s=t.data.get(o.dataId).values,[u,l]=kh(s,o.shape,o.dtype,a,i);return[t.makeTensorInfo(u.shape,u.dtype,u.values),t.makeTensorInfo(l.shape,l.dtype,l.values)]}var lV={kernelName:Vi,backendName:"cpu",kernelFunc:qxe};function Kxe(r){let{inputs:e,attrs:t,backend:n}=r,{image:o,transforms:a}=e,{interpolation:i,fillMode:s,fillValue:u,outputShape:l}=t,[c,p,f,d]=o.shape,[m,h]=l!=null?l:[p,f],g=[c,m,h,d],v=w.computeStrides(o.shape),x=v[0],y=v[1],b=v[2],k=w.getTypedArrayFromDType(o.dtype,w.sizeFromShape(g));k.fill(u);let N=n.data.get(o.dataId).values,E=n.data.get(a.dataId).values;for(let R=0;R<c;++R){let $=a.shape[0]===1?E:E.subarray(R*8,R*8+8);for(let O=0;O<m;++O)for(let M=0;M<h;++M)for(let B=0;B<d;++B){let L,H=$[6]*M+$[7]*O+1;if(H===0)continue;let W=($[0]*M+$[1]*O+$[2])/H,K=($[3]*M+$[4]*O+$[5])/H,J=pV(W,f,s),Q=pV(K,p,s);switch(i){case"nearest":L=Qxe(N,p,f,x,y,b,R,Q,J,B,u);break;case"bilinear":L=eye(N,p,f,x,y,b,R,Q,J,B,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}let ee=R*x+O*y+M*b+B;k[ee]=L}return n.makeTensorInfo(g,o.dtype,k)}return{dataId:n.write(k,g,o.dtype),shape:o.shape,dtype:o.dtype}}var cV={kernelName:Wi,backendName:"cpu",kernelFunc:Kxe};function pV(r,e,t){switch(t){case"reflect":return Xxe(r,e);case"wrap":return Yxe(r,e);case"nearest":return Jxe(r,e);case"constant":default:return Zxe(r,e)}}function Xxe(r,e){let t=r;if(t<0)if(e<=1)t=0;else{let n=2*e;t<n&&(t=n*Math.trunc(-t/n)+t),t=t<-e?t+n:-t-1}else if(t>e-1)if(e<=1)t=0;else{let n=2*e;t-=n*Math.trunc(t/n),t>=e&&(t=n-t-1)}return w.clamp(0,t,e-1)}function Yxe(r,e){let t=r;if(t<0)if(e<=1)t=0;else{let n=e-1;t+=e*(Math.trunc(-t/n)+1)}else if(t>e-1)if(e<=1)t=0;else{let n=e-1;t-=e*Math.trunc(t/n)}return w.clamp(0,t,e-1)}function Zxe(r,e){return r}function Jxe(r,e){return w.clamp(0,r,e-1)}function ff(r,e,t,n,o,a,i,s,u,l,c){let p=i*n+s*o+u*a+l;return 0<=s&&s<e&&0<=u&&u<t?r[p]:c}function Qxe(r,e,t,n,o,a,i,s,u,l,c){let p=Math.round(s),f=Math.round(u);return ff(r,e,t,n,o,a,i,p,f,l,c)}function eye(r,e,t,n,o,a,i,s,u,l,c){let p=Math.floor(s),f=Math.floor(u),d=p+1,m=f+1,h=(m-u)*ff(r,e,t,n,o,a,i,p,f,l,c)+(u-f)*ff(r,e,t,n,o,a,i,p,m,l,c),g=(m-u)*ff(r,e,t,n,o,a,i,d,f,l,c)+(u-f)*ff(r,e,t,n,o,a,i,d,m,l,c);return(d-s)*h+(s-p)*g}function tye(r){let{inputs:e,attrs:t,backend:n}=r,{axis:o}=t,{x:a}=e;oe(a,"unique");let i=n.data.get(a.dataId).values,{outputValues:s,outputShape:u,indices:l}=_h(i,o,a.shape,a.dtype);return[n.makeTensorInfo(u,a.dtype,s),n.makeTensorInfo([l.length],"int32",l)]}var fV={kernelName:Km,backendName:"cpu",kernelFunc:tye};function rye(r){let{inputs:e,backend:t,attrs:n}=r,{value:o}=e,{axis:a}=n;a<0&&(a+=o.shape.length);let i=o.shape.length,s=o.shape[a],u=new Array(i-1),l=0;for(let d=0;d<i;d++)d!==a&&(u[l++]=o.shape[d]);let c=new Array(i).fill(0),p=o.shape.slice();p[a]=1;let f=new Array(s);for(let d=0;d<f.length;d++){c[a]=d;let m=Bn({inputs:{x:o},backend:t,attrs:{begin:c,size:p}});f[d]=Xe({inputs:{x:m},backend:t,attrs:{shape:u}}),t.disposeIntermediateTensorInfo(m)}return f}var dV={kernelName:Tl,backendName:"cpu",kernelFunc:rye};function nye(r){let{inputs:e,backend:t,attrs:n}=r,{x:o,segmentIds:a}=e,{numSegments:i}=n;oe(o,"unsortedSegmentSum");let s=o.shape.length,u=a.shape.length,l=[],c=[],p=s-u,f=a;for(let m=0;m<p;++m){let h=sc({inputs:{input:f},backend:t,attrs:{dim:m+1}});f=h,c.push(h)}for(let m=0;m<i;++m){let h=w.createScalarValue(m,"int32"),g=t.makeTensorInfo([],"int32",h),v=w0({inputs:{a:g,b:f},backend:t}),x=On({inputs:{x:v},backend:t,attrs:{dtype:"float32"}}),y=su({inputs:{a:x,b:o},backend:t}),b=oa({inputs:{x:y},backend:t,attrs:{axis:0,keepDims:!1}});l.push(b),c.push(g),c.push(v),c.push(x),c.push(y),c.push(b)}let d=lk({inputs:l,backend:t,attrs:{axis:0}});return c.forEach(m=>t.disposeIntermediateTensorInfo(m)),d}var mV={kernelName:Xm,backendName:"cpu",kernelFunc:nye};var oye=[HB,vF,qB,KB,kF,XB,YB,ZB,JB,QB,eL,tL,rL,nL,oL,sL,iL,uL,lL,jB,cL,pL,fL,dL,wF,_F,mL,xF,hL,vL,yL,bL,xL,kL,_L,wL,SL,IL,CL,NL,EL,TL,AL,FL,DL,RL,$L,OL,PL,lf,BL,LB,LL,SF,VL,IF,WL,CF,zL,UL,GL,NF,jL,HL,qL,KL,XL,EF,TF,yF,YL,gL,ZL,JL,QL,VB,AF,FF,e4,DF,t4,r4,n4,o4,a4,s4,RF,u4,l4,c4,p4,d4,i4,m4,h4,$F,g4,v4,b4,PF,OF,w4,k4,_4,MF,S4,N4,E4,ng,T4,WB,LF,A4,bF,F4,zB,UB,GB,D4,R4,$4,P4,O4,M4,B4,VF,L4,V4,W4,zF,z4,U4,G4,UF,x4,H4,q4,K4,X4,Y4,Z4,J4,Q4,jF,eV,HF,tV,rV,nV,oV,aV,KF,ML,sV,iV,uV,lV,BF,cV,fV,dV,mV,I4];for(let r of oye)Fl(r);J0(`https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@${Q0}/dist/`);var ag=new Stats;ag.showPanel(0);document.body.prepend(ag.domElement);var gV,wu,ck,pk,yo,ic,pn=document.getElementById("breakout"),ar=pn.getContext("2d"),df=10,aa=pn.width/2,ku=pn.height-30,uc=2,bo=-2,vV=10,mf=75,sa=(pn.width-mf)/2,aye=!1,sye=!1,sg=7,ig=5,fk=75,dk=20,xV=10,iye=30,uye=30,mk=0,hk=3,lc=[];for(let r=0;r<ig;r++){lc[r]=[];for(let e=0;e<sg;e++)lc[r][e]={x:0,y:0,status:1}}function lye(){for(let r=0;r<ig;r++)for(let e=0;e<sg;e++){let t=lc[r][e];t.status==1&&aa>t.x&&aa<t.x+fk&&ku>t.y&&ku<t.y+dk&&(bo=-bo,t.status=0,mk++,mk==sg*ig&&(alert("YOU WIN, CONGRATS!"),document.location.reload()))}}function cye(){ar.beginPath(),ar.arc(aa,ku,df,0,Math.PI*2),ar.fillStyle="#0095DD",ar.fill(),ar.closePath()}function pye(){ar.beginPath(),ar.rect(sa,pn.height-vV,mf,vV),ar.fillStyle="#0095DD",ar.fill(),ar.closePath()}function fye(){for(let r=0;r<ig;r++)for(let e=0;e<sg;e++)if(lc[r][e].status==1){let t=e*(fk+xV)+uye,n=r*(dk+xV)+iye;lc[r][e].x=t,lc[r][e].y=n,ar.beginPath(),ar.rect(t,n,fk,dk),ar.fillStyle="#0095DD",ar.fill(),ar.closePath()}}function dye(){ar.font="16px Arial",ar.fillStyle="#0095DD",ar.fillText("Score: "+mk,8,20)}function mye(){ar.font="16px Arial",ar.fillStyle="#0095DD",ar.fillText("Lives: "+hk,pn.width-65,20)}function yV(){ar.clearRect(0,0,pn.width,pn.height),fye(),cye(),pye(),dye(),mye(),lye(),(aa+uc>pn.width-df||aa+uc<df)&&(uc=-uc),ku+bo<df?bo=-bo:ku+bo>pn.height-df&&(aa>sa&&aa<sa+mf?bo=-bo:(hk--,hk?(aa=pn.width/2,ku=pn.height-30,uc=2,bo=-2,sa=(pn.width-mf)/2):(alert("GAME OVER"),document.location.reload()))),aye&&sa<pn.width-mf?sa+=7:sye&&sa>0&&(sa-=7),aa+=uc,ku+=bo,requestAnimationFrame(yV)}yV();var bV={backend:"wasm"},hye=new dat.GUI;hye.add(bV,"backend",["wasm","webgl","cpu"]).onChange(r=>Be(void 0,null,function*(){yield e0(r)}));function gye(){return Be(this,null,function*(){yo=document.getElementById("video");let r=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}});return yo.srcObject=r,new Promise(e=>{yo.onloadedmetadata=()=>{e(yo)}})})}var wV=()=>Be(void 0,null,function*(){ag.begin();let r=!1,e=!0,t=!0,n=yield gV.estimateFaces(yo,r,e,t);if(n.length>0){wu.clearRect(0,0,ic.width,ic.height);for(let o=0;o<n.length;o++){r&&(n[o].topLeft=n[o].topLeft.arraySync(),n[o].bottomRight=n[o].bottomRight.arraySync(),t&&(n[o].landmarks=n[o].landmarks.arraySync()));let a=n[o].topLeft,i=n[o].bottomRight,s=[i[0]-a[0],i[1]-a[1]];if(wu.fillStyle="rgb(224, 247, 250)",wu.fillRect(a[0],a[1],s[0],s[1]),t){let u=n[o].landmarks;wu.fillStyle="blue";let l=u[2][0],c=u[2][1];wu.fillRect(l,c,5,5),sa=l}}}ag.end(),requestAnimationFrame(wV)}),vye=()=>Be(void 0,null,function*(){yield e0(bV.backend),yield gye(),yo.play(),ck=yo.videoWidth,pk=yo.videoHeight,yo.width=ck,yo.height=pk,ic=document.getElementById("output"),ic.width=ck,ic.height=pk,wu=ic.getContext("2d"),wu.fillStyle="rgba(255, 0, 0, 0.5)",gV=yield hV.load(),wV()});vye();})();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/** @license See the LICENSE file. */
//# sourceMappingURL=index.js.map
